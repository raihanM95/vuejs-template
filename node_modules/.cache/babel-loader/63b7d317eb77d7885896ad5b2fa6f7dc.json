{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\ipd\\IPDPatientList.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\ipd\\IPDPatientList.js","mtime":1664188912336},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L1NWTiBQUk9KRUNUUy9FUlBfSG9zcGl0YWxfQ2xpZW50L3RydW5rL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCBBZG1pc3Npb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvZnJvbnQtZGVzay9BZG1pc3Npb25TZXJ2aWNlIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwppbXBvcnQgVmFsaWRhdGlvbiBmcm9tICIuLi8uLi9zY3JpcHRzL3ZhbGlkYXRpb24iOwppbXBvcnQgeyBGaWx0ZXJNYXRjaE1vZGUsIEZpbHRlck9wZXJhdG9yIH0gZnJvbSAicHJpbWV2dWUvYXBpIjsgLy8gUHJlc2NyaXB0aW9uCgppbXBvcnQgQXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvZG9jdG9yLXBhbmVsL0FwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSI7CmltcG9ydCBBZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcHJlc2NyaXB0aW9uL0FkbWlzc2lvblByZXNjcmlwdGlvblNlcnZpY2UiOyAvLyBQcmVzY3JpcHRpb24gVHJlYXRtZW50CgppbXBvcnQgTWVkaWNpbmVUeXBlU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvTWVkaWNpbmVUeXBlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IE1lZGljaW5lU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvTWVkaWNpbmVTZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSI7CmltcG9ydCBUcmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlIjsgLy8gSGlzdG9yeQoKaW1wb3J0IFBhdGllbnRQcm9maWxlU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3Byb2ZpbGVzL1BhdGllbnRQcm9maWxlU2VydmljZSI7IC8vaW1wb3J0IFdvcmRDYWJpblNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1dvcmRDYWJpblNldHVwU2VydmljZSI7CgppbXBvcnQgQ29tcGxhaW50U2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvQ29tcGxhaW50U2V0dXBTZXJ2aWNlIjsKaW1wb3J0IEZvb2RTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvRm9vZFNlcnZpY2UiOwppbXBvcnQgT25FeGFtaW5hdGlvblNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL09uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UiOwppbXBvcnQgRGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9EaWV0Q2hhcnRUZW1wbGF0ZVNldHVwU2VydmljZSI7CmltcG9ydCBEaWV0Q2hhcnRTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9EaWV0Q2hhcnRTZXR1cFNlcnZpY2UiOwppbXBvcnQgRGlhZ25vc2lzU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvRGlhZ25vc2lzU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IENvbW1vblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9Db21tb25TZXJ2aWNlIjsKaW1wb3J0IFByZXNjcmlwdGlvblJlcG9ydFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9yZXBvcnQvUHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZSI7IC8vIERpc2NoYXJnZQoKaW1wb3J0IElQRFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9pcGQvSVBEU2VydmljZSI7CmltcG9ydCB7IENvb2xTZWxlY3QgfSBmcm9tICd2dWUtY29vbC1zZWxlY3QnOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ29vbFNlbGVjdDogQ29vbFNlbGVjdAogIH0sCiAgLy8gLi4uCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRhdGFMaXN0OiB0cnVlLAogICAgICBpc0RvY3RvcjogZmFsc2UsCiAgICAgIGFkbWl0dGVkUGF0aWVudExpc3Q6IFtdLAogICAgICBhZG1pdHRlZFBhdGllbnQ6IHsKICAgICAgICBjZGZyb21kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICAvLyBjZGZyb21kYXRlOiBtb21lbnQoCiAgICAgICAgLy8gICBTdHJpbmcobmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpIC0gNjApKSkKICAgICAgICAvLyApLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGNkdG9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSAvLyBjZHRvZGF0ZTogbW9tZW50KAogICAgICAgIC8vICAgU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSArIDcpKSkKICAgICAgICAvLyApLmZvcm1hdCgiTU0vREQvWVlZWSIpLAoKICAgICAgfSwKICAgICAgLy8KICAgICAgc3VibWl0dGVkOiBmYWxzZSwKICAgICAgZmlsdGVyczogewogICAgICAgIGdsb2JhbDogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5DT05UQUlOUwogICAgICAgIH0sCiAgICAgICAgbmFtZTogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5pdEZpbHRlcnM6IGZ1bmN0aW9uIGluaXRGaWx0ZXJzKCkgewogICAgICAgIHRoaXMuZmlsdGVycyA9IHsKICAgICAgICAgIGdsb2JhbDogewogICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICAgIH0sCiAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgIG9wZXJhdG9yOiBGaWx0ZXJPcGVyYXRvci5BTkQsCiAgICAgICAgICAgIGNvbnN0cmFpbnRzOiBbewogICAgICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLlNUQVJUU19XSVRICiAgICAgICAgICAgIH1dCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSwKICAgICAgLy8gRGlzY2hhcmdlCiAgICAgIGlzRGlzY2hhcmdlOiBmYWxzZSwKICAgICAgZGlzY2hhcmdlRGlhbG9nOiBmYWxzZSwKICAgICAgZGlzY2hhcmdlT2JqOiB7CiAgICAgICAgYUFkbWlzc2lvbkJlZERldGFpbHM6IHt9CiAgICAgIH0sCiAgICAgIC8vIFByZXNjcmlwdGlvbgogICAgICBhZG1pdHRlZFBhdGllbnRJbmZvOiB7fSwKICAgICAgcHJlc2NyaXB0aW9uRGF0YUxpc3Q6IFtdLAogICAgICB0ZW1wRGF0YTogW10sCiAgICAgIGhlYWRlck5hbWU6ICJTZWN0aW9ucyIsCiAgICAgIGFkbWlzc2lvblByZXNjcmlwdGlvbkluZm86IHsKICAgICAgICBjZHByZXNjcmlwdGlvbl9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZGZvbG93dXBfZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBhbGxBZHZpY2U6IGZhbHNlLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb246IFtdLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudDogW10sCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9LAogICAgICAvLyBQcmVzY3JpcHRpb24gVHJlYXRtZW50CiAgICAgIHRyZWF0bWVudEFkZERpYWxvZzogZmFsc2UsCiAgICAgIHRyZWF0bWVudERpYWxvZzogZmFsc2UsCiAgICAgIHRyZWF0bWVudFNldHVwOiB7fSwKICAgICAgbWVkaWNpbmVUeXBlTGlzdDogW10sCiAgICAgIG1lZGljaW5lTGlzdDogW10sCiAgICAgIHRyZWF0bWVudFJ1bGVzTGlzdDogW10sCiAgICAgIHRyZWF0bWVudER1cmF0aW9uTGlzdDogW10sCiAgICAgIHRyZWF0bWVudERvc2VMaXN0OiBbXSwKICAgICAgLy8gU2VjdGlvbgogICAgICBTZWN0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgLy8gSGlzdG9yeQogICAgICBpc0hpc3Rvcnk6IGZhbHNlLAogICAgICBhY3RpdmU6IDAsCiAgICAgIGV4cGFuZGVkUm93czogW10sCiAgICAgIGlzRmVtYWxlOiBmYWxzZSwKICAgICAgY2hpZWZDb21wbGFpbkRpYWxvZzogZmFsc2UsCiAgICAgIGNoaWVmQ29tcGxhaW46IHt9LAogICAgICBjaGllZkNvbXBsYWluTGlzdDogW10sCiAgICAgIGNvbXBsaWFudExpc3Q6IFtdLAogICAgICBmb29kRGlhbG9nOiBmYWxzZSwKICAgICAgZm9vZFNldHVwOiB7fSwKICAgICAgYWxsZXJneURldGFpbHNEaWFsb2c6IGZhbHNlLAogICAgICBhbGxlcmd5RGV0YWlsczoge30sCiAgICAgIGFsbGVyZ3lEZXRhaWxzTGlzdDogW10sCiAgICAgIGZvb2RMaXN0OiBbXSwKICAgICAgYWxsZXJneVR5cGVMaXN0OiBbXSwKICAgICAgb25FeGFtaW5hdGlvbkRpYWxvZzogZmFsc2UsCiAgICAgIG9uRXhhbWluYXRpb246IHt9LAogICAgICBwYXRpZW50T25FeGFtaW5hdGlvbkxpc3Q6IFtdLAogICAgICBvbkV4YW1pbmF0aW9uTGlzdDogW10sCiAgICAgIGlPQ2hhcnREaWFsb2c6IGZhbHNlLAogICAgICBpT0NoYXJ0OiB7fSwKICAgICAgaU9DaGFydExpc3Q6IFtdLAogICAgICBkaWFiZXRlc0NoYXJ0RGlhbG9nOiBmYWxzZSwKICAgICAgZGlhYmV0ZXNDaGFydDogewogICAgICAgIGFBZG1pc3Npb25TZXJ2aWNlRGV0YWlsczoge30KICAgICAgfSwKICAgICAgZGlhYmV0ZXNDaGFydExpc3Q6IFtdLAogICAgICBkaWFiZXRlc01lYWxMaXN0OiBbXSwKICAgICAgZGlldENoYXJ0RGlhbG9nOiBmYWxzZSwKICAgICAgZGlldENoYXJ0OiB7fSwKICAgICAgZGlldENoYXJ0TGlzdDogW10sCiAgICAgIGRpZXRDaGFydFRlbXBsYXRlTGlzdDogW10sCiAgICAgIGRpZXRDaGFydFRlbXBMaXN0OiBbXSwKICAgICAgY3VycmVudE1lZGljYXRpb25zRGlhbG9nOiBmYWxzZSwKICAgICAgY3VycmVudE1lZGljYXRpb25zOiB7fSwKICAgICAgY3VycmVudE1lZGljYXRpb25zTGlzdDogW10sCiAgICAgIHBhc3RNZWRpY2FsSGlzdG9yeURpYWxvZzogZmFsc2UsCiAgICAgIHBhc3RNZWRpY2FsSGlzdG9yeToge30sCiAgICAgIHBhc3RNZWRpY2FsSGlzdG9yeUxpc3Q6IFtdLAogICAgICBkaWFnbm9zaXNMaXN0OiBbXSwKICAgICAgcGF0aWVudExhdGVzdEhpc3Rvcnk6IHsKICAgICAgICBsc3RQYXRpZW50T25FeGFtaW5hdGlvbjogW10sCiAgICAgICAgbHN0UGF0aWVudEFsbGVyZ3lEZXRhaWxzOiBbXSwKICAgICAgICBsc3RQYXRpZW50RGlhYmV0ZXNDaGFydDogW10sCiAgICAgICAgbHN0UGF0aWVudERpZXRDaGFydDogW10KICAgICAgfSwKICAgICAgcGF0aWVudEhpc3Rvcnk6IHsKICAgICAgICBsc3RQZXJzb25hbEhpc3Rvcnk6IFtdLAogICAgICAgIGxzdEZhbWlseUhpc3Rvcnk6IFtdLAogICAgICAgIGxzdFN5c3RlbXNSZXZpZXc6IFtdLAogICAgICAgIGxzdFN1YnN0YW5jZVVzZTogW10sCiAgICAgICAgbHN0UmVwcm9kdWN0aXZlSGlzdG9yeTogW10KICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIC8vIHBhc3QgZGF0ZS15ZWFyIGRpc2FibGVkCiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgdmFyIG1vbnRoID0gdG9kYXkuZ2V0TW9udGgoKTsKICAgIHZhciB5ZWFyID0gdG9kYXkuZ2V0RnVsbFllYXIoKTsKICAgIHZhciBwcmV2TW9udGggPSBtb250aCA9PT0gMCA/IDExIDogbW9udGggLSAwOwogICAgdmFyIHByZXZZZWFyID0gcHJldk1vbnRoID09PSAxMSA/IHllYXIgLSAwIDogeWVhcjsKICAgIHRoaXMubWluRGF0ZSA9IG5ldyBEYXRlKCk7CiAgICB0aGlzLm1pbkRhdGUuc2V0TW9udGgocHJldk1vbnRoKTsKICAgIHRoaXMubWluRGF0ZS5zZXRGdWxsWWVhcihwcmV2WWVhcik7IC8vdGhpcy53b3JkQ2FiaW5TZXR1cFNlcnZpY2UgPSBuZXcgV29yZENhYmluU2V0dXBTZXJ2aWNlKCk7CgogICAgdGhpcy5hZG1pc3Npb25TZXJ2aWNlID0gbmV3IEFkbWlzc2lvblNlcnZpY2UoKTsgLy8gUHJlc2NyaXB0aW9uCgogICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlID0gbmV3IEFkbWlzc2lvblByZXNjcmlwdGlvblNlcnZpY2UoKTsKICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlID0gbmV3IEFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSgpOyAvLyBQcmVzY3JpcHRpb24gVHJlYXRtZW50CgogICAgdGhpcy5tZWRpY2luZVR5cGVTZXR1cFNlcnZpY2UgPSBuZXcgTWVkaWNpbmVUeXBlU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLm1lZGljaW5lU2V0dXBTZXJ2aWNlID0gbmV3IE1lZGljaW5lU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgPSBuZXcgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSgpOyAvLyBIaXN0b3J5CgogICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UgPSBuZXcgUGF0aWVudFByb2ZpbGVTZXJ2aWNlKCk7CiAgICB0aGlzLmNvbXBsYWludFNldHVwU2VydmljZSA9IG5ldyBDb21wbGFpbnRTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZm9vZFNlcnZpY2UgPSBuZXcgRm9vZFNlcnZpY2UoKTsKICAgIHRoaXMub25FeGFtaW5hdGlvblNldHVwU2VydmljZSA9IG5ldyBPbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmRpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlID0gbmV3IERpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmRpZXRDaGFydFNldHVwU2VydmljZSA9IG5ldyBEaWV0Q2hhcnRTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlID0gbmV3IERpYWdub3Npc1NldHVwU2VydmljZSgpOwogICAgdGhpcy5jb21tb25TZXJ2aWNlID0gbmV3IENvbW1vblNlcnZpY2UoKTsKICAgIHRoaXMudmFsaWRhdGlvbiA9IG5ldyBWYWxpZGF0aW9uKCk7CiAgICB0aGlzLnByZXNjcmlwdGlvblJlcG9ydFNlcnZpY2UgPSBuZXcgUHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZSgpOyAvLyBEaXNjaGFyZ2UKCiAgICB0aGlzLmlQRFNlcnZpY2UgPSBuZXcgSVBEU2VydmljZSgpOyAvLyB0aGlzLndvcmRDYWJpblNldHVwU2VydmljZQogICAgLy8gICAgIC5nZXRBbGwoKQogICAgLy8gICAgIC50aGVuKChkYXRhKSA9PiAodGhpcy53b3JkQ2FiaW5MaXN0ID0gZGF0YS5kYXRhKSk7CgogICAgdmFyIHRoYXQgPSB0aGlzOwoKICAgIGRvY3VtZW50Lm9ua2V5dXAgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzMpIHsKICAgICAgICB0aGF0LmdldEludmVzdGlnYXRpb24oKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4NCkgewogICAgICAgIHRoYXQuZ2V0VHJlYXRtZW50KCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNjUpIHsKICAgICAgICB0aGF0LmdldEFkdmljZSgpOwogICAgICB9IC8vIGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLnNoaWZ0S2V5KSB7CiAgICAgIC8vIH0KCiAgICB9OwoKICAgIHRoaXMubWVkaWNpbmVUeXBlU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMubWVkaWNpbmVUeXBlTGlzdCA9IGRhdGEuZGF0YTsKICAgIH0pOwogICAgdGhpcy51c2VySW5mbyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJbmZvIikpOwogICAgdGhpcy5zaG93KCk7CgogICAgaWYgKHRoaXMudXNlckluZm8uZG9jdG9yX2lkKSB7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlLmdldFByZXNjcmlwdGlvbkRhdGFCeURvY3RvcklkKHRoaXMudXNlckluZm8uZG9jdG9yX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy5kb2N0b3JfaWQgPSB0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZDsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmRvY3Rvcl9pZCA9IHRoaXMuZG9jdG9yX2lkOwogICAgICB0aGlzLmlzRG9jdG9yID0gdHJ1ZTsKICAgIH0gZWxzZSBpZiAoIXRoaXMudXNlckluZm8uZG9jdG9yX2lkKSB7CiAgICAgIHRoaXMuaXNEb2N0b3IgPSBmYWxzZTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLmFkbWl0dGVkUGF0aWVudC5jZGZyb21kYXRlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmFkbWl0dGVkUGF0aWVudC5jZHRvZGF0ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudC5mcm9tZGF0ZSA9IG1vbWVudChTdHJpbmcodGhpcy5hZG1pdHRlZFBhdGllbnQuY2Rmcm9tZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50LnRvZGF0ZSA9IG1vbWVudChTdHJpbmcodGhpcy5hZG1pdHRlZFBhdGllbnQuY2R0b2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICB0aGlzLnVzZXJJbmZvID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlckluZm8iKSk7CiAgICAgICAgdGhpcy5hZG1pc3Npb25TZXJ2aWNlLmFkbWl0dGVkUGF0aWVudExpc3RGb3JUcmVhdG1lbnRCeURvY3RvcklkKHRoaXMuYWRtaXR0ZWRQYXRpZW50LmZyb21kYXRlLCB0aGlzLmFkbWl0dGVkUGF0aWVudC50b2RhdGUsIHRoaXMudXNlckluZm8uZG9jdG9yX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLmFkbWl0dGVkUGF0aWVudExpc3QgPSBkYXRhLmRhdGE7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhTGlzdCA9IHRydWU7CiAgICB9LAogICAgcHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBwcmVzY3JpcHRpb24oZGF0YSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5hZG1pc3Npb25faWQgPSBkYXRhLmFkbWlzc2lvbl9pZDsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFkbWlzc2lvbl9ubyA9IGRhdGEuYWRtaXNzaW9uX25vOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWRtaXNzaW9uSWRGb3JEaWFiZXRlc1NlcnZpY2UnLCBkYXRhLmFkbWlzc2lvbl9pZCk7CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5wYXRpZW50X2lkID0gZGF0YS5wYXRpZW50X2lkOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncGF0aWVudElkRm9yVHJlYXRtZW50JywgZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLnJlZ2lzdHJhdGlvbl9ubyA9IGRhdGEucmVnaXN0cmF0aW9uX25vOwogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8ucGF0aWVudF9uYW1lID0gZGF0YS5wYXRpZW50X25hbWU7CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5nZW5kZXIgPSBkYXRhLmdlbmRlcjsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV95ZWFyID0gZGF0YS5hZ2VfeWVhcjsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV9tb250aCA9IGRhdGEuYWdlX21vbnRoOwogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8uYWdlX2RheSA9IGRhdGEuYWdlX2RheTsKICAgICAgdGhpcy5kYXRhTGlzdCA9IGZhbHNlOwogICAgICB0aGlzLmdldENvbXBsYWluc0J5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7IC8vIFVzZSBmb3IgRGlhbG9nIC8vCgogICAgICB0aGlzLmNvbXBsYWludFNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLmNvbXBsaWFudExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmZvb2RTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMuZm9vZExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5vbkV4YW1pbmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlLmdldEFsbCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLmRpYWdub3Npc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmNvbW1vblNlcnZpY2UuR2V0QWxsQWxsZXJneVR5cGUoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5hbGxlcmd5VHlwZUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmNvbW1vblNlcnZpY2UuR2V0QWxsRGlhYmV0ZXNNZWFsKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMuZGlhYmV0ZXNNZWFsTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5kaWV0Q2hhcnRUZW1wbGF0ZUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOyAvLyBVc2UgZm9yIERpYWxvZyAvLwogICAgICAvLyBQcmV2aW91cyBQcmVzY3JpcHRpb24gRGF0YQoKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlLmdldFByZXZpb3VzUHJlc2NyaXB0aW9uRGF0YUFkbWlzc2lvbklkKGRhdGEuYWRtaXNzaW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5wcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFGb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgfSk7IC8vIFByZXNjcmlwdGlvbiBUcmVhdG1lbnQKCiAgICAgIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5tZWRpY2luZUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMudHJlYXRtZW50UnVsZXNMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy50cmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLnRyZWF0bWVudER1cmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLnRyZWF0bWVudERvc2VMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBwcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFGb3JtYXR0ZWQ6IGZ1bmN0aW9uIHByZXZpb3VzUHJlc2NyaXB0aW9uRGF0YUZvcm1hdHRlZChkYXRhKSB7CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5jZHByZXNjcmlwdGlvbl9kYXRlID0gbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5jZGZvbG93dXBfZGF0ZSA9IG1vbWVudChTdHJpbmcobmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpICsgNykpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQgPSBkYXRhLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudDsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZSA9IGRhdGEubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbiA9IGRhdGEubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbjsKICAgIH0sCiAgICBnZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb246IGZ1bmN0aW9uIGdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbigpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbihwYXRpZW50SWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LnBhdGllbnRMYXRlc3RIaXN0b3J5ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBHZXQgUHJlc2NyaXB0aW9uIERhdGEKICAgIGdldEludmVzdGlnYXRpb246IGZ1bmN0aW9uIGdldEludmVzdGlnYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIkludmVzdGlnYXRpb24iOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdEludmVzdGlnYXRpb24uZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzNS50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuaW52ZXN0aW5nYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmludmVzdGlnYXRpb25faWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuU2VjdGlvbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZ2V0VHJlYXRtZW50OiBmdW5jdGlvbiBnZXRUcmVhdG1lbnQoKSB7CiAgICAgIHRoaXMudHJlYXRtZW50QWRkRGlhbG9nID0gdHJ1ZTsgLy8gdGhpcy5oZWFkZXJOYW1lID0gIk1lZGljaW5lIjsKICAgICAgLy8gdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICAvLyB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIC8vIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgLy8gdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RUcmVhdG1lbnQuZm9yRWFjaCgoZWxlbWVudCkgPT4gewogICAgICAvLyAgIHRoaXMudGVtcERhdGEucHVzaCh7CiAgICAgIC8vICAgICBfbWVkaWNpbmVfdHlwZV9uYW1lOiBlbGVtZW50Ll9tZWRpY2luZV90eXBlX25hbWUsCiAgICAgIC8vICAgICBfbWVkaWNpbmVfbmFtZTogZWxlbWVudC5fbWVkaWNpbmVfbmFtZSwKICAgICAgLy8gICAgIG5hbWU6IGVsZW1lbnQuX21lZGljaW5lX3R5cGVfbmFtZSArICIgIiArIGVsZW1lbnQuX21lZGljaW5lX25hbWUgKyAiICIgKyBlbGVtZW50Ll90cmVhdG1lbnRfZG9zZV9uYW1lICsgIiAiICsgZWxlbWVudC5fdHJlYXRtZW50X3J1bGVfbmFtZSArICIgIiArIGVsZW1lbnQuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAvLyAgICAgaWQ6IGVsZW1lbnQubWVkaWNpbmVfaWQsCiAgICAgIC8vICAgICBfdHJlYXRtZW50X2Rvc2VfbmFtZTogZWxlbWVudC5fdHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgLy8gICAgIHRyZWF0bWVudF9kb3NlX2lkOiBlbGVtZW50LnRyZWF0bWVudF9kb3NlX2lkLAogICAgICAvLyAgICAgX3RyZWF0bWVudF9ydWxlX25hbWU6IGVsZW1lbnQuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgIC8vICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IGVsZW1lbnQudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAvLyAgICAgX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lOiBlbGVtZW50Ll90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgLy8gICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogZWxlbWVudC50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgIC8vICAgICBkZXNjcmlwdGlvbjogZWxlbWVudC5kZXNjcmlwdGlvbiwKICAgICAgLy8gICB9KTsKICAgICAgLy8gfSk7CiAgICB9LAogICAgc2F2ZVRyZWF0bWVudDogZnVuY3Rpb24gc2F2ZVRyZWF0bWVudCgpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lX3R5cGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgYU1lZGljaW5lID0gdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwubWVkaWNpbmVfaWQgPT09IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudmFsdWU7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYU1lZGljaW5lLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudC5wdXNoKHsKICAgICAgICAgICAgX21lZGljaW5lX3R5cGVfbmFtZTogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlLnRleHQsCiAgICAgICAgICAgIG5hbWU6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudGV4dCwKICAgICAgICAgICAgbWVkaWNpbmVfaWQ6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudmFsdWUsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZG9zZV9uYW1lOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnRleHQsCiAgICAgICAgICAgIHRyZWF0bWVudF9kb3NlX2lkOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnZhbHVlLAogICAgICAgICAgICBfdHJlYXRtZW50X3J1bGVfbmFtZTogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudGV4dCwKICAgICAgICAgICAgdHJlYXRtZW50X3J1bGVzX2lkOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy52YWx1ZSwKICAgICAgICAgICAgX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbi50ZXh0LAogICAgICAgICAgICB0cmVhdG1lbnRfZHVyYXRpb25faWQ6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnZhbHVlLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogIiIKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5oaWRlRGlhbG9nKCk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRBZHZpY2U6IGZ1bmN0aW9uIGdldEFkdmljZSgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiQWR2aWNlIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gdHJ1ZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdEFkdmljZXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzNi50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuYWR2aWNlX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5hZHZpY2VfaWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuU2VjdGlvbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgLy8gQWRkIGFsbCBhZHZpY2UgY2hlY2tib3gKICAgIGFkZEFsbEFkdmljZTogZnVuY3Rpb24gYWRkQWxsQWR2aWNlKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmFsbEFkdmljZSkgewogICAgICAgIHRoaXMudGVtcERhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgdmFyIGFBZHZpY2UgPSBfdGhpczcuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICByZXR1cm4gZWwuYWR2aWNlX2lkID09PSBlbGVtZW50LmlkOwogICAgICAgICAgfSwgX3RoaXM3KTsKCiAgICAgICAgICBpZiAoIWFBZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICAgIF90aGlzNy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZS5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiBlbGVtZW50Lm5hbWUsCiAgICAgICAgICAgICAgYWR2aWNlX2lkOiBlbGVtZW50LmlkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8gQWRkIHZhbHVlIAogICAgZ2V0VmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlKGRhdGEpIHsKICAgICAgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiSW52ZXN0aWdhdGlvbiIpIHsKICAgICAgICB2YXIgYUludmVzdGlnYXRpb24gPSB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbi5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuaW52ZXN0aWdhdGlvbl9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhSW52ZXN0aWdhdGlvbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uLnB1c2goewogICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgICAgIGludmVzdGlnYXRpb25faWQ6IGRhdGEuaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIk1lZGljaW5lIikgewogICAgICAgIHZhciBhTWVkaWNpbmUgPSB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5tZWRpY2luZV9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhTWVkaWNpbmUubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50LnB1c2goewogICAgICAgICAgICBfbWVkaWNpbmVfdHlwZV9uYW1lOiBkYXRhLl9tZWRpY2luZV90eXBlX25hbWUsCiAgICAgICAgICAgIG5hbWU6IGRhdGEuX21lZGljaW5lX25hbWUsCiAgICAgICAgICAgIG1lZGljaW5lX2lkOiBkYXRhLmlkLAogICAgICAgICAgICBfdHJlYXRtZW50X2Rvc2VfbmFtZTogZGF0YS5fdHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgICAgICAgdHJlYXRtZW50X2Rvc2VfaWQ6IGRhdGEudHJlYXRtZW50X2Rvc2VfaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfcnVsZV9uYW1lOiBkYXRhLl90cmVhdG1lbnRfcnVsZV9uYW1lLAogICAgICAgICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IGRhdGEudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAgICAgICBfdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IGRhdGEuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAgICAgICB0cmVhdG1lbnRfZHVyYXRpb25faWQ6IGRhdGEudHJlYXRtZW50X2R1cmF0aW9uX2lkLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiQWR2aWNlIikgewogICAgICAgIHZhciBhQWR2aWNlID0gdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuYWR2aWNlX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFBZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlLnB1c2goewogICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgICAgIGFkdmljZV9pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaGlkZURpYWxvZzogZnVuY3Rpb24gaGlkZURpYWxvZygpIHsKICAgICAgdGhpcy5TZWN0aW9uRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMudHJlYXRtZW50QWRkRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gZmFsc2U7CiAgICAgIHZhciBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKICAgICAgdGhpcy5jaGllZkNvbXBsYWluRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbiA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5mb29kRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuZm9vZFNldHVwID0ge307CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHNEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlscyA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7IC8vIHRoaXMub25FeGFtaW5hdGlvbiA9IHsKICAgICAgLy8gICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgLy8gfTsKCiAgICAgIHRoaXMuaU9DaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmlPQ2hhcnQgPSB7CiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkCiAgICAgIH07CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmRpYWJldGVzQ2hhcnQgPSB7CiAgICAgICAgYUFkbWlzc2lvblNlcnZpY2VEZXRhaWxzOiB7fSwKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5kaWV0Q2hhcnREaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5kaWV0Q2hhcnQgPSB7CiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkCiAgICAgIH07CiAgICAgIHRoaXMuY3VycmVudE1lZGljYXRpb25zRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudE1lZGljYXRpb25zID0gewogICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICB9OwogICAgICB0aGlzLnBhc3RNZWRpY2FsSGlzdG9yeURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnBhc3RNZWRpY2FsSGlzdG9yeSA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsgLy8gRGlzY2hhcmdlCgogICAgICB0aGlzLmRpc2NoYXJnZURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmRpc2NoYXJnZU9iaiA9IHsKICAgICAgICBhQWRtaXNzaW9uQmVkRGV0YWlsczoge30KICAgICAgfTsKICAgIH0sCiAgICBmaWx0ZXJNZWRpY2luZVR5cGVXaXNlOiBmdW5jdGlvbiBmaWx0ZXJNZWRpY2luZVR5cGVXaXNlKCkgewogICAgICBpZiAodGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlKSB7CiAgICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlLnRleHQ7CiAgICAgICAgcmV0dXJuIHRoaXMubWVkaWNpbmVMaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5yZWZpZCA9PT0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlLnZhbHVlOwogICAgICAgIH0sIHRoaXMpOwogICAgICB9CiAgICB9LAogICAgZWRpdFRyZWF0bWVudDogZnVuY3Rpb24gZWRpdFRyZWF0bWVudChkYXRhLCBpbmRleCkgewogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLm1lZGljaW5lTmFtZSA9IGRhdGEubmFtZTsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMgPSB7CiAgICAgICAgdGV4dDogZGF0YS5fdHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgICB2YWx1ZTogZGF0YS50cmVhdG1lbnRfcnVsZXNfaWQsCiAgICAgICAgcmVmaWQ6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24gPSB7CiAgICAgICAgdGV4dDogZGF0YS5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X2R1cmF0aW9uX2lkLAogICAgICAgIHJlZmlkOiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UgPSB7CiAgICAgICAgdGV4dDogZGF0YS5fdHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgICB2YWx1ZTogZGF0YS50cmVhdG1lbnRfZG9zZV9pZCwKICAgICAgICByZWZpZDogbnVsbAogICAgICB9OwogICAgICB0aGlzLnRyZWF0bWVudERpYWxvZyA9IHRydWU7CiAgICAgIHRoaXMudHJlYXRtZW50SW5kZXggPSBpbmRleDsKICAgIH0sCiAgICB0cmVhdG1lbnRFZGl0U2F2ZTogZnVuY3Rpb24gdHJlYXRtZW50RWRpdFNhdmUoKSB7CiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIC8vdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS50ZXh0OwogICAgICAgIC8vdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5tZWRpY2luZV9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudmFsdWU7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5fdHJlYXRtZW50X3J1bGVfbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnRleHQ7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS50cmVhdG1lbnRfcnVsZXNfaWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy52YWx1ZTsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnRleHQ7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS50cmVhdG1lbnRfZHVyYXRpb25faWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbi52YWx1ZTsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfZG9zZV9uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZS50ZXh0OwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X2Rvc2VfaWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnZhbHVlOwogICAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gZmFsc2U7CiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGRlbGV0ZUl0ZW06IGZ1bmN0aW9uIGRlbGV0ZUl0ZW0obHN0LCBkYXRhKSB7CiAgICAgIGxzdC5zcGxpY2UobHN0LmZpbmRJbmRleChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpID09PSBkYXRhOwogICAgICB9KSwgMSk7CiAgICB9LAogICAgYWRkOiBmdW5jdGlvbiBhZGQoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczguYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQbGVhc2UgYWRkIFBhdGllbnQgQWR2aWNlIiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBfdGhpczguYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5hZG1pc3Npb25faWQgPSBfdGhpczguYWRtaXR0ZWRQYXRpZW50SW5mby5hZG1pc3Npb25faWQ7CiAgICAgICAgICAgICAgICBfdGhpczguYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5wcmVzY3JpcHRpb25fZGF0ZSA9IG1vbWVudChTdHJpbmcoX3RoaXM4LmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uY2RwcmVzY3JpcHRpb25fZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczguYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5jZGZvbG93dXBfZGF0ZSkgewogICAgICAgICAgICAgICAgICBfdGhpczguYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5mb2xvd3VwX2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzOC5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmNkZm9sb3d1cF9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOC5hZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlLmFkZChfdGhpczguYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mbyk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXM4LmRvd25sb2FkUHJlc2NyaXB0aW9uKHJlc3VsdC5kYXRhKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQcmVzY3JpYmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczgubmV3UHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczgucmVzZXQoKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzOC5zaG93KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTU7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICAgIF90aGlzOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzAsIDE1XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBkb3dubG9hZFByZXNjcmlwdGlvbjogZnVuY3Rpb24gZG93bmxvYWRQcmVzY3JpcHRpb24oYWRtaXNzaW9uX3ByZXNjcmlwdGlvbl9pZCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHRoaXMucHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZS5HZXRJUERQZXNjcmlwdGlvbihhZG1pc3Npb25fcHJlc2NyaXB0aW9uX2lkLCB0aGlzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzOS5jb21tb25TZXJ2aWNlLkRvd25sb2FkZmlsZShkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBuZXdQcmVzY3JpcHRpb246IGZ1bmN0aW9uIG5ld1ByZXNjcmlwdGlvbigpIHsKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIlNlY3Rpb25zIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mbyA9IHsKICAgICAgICBjZHByZXNjcmlwdGlvbl9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZGZvbG93dXBfZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBhbGxBZHZpY2U6IGZhbHNlLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb246IFtdLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudDogW10sCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9LCB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfSwKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnQgPSB7CiAgICAgICAgY2Rmcm9tZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgLy8gY2Rmcm9tZGF0ZTogbW9tZW50KAogICAgICAgIC8vICAgU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSAtIDYwKSkpCiAgICAgICAgLy8gKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZHRvZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIikgLy8gY2R0b2RhdGU6IG1vbWVudCgKICAgICAgICAvLyAgIFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpCiAgICAgICAgLy8gKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKCiAgICAgIH0sIC8vCiAgICAgIC8vIHRoaXMuZGF0YUxpc3QgPSB0cnVlOwogICAgICAvLyB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgICB0aGlzLmlzRGlzY2hhcmdlID0gZmFsc2U7CiAgICAgIHRoaXMuc2hvdygpOwogICAgfSwKICAgIGZvcm1hdERhdGU6IGZ1bmN0aW9uIGZvcm1hdERhdGUodmFsdWUpIHsKICAgICAgcmV0dXJuIG1vbWVudChTdHJpbmcodmFsdWUpKS5mb3JtYXQoIk1NL0REL1lZWVkiKTsKICAgIH0sCiAgICBmb3JtYXREYXRlVGltZTogZnVuY3Rpb24gZm9ybWF0RGF0ZVRpbWUodmFsdWUpIHsKICAgICAgcmV0dXJuIG1vbWVudChTdHJpbmcodmFsdWUpKS5mb3JtYXQoIk1NL0REL1lZWVkgaDptbTpzcyBhIik7CiAgICB9LAogICAgLy8gSGlzdG9yeQogICAgaGlzdG9yeTogZnVuY3Rpb24gaGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdmFyIGRhdGEgPSB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm87CgogICAgICBpZiAoZGF0YS5nZW5kZXIgPT0gIkZlbWFsZSIpIHsKICAgICAgICB0aGlzLmlzRmVtYWxlID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzRmVtYWxlID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSk7CgogICAgICBpZiAocGF0aWVudElkKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3BhdGllbnRJZEZvclRyZWF0bWVudCcpOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwYXRpZW50SWRGb3JUcmVhdG1lbnQnLCBkYXRhLnBhdGllbnRfaWQpOwogICAgICB9IGVsc2UgewogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwYXRpZW50SWRGb3JUcmVhdG1lbnQnLCBkYXRhLnBhdGllbnRfaWQpOwogICAgICB9IC8vIENvbGxlY3QgaGlzdG9yeSBwYXRpZW50IHdpc2UgLy8KCgogICAgICB0aGlzLmdldENvbXBsYWluc0J5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0QWxsZXJneURldGFpbHNCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldE9uRXhhbWluYXRpb25CeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldElPQ2hhcnRCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldERpYWJldGVzQ2hhcnRCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldERpZXRDaGFydEJ5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldFN5c3RlbVN1YnN0YW5jZShkYXRhLnBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMC5mb3JtYXR0ZWRTeXN0ZW1TdWJzdGFuY2UoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMuaXNIaXN0b3J5ID0gdHJ1ZTsKICAgICAgdGhpcy5kYXRhTGlzdCA9IGZhbHNlOyAvLyBDb2xsZWN0IGhpc3RvcnkgcGF0aWVudCB3aXNlIC8vCiAgICB9LAogICAgZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldENvbXBsYWluc0J5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgdGhpcy5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTEuY2hpZWZDb21wbGFpbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEFsbGVyZ3lEZXRhaWxzQnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldEFsbGVyZ3lEZXRhaWxzQnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CgogICAgICB0aGlzLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRBbGxlcmd5RGV0YWlsc0J5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5hbGxlcmd5RGV0YWlsc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldE9uRXhhbWluYXRpb25zUG9wdXA6IGZ1bmN0aW9uIGdldE9uRXhhbWluYXRpb25zUG9wdXAoKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIHZhciBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSk7CiAgICAgIHRoaXMucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEgPSBbXTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxMy5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5wdXNoKHsKICAgICAgICAgIF9vbl9leGFtaW5hdGlvbl9uYW1lOiBlbGVtZW50LnRleHQsCiAgICAgICAgICBvbl9leGFtaW5hdGlvbl9pZDogZWxlbWVudC52YWx1ZSwKICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX3Jlc3VsdDogU3RyaW5nKDEpLAogICAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkLnRvU3RyaW5nKCkKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvblBvcHVwRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBnZXRPbkV4YW1pbmF0aW9uQnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldE9uRXhhbWluYXRpb25CeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKCiAgICAgIHRoaXMub25FeGFtaW5hdGlvbi5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0T25FeGFtaW5hdGlvbkJ5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxNC5wYXRpZW50T25FeGFtaW5hdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldElPQ2hhcnRCeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0SU9DaGFydEJ5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgdGhpcy5pT0NoYXJ0LnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRJT0NoYXJ0QnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczE1LmlPQ2hhcnRMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnZXREaWFiZXRlc0NoYXJ0QnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldERpYWJldGVzQ2hhcnRCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydC5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0RGlhYmV0ZXNDaGFydEJ5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxNi5kaWFiZXRlc0NoYXJ0TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0RGlldENoYXJ0QnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldERpZXRDaGFydEJ5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMTcgPSB0aGlzOwoKICAgICAgdGhpcy5kaWV0Q2hhcnQucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldERpZXRDaGFydEJ5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxNy5kaWV0Q2hhcnRMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRDdXJyZW50TWVkaWNhdGlvbnNCeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgICB0aGlzLmN1cnJlbnRNZWRpY2F0aW9ucy5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczE4LmN1cnJlbnRNZWRpY2F0aW9uc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFBhc3RIaXN0b3J5QnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldFBhc3RIaXN0b3J5QnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMxOSA9IHRoaXM7CgogICAgICB0aGlzLnBhc3RNZWRpY2FsSGlzdG9yeS5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTkucGFzdE1lZGljYWxIaXN0b3J5TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZm9ybWF0dGVkU3lzdGVtU3Vic3RhbmNlOiBmdW5jdGlvbiBmb3JtYXR0ZWRTeXN0ZW1TdWJzdGFuY2UoZGF0YSkgewogICAgICAvL3RoaXMucGF0aWVudEhpc3RvcnkucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudEhpc3RvcnkubHN0UGVyc29uYWxIaXN0b3J5ID0gZGF0YS5sc3RQZXJzb25hbEhpc3Rvcnk7CiAgICAgIHRoaXMucGF0aWVudEhpc3RvcnkubHN0RmFtaWx5SGlzdG9yeSA9IGRhdGEubHN0RmFtaWx5SGlzdG9yeTsKICAgICAgdGhpcy5wYXRpZW50SGlzdG9yeS5sc3RTeXN0ZW1zUmV2aWV3ID0gZGF0YS5sc3RTeXN0ZW1zUmV2aWV3OwogICAgICB0aGlzLnBhdGllbnRIaXN0b3J5LmxzdFN1YnN0YW5jZVVzZSA9IGRhdGEubHN0U3Vic3RhbmNlVXNlOwogICAgICB0aGlzLnBhdGllbnRIaXN0b3J5LmxzdFJlcHJvZHVjdGl2ZUhpc3RvcnkgPSBkYXRhLmxzdFJlcHJvZHVjdGl2ZUhpc3Rvcnk7CiAgICB9LAogICAgaGlkZUhpc3Rvcnk6IGZ1bmN0aW9uIGhpZGVIaXN0b3J5KCkgewogICAgICB0aGlzLmlzSGlzdG9yeSA9IGZhbHNlOwogICAgICB0aGlzLmRhdGFMaXN0ID0gZmFsc2U7IC8vbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3BhdGllbnRJZEZvclRyZWF0bWVudCcpOwogICAgfSwKICAgIG5ld0NoaWVmQ29tcGxhaW46IGZ1bmN0aW9uIG5ld0NoaWVmQ29tcGxhaW4oKSB7CiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQ2hpZWZDb21wbGFpbjogZnVuY3Rpb24gYWRkQ2hpZWZDb21wbGFpbigpIHsKICAgICAgdmFyIF90aGlzMjAgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHBhdGllbnRJZCwgcmVzdWx0LCBfcmVzdWx0OwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICBfdGhpczIwLmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCA9IHBhdGllbnRJZDsKICAgICAgICAgICAgICAgIF90aGlzMjAuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMC5jaGllZkNvbXBsYWluLmNvbXBpbGFudHNfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIwLmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMC5jaGllZkNvbXBsYWluLmNkZnJvbV9kYXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIGlmICghX3RoaXMyMC52YWxpZGF0aW9uLmlzSWRFeGlzdHMoX3RoaXMyMC5jaGllZkNvbXBsYWluTGlzdCwgJ2NvbXBpbGFudHNfaWQnLCBfdGhpczIwLmNoaWVmQ29tcGxhaW4uY29tcGlsYW50c19pZCwgJ3BhdGllbnRfY29tcGxhaW5faWQnLCBfdGhpczIwLmNoaWVmQ29tcGxhaW4ucGF0aWVudF9jb21wbGFpbl9pZCwgX3RoaXMyMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgX3RoaXMyMC5jaGllZkNvbXBsYWluLmZyb21fZGF0ZSA9IG1vbWVudChTdHJpbmcoX3RoaXMyMC5jaGllZkNvbXBsYWluLmNkZnJvbV9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjAuY2hpZWZDb21wbGFpbi5wYXRpZW50X2NvbXBsYWluX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMC5wYXRpZW50UHJvZmlsZVNlcnZpY2UuY29tcGxhaW5TYXZlKF90aGlzMjAuY2hpZWZDb21wbGFpbik7CgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjAuZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQoX3RoaXMyMC5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyMC5oaWRlRGlhbG9nKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczIwLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjAuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzE7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjk7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMC5wYXRpZW50UHJvZmlsZVNlcnZpY2UuY29tcGxhaW5VcGRhdGUoX3RoaXMyMC5jaGllZkNvbXBsYWluKTsKCiAgICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICAgIF9yZXN1bHQgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoX3Jlc3VsdC5zdGF0dXMgPT09IDIwMikgewogICAgICAgICAgICAgICAgICBfdGhpczIwLmdldENvbXBsYWluc0J5UGF0aWVudElkKF90aGlzMjAuY2hpZWZDb21wbGFpbi5wYXRpZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjAuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJVcGRhdGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9yZXN1bHQuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogX3Jlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDMxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZWRpdENoaWVmQ29tcGxhaW46IGZ1bmN0aW9uIGVkaXRDaGllZkNvbXBsYWluKGRhdGEpIHsKICAgICAgdGhpcy5jaGllZkNvbXBsYWluID0gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7CiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbi5jZGZyb21fZGF0ZSA9IG1vbWVudChTdHJpbmcodGhpcy5jaGllZkNvbXBsYWluLmZyb21fZGF0ZSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgICB0aGlzLmNoaWVmQ29tcGxhaW5EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGdldEZvb2Q6IGZ1bmN0aW9uIGdldEZvb2QoKSB7CiAgICAgIHZhciBfdGhpczIxID0gdGhpczsKCiAgICAgIHRoaXMuZm9vZFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjEuZm9vZEZvcm1hdHRlZChkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBmb29kRm9ybWF0dGVkOiBmdW5jdGlvbiBmb29kRm9ybWF0dGVkKGRhdGEpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgdGhpcy5mb29kU2V0dXAgPSB7fTsKICAgICAgdGhpcy5mb29kTGlzdCA9IGRhdGE7CiAgICAgIHRoaXMuZm9vZERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmFsbGVyZ3lEZXRhaWxzRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBuZXdGb29kOiBmdW5jdGlvbiBuZXdGb29kKCkgewogICAgICB0aGlzLmFsbGVyZ3lEZXRhaWxzRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuZm9vZERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkRm9vZDogZnVuY3Rpb24gYWRkRm9vZCgpIHsKICAgICAgdmFyIF90aGlzMjIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMyMi5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIyLmZvb2RTZXR1cC5mb29kX25hbWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmICghX3RoaXMyMi52YWxpZGF0aW9uLmlzTmFtZUV4aXN0cyhfdGhpczIyLmZvb2RMaXN0LCAndGV4dCcsIF90aGlzMjIuZm9vZFNldHVwLmZvb2RfbmFtZSwgJ3ZhbHVlJywgX3RoaXMyMi5mb29kU2V0dXAuZm9vZF9pZCwgX3RoaXMyMikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF90aGlzMjIuZm9vZFNldHVwLmFjdGl2ZSA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjIuZm9vZFNlcnZpY2UuYWRkKF90aGlzMjIuZm9vZFNldHVwKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMi5nZXRGb29kKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczIyLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczIyLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG5ld0FsbGVyZ3lEZXRhaWxzOiBmdW5jdGlvbiBuZXdBbGxlcmd5RGV0YWlscygpIHsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlsc0RpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQWxsZXJneURldGFpbHM6IGZ1bmN0aW9uIGFkZEFsbGVyZ3lEZXRhaWxzKCkgewogICAgICB2YXIgX3RoaXMyMyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICB2YXIgcmVzdWx0LCBfcmVzdWx0MjsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMjMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMy5hbGxlcmd5RGV0YWlscy5mb29kX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMy5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMy5hbGxlcmd5RGV0YWlscy50eXBlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIzLmFsbGVyZ3lEZXRhaWxzLmNkZnJvbV9kYXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIGlmICghX3RoaXMyMy52YWxpZGF0aW9uLmlzSWRFeGlzdHMoX3RoaXMyMy5hbGxlcmd5RGV0YWlsc0xpc3QsICdmb29kX2lkJywgX3RoaXMyMy5hbGxlcmd5RGV0YWlscy5mb29kX2lkLCAncGF0aWVudF9hbGxlcmd5X2RldGFpbHNfaWQnLCBfdGhpczIzLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfYWxsZXJneV9kZXRhaWxzX2lkLCBfdGhpczIzKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBfdGhpczIzLmFsbGVyZ3lEZXRhaWxzLmZyb21fZGF0ZSA9IG1vbWVudChTdHJpbmcoX3RoaXMyMy5hbGxlcmd5RGV0YWlscy5jZGZyb21fZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIzLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfYWxsZXJneV9kZXRhaWxzX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuYWxsZXJneURldGFpbHNTYXZlKF90aGlzMjMuYWxsZXJneURldGFpbHMpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczIzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczIzLmdldEFsbGVyZ3lEZXRhaWxzQnlQYXRpZW50SWQoX3RoaXMyMy5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjMuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczIzLmhpZGVEaWFsb2coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI5OgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzMTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIzLnBhdGllbnRQcm9maWxlU2VydmljZS5hbGxlcmd5RGV0YWlsc1VwZGF0ZShfdGhpczIzLmFsbGVyZ3lEZXRhaWxzKTsKCiAgICAgICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgICAgIF9yZXN1bHQyID0gX2NvbnRleHQ0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKF9yZXN1bHQyLnN0YXR1cyA9PT0gMjAyKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjMuZ2V0QWxsZXJneURldGFpbHNCeVBhdGllbnRJZChfdGhpczIzLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyMy5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczIzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlVwZGF0ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3Jlc3VsdDIuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogX3Jlc3VsdDIuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfcmVzdWx0Mi5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMzM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBlZGl0QWxsZXJneURldGFpbHM6IGZ1bmN0aW9uIGVkaXRBbGxlcmd5RGV0YWlscyhkYXRhKSB7CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHMgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlscy5jZGZyb21fZGF0ZSA9IG1vbWVudChTdHJpbmcodGhpcy5hbGxlcmd5RGV0YWlscy5mcm9tX2RhdGUpKS5mb3JtYXQoIk1NL0REL1lZWVkiKTsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlsc0RpYWxvZyA9IHRydWU7CiAgICB9LAogICAgbmV3T25FeGFtaW5hdGlvbjogZnVuY3Rpb24gbmV3T25FeGFtaW5hdGlvbigpIHsKICAgICAgdGhpcy5nZXRPbkV4YW1pbmF0aW9uc1BvcHVwKCk7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkT25FeGFtaW5hdGlvbjogZnVuY3Rpb24gYWRkT25FeGFtaW5hdGlvbigpIHsKICAgICAgdmFyIF90aGlzMjQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIHJlc3VsdCwgcGF0aWVudElkOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczI0LnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczI0LnJlcXVyZWQgPSAiIjsKCiAgICAgICAgICAgICAgICBfdGhpczI0LnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgaWYgKCFlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX3Jlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzMjQucmVxdXJlZCA9ICJyZXF1aXJlZCI7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmICghX3RoaXMyNC5yZXF1cmVkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJSZXF1aXJlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogIlBsZWFzZSBmaWxsIGluIHRoZSByZXF1aXJlZCBmaWVsZHMiLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMjQucmVxdXJlZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjQucGF0aWVudFByb2ZpbGVTZXJ2aWNlLm9uRXhhbWluYXRpb25TYXZlKF90aGlzMjQucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ1LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSk7CgogICAgICAgICAgICAgICAgICBfdGhpczI0LmdldE9uRXhhbWluYXRpb25CeVBhdGllbnRJZChwYXRpZW50SWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyNC5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjQuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdJT0NoYXJ0OiBmdW5jdGlvbiBuZXdJT0NoYXJ0KCkgewogICAgICB0aGlzLmlPQ2hhcnREaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZElPQ2hhcnQ6IGZ1bmN0aW9uIGFkZElPQ2hhcnQoKSB7CiAgICAgIHZhciBfdGhpczI1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHZhciByZXN1bHQsIHBhdGllbnRJZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMyNS5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczI1LmlPQ2hhcnQucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjUucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmlPQ2hhcnRTYXZlKF90aGlzMjUuaU9DaGFydCk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ni5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyNS5nZXRJT0NoYXJ0QnlQYXRpZW50SWQocGF0aWVudElkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjUuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG5ld0RpYWJldGVzQ2hhcnQ6IGZ1bmN0aW9uIG5ld0RpYWJldGVzQ2hhcnQoKSB7CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkRGlhYmV0ZXNDaGFydDogZnVuY3Rpb24gYWRkRGlhYmV0ZXNDaGFydCgpIHsKICAgICAgdmFyIF90aGlzMjYgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIGFkbWlzc2lvbl9pZCwgcmVzdWx0LCBwYXRpZW50SWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMjYuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyNi5kaWFiZXRlc0NoYXJ0Lm1lYWwpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmIChfdGhpczI2LmRpYWJldGVzQ2hhcnQuYmVmb3JlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyNi5kaWFiZXRlc0NoYXJ0LmFmdGVyKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIGFkbWlzc2lvbl9pZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImFkbWlzc2lvbklkRm9yRGlhYmV0ZXNTZXJ2aWNlIikpOwogICAgICAgICAgICAgICAgX3RoaXMyNi5kaWFiZXRlc0NoYXJ0LmFBZG1pc3Npb25TZXJ2aWNlRGV0YWlscy5hZG1pc3Npb25faWQgPSBTdHJpbmcoYWRtaXNzaW9uX2lkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyNi5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZGlhYmV0ZXNDaGFydFNhdmUoX3RoaXMyNi5kaWFiZXRlc0NoYXJ0KTsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ny5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyNi5nZXREaWFiZXRlc0NoYXJ0QnlQYXRpZW50SWQocGF0aWVudElkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjYuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczI2LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbmV3RGlldENoYXJ0OiBmdW5jdGlvbiBuZXdEaWV0Q2hhcnQoKSB7CiAgICAgIHRoaXMuZGlldENoYXJ0RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBnZXREaWV0Q2hhcnRCeVRlbXBsYXRlSWQ6IGZ1bmN0aW9uIGdldERpZXRDaGFydEJ5VGVtcGxhdGVJZCgpIHsKICAgICAgdmFyIF90aGlzMjcgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmRpZXRDaGFydC5kaWV0X2NoYXJ0X3RlbXBsYXRlX2lkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZGlldENoYXJ0U2V0dXBTZXJ2aWNlLmdldEJ5RGlldENoYXJ0VGVtcGxhdGVJZCh0aGlzLmRpZXRDaGFydC5kaWV0X2NoYXJ0X3RlbXBsYXRlX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyNy5kaWV0Q2hhcnRUZW1wTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGFkZERpZXRDaGFydDogZnVuY3Rpb24gYWRkRGlldENoYXJ0KCkgewogICAgICB2YXIgX3RoaXMyOCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICB2YXIgcGF0aWVudElkLCByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMjguc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczI4LmRpZXRDaGFydFRlbXBMaXN0Lmxlbmd0aCA8PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgICAgICAgICAgIF90aGlzMjguZGlldENoYXJ0VGVtcExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICBlbGVtZW50LnBhdGllbnRfaWQgPSBwYXRpZW50SWQudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczI4LnBhdGllbnRQcm9maWxlU2VydmljZS5kaWV0Q2hhcnRTYXZlKF90aGlzMjguZGlldENoYXJ0VGVtcExpc3QpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDguc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIC8vdmFyIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKTsKICAgICAgICAgICAgICAgICAgX3RoaXMyOC5nZXREaWV0Q2hhcnRCeVBhdGllbnRJZChwYXRpZW50SWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyOC5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjguaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdDdXJyZW50TWVkaWNhdGlvbnM6IGZ1bmN0aW9uIG5ld0N1cnJlbnRNZWRpY2F0aW9ucygpIHsKICAgICAgdGhpcy5jdXJyZW50TWVkaWNhdGlvbnNEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZEN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gYWRkQ3VycmVudE1lZGljYXRpb25zKCkgewogICAgICB2YXIgX3RoaXMyOSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczI5LnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjkuY3VycmVudE1lZGljYXRpb25zLm1lZGljaW5lX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyOS5jdXJyZW50TWVkaWNhdGlvbnMudHJlYXRtZW50X3J1bGVzX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyOS5jdXJyZW50TWVkaWNhdGlvbnMudHJlYXRtZW50X2R1cmF0aW9uX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIGlmIChfdGhpczI5LmN1cnJlbnRNZWRpY2F0aW9ucy50cmVhdG1lbnRfZG9zZV9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyOS5jdXJyZW50TWVkaWNhdGlvbnMucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMjkudmFsaWRhdGlvbi5pc0lkRXhpc3RzKF90aGlzMjkuY3VycmVudE1lZGljYXRpb25zTGlzdCwgJ21lZGljaW5lX2lkJywgX3RoaXMyOS5jdXJyZW50TWVkaWNhdGlvbnMubWVkaWNpbmVfaWQsICdwYXRpZW50X2N1cnJlbnRfbWVkaWNhdGlvbnNfaWQnLCBfdGhpczI5LmN1cnJlbnRNZWRpY2F0aW9ucy5wYXRpZW50X2N1cnJlbnRfbWVkaWNhdGlvbnNfaWQsIF90aGlzMjkpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjc7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyOS5wYXRpZW50UHJvZmlsZVNlcnZpY2UuY3VycmVudE1lZGljYXRpb25zU2F2ZShfdGhpczI5LmN1cnJlbnRNZWRpY2F0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDkuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjkuZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQoX3RoaXMyOS5jdXJyZW50TWVkaWNhdGlvbnMucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczI5LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDI5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY29uZmlybURlbGV0ZUN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gY29uZmlybURlbGV0ZUN1cnJlbnRNZWRpY2F0aW9ucyhkYXRhKSB7CiAgICAgIHZhciBfdGhpczMwID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0ucmVxdWlyZSh7CiAgICAgICAgbWVzc2FnZTogJ0RvIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHJlY29yZD8nLAogICAgICAgIGhlYWRlcjogJ0RlbGV0ZSBDb25maXJtYXRpb24nLAogICAgICAgIGljb246ICdwaSBwaS1pbmZvLWNpcmNsZScsCiAgICAgICAgYWNjZXB0Q2xhc3M6ICdwLWJ1dHRvbi1kYW5nZXInLAogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMzMC5kZWxldGVDdXJyZW50TWVkaWNhdGlvbnMoZGF0YSk7CiAgICAgICAgfSwKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdCgpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGRlbGV0ZUN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gZGVsZXRlQ3VycmVudE1lZGljYXRpb25zKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMzEgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMzEucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmN1cnJlbnRNZWRpY2F0aW9uc0RlbGV0ZShkYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMS5nZXRDdXJyZW50TWVkaWNhdGlvbnNCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEwKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbmV3UGFzdE1lZGljYWxIaXN0b3J5OiBmdW5jdGlvbiBuZXdQYXN0TWVkaWNhbEhpc3RvcnkoKSB7CiAgICAgIHRoaXMucGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBhZGRQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGFkZFBhc3RNZWRpY2FsSGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzMzIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczMyLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzIucGFzdE1lZGljYWxIaXN0b3J5LmRpYWdub3Npc19pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzMi5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMzIudmFsaWRhdGlvbi5pc0lkRXhpc3RzKF90aGlzMzIucGFzdE1lZGljYWxIaXN0b3J5TGlzdCwgJ2RpYWdub3Npc19pZCcsIF90aGlzMzIucGFzdE1lZGljYWxIaXN0b3J5LmRpYWdub3Npc19pZCwgJ3BhdGllbnRfcGFzdF9oaXN0b3J5X2lkJywgX3RoaXMzMi5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9wYXN0X2hpc3RvcnlfaWQsIF90aGlzMzIpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzMi5wYXRpZW50UHJvZmlsZVNlcnZpY2UucGFzdEhpc3RvcnlTYXZlKF90aGlzMzIucGFzdE1lZGljYWxIaXN0b3J5KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0MTEuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzIuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChfdGhpczMyLnBhc3RNZWRpY2FsSGlzdG9yeS5wYXRpZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzIuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNvbmZpcm1EZWxldGVQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGNvbmZpcm1EZWxldGVQYXN0TWVkaWNhbEhpc3RvcnkoZGF0YSkgewogICAgICB2YXIgX3RoaXMzMyA9IHRoaXM7CgogICAgICB0aGlzLiRjb25maXJtLnJlcXVpcmUoewogICAgICAgIG1lc3NhZ2U6ICdEbyB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyByZWNvcmQ/JywKICAgICAgICBoZWFkZXI6ICdEZWxldGUgQ29uZmlybWF0aW9uJywKICAgICAgICBpY29uOiAncGkgcGktaW5mby1jaXJjbGUnLAogICAgICAgIGFjY2VwdENsYXNzOiAncC1idXR0b24tZGFuZ2VyJywKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIF90aGlzMzMuZGVsZXRlUGFzdE1lZGljYWxIaXN0b3J5KGRhdGEpOwogICAgICAgIH0sCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QoKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZWxldGVQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGRlbGV0ZVBhc3RNZWRpY2FsSGlzdG9yeShkYXRhKSB7CiAgICAgIHZhciBfdGhpczM0ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczM0LnBhdGllbnRQcm9maWxlU2VydmljZS5wYXN0SGlzdG9yeURlbGV0ZShkYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMi5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzNC5nZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczM0LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBwYXRpZW50SGlzdG9yeVNhdmU6IGZ1bmN0aW9uIHBhdGllbnRIaXN0b3J5U2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMzUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczM1LnBhdGllbnRIaXN0b3J5LnBhdGllbnRfaWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsgLy90aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzUucGF0aWVudEhpc3RvcnkucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMzUucGF0aWVudFByb2ZpbGVTZXJ2aWNlLnBhdGllbnRIaXN0b3J5U2F2ZShfdGhpczM1LnBhdGllbnRIaXN0b3J5LCBfdGhpczM1KTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMy5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzNS5oaWRlSGlzdG9yeSgpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gRmluYWwgUHJlc2NyaXB0aW9uCiAgICBkaXNjaGFyZ2VQcmVzY3JpcHRpb246IGZ1bmN0aW9uIGRpc2NoYXJnZVByZXNjcmlwdGlvbihkYXRhKSB7CiAgICAgIHZhciBfdGhpczM2ID0gdGhpczsKCiAgICAgIHRoaXMuaXNEaXNjaGFyZ2UgPSB0cnVlOwogICAgICB0aGlzLmRpc2NoYXJnZU9iai5hZG1pc3Npb25faWQgPSBkYXRhLmFkbWlzc2lvbl9pZDsKICAgICAgdGhpcy5kaXNjaGFyZ2VPYmouYUFkbWlzc2lvbkJlZERldGFpbHMuYWRtaXNzaW9uX2JlZF9kZXRhaWxzX2lkID0gZGF0YS5hZG1pc3Npb25fYmVkX2RldGFpbHNfaWQ7CiAgICAgIHRoaXMuZGlzY2hhcmdlT2JqLmFBZG1pc3Npb25CZWREZXRhaWxzLm1ycCA9IGRhdGEubXJwOwogICAgICB0aGlzLmRpc2NoYXJnZU9iai5hQWRtaXNzaW9uQmVkRGV0YWlscy5jaGVja19pbl90aW1lID0gZGF0YS5jaGVja19pbl90aW1lOwogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8uYWRtaXNzaW9uX2lkID0gZGF0YS5hZG1pc3Npb25faWQ7CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5hZG1pc3Npb25fbm8gPSBkYXRhLmFkbWlzc2lvbl9ubzsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FkbWlzc2lvbklkRm9yRGlhYmV0ZXNTZXJ2aWNlJywgZGF0YS5hZG1pc3Npb25faWQpOwogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8ucGF0aWVudF9pZCA9IGRhdGEucGF0aWVudF9pZDsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BhdGllbnRJZEZvclRyZWF0bWVudCcsIGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5yZWdpc3RyYXRpb25fbm8gPSBkYXRhLnJlZ2lzdHJhdGlvbl9ubzsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLnBhdGllbnRfbmFtZSA9IGRhdGEucGF0aWVudF9uYW1lOwogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8uZ2VuZGVyID0gZGF0YS5nZW5kZXI7CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5hZ2VfeWVhciA9IGRhdGEuYWdlX3llYXI7CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5hZ2VfbW9udGggPSBkYXRhLmFnZV9tb250aDsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV9kYXkgPSBkYXRhLmFnZV9kYXk7CiAgICAgIHRoaXMuZGF0YUxpc3QgPSBmYWxzZTsKICAgICAgdGhpcy5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbigpOyAvLyBVc2UgZm9yIERpYWxvZyAvLwoKICAgICAgdGhpcy5jb21wbGFpbnRTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMzYuY29tcGxpYW50TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZm9vZFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMzYuZm9vZExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMzYub25FeGFtaW5hdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmRpYWdub3Npc1NldHVwU2VydmljZS5nZXRBbGwoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMzYuZGlhZ25vc2lzTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxBbGxlcmd5VHlwZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzNi5hbGxlcmd5VHlwZUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmNvbW1vblNlcnZpY2UuR2V0QWxsRGlhYmV0ZXNNZWFsKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczM2LmRpYWJldGVzTWVhbExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmRpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczM2LmRpZXRDaGFydFRlbXBsYXRlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7IC8vIFVzZSBmb3IgRGlhbG9nIC8vCiAgICAgIC8vIFByZXZpb3VzIFByZXNjcmlwdGlvbiBEYXRhCgogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvblNlcnZpY2UuZ2V0UHJldmlvdXNQcmVzY3JpcHRpb25EYXRhQWRtaXNzaW9uSWQoZGF0YS5hZG1pc3Npb25faWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzNi5wcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFGb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgfSk7IC8vIFByZXNjcmlwdGlvbiBUcmVhdG1lbnQKCiAgICAgIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMzYubWVkaWNpbmVMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy50cmVhdG1lbnRSdWxlc1NldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzNi50cmVhdG1lbnRSdWxlc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczM2LnRyZWF0bWVudER1cmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzNi50cmVhdG1lbnREb3NlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZGlzY2hhcmdlOiBmdW5jdGlvbiBkaXNjaGFyZ2UoKSB7CiAgICAgIHRoaXMuZGlzY2hhcmdlRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBkaXNjaGFyZ2VkOiBmdW5jdGlvbiBkaXNjaGFyZ2VkKCkgewogICAgICB2YXIgX3RoaXMzNyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTQoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMzcuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzNy5kaXNjaGFyZ2VPYmouYWRtaXNzaW9uX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmIChfdGhpczM3LmRpc2NoYXJnZU9iai5kaXNjaGFyZ2Vfc3VtbWFyeSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczM3LmlQRFNlcnZpY2UuZGlzY2hhcmdlZChfdGhpczM3LmRpc2NoYXJnZU9iaiwgX3RoaXMzNyk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDE0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczM3LmlzRGlzY2hhcmdlID0gZmFsc2U7CgogICAgICAgICAgICAgICAgICBfdGhpczM3LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTQpOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/ipd/IPDPatientList.js"],"names":["AdmissionService","moment","Validation","FilterMatchMode","FilterOperator","AppointmentPrescriptionService","AdmissionPrescriptionService","MedicineTypeSetupService","MedicineSetupService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","PatientProfileService","ComplaintSetupService","FoodService","OnExaminationSetupService","DietChartTemplateSetupService","DietChartSetupService","DiagnosisSetupService","CommonService","PrescriptionReportService","IPDService","CoolSelect","components","data","dataList","isDoctor","admittedPatientList","admittedPatient","cdfromdate","String","Date","format","cdtodate","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","isDischarge","dischargeDialog","dischargeObj","aAdmissionBedDetails","admittedPatientInfo","prescriptionDataList","tempData","headerName","admissionPrescriptionInfo","cdprescription_date","cdfolowup_date","setDate","getDate","allAdvice","lstAdmissionPrescriptionInvestigation","lstAdmissionPrescriptionTreatment","lstAdmissionPrescriptionAdvice","treatmentAddDialog","treatmentDialog","treatmentSetup","medicineTypeList","medicineList","treatmentRulesList","treatmentDurationList","treatmentDoseList","SectionDialog","isHistory","active","expandedRows","isFemale","chiefComplainDialog","chiefComplain","chiefComplainList","compliantList","foodDialog","foodSetup","allergyDetailsDialog","allergyDetails","allergyDetailsList","foodList","allergyTypeList","onExaminationDialog","onExamination","patientOnExaminationList","onExaminationList","iOChartDialog","iOChart","iOChartList","diabetesChartDialog","diabetesChart","aAdmissionServiceDetails","diabetesChartList","diabetesMealList","dietChartDialog","dietChart","dietChartList","dietChartTemplateList","dietChartTempList","currentMedicationsDialog","currentMedications","currentMedicationsList","pastMedicalHistoryDialog","pastMedicalHistory","pastMedicalHistoryList","diagnosisList","patientLatestHistory","lstPatientOnExamination","lstPatientAllergyDetails","lstPatientDiabetesChart","lstPatientDietChart","patientHistory","lstPersonalHistory","lstFamilyHistory","lstSystemsReview","lstSubstanceUse","lstReproductiveHistory","created","today","month","getMonth","year","getFullYear","prevMonth","prevYear","minDate","setMonth","setFullYear","admissionService","admissionPrescriptionService","appointmentPrescriptionService","medicineTypeSetupService","medicineSetupService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","patientProfileService","complaintSetupService","foodService","onExaminationSetupService","dietChartTemplateSetupService","dietChartSetupService","diagnosisSetupService","commonService","validation","prescriptionReportService","iPDService","that","document","onkeyup","e","ctrlKey","altKey","which","getInvestigation","getTreatment","getAdvice","getActiveCombo","then","userInfo","JSON","parse","localStorage","getItem","show","doctor_id","getPrescriptionDataByDoctorId","methods","fromdate","todate","admittedPatientListForTreatmentByDoctorId","prescription","admission_id","admission_no","setItem","patient_id","registration_no","patient_name","gender","age_year","age_month","age_day","getComplainsByPatientId","getLatestHistoryByPatientIdForPrescription","getAll","GetAllAllergyType","GetAllDiabetesMeal","getPreviousPrescriptionDataAdmissionId","previousPrescriptionDataFormatted","patientId","toString","isAdvice","lstInvestigation","forEach","element","push","investingation_name","id","investigation_id","saveTreatment","ddlmedicine_type","ddlmedicine","ddltreatment_rules","ddltreatment_duration","ddltreatment_dose","aMedicine","filter","el","medicine_id","length","_medicine_type_name","text","_treatment_dose_name","treatment_dose_id","_treatment_rule_name","treatment_rules_id","_treatment_duration_name","treatment_duration_id","description","hideDialog","lstAdvices","advice_name","advice_id","addAllAdvice","aAdvice","getValue","aInvestigation","_medicine_name","filterMedicineTypeWise","refid","editTreatment","index","medicineName","treatmentIndex","treatmentEditSave","deleteItem","lst","splice","findIndex","i","add","$toast","severity","summary","detail","life","prescription_date","folowup_date","result","status","downloadPrescription","newPrescription","reset","res","admission_prescription_id","GetIPDPescription","Downloadfile","formatDate","formatDateTime","history","removeItem","getAllergyDetailsByPatientId","getOnExaminationByPatientId","getIOChartByPatientId","getDiabetesChartByPatientId","getDietChartByPatientId","getCurrentMedicationsByPatientId","getPastHistoryByPatientId","getSystemSubstance","formattedSystemSubstance","getOnExaminationsPopup","popupOnExaminationsData","_on_examination_name","on_examination_id","on_examination_result","onExaminationPopupDialog","hideHistory","newChiefComplain","addChiefComplain","compilants_id","cdfrom_date","isIdExists","patient_complain_id","from_date","complainSave","complainUpdate","editChiefComplain","Object","assign","getFood","foodFormatted","newFood","addFood","food_name","isNameExists","food_id","newAllergyDetails","addAllergyDetails","type","patient_allergy_details_id","allergyDetailsSave","allergyDetailsUpdate","editAllergyDetails","newOnExamination","addOnExamination","requred","onExaminationSave","newIOChart","addIOChart","iOChartSave","newDiabetesChart","addDiabetesChart","meal","before","after","diabetesChartSave","newDietChart","getDietChartByTemplateId","diet_chart_template_id","getByDietChartTemplateId","addDietChart","dietChartSave","newCurrentMedications","addCurrentMedications","patient_current_medications_id","currentMedicationsSave","confirmDeleteCurrentMedications","$confirm","require","message","header","icon","acceptClass","accept","deleteCurrentMedications","reject","currentMedicationsDelete","newPastMedicalHistory","addPastMedicalHistory","diagnosis_id","patient_past_history_id","pastHistorySave","confirmDeletePastMedicalHistory","deletePastMedicalHistory","pastHistoryDelete","patientHistorySave","dischargePrescription","admission_bed_details_id","mrp","check_in_time","discharge","discharged","discharge_summary"],"mappings":"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","sourcesContent":["import AdmissionService from \"../../service/front-desk/AdmissionService\";\r\n\r\nimport moment from \"moment\";\r\nimport Validation from \"../../scripts/validation\";\r\nimport { FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n// Prescription\r\nimport AppointmentPrescriptionService from \"../../service/doctor-panel/AppointmentPrescriptionService\";\r\nimport AdmissionPrescriptionService from \"../../service/prescription/AdmissionPrescriptionService\";\r\n// Prescription Treatment\r\nimport MedicineTypeSetupService from \"../../service/setup/MedicineTypeSetupService\";\r\nimport MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\n// History\r\nimport PatientProfileService from \"../../service/profiles/PatientProfileService\";\r\n//import WordCabinSetupService from \"../../service/setup/WordCabinSetupService\";\r\nimport ComplaintSetupService from \"../../service/setup/ComplaintSetupService\";\r\nimport FoodService from \"../../service/setup/FoodService\";\r\nimport OnExaminationSetupService from \"../../service/setup/OnExaminationSetupService\";\r\nimport DietChartTemplateSetupService from \"../../service/setup/DietChartTemplateSetupService\";\r\nimport DietChartSetupService from \"../../service/setup/DietChartSetupService\";\r\nimport DiagnosisSetupService from \"../../service/setup/DiagnosisSetupService\";\r\nimport CommonService from \"../../service/CommonService\";\r\nimport PrescriptionReportService from \"../../service/report/PrescriptionReportService\";\r\n// Discharge\r\nimport IPDService from \"../../service/ipd/IPDService\";\r\nimport { CoolSelect } from 'vue-cool-select'\r\n\r\nexport default {\r\n  components: { CoolSelect },\r\n  // ...\r\n  data() {\r\n    return {\r\n      dataList: true,\r\n      isDoctor: false,\r\n      admittedPatientList: [],\r\n      admittedPatient: {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdfromdate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() - 60)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdtodate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n      },\r\n      //\r\n\r\n      submitted: false,\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n\r\n      // Discharge\r\n      isDischarge: false,\r\n      dischargeDialog: false,\r\n      dischargeObj: {\r\n        aAdmissionBedDetails: {},\r\n      },\r\n      // Prescription\r\n      admittedPatientInfo: {},\r\n      prescriptionDataList: [],\r\n      tempData: [],\r\n      headerName: \"Sections\",\r\n\r\n      admissionPrescriptionInfo: {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        allAdvice: false,\r\n\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n      // Prescription Treatment\r\n      treatmentAddDialog: false,\r\n      treatmentDialog: false,\r\n      treatmentSetup: {},\r\n      medicineTypeList: [],\r\n      medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n\r\n      // Section\r\n      SectionDialog: false,\r\n\r\n      // History\r\n      isHistory: false,\r\n      active: 0,\r\n      expandedRows: [],\r\n      isFemale: false,\r\n\r\n      chiefComplainDialog: false,\r\n      chiefComplain: {},\r\n      chiefComplainList: [],\r\n      compliantList: [],\r\n\r\n      foodDialog: false,\r\n      foodSetup: {},\r\n      allergyDetailsDialog: false,\r\n      allergyDetails: {},\r\n      allergyDetailsList: [],\r\n      foodList: [],\r\n      allergyTypeList: [],\r\n\r\n      onExaminationDialog: false,\r\n      onExamination: {},\r\n      patientOnExaminationList: [],\r\n      onExaminationList: [],\r\n\r\n      iOChartDialog: false,\r\n      iOChart: {},\r\n      iOChartList: [],\r\n\r\n      diabetesChartDialog: false,\r\n      diabetesChart: {\r\n        aAdmissionServiceDetails: {}\r\n      },\r\n      diabetesChartList: [],\r\n      diabetesMealList: [],\r\n\r\n      dietChartDialog: false,\r\n      dietChart: {},\r\n      dietChartList: [],\r\n      dietChartTemplateList: [],\r\n      dietChartTempList: [],\r\n\r\n      currentMedicationsDialog: false,\r\n      currentMedications: {},\r\n      currentMedicationsList: [],\r\n\r\n      pastMedicalHistoryDialog: false,\r\n      pastMedicalHistory: {},\r\n      pastMedicalHistoryList: [],\r\n      diagnosisList: [],\r\n\r\n      patientLatestHistory: {\r\n        lstPatientOnExamination: [],\r\n        lstPatientAllergyDetails: [],\r\n        lstPatientDiabetesChart: [],\r\n        lstPatientDietChart: [],\r\n      },\r\n      patientHistory: {\r\n        lstPersonalHistory: [],\r\n        lstFamilyHistory: [],\r\n        lstSystemsReview: [],\r\n        lstSubstanceUse: [],\r\n        lstReproductiveHistory: [],\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    // past date-year disabled\r\n    let today = new Date();\r\n    let month = today.getMonth();\r\n    let year = today.getFullYear();\r\n    let prevMonth = (month === 0) ? 11 : month - 0;\r\n    let prevYear = (prevMonth === 11) ? year - 0 : year;\r\n    this.minDate = new Date();\r\n    this.minDate.setMonth(prevMonth);\r\n    this.minDate.setFullYear(prevYear);\r\n\r\n    //this.wordCabinSetupService = new WordCabinSetupService();\r\n    this.admissionService = new AdmissionService();\r\n    // Prescription\r\n    this.admissionPrescriptionService = new AdmissionPrescriptionService();\r\n    this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n\r\n    // Prescription Treatment\r\n    this.medicineTypeSetupService = new MedicineTypeSetupService();\r\n    this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n\r\n    // History\r\n    this.patientProfileService = new PatientProfileService();\r\n\r\n    this.complaintSetupService = new ComplaintSetupService();\r\n    this.foodService = new FoodService();\r\n    this.onExaminationSetupService = new OnExaminationSetupService();\r\n    this.dietChartTemplateSetupService = new DietChartTemplateSetupService();\r\n    this.dietChartSetupService = new DietChartSetupService();\r\n\r\n    this.diagnosisSetupService = new DiagnosisSetupService();\r\n    this.commonService = new CommonService();\r\n    this.validation = new Validation();\r\n    this.prescriptionReportService = new PrescriptionReportService();\r\n\r\n    // Discharge\r\n    this.iPDService = new IPDService();\r\n\r\n    // this.wordCabinSetupService\r\n    //     .getAll()\r\n    //     .then((data) => (this.wordCabinList = data.data));\r\n\r\n    let that = this;\r\n    document.onkeyup = function (e) {\r\n      if (e.ctrlKey && e.altKey && e.which == 73) {\r\n        that.getInvestigation();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 84) {\r\n        that.getTreatment();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 65) {\r\n        that.getAdvice();\r\n      }\r\n      // else if (e.ctrlKey && e.altKey && e.shiftKey) {\r\n\r\n      // }\r\n    };\r\n\r\n    this.medicineTypeSetupService.getActiveCombo().then((data) => (this.medicineTypeList = data.data));\r\n\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n    this.show();\r\n\r\n    if (this.userInfo.doctor_id) {\r\n      this.appointmentPrescriptionService\r\n        .getPrescriptionDataByDoctorId(this.userInfo.doctor_id)\r\n        .then((data) => (this.prescriptionDataList = data.data));\r\n\r\n      this.doctor_id = this.userInfo.doctor_id;\r\n      this.admissionPrescriptionInfo.doctor_id = this.doctor_id;\r\n\r\n      this.isDoctor = true;\r\n    } else if (!this.userInfo.doctor_id) {\r\n      this.isDoctor = false;\r\n    }\r\n  },\r\n  methods: {\r\n    show() {\r\n      this.submitted = true;\r\n      if (!this.admittedPatient.cdfromdate) {\r\n        return;\r\n      } else if (!this.admittedPatient.cdtodate) {\r\n        return;\r\n      } else {\r\n        this.admittedPatient.fromdate = moment(\r\n          String(this.admittedPatient.cdfromdate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.admittedPatient.todate = moment(\r\n          String(this.admittedPatient.cdtodate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n        this.admissionService\r\n          .admittedPatientListForTreatmentByDoctorId(this.admittedPatient.fromdate, this.admittedPatient.todate, this.userInfo.doctor_id)\r\n          .then((data) => (this.admittedPatientList = data.data));\r\n\r\n        this.submitted = false;\r\n      }\r\n      this.dataList = true;\r\n    },\r\n\r\n    prescription(data) {\r\n      this.admittedPatientInfo.admission_id = data.admission_id;\r\n      this.admittedPatientInfo.admission_no = data.admission_no;\r\n      localStorage.setItem('admissionIdForDiabetesService', data.admission_id);\r\n      this.admittedPatientInfo.patient_id = data.patient_id;\r\n      localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      this.admittedPatientInfo.registration_no = data.registration_no;\r\n      this.admittedPatientInfo.patient_name = data.patient_name;\r\n      this.admittedPatientInfo.gender = data.gender;\r\n      this.admittedPatientInfo.age_year = data.age_year;\r\n      this.admittedPatientInfo.age_month = data.age_month;\r\n      this.admittedPatientInfo.age_day = data.age_day;\r\n\r\n      this.dataList = false;\r\n      this.getComplainsByPatientId(data.patient_id);\r\n      this.getLatestHistoryByPatientIdForPrescription();\r\n      // Use for Dialog //\r\n      this.complaintSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.compliantList = data.data));\r\n\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => (this.foodList = data.data));\r\n\r\n      this.onExaminationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.onExaminationList = data.data));\r\n\r\n      this.diagnosisSetupService\r\n        .getAll()\r\n        .then((data) => (this.diagnosisList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllAllergyType()\r\n        .then((data) => (this.allergyTypeList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllDiabetesMeal()\r\n        .then((data) => (this.diabetesMealList = data.data));\r\n\r\n      this.dietChartTemplateSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.dietChartTemplateList = data.data));\r\n      // Use for Dialog //\r\n\r\n      // Previous Prescription Data\r\n      this.admissionPrescriptionService\r\n        .getPreviousPrescriptionDataAdmissionId(data.admission_id)\r\n        .then((data) => this.previousPrescriptionDataFormatted(data.data));\r\n\r\n      // Prescription Treatment\r\n      this.medicineSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.medicineList = data.data));\r\n\r\n      this.treatmentRulesSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n      this.treatmentDurationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n      this.treatmentDoseSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDoseList = data.data));\r\n    },\r\n    previousPrescriptionDataFormatted(data) {\r\n      this.admissionPrescriptionInfo.cdprescription_date = moment(String(new Date())).format(\"MM/DD/YYYY\");\r\n      this.admissionPrescriptionInfo.cdfolowup_date = moment(\r\n        String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n      ).format(\"MM/DD/YYYY\");\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment = data.lstAdmissionPrescriptionTreatment;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice = data.lstAdmissionPrescriptionAdvice;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation = data.lstAdmissionPrescriptionInvestigation;\r\n    },\r\n    getLatestHistoryByPatientIdForPrescription() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n\r\n      this.patientProfileService.getLatestHistoryByPatientIdForPrescription(patientId).then((data) => (this.patientLatestHistory = data.data));\r\n    },\r\n\r\n    // Get Prescription Data\r\n    getInvestigation() {\r\n      this.headerName = \"Investigation\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstInvestigation.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.investingation_name,\r\n          id: element.investigation_id,\r\n        });\r\n      });\r\n\r\n      this.SectionDialog = true;\r\n    },\r\n    getTreatment() {\r\n      this.treatmentAddDialog = true;\r\n      // this.headerName = \"Medicine\";\r\n      // this.filters['global'].value = \"\";\r\n      // this.isAdvice = false;\r\n      // this.tempData = [];\r\n      // this.prescriptionDataList.lstTreatment.forEach((element) => {\r\n      //   this.tempData.push({\r\n      //     _medicine_type_name: element._medicine_type_name,\r\n      //     _medicine_name: element._medicine_name,\r\n      //     name: element._medicine_type_name + \" \" + element._medicine_name + \" \" + element._treatment_dose_name + \" \" + element._treatment_rule_name + \" \" + element._treatment_duration_name,\r\n      //     id: element.medicine_id,\r\n      //     _treatment_dose_name: element._treatment_dose_name,\r\n      //     treatment_dose_id: element.treatment_dose_id,\r\n      //     _treatment_rule_name: element._treatment_rule_name,\r\n      //     treatment_rules_id: element.treatment_rules_id,\r\n      //     _treatment_duration_name: element._treatment_duration_name,\r\n      //     treatment_duration_id: element.treatment_duration_id,\r\n      //     description: element.description,\r\n      //   });\r\n      // });\r\n    },\r\n    saveTreatment() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddlmedicine_type) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddlmedicine) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === this.treatmentSetup.ddlmedicine.value;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            _medicine_type_name: this.treatmentSetup.ddlmedicine_type.text,\r\n            name: this.treatmentSetup.ddlmedicine.text,\r\n            medicine_id: this.treatmentSetup.ddlmedicine.value,\r\n            _treatment_dose_name: this.treatmentSetup.ddltreatment_dose.text,\r\n            treatment_dose_id: this.treatmentSetup.ddltreatment_dose.value,\r\n            _treatment_rule_name: this.treatmentSetup.ddltreatment_rules.text,\r\n            treatment_rules_id: this.treatmentSetup.ddltreatment_rules.value,\r\n            _treatment_duration_name: this.treatmentSetup.ddltreatment_duration.text,\r\n            treatment_duration_id: this.treatmentSetup.ddltreatment_duration.value,\r\n            description: \"\",\r\n          });\r\n        }\r\n        this.hideDialog();\r\n      }\r\n    },\r\n    getAdvice() {\r\n      this.headerName = \"Advice\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = true;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstAdvices.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.advice_name,\r\n          id: element.advice_id,\r\n        });\r\n      });\r\n      this.SectionDialog = true;\r\n    },\r\n    // Add all advice checkbox\r\n    addAllAdvice() {\r\n      if (!this.admissionPrescriptionInfo.allAdvice) {\r\n        this.tempData.forEach((element) => {\r\n          var aAdvice =\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n              function (el) {\r\n                return el.advice_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aAdvice.length) {\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n              name: element.name,\r\n              advice_id: element.id,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // Add value \r\n    getValue(data) {\r\n      if (this.headerName == \"Investigation\") {\r\n        var aInvestigation =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.filter(\r\n            function (el) {\r\n              return el.investigation_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aInvestigation.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.push(\r\n            {\r\n              name: data.name,\r\n              investigation_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Medicine\") {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            _medicine_type_name: data._medicine_type_name,\r\n            name: data._medicine_name,\r\n            medicine_id: data.id,\r\n            _treatment_dose_name: data._treatment_dose_name,\r\n            treatment_dose_id: data.treatment_dose_id,\r\n            _treatment_rule_name: data._treatment_rule_name,\r\n            treatment_rules_id: data.treatment_rules_id,\r\n            _treatment_duration_name: data._treatment_duration_name,\r\n            treatment_duration_id: data.treatment_duration_id,\r\n            description: data.description,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Advice\") {\r\n        var aAdvice =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n            function (el) {\r\n              return el.advice_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aAdvice.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: data.name,\r\n            advice_id: data.id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    hideDialog() {\r\n      this.SectionDialog = false;\r\n      this.treatmentAddDialog = false;\r\n      this.treatmentDialog = false;\r\n\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n\r\n      this.chiefComplainDialog = false;\r\n      this.chiefComplain = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.foodDialog = false;\r\n      this.foodSetup = {};\r\n      this.allergyDetailsDialog = false;\r\n      this.allergyDetails = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.onExaminationDialog = false;\r\n      // this.onExamination = {\r\n      //   patient_id: patientId\r\n      // };\r\n\r\n      this.iOChartDialog = false;\r\n      this.iOChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.diabetesChartDialog = false;\r\n      this.diabetesChart = {\r\n        aAdmissionServiceDetails: {},\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.dietChartDialog = false;\r\n      this.dietChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.currentMedicationsDialog = false;\r\n      this.currentMedications = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.pastMedicalHistoryDialog = false;\r\n      this.pastMedicalHistory = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.submitted = false;\r\n\r\n      // Discharge\r\n      this.dischargeDialog = false;\r\n      this.dischargeObj = {\r\n        aAdmissionBedDetails: {},\r\n      };\r\n    },\r\n    filterMedicineTypeWise() {\r\n      if (this.treatmentSetup.ddlmedicine_type) {\r\n        this.treatmentSetup.ddlmedicine_type.text;\r\n        return this.medicineList.filter(function (el) {\r\n          return el.refid === this.treatmentSetup.ddlmedicine_type.value;\r\n        }, this);\r\n      }\r\n    },\r\n    editTreatment(data, index) {\r\n      this.treatmentSetup.medicineName = data.name;\r\n      this.treatmentSetup.ddltreatment_rules = {\r\n        text: data._treatment_rule_name,\r\n        value: data.treatment_rules_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_duration = {\r\n        text: data._treatment_duration_name,\r\n        value: data.treatment_duration_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_dose = {\r\n        text: data._treatment_dose_name,\r\n        value: data.treatment_dose_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentDialog = true;\r\n      this.treatmentIndex = index\r\n    },\r\n    treatmentEditSave() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].name = this.treatmentSetup.ddlmedicine.text;\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].medicine_id = this.treatmentSetup.ddlmedicine.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_rule_name = this.treatmentSetup.ddltreatment_rules.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_rules_id = this.treatmentSetup.ddltreatment_rules.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_duration_name = this.treatmentSetup.ddltreatment_duration.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_duration_id = this.treatmentSetup.ddltreatment_duration.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_dose_name = this.treatmentSetup.ddltreatment_dose.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_dose_id = this.treatmentSetup.ddltreatment_dose.value;\r\n\r\n        this.treatmentDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n    deleteItem(lst, data) {\r\n      lst.splice(\r\n        lst.findIndex((i) => i === data),\r\n        1\r\n      );\r\n    },\r\n    async add() {\r\n      try {\r\n        if (\r\n          !this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice\r\n            .length\r\n        ) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Please add Patient Advice\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else {\r\n          this.admissionPrescriptionInfo.admission_id =\r\n            this.admittedPatientInfo.admission_id;\r\n\r\n          this.admissionPrescriptionInfo.prescription_date = moment(\r\n            String(this.admissionPrescriptionInfo.cdprescription_date)\r\n          ).format(\"YYYY-MM-DD\");\r\n\r\n          if (this.admissionPrescriptionInfo.cdfolowup_date) {\r\n            this.admissionPrescriptionInfo.folowup_date = moment(\r\n              String(this.admissionPrescriptionInfo.cdfolowup_date)\r\n            ).format(\"YYYY-MM-DD\");\r\n          }\r\n\r\n          let result = await this.admissionPrescriptionService.add(\r\n            this.admissionPrescriptionInfo\r\n          );\r\n          if (result.status === 200) {\r\n            this.downloadPrescription(result.data)\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Prescribed Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.newPrescription();\r\n            this.reset();\r\n            this.show();\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    downloadPrescription(admission_prescription_id) {\r\n      this.prescriptionReportService.GetIPDPescription(admission_prescription_id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    newPrescription() {\r\n      this.headerName = \"Sections\";\r\n      this.filters['global'].value = \"\";\r\n      this.tempData = [];\r\n\r\n      this.admissionPrescriptionInfo = {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        allAdvice: false,\r\n\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n        this.submitted = false;\r\n    },\r\n    reset() {\r\n      this.admittedPatient = {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdfromdate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() - 60)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdtodate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n      },\r\n        //\r\n        // this.dataList = true;\r\n        // this.submitted = false;\r\n        this.isDischarge = false;\r\n      this.show();\r\n    },\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY\");\r\n    },\r\n    formatDateTime(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n\r\n    // History\r\n    history() {\r\n      var data = this.admittedPatientInfo;\r\n      if (data.gender == \"Female\") {\r\n        this.isFemale = true;\r\n      } else {\r\n        this.isFemale = false;\r\n      }\r\n\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n      if (patientId) {\r\n        localStorage.removeItem('patientIdForTreatment');\r\n        localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      } else {\r\n        localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      }\r\n\r\n      // Collect history patient wise //\r\n      this.getComplainsByPatientId(data.patient_id);\r\n\r\n      this.getAllergyDetailsByPatientId(data.patient_id);\r\n\r\n      this.getOnExaminationByPatientId(data.patient_id);\r\n\r\n      this.getIOChartByPatientId(data.patient_id);\r\n\r\n      this.getDiabetesChartByPatientId(data.patient_id);\r\n\r\n      this.getDietChartByPatientId(data.patient_id);\r\n\r\n      this.getCurrentMedicationsByPatientId(data.patient_id);\r\n\r\n      this.getPastHistoryByPatientId(data.patient_id);\r\n\r\n      this.patientProfileService.getSystemSubstance(data.patient_id).then((data) => this.formattedSystemSubstance(data.data));\r\n\r\n      this.isHistory = true;\r\n      this.dataList = false;\r\n      // Collect history patient wise //\r\n    },\r\n    getComplainsByPatientId(patient_id) {\r\n      this.chiefComplain.patient_id = patient_id;\r\n      this.patientProfileService.getComplainsByPatientId(patient_id).then((data) => (this.chiefComplainList = data.data));\r\n    },\r\n\r\n    getAllergyDetailsByPatientId(patient_id) {\r\n      this.allergyDetails.patient_id = patient_id;\r\n      this.patientProfileService.getAllergyDetailsByPatientId(patient_id).then((data) => (this.allergyDetailsList = data.data));\r\n    },\r\n\r\n    getOnExaminationsPopup() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n\r\n      this.popupOnExaminationsData = [];\r\n      this.onExaminationList.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          _on_examination_name: element.text,\r\n          on_examination_id: element.value,\r\n          on_examination_result: String(1),\r\n          patient_id: patientId.toString()\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n\r\n    getOnExaminationByPatientId(patient_id) {\r\n      this.onExamination.patient_id = patient_id;\r\n      this.patientProfileService.getOnExaminationByPatientId(patient_id).then((data) => (this.patientOnExaminationList = data.data));\r\n    },\r\n\r\n    getIOChartByPatientId(patient_id) {\r\n      this.iOChart.patient_id = patient_id;\r\n      this.patientProfileService.getIOChartByPatientId(patient_id).then((data) => (this.iOChartList = data.data));\r\n    },\r\n\r\n    getDiabetesChartByPatientId(patient_id) {\r\n      this.diabetesChart.patient_id = patient_id;\r\n      this.patientProfileService.getDiabetesChartByPatientId(patient_id).then((data) => (this.diabetesChartList = data.data));\r\n    },\r\n\r\n    getDietChartByPatientId(patient_id) {\r\n      this.dietChart.patient_id = patient_id;\r\n      this.patientProfileService.getDietChartByPatientId(patient_id).then((data) => (this.dietChartList = data.data));\r\n    },\r\n\r\n    getCurrentMedicationsByPatientId(patient_id) {\r\n      this.currentMedications.patient_id = patient_id;\r\n      this.patientProfileService.getCurrentMedicationsByPatientId(patient_id).then((data) => (this.currentMedicationsList = data.data));\r\n    },\r\n\r\n    getPastHistoryByPatientId(patient_id) {\r\n      this.pastMedicalHistory.patient_id = patient_id;\r\n      this.patientProfileService.getPastHistoryByPatientId(patient_id).then((data) => (this.pastMedicalHistoryList = data.data));\r\n    },\r\n\r\n    formattedSystemSubstance(data) {\r\n      //this.patientHistory.patient_id = patient_id;\r\n      this.patientHistory.lstPersonalHistory = data.lstPersonalHistory;\r\n      this.patientHistory.lstFamilyHistory = data.lstFamilyHistory;\r\n      this.patientHistory.lstSystemsReview = data.lstSystemsReview;\r\n      this.patientHistory.lstSubstanceUse = data.lstSubstanceUse;\r\n      this.patientHistory.lstReproductiveHistory = data.lstReproductiveHistory;\r\n    },\r\n\r\n    hideHistory() {\r\n      this.isHistory = false;\r\n      this.dataList = false;\r\n      //localStorage.removeItem('patientIdForTreatment');\r\n    },\r\n\r\n    newChiefComplain() {\r\n      this.chiefComplainDialog = true;\r\n    },\r\n    async addChiefComplain() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      this.chiefComplain.patient_id = patientId;\r\n      this.submitted = true;\r\n      if (!this.chiefComplain.compilants_id) {\r\n        return;\r\n      } else if (!this.chiefComplain.patient_id) {\r\n        return;\r\n      } else if (!this.chiefComplain.cdfrom_date) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.chiefComplainList, 'compilants_id', this.chiefComplain.compilants_id, 'patient_complain_id', this.chiefComplain.patient_complain_id, this)) {\r\n        return;\r\n      } else {\r\n        this.chiefComplain.from_date = moment(\r\n          String(this.chiefComplain.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        if (!this.chiefComplain.patient_complain_id) {\r\n          let result = await this.patientProfileService.complainSave(this.chiefComplain);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          let result = await this.patientProfileService.complainUpdate(this.chiefComplain);\r\n          if (result.status === 202) {\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    editChiefComplain(data) {\r\n      this.chiefComplain = Object.assign({}, data);\r\n      this.chiefComplain.cdfrom_date = moment(\r\n        String(this.chiefComplain.from_date)\r\n      ).format(\"MM/DD/YYYY\");\r\n      this.chiefComplainDialog = true;\r\n    },\r\n\r\n    getFood() {\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => this.foodFormatted(data.data));\r\n    },\r\n    foodFormatted(data) {\r\n      this.submitted = false;\r\n      this.foodSetup = {};\r\n      this.foodList = data;\r\n      this.foodDialog = false;\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n    newFood() {\r\n      this.allergyDetailsDialog = false;\r\n      this.foodDialog = true;\r\n    },\r\n    async addFood() {\r\n      this.submitted = true;\r\n      if (!this.foodSetup.food_name) {\r\n        return;\r\n      } else if (this.validation.isNameExists(this.foodList, 'text', this.foodSetup.food_name, 'value', this.foodSetup.food_id, this)) {\r\n        return;\r\n      } else {\r\n        this.foodSetup.active = true;\r\n        let result = await this.foodService.add(this.foodSetup);\r\n        if (result.status === 201) {\r\n          this.getFood();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newAllergyDetails() {\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n    async addAllergyDetails() {\r\n      this.submitted = true;\r\n      if (!this.allergyDetails.food_id) {\r\n        return;\r\n      } else if (!this.allergyDetails.patient_id) {\r\n        return;\r\n      } else if (!this.allergyDetails.type) {\r\n        return;\r\n      } else if (!this.allergyDetails.cdfrom_date) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.allergyDetailsList, 'food_id', this.allergyDetails.food_id, 'patient_allergy_details_id', this.allergyDetails.patient_allergy_details_id, this)) {\r\n        return;\r\n      } else {\r\n        this.allergyDetails.from_date = moment(\r\n          String(this.allergyDetails.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        if (!this.allergyDetails.patient_allergy_details_id) {\r\n          let result = await this.patientProfileService.allergyDetailsSave(this.allergyDetails);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getAllergyDetailsByPatientId(this.allergyDetails.patient_id);\r\n            this.getLatestHistoryByPatientIdForPrescription();\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          let result = await this.patientProfileService.allergyDetailsUpdate(this.allergyDetails);\r\n          if (result.status === 202) {\r\n            this.getAllergyDetailsByPatientId(this.allergyDetails.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    editAllergyDetails(data) {\r\n      this.allergyDetails = Object.assign({}, data);\r\n      this.allergyDetails.cdfrom_date = moment(\r\n        String(this.allergyDetails.from_date)\r\n      ).format(\"MM/DD/YYYY\");\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n\r\n    newOnExamination() {\r\n      this.getOnExaminationsPopup();\r\n      this.onExaminationDialog = true;\r\n    },\r\n    async addOnExamination() {\r\n      this.submitted = true;\r\n      this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (!element.on_examination_result) {\r\n          this.requred = \"required\";\r\n        }\r\n      });\r\n\r\n      if (this.requred) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Required\",\r\n          detail: \"Please fill in the required fields\",\r\n          life: 10000,\r\n        });\r\n        return;\r\n      }\r\n      if (this.requred) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.onExaminationSave(this.popupOnExaminationsData);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getOnExaminationByPatientId(patientId);\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newIOChart() {\r\n      this.iOChartDialog = true;\r\n    },\r\n    async addIOChart() {\r\n      this.submitted = true;\r\n      if (!this.iOChart.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.iOChartSave(this.iOChart);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getIOChartByPatientId(patientId);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newDiabetesChart() {\r\n      this.diabetesChartDialog = true;\r\n    },\r\n    async addDiabetesChart() {\r\n      this.submitted = true;\r\n      if (!this.diabetesChart.meal) {\r\n        return;\r\n      } else if (!this.diabetesChart.before) {\r\n        return;\r\n      } else if (!this.diabetesChart.after) {\r\n        return;\r\n      } else {\r\n        var admission_id = JSON.parse(localStorage.getItem(\"admissionIdForDiabetesService\"));\r\n        this.diabetesChart.aAdmissionServiceDetails.admission_id = String(admission_id);\r\n        let result = await this.patientProfileService.diabetesChartSave(this.diabetesChart);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getDiabetesChartByPatientId(patientId);\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newDietChart() {\r\n      this.dietChartDialog = true;\r\n    },\r\n    getDietChartByTemplateId() {\r\n      if (!this.dietChart.diet_chart_template_id) {\r\n        return\r\n      } else {\r\n        this.dietChartSetupService\r\n          .getByDietChartTemplateId(this.dietChart.diet_chart_template_id)\r\n          .then((data) => (this.dietChartTempList = data.data));\r\n      }\r\n    },\r\n    async addDietChart() {\r\n      this.submitted = true;\r\n      if (this.dietChartTempList.length <= 0) {\r\n        return;\r\n      } else {\r\n        var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n        this.dietChartTempList.forEach(element => {\r\n          element.patient_id = patientId.toString()\r\n        });\r\n\r\n        let result = await this.patientProfileService.dietChartSave(this.dietChartTempList);\r\n        if (result.status === 201) {\r\n          //var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getDietChartByPatientId(patientId);\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newCurrentMedications() {\r\n      this.currentMedicationsDialog = true;\r\n    },\r\n    async addCurrentMedications() {\r\n      this.submitted = true;\r\n      if (!this.currentMedications.medicine_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_rules_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_duration_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_dose_id) {\r\n        return;\r\n      } else if (!this.currentMedications.patient_id) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.currentMedicationsList, 'medicine_id', this.currentMedications.medicine_id, 'patient_current_medications_id', this.currentMedications.patient_current_medications_id, this)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.currentMedicationsSave(this.currentMedications);\r\n        if (result.status === 201) {\r\n          this.getCurrentMedicationsByPatientId(this.currentMedications.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeleteCurrentMedications(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deleteCurrentMedications(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deleteCurrentMedications(data) {\r\n      let result = await this.patientProfileService.currentMedicationsDelete(data);\r\n      if (result.status === 202) {\r\n        this.getCurrentMedicationsByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    newPastMedicalHistory() {\r\n      this.pastMedicalHistoryDialog = true;\r\n    },\r\n    async addPastMedicalHistory() {\r\n      this.submitted = true;\r\n      if (!this.pastMedicalHistory.diagnosis_id) {\r\n        return;\r\n      } else if (!this.pastMedicalHistory.patient_id) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.pastMedicalHistoryList, 'diagnosis_id', this.pastMedicalHistory.diagnosis_id, 'patient_past_history_id', this.pastMedicalHistory.patient_past_history_id, this)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.pastHistorySave(this.pastMedicalHistory);\r\n        if (result.status === 201) {\r\n          this.getPastHistoryByPatientId(this.pastMedicalHistory.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeletePastMedicalHistory(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deletePastMedicalHistory(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deletePastMedicalHistory(data) {\r\n      let result = await this.patientProfileService.pastHistoryDelete(data);\r\n      if (result.status === 202) {\r\n        this.getPastHistoryByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    async patientHistorySave() {\r\n      this.patientHistory.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      //this.submitted = true;\r\n      if (!this.patientHistory.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.patientHistorySave(this.patientHistory, this);\r\n        if (result.status === 201) {\r\n          this.hideHistory();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Final Prescription\r\n    dischargePrescription(data) {\r\n      this.isDischarge = true;\r\n      this.dischargeObj.admission_id = data.admission_id;\r\n      this.dischargeObj.aAdmissionBedDetails.admission_bed_details_id = data.admission_bed_details_id;\r\n      this.dischargeObj.aAdmissionBedDetails.mrp = data.mrp;\r\n      this.dischargeObj.aAdmissionBedDetails.check_in_time = data.check_in_time;\r\n\r\n      this.admittedPatientInfo.admission_id = data.admission_id;\r\n      this.admittedPatientInfo.admission_no = data.admission_no;\r\n      localStorage.setItem('admissionIdForDiabetesService', data.admission_id);\r\n      this.admittedPatientInfo.patient_id = data.patient_id;\r\n      localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      this.admittedPatientInfo.registration_no = data.registration_no;\r\n      this.admittedPatientInfo.patient_name = data.patient_name;\r\n      this.admittedPatientInfo.gender = data.gender;\r\n      this.admittedPatientInfo.age_year = data.age_year;\r\n      this.admittedPatientInfo.age_month = data.age_month;\r\n      this.admittedPatientInfo.age_day = data.age_day;\r\n\r\n      this.dataList = false;\r\n      this.getComplainsByPatientId(data.patient_id);\r\n      this.getLatestHistoryByPatientIdForPrescription();\r\n      // Use for Dialog //\r\n      this.complaintSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.compliantList = data.data));\r\n\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => (this.foodList = data.data));\r\n\r\n      this.onExaminationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.onExaminationList = data.data));\r\n\r\n      this.diagnosisSetupService\r\n        .getAll()\r\n        .then((data) => (this.diagnosisList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllAllergyType()\r\n        .then((data) => (this.allergyTypeList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllDiabetesMeal()\r\n        .then((data) => (this.diabetesMealList = data.data));\r\n\r\n      this.dietChartTemplateSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.dietChartTemplateList = data.data));\r\n      // Use for Dialog //\r\n\r\n      // Previous Prescription Data\r\n      this.admissionPrescriptionService\r\n        .getPreviousPrescriptionDataAdmissionId(data.admission_id)\r\n        .then((data) => this.previousPrescriptionDataFormatted(data.data));\r\n\r\n      // Prescription Treatment\r\n      this.medicineSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.medicineList = data.data));\r\n\r\n      this.treatmentRulesSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n      this.treatmentDurationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n      this.treatmentDoseSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDoseList = data.data));\r\n    },\r\n    discharge() {\r\n      this.dischargeDialog = true;\r\n    },\r\n    async discharged() {\r\n      this.submitted = true;\r\n\r\n      if (!this.dischargeObj.admission_id) {\r\n        return;\r\n      } else if (!this.dischargeObj.discharge_summary) {\r\n        return;\r\n      } else {\r\n        let result = await this.iPDService.discharged(this.dischargeObj, this);\r\n        if (result.status === 201) {\r\n          this.isDischarge = false;\r\n          this.hideDialog();\r\n\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  },\r\n};"]}]}