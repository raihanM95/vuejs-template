{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\thread-loader\\dist\\cjs.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\components\\PatientHistory.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\components\\PatientHistory.js","mtime":1666697129191},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOi9TVk4gUFJPSkVDVFMvRVJQX0hvc3BpdGFsX0NsaWVudC90cnVuay9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRjovU1ZOIFBST0pFQ1RTL0VSUF9Ib3NwaXRhbF9DbGllbnQvdHJ1bmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgUGF0aWVudFByb2ZpbGVTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcHJvZmlsZXMvUGF0aWVudFByb2ZpbGVTZXJ2aWNlIjsKaW1wb3J0IENvbXBsYWludFNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0NvbXBsYWludFNldHVwU2VydmljZSI7CmltcG9ydCBGb29kU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0Zvb2RTZXJ2aWNlIjsKaW1wb3J0IE9uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9PbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IERpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvRGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UiOwppbXBvcnQgRGlldENoYXJ0U2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvRGlldENoYXJ0U2V0dXBTZXJ2aWNlIjsKaW1wb3J0IE1lZGljaW5lU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvTWVkaWNpbmVTZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSI7CmltcG9ydCBUcmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IERpYWdub3Npc1NldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpYWdub3Npc1NldHVwU2VydmljZSI7CmltcG9ydCBDb21tb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvQ29tbW9uU2VydmljZSI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IFZhbGlkYXRpb24gZnJvbSAiLi4vLi4vc2NyaXB0cy92YWxpZGF0aW9uIjsKaW1wb3J0IHsgRmlsdGVyU2VydmljZSwgRmlsdGVyTWF0Y2hNb2RlLCBGaWx0ZXJPcGVyYXRvciB9IGZyb20gInByaW1ldnVlL2FwaSI7CmV4cG9ydCBkZWZhdWx0IHsKICAvL3Byb3BzOiBbJ2hpZGVIaXN0b3J5J10sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpbHRlcmVkSXRlbXM6IG51bGwsCiAgICAgIGFjdGl2ZTogMCwKICAgICAgZXhwYW5kZWRSb3dzOiBbXSwKICAgICAgaXNGZW1hbGU6IGZhbHNlLAogICAgICBjb21wbGFpbnRTZXR1cDoge30sCiAgICAgIGNoaWVmQ29tcGxhaW5EaWFsb2c6IGZhbHNlLAogICAgICBjaGllZkNvbXBsYWluOiB7fSwKICAgICAgY2hpZWZDb21wbGFpbkxpc3Q6IFtdLAogICAgICBjb21wbGlhbnRMaXN0OiBbXSwKICAgICAgZm9vZFNldHVwOiB7fSwKICAgICAgYWxsZXJneURldGFpbHNEaWFsb2c6IGZhbHNlLAogICAgICBhbGxlcmd5RGV0YWlsczoge30sCiAgICAgIGFsbGVyZ3lEZXRhaWxzTGlzdDogW10sCiAgICAgIGZvb2RMaXN0OiBbXSwKICAgICAgYWxsZXJneVR5cGVMaXN0OiBbXSwKICAgICAgb25FeGFtaW5hdGlvbkRpYWxvZzogZmFsc2UsCiAgICAgIG9uRXhhbWluYXRpb246IHt9LAogICAgICBwYXRpZW50T25FeGFtaW5hdGlvbkxpc3Q6IFtdLAogICAgICBvbkV4YW1pbmF0aW9uTGlzdDogW10sCiAgICAgIGlPQ2hhcnREaWFsb2c6IGZhbHNlLAogICAgICBpT0NoYXJ0OiB7fSwKICAgICAgaU9DaGFydExpc3Q6IFtdLAogICAgICBkaWFiZXRlc0NoYXJ0RGlhbG9nOiBmYWxzZSwKICAgICAgZGlhYmV0ZXNDaGFydDogewogICAgICAgIGFBZG1pc3Npb25TZXJ2aWNlRGV0YWlsczoge30KICAgICAgfSwKICAgICAgZGlhYmV0ZXNDaGFydExpc3Q6IFtdLAogICAgICBkaWFiZXRlc01lYWxMaXN0OiBbXSwKICAgICAgZGlldENoYXJ0RGlhbG9nOiBmYWxzZSwKICAgICAgZGlldENoYXJ0OiB7fSwKICAgICAgZGlldENoYXJ0TGlzdDogW10sCiAgICAgIGRpZXRDaGFydFRlbXBsYXRlTGlzdDogW10sCiAgICAgIGRpZXRDaGFydFRlbXBMaXN0OiBbXSwKICAgICAgY3VycmVudE1lZGljYXRpb25zRGlhbG9nOiBmYWxzZSwKICAgICAgY3VycmVudE1lZGljYXRpb25zOiB7fSwKICAgICAgY3VycmVudE1lZGljYXRpb25zTGlzdDogW10sCiAgICAgIG1lZGljaW5lTGlzdDogW10sCiAgICAgIHRyZWF0bWVudFJ1bGVzTGlzdDogW10sCiAgICAgIHRyZWF0bWVudER1cmF0aW9uTGlzdDogW10sCiAgICAgIHRyZWF0bWVudERvc2VMaXN0OiBbXSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nOiBmYWxzZSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5OiB7fSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5TGlzdDogW10sCiAgICAgIGRpYWdub3Npc0xpc3Q6IFtdLAogICAgICBwYXRpZW50SGlzdG9yeTogewogICAgICAgIGxzdFBlcnNvbmFsSGlzdG9yeTogW10sCiAgICAgICAgbHN0RmFtaWx5SGlzdG9yeTogW10sCiAgICAgICAgbHN0U3lzdGVtc1JldmlldzogW10sCiAgICAgICAgbHN0U3Vic3RhbmNlVXNlOiBbXSwKICAgICAgICBsc3RSZXByb2R1Y3RpdmVIaXN0b3J5OiBbXQogICAgICB9LAogICAgICBjb25zdW1lZE1lZGljaW5lRGlhbG9nOiBmYWxzZSwKICAgICAgY29uc3VtZWRNZWRpY2luZUxpc3Q6IFtdLAogICAgICBjb25zdW1lZE1lZGljaW5lOiB7fSwKICAgICAgc3VibWl0dGVkOiBmYWxzZSwKICAgICAgZmlsdGVyczogewogICAgICAgIGdsb2JhbDogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5DT05UQUlOUwogICAgICAgIH0sCiAgICAgICAgbmFtZTogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5pdEZpbHRlcnM6IGZ1bmN0aW9uIGluaXRGaWx0ZXJzKCkgewogICAgICAgIHRoaXMuZmlsdGVycyA9IHsKICAgICAgICAgIGdsb2JhbDogewogICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICAgIH0sCiAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgIG9wZXJhdG9yOiBGaWx0ZXJPcGVyYXRvci5BTkQsCiAgICAgICAgICAgIGNvbnN0cmFpbnRzOiBbewogICAgICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLlNUQVJUU19XSVRICiAgICAgICAgICAgIH1dCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZSA9IG5ldyBQYXRpZW50UHJvZmlsZVNlcnZpY2UoKTsKICAgIHRoaXMuY29tcGxhaW50U2V0dXBTZXJ2aWNlID0gbmV3IENvbXBsYWludFNldHVwU2VydmljZSgpOwogICAgdGhpcy5mb29kU2VydmljZSA9IG5ldyBGb29kU2VydmljZSgpOwogICAgdGhpcy5vbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IE9uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UgPSBuZXcgRGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZGlldENoYXJ0U2V0dXBTZXJ2aWNlID0gbmV3IERpZXRDaGFydFNldHVwU2VydmljZSgpOwogICAgdGhpcy5tZWRpY2luZVNldHVwU2VydmljZSA9IG5ldyBNZWRpY2luZVNldHVwU2VydmljZSgpOwogICAgdGhpcy50cmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSA9IG5ldyBUcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSgpOwogICAgdGhpcy50cmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSA9IG5ldyBUcmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSgpOwogICAgdGhpcy50cmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlID0gbmV3IERpYWdub3Npc1NldHVwU2VydmljZSgpOwogICAgdGhpcy5jb21tb25TZXJ2aWNlID0gbmV3IENvbW1vblNlcnZpY2UoKTsKICAgIHRoaXMudmFsaWRhdGlvbiA9IG5ldyBWYWxpZGF0aW9uKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBoaWRlRGlhbG9nOiBmdW5jdGlvbiBoaWRlRGlhbG9nKCkgewogICAgICB0aGlzLmNoaWVmQ29tcGxhaW5EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5jaGllZkNvbXBsYWluID0ge307CiAgICAgIHRoaXMuZm9vZFNldHVwID0ge307CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHNEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlscyA9IHt9OwogICAgICB0aGlzLm9uRXhhbWluYXRpb25EaWFsb2cgPSBmYWxzZTsgLy8gdGhpcy5vbkV4YW1pbmF0aW9uID0ge307CgogICAgICB0aGlzLmlPQ2hhcnREaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5pT0NoYXJ0ID0ge307CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmRpYWJldGVzQ2hhcnQgPSB7CiAgICAgICAgYUFkbWlzc2lvblNlcnZpY2VEZXRhaWxzOiB7fQogICAgICB9OwogICAgICB0aGlzLmRpZXRDaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmRpZXRDaGFydCA9IHt9OwogICAgICB0aGlzLmN1cnJlbnRNZWRpY2F0aW9uc0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmN1cnJlbnRNZWRpY2F0aW9ucyA9IHt9OwogICAgICB0aGlzLnBhc3RNZWRpY2FsSGlzdG9yeURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnBhc3RNZWRpY2FsSGlzdG9yeSA9IHt9OwogICAgICB0aGlzLmNvbnN1bWVkTWVkaWNpbmVEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5jb25zdW1lZE1lZGljaW5lID0ge307CiAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICB9LAogICAgLy8gR2V0IFByZXZpb3VzIENoaWVmIENvbXBsYWluCiAgICBnZXRDb21wbGFpbnNCeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmNoaWVmQ29tcGxhaW5MaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBHZXQsIEFkZCBDb21wbGFpbgogICAgZ2V0Q29tcGxhaW46IGZ1bmN0aW9uIGdldENvbXBsYWluKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuY29tcGxhaW50U2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczIuY29tcGxpYW50TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgYWRkQ29tcGxhaW46IGZ1bmN0aW9uIGFkZENvbXBsYWluKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczMuc3VibWl0dGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczMuY29tcGxhaW50U2V0dXAuY29tcGlsYW50c19uYW1lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgX3RoaXMzLmNvbXBsYWludFNldHVwLmNvbXBsaWFudHNfZ3JvdXBfaWQgPSAiMSI7CiAgICAgICAgICAgICAgICBfdGhpczMuY29tcGxhaW50U2V0dXAuaXNfZmF2b3VyaXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMuY29tcGxhaW50U2V0dXBTZXJ2aWNlLmFkZChfdGhpczMuY29tcGxhaW50U2V0dXApOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIShyZXN1bHQuc3RhdHVzID09PSAyMDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMzLmdldENvbXBsYWluKCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzdWx0LmRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgX3RoaXMzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTk7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICAgIF90aGlzMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzEsIDE5XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBBZGQgQ2hpZWYgQ29tcGxhaW4KICAgIHNlYXJjaENvbXBsYWluOiBmdW5jdGlvbiBzZWFyY2hDb21wbGFpbihldmVudCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghZXZlbnQucXVlcnkudHJpbSgpLmxlbmd0aCkgewogICAgICAgICAgX3RoaXM0LmZpbHRlcmVkSXRlbXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoX3RoaXM0LmNvbXBsaWFudExpc3QpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL3N0YXJ0IHdpdGgKICAgICAgICAgIF90aGlzNC5maWx0ZXJlZEl0ZW1zID0gX3RoaXM0LmNvbXBsaWFudExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCAyNTApOwogICAgfSwKICAgIG5ld0NoaWVmQ29tcGxhaW46IGZ1bmN0aW9uIG5ld0NoaWVmQ29tcGxhaW4oKSB7CiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQ2hpZWZDb21wbGFpbjogZnVuY3Rpb24gYWRkQ2hpZWZDb21wbGFpbigpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgaXNDb21wbGFpbkV4aXN0LCBjb21wbGFpbklkLCBpc0R1cGxpY2F0ZSwgcmVzdWx0LCBfcmVzdWx0OwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXM1LnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczUuY2hpZWZDb21wbGFpbi5wYXRpZW50X2lkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNS5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM1LmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM1LmNoaWVmQ29tcGxhaW4uY2Rmcm9tX2RhdGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX3RoaXM1LmNoaWVmQ29tcGxhaW4uZnJvbV9kYXRlID0gbW9tZW50KFN0cmluZyhfdGhpczUuY2hpZWZDb21wbGFpbi5jZGZyb21fZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOyAvLyBjb21wbGFpbiBpcyBleGlzdCBjaGVjayBzdGFydAoKICAgICAgICAgICAgICAgIGlmIChfdGhpczUuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbi52YWx1ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpc0NvbXBsYWluRXhpc3QgPSBfdGhpczUuY29tcGxpYW50TGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC50ZXh0ID09IHRoaXMuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbjsKICAgICAgICAgICAgICAgIH0sIF90aGlzNSk7CgogICAgICAgICAgICAgICAgaWYgKCEoaXNDb21wbGFpbkV4aXN0Lmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczUuY29tcGxhaW50U2V0dXAuY29tcGlsYW50c19uYW1lID0gX3RoaXM1LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW47CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNS5hZGRDb21wbGFpbigpOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgY29tcGxhaW5JZCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX3RoaXM1LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW4gPSB7CiAgICAgICAgICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpczUuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbi52YWx1ZSA9IGNvbXBsYWluSWQudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgICAgIF90aGlzNS5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluID0gewogICAgICAgICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXM1LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW4udmFsdWUgPSBpc0NvbXBsYWluRXhpc3RbMF0udmFsdWU7CgogICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgICAvLyBjb21wbGFpbiBpcyBleGlzdCBjaGVjayBlbmQKICAgICAgICAgICAgICAgIGlzRHVwbGljYXRlID0gX3RoaXM1LmNoaWVmQ29tcGxhaW5MaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmNvbXBpbGFudHNfaWQgPT0gdGhpcy5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluLnZhbHVlOwogICAgICAgICAgICAgICAgfSwgX3RoaXM1KTsKICAgICAgICAgICAgICAgIF90aGlzNS5jaGllZkNvbXBsYWluLmNvbXBpbGFudHNfaWQgPSBfdGhpczUuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbi52YWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShpc0R1cGxpY2F0ZS5sZW5ndGggPT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczUucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmNvbXBsYWluU2F2ZShfdGhpczUuY2hpZWZDb21wbGFpbik7CgogICAgICAgICAgICAgIGNhc2UgMzM6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXM1LmdldENvbXBsYWluc0J5UGF0aWVudElkKF90aGlzNS5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM1LmhpZGVEaWFsb2coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczUuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgICAgIF90aGlzNS5jaGllZkNvbXBsYWluLnBhdGllbnRfY29tcGxhaW5faWQgPSBpc0R1cGxpY2F0ZVswXS5wYXRpZW50X2NvbXBsYWluX2lkOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0MDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczUucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmNvbXBsYWluVXBkYXRlKF90aGlzNS5jaGllZkNvbXBsYWluKTsKCiAgICAgICAgICAgICAgY2FzZSA0MDoKICAgICAgICAgICAgICAgIF9yZXN1bHQgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoX3Jlc3VsdC5zdGF0dXMgPT09IDIwMikgewogICAgICAgICAgICAgICAgICBfdGhpczUuZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQoX3RoaXM1LmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczUuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM1LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlVwZGF0ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3Jlc3VsdC5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczUuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDQyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gR2V0IFByZXZpb3VzIEFsbGVyZ3kgRGV0YWlscwogICAgZ2V0QWxsZXJneURldGFpbHNCeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0QWxsZXJneURldGFpbHNCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0QWxsZXJneURldGFpbHNCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNi5hbGxlcmd5RGV0YWlsc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIEdldCwgQWRkIEZvb2QKICAgIGdldEZvb2Q6IGZ1bmN0aW9uIGdldEZvb2QoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdGhpcy5mb29kU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXM3LmZvb2RMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBhZGRGb29kOiBmdW5jdGlvbiBhZGRGb29kKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMDsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXM4LmZvb2RTZXR1cC5mb29kX25hbWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF90aGlzOC5mb29kU2V0dXAuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczguZm9vZFNlcnZpY2UuYWRkKF90aGlzOC5mb29kU2V0dXApOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIShyZXN1bHQuc3RhdHVzID09PSAyMDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzOC5nZXRGb29kKCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHJlc3VsdC5kYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIF90aGlzOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMTc7CiAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgX3RoaXM4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogX2NvbnRleHQzLnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIG51bGwsIFtbMCwgMTddXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEFkZCBBbGxlcmd5IERldGFpbHMKICAgIHNlYXJjaEZvb2Q6IGZ1bmN0aW9uIHNlYXJjaEZvb2QoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWV2ZW50LnF1ZXJ5LnRyaW0oKS5sZW5ndGgpIHsKICAgICAgICAgIF90aGlzOS5maWx0ZXJlZEl0ZW1zID0gX3RvQ29uc3VtYWJsZUFycmF5KF90aGlzOS5mb29kTGlzdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vc3RhcnQgd2l0aAogICAgICAgICAgX3RoaXM5LmZpbHRlcmVkSXRlbXMgPSBfdGhpczkuZm9vZExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCAyNTApOwogICAgfSwKICAgIG5ld0FsbGVyZ3lEZXRhaWxzOiBmdW5jdGlvbiBuZXdBbGxlcmd5RGV0YWlscygpIHsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlsc0RpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQWxsZXJneURldGFpbHM6IGZ1bmN0aW9uIGFkZEFsbGVyZ3lEZXRhaWxzKCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICB2YXIgaXNGb29kRXhpc3QsIGZvb2RJZCwgaXNEdXBsaWNhdGUsIHJlc3VsdCwgX3Jlc3VsdDI7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczEwLnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczEwLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfaWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5kZGxmb29kKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEwLmFsbGVyZ3lEZXRhaWxzLnR5cGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTAuYWxsZXJneURldGFpbHMuY2Rmcm9tX2RhdGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5mcm9tX2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzMTAuYWxsZXJneURldGFpbHMuY2Rmcm9tX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsgLy8gZm9vZCBpcyBleGlzdCBjaGVjayBzdGFydAoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEwLmFsbGVyZ3lEZXRhaWxzLmRkbGZvb2QudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaXNGb29kRXhpc3QgPSBfdGhpczEwLmZvb2RMaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLnRleHQgPT0gdGhpcy5hbGxlcmd5RGV0YWlscy5kZGxmb29kOwogICAgICAgICAgICAgICAgfSwgX3RoaXMxMCk7CgogICAgICAgICAgICAgICAgaWYgKCEoaXNGb29kRXhpc3QubGVuZ3RoID09IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMTAuZm9vZFNldHVwLmZvb2RfbmFtZSA9IF90aGlzMTAuYWxsZXJneURldGFpbHMuZGRsZm9vZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMC5hZGRGb29kKCk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICBmb29kSWQgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzMTAuYWxsZXJneURldGFpbHMuZGRsZm9vZCA9IHsKICAgICAgICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF90aGlzMTAuYWxsZXJneURldGFpbHMuZGRsZm9vZC52YWx1ZSA9IGZvb2RJZC50b1N0cmluZygpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgICAgX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5kZGxmb29kID0gewogICAgICAgICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5kZGxmb29kLnZhbHVlID0gaXNGb29kRXhpc3RbMF0udmFsdWU7CgogICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgICAvLyBmb29kIGlzIGV4aXN0IGNoZWNrIGVuZAogICAgICAgICAgICAgICAgaXNEdXBsaWNhdGUgPSBfdGhpczEwLmFsbGVyZ3lEZXRhaWxzTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC5mb29kX2lkID09IHRoaXMuYWxsZXJneURldGFpbHMuZGRsZm9vZC52YWx1ZTsKICAgICAgICAgICAgICAgIH0sIF90aGlzMTApOwogICAgICAgICAgICAgICAgX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5mb29kX2lkID0gX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5kZGxmb29kLnZhbHVlOwoKICAgICAgICAgICAgICAgIGlmICghKGlzRHVwbGljYXRlLmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTAucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmFsbGVyZ3lEZXRhaWxzU2F2ZShfdGhpczEwLmFsbGVyZ3lEZXRhaWxzKTsKCiAgICAgICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMC5nZXRBbGxlcmd5RGV0YWlsc0J5UGF0aWVudElkKF90aGlzMTAuYWxsZXJneURldGFpbHMucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczEwLmhpZGVEaWFsb2coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTAuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0NjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDQxOgogICAgICAgICAgICAgICAgX3RoaXMxMC5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2FsbGVyZ3lfZGV0YWlsc19pZCA9IGlzRHVwbGljYXRlWzBdLnBhdGllbnRfYWxsZXJneV9kZXRhaWxzX2lkOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0NDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczEwLnBhdGllbnRQcm9maWxlU2VydmljZS5hbGxlcmd5RGV0YWlsc1VwZGF0ZShfdGhpczEwLmFsbGVyZ3lEZXRhaWxzKTsKCiAgICAgICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgICAgIF9yZXN1bHQyID0gX2NvbnRleHQ0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKF9yZXN1bHQyLnN0YXR1cyA9PT0gMjAyKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTAuZ2V0QWxsZXJneURldGFpbHNCeVBhdGllbnRJZChfdGhpczEwLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMC5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczEwLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlVwZGF0ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3Jlc3VsdDIuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogX3Jlc3VsdDIuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTAuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfcmVzdWx0Mi5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBBZGQgT24gRXhhbWluYXRpb24KICAgIG5ld09uRXhhbWluYXRpb246IGZ1bmN0aW9uIG5ld09uRXhhbWluYXRpb24oKSB7CiAgICAgIHRoaXMuZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZE9uRXhhbWluYXRpb246IGZ1bmN0aW9uIGFkZE9uRXhhbWluYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciByZXN1bHQsIHBhdGllbnRJZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMxMS5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXMxMS5yZXF1cmVkID0gIiI7CgogICAgICAgICAgICAgICAgX3RoaXMxMS5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgIGlmICghZWxlbWVudC5vbl9leGFtaW5hdGlvbl9yZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczExLnJlcXVyZWQgPSAicmVxdWlyZWQiOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMTEucmVxdXJlZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMTEuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiUmVxdWlyZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQbGVhc2UgZmlsbCBpbiB0aGUgcmVxdWlyZWQgZmllbGRzIiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczExLnJlcXVyZWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczExLnBhdGllbnRQcm9maWxlU2VydmljZS5vbkV4YW1pbmF0aW9uU2F2ZShfdGhpczExLnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NS5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMS5nZXRPbkV4YW1pbmF0aW9uQnlQYXRpZW50SWQocGF0aWVudElkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTEuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBBZGQgSS9PIENoYXJ0CiAgICBuZXdJT0NoYXJ0OiBmdW5jdGlvbiBuZXdJT0NoYXJ0KCkgewogICAgICB0aGlzLmlPQ2hhcnREaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZElPQ2hhcnQ6IGZ1bmN0aW9uIGFkZElPQ2hhcnQoKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMTIuc3VibWl0dGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF90aGlzMTIuaU9DaGFydC5wYXRpZW50X2lkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTIuaU9DaGFydC5wYXRpZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMi5wYXRpZW50UHJvZmlsZVNlcnZpY2UuaU9DaGFydFNhdmUoX3RoaXMxMi5pT0NoYXJ0KTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ2LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczEyLmdldElPQ2hhcnRCeVBhdGllbnRJZChfdGhpczEyLmlPQ2hhcnQucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczEyLmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTIuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTIuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gRGlhYmV0ZXMgQ2hhcnQKICAgIG5ld0RpYWJldGVzQ2hhcnQ6IGZ1bmN0aW9uIG5ld0RpYWJldGVzQ2hhcnQoKSB7CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkRGlhYmV0ZXNDaGFydDogZnVuY3Rpb24gYWRkRGlhYmV0ZXNDaGFydCgpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMxMy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXMxMy5kaWFiZXRlc0NoYXJ0LnBhdGllbnRfaWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMy5kaWFiZXRlc0NoYXJ0Lm1lYWwpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEzLmRpYWJldGVzQ2hhcnQuYmVmb3JlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEzLmRpYWJldGVzQ2hhcnQuYWZ0ZXIpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTMuZGlhYmV0ZXNDaGFydC5wYXRpZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZGlhYmV0ZXNDaGFydFNhdmUoX3RoaXMxMy5kaWFiZXRlc0NoYXJ0KTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ny5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMy5nZXREaWFiZXRlc0NoYXJ0QnlQYXRpZW50SWQoX3RoaXMxMy5kaWFiZXRlc0NoYXJ0LnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMy5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczEzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczEzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEFkZCBEaWV0IENoYXJ0CiAgICBuZXdEaWV0Q2hhcnQ6IGZ1bmN0aW9uIG5ld0RpZXRDaGFydCgpIHsKICAgICAgdGhpcy5kaWV0Q2hhcnREaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGdldERpZXRDaGFydEJ5VGVtcGxhdGVJZDogZnVuY3Rpb24gZ2V0RGlldENoYXJ0QnlUZW1wbGF0ZUlkKCkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuZGlldENoYXJ0LmRpZXRfY2hhcnRfdGVtcGxhdGVfaWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kaWV0Q2hhcnRTZXR1cFNlcnZpY2UuZ2V0QnlEaWV0Q2hhcnRUZW1wbGF0ZUlkKHRoaXMuZGlldENoYXJ0LmRpZXRfY2hhcnRfdGVtcGxhdGVfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIHJldHVybiBfdGhpczE0LmRpZXRDaGFydFRlbXBMaXN0ID0gZGF0YS5kYXRhOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgYWRkRGlldENoYXJ0OiBmdW5jdGlvbiBhZGREaWV0Q2hhcnQoKSB7CiAgICAgIHZhciBfdGhpczE1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHZhciBwYXRpZW50SWQsIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMxNS5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMTUuZGlldENoYXJ0VGVtcExpc3QubGVuZ3RoIDw9IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSk7CgogICAgICAgICAgICAgICAgX3RoaXMxNS5kaWV0Q2hhcnRUZW1wTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGF0aWVudF9pZCA9IHBhdGllbnRJZC50b1N0cmluZygpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTUucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmRpZXRDaGFydFNhdmUoX3RoaXMxNS5kaWV0Q2hhcnRUZW1wTGlzdCk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0OC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgLy92YXIgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwogICAgICAgICAgICAgICAgICBfdGhpczE1LmdldERpZXRDaGFydEJ5UGF0aWVudElkKHBhdGllbnRJZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE1LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTUuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTUuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gQWRkIEN1cnJlbnQgTWVkaWNhdGlvbnMKICAgIG5ld0N1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gbmV3Q3VycmVudE1lZGljYXRpb25zKCkgewogICAgICB0aGlzLmN1cnJlbnRNZWRpY2F0aW9uc0RpYWxvZyA9IHRydWU7CiAgICB9LAogICAgc2VhcmNoTWVkaWNpbmU6IGZ1bmN0aW9uIHNlYXJjaE1lZGljaW5lKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghZXZlbnQucXVlcnkudHJpbSgpLmxlbmd0aCkgewogICAgICAgICAgX3RoaXMxNi5maWx0ZXJlZEl0ZW1zID0gX3RvQ29uc3VtYWJsZUFycmF5KF90aGlzMTYubWVkaWNpbmVMaXN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gc3RhcnQgd2l0aAogICAgICAgICAgLy8gdGhpcy5maWx0ZXJlZEl0ZW1zID0gdGhpcy5tZWRpY2luZUxpc3QuZmlsdGVyKChpdGVtKSA9PiB7CiAgICAgICAgICAvLyAgICAgcmV0dXJuIGl0ZW0udGV4dC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoZXZlbnQucXVlcnkudG9Mb3dlckNhc2UoKSk7CiAgICAgICAgICAvLyB9KTsKICAgICAgICAgIC8vIGNvbnRhaW5zCiAgICAgICAgICBfdGhpczE2LmZpbHRlcmVkSXRlbXMgPSBGaWx0ZXJTZXJ2aWNlLmZpbHRlcihfdGhpczE2Lm1lZGljaW5lTGlzdCwgWyd0ZXh0J10sIGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKCksIEZpbHRlck1hdGNoTW9kZS5DT05UQUlOUykuc2xpY2UoMCwgMTApOwogICAgICAgIH0KICAgICAgfSwgMjUwKTsKICAgIH0sCiAgICBhZGRDdXJyZW50TWVkaWNhdGlvbnM6IGZ1bmN0aW9uIGFkZEN1cnJlbnRNZWRpY2F0aW9ucygpIHsKICAgICAgdmFyIF90aGlzMTcgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMxNy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXMxNy5jdXJyZW50TWVkaWNhdGlvbnMucGF0aWVudF9pZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgX3RoaXMxNy5jdXJyZW50TWVkaWNhdGlvbnMubWVkaWNpbmVfaWQgPSBfdGhpczE3LmN1cnJlbnRNZWRpY2F0aW9ucy5kZGxtZWRpY2luZS52YWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNy5jdXJyZW50TWVkaWNhdGlvbnMuZGRsbWVkaWNpbmUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGlmIChfdGhpczE3LmN1cnJlbnRNZWRpY2F0aW9ucy50cmVhdG1lbnRfcnVsZXNfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTcuY3VycmVudE1lZGljYXRpb25zLnRyZWF0bWVudF9kdXJhdGlvbl9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNy5jdXJyZW50TWVkaWNhdGlvbnMudHJlYXRtZW50X2Rvc2VfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAxOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTcuY3VycmVudE1lZGljYXRpb25zLnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczE3LnZhbGlkYXRpb24uaXNJZEV4aXN0cyhfdGhpczE3LmN1cnJlbnRNZWRpY2F0aW9uc0xpc3QsICdtZWRpY2luZV9pZCcsIF90aGlzMTcuY3VycmVudE1lZGljYXRpb25zLm1lZGljaW5lX2lkLCAncGF0aWVudF9jdXJyZW50X21lZGljYXRpb25zX2lkJywgX3RoaXMxNy5jdXJyZW50TWVkaWNhdGlvbnMucGF0aWVudF9jdXJyZW50X21lZGljYXRpb25zX2lkLCBfdGhpczE3KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDI3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDI5OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTcucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmN1cnJlbnRNZWRpY2F0aW9uc1NhdmUoX3RoaXMxNy5jdXJyZW50TWVkaWNhdGlvbnMpOwoKICAgICAgICAgICAgICBjYXNlIDI5OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ5LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKF90aGlzMTcuY3VycmVudE1lZGljYXRpb25zLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxNy5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczE3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNvbmZpcm1EZWxldGVDdXJyZW50TWVkaWNhdGlvbnM6IGZ1bmN0aW9uIGNvbmZpcm1EZWxldGVDdXJyZW50TWVkaWNhdGlvbnMoZGF0YSkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgICB0aGlzLiRjb25maXJtLnJlcXVpcmUoewogICAgICAgIG1lc3NhZ2U6ICdEbyB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyByZWNvcmQ/JywKICAgICAgICBoZWFkZXI6ICdEZWxldGUgQ29uZmlybWF0aW9uJywKICAgICAgICBpY29uOiAncGkgcGktaW5mby1jaXJjbGUnLAogICAgICAgIGFjY2VwdENsYXNzOiAncC1idXR0b24tZGFuZ2VyJywKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIF90aGlzMTguZGVsZXRlQ3VycmVudE1lZGljYXRpb25zKGRhdGEpOwogICAgICAgIH0sCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QoKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZWxldGVDdXJyZW50TWVkaWNhdGlvbnM6IGZ1bmN0aW9uIGRlbGV0ZUN1cnJlbnRNZWRpY2F0aW9ucyhkYXRhKSB7CiAgICAgIHZhciBfdGhpczE5ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczE5LnBhdGllbnRQcm9maWxlU2VydmljZS5jdXJyZW50TWVkaWNhdGlvbnNEZWxldGUoZGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0MTAuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAyKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTkuZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIENvbnN1bWVkIE1lZGljaW5lCiAgICBuZXdDb25zdW1lZE1lZGljaW5lOiBmdW5jdGlvbiBuZXdDb25zdW1lZE1lZGljaW5lKCkgewogICAgICB0aGlzLmNvbnN1bWVkTWVkaWNpbmVEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZENvbnN1bWVkTWVkaWNpbmU6IGZ1bmN0aW9uIGFkZENvbnN1bWVkTWVkaWNpbmUoKSB7CiAgICAgIHZhciBfdGhpczIwID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMSgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMyMC5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXMyMC5jb25zdW1lZE1lZGljaW5lLnBhdGllbnRfaWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIF90aGlzMjAuY29uc3VtZWRNZWRpY2luZS5tZWRpY2luZV9pZCA9IF90aGlzMjAuY29uc3VtZWRNZWRpY2luZS5kZGxtZWRpY2luZS52YWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMC5jb25zdW1lZE1lZGljaW5lLmRkbG1lZGljaW5lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIwLmNvbnN1bWVkTWVkaWNpbmUudHJlYXRtZW50X2Rvc2VfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMC5jb25zdW1lZE1lZGljaW5lLnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIwLnBhdGllbnRQcm9maWxlU2VydmljZS5jb25zdW1lZE1lZGljaW5lU2F2ZShfdGhpczIwLmNvbnN1bWVkTWVkaWNpbmUpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMS5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMC5nZXRDb25zdW1lZE1lZGljaW5lQnlQYXRpZW50SWQoX3RoaXMyMC5jb25zdW1lZE1lZGljaW5lLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyMC5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczIwLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczIwLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gUGFzdCBNZWRpY2FsIEhpc3RvcnkKICAgIG5ld1Bhc3RNZWRpY2FsSGlzdG9yeTogZnVuY3Rpb24gbmV3UGFzdE1lZGljYWxIaXN0b3J5KCkgewogICAgICB0aGlzLnBhc3RNZWRpY2FsSGlzdG9yeURpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkUGFzdE1lZGljYWxIaXN0b3J5OiBmdW5jdGlvbiBhZGRQYXN0TWVkaWNhbEhpc3RvcnkoKSB7CiAgICAgIHZhciBfdGhpczIxID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMyMS5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXMyMS5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9pZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKS50b1N0cmluZygpOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIxLnBhc3RNZWRpY2FsSGlzdG9yeS5kaWFnbm9zaXNfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjEucGFzdE1lZGljYWxIaXN0b3J5LnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMjEudmFsaWRhdGlvbi5pc0lkRXhpc3RzKF90aGlzMjEucGFzdE1lZGljYWxIaXN0b3J5TGlzdCwgJ2RpYWdub3Npc19pZCcsIF90aGlzMjEucGFzdE1lZGljYWxIaXN0b3J5LmRpYWdub3Npc19pZCwgJ3BhdGllbnRfcGFzdF9oaXN0b3J5X2lkJywgX3RoaXMyMS5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9wYXN0X2hpc3RvcnlfaWQsIF90aGlzMjEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMS5wYXRpZW50UHJvZmlsZVNlcnZpY2UucGFzdEhpc3RvcnlTYXZlKF90aGlzMjEucGFzdE1lZGljYWxIaXN0b3J5KTsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0MTIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjEuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChfdGhpczIxLnBhc3RNZWRpY2FsSGlzdG9yeS5wYXRpZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjEuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNvbmZpcm1EZWxldGVQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGNvbmZpcm1EZWxldGVQYXN0TWVkaWNhbEhpc3RvcnkoZGF0YSkgewogICAgICB2YXIgX3RoaXMyMiA9IHRoaXM7CgogICAgICB0aGlzLiRjb25maXJtLnJlcXVpcmUoewogICAgICAgIG1lc3NhZ2U6ICdEbyB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyByZWNvcmQ/JywKICAgICAgICBoZWFkZXI6ICdEZWxldGUgQ29uZmlybWF0aW9uJywKICAgICAgICBpY29uOiAncGkgcGktaW5mby1jaXJjbGUnLAogICAgICAgIGFjY2VwdENsYXNzOiAncC1idXR0b24tZGFuZ2VyJywKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIF90aGlzMjIuZGVsZXRlUGFzdE1lZGljYWxIaXN0b3J5KGRhdGEpOwogICAgICAgIH0sCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QoKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZWxldGVQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGRlbGV0ZVBhc3RNZWRpY2FsSGlzdG9yeShkYXRhKSB7CiAgICAgIHZhciBfdGhpczIzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMygpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTMkKF9jb250ZXh0MTMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIzLnBhdGllbnRQcm9maWxlU2VydmljZS5wYXN0SGlzdG9yeURlbGV0ZShkYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMy5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMy5nZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczIzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTMpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBwYXRpZW50SGlzdG9yeVNhdmU6IGZ1bmN0aW9uIHBhdGllbnRIaXN0b3J5U2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMjQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNCQoX2NvbnRleHQxNCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczI0LnBhdGllbnRIaXN0b3J5LnBhdGllbnRfaWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsgLy90aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjQucGF0aWVudEhpc3RvcnkucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjQucGF0aWVudFByb2ZpbGVTZXJ2aWNlLnBhdGllbnRIaXN0b3J5U2F2ZShfdGhpczI0LnBhdGllbnRIaXN0b3J5LCBfdGhpczI0KTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxNC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyNC5oaWRlSGlzdG9yeSgpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE0KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gY29sbGVjdCBoaXN0b3J5CiAgICBoaXN0b3J5Q29sbGVjdGlvbjogZnVuY3Rpb24gaGlzdG9yeUNvbGxlY3Rpb24oZGF0YSkgewogICAgICB2YXIgX3RoaXMyNSA9IHRoaXM7CgogICAgICBpZiAoZGF0YS5nZW5kZXIgPT0gIkZlbWFsZSIpIHsKICAgICAgICB0aGlzLmlzRmVtYWxlID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzRmVtYWxlID0gZmFsc2U7CiAgICAgIH0gLy9sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWRtaXNzaW9uSWRGb3JEaWFiZXRlc1NlcnZpY2UnLCBkYXRhLmFkbWlzc2lvbl9pZCk7CgoKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3BhdGllbnRJZEZvclRyZWF0bWVudCcpOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncGF0aWVudElkRm9yVHJlYXRtZW50JywgZGF0YS5wYXRpZW50X2lkKTsgLy8gdXNlIGZvciBEaWFsb2cgLy8KCiAgICAgIHRoaXMuZ2V0Q29tcGxhaW4oKTsKICAgICAgdGhpcy5nZXRGb29kKCk7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvblNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNS5vbkV4YW1pbmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjUubWVkaWNpbmVMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy50cmVhdG1lbnRSdWxlc1NldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNS50cmVhdG1lbnRSdWxlc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI1LnRyZWF0bWVudER1cmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNS50cmVhdG1lbnREb3NlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlLmdldEFsbCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNS5kaWFnbm9zaXNMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy5jb21tb25TZXJ2aWNlLkdldEFsbEFsbGVyZ3lUeXBlKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI1LmFsbGVyZ3lUeXBlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxEaWFiZXRlc01lYWwoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjUuZGlhYmV0ZXNNZWFsTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjUuZGlldENoYXJ0VGVtcGxhdGVMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsgLy8gdXNlIGZvciBEaWFsb2cgLy8KICAgICAgLy8gY29sbGVjdCBoaXN0b3J5IHBhdGllbnQgd2lzZSAvLwoKICAgICAgdGhpcy5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldEFsbGVyZ3lEZXRhaWxzQnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXRPbkV4YW1pbmF0aW9uQnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXRJT0NoYXJ0QnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXREaWFiZXRlc0NoYXJ0QnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXREaWV0Q2hhcnRCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRTeXN0ZW1TdWJzdGFuY2UoZGF0YS5wYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjUuZm9ybWF0dGVkU3lzdGVtU3Vic3RhbmNlKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgICB0aGlzLmdldENvbnN1bWVkTWVkaWNpbmVCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOyAvLyBjb2xsZWN0IGhpc3RvcnkgcGF0aWVudCB3aXNlIC8vCiAgICB9LAogICAgZ2V0T25FeGFtaW5hdGlvbnNQb3B1cDogZnVuY3Rpb24gZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpIHsKICAgICAgdmFyIF90aGlzMjYgPSB0aGlzOwoKICAgICAgdmFyIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKTsKICAgICAgdGhpcy5wb3B1cE9uRXhhbWluYXRpb25zRGF0YSA9IFtdOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25MaXN0LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczI2LnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhLnB1c2goewogICAgICAgICAgX29uX2V4YW1pbmF0aW9uX25hbWU6IGVsZW1lbnQudGV4dCwKICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX2lkOiBlbGVtZW50LnZhbHVlLAogICAgICAgICAgb25fZXhhbWluYXRpb25fcmVzdWx0OiBTdHJpbmcoMSksCiAgICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQudG9TdHJpbmcoKQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uUG9wdXBEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGdldE9uRXhhbWluYXRpb25CeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0T25FeGFtaW5hdGlvbkJ5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMjcgPSB0aGlzOwoKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uLnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRPbkV4YW1pbmF0aW9uQnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI3LnBhdGllbnRPbkV4YW1pbmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0SU9DaGFydEJ5UGF0aWVudElkOiBmdW5jdGlvbiBnZXRJT0NoYXJ0QnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMyOCA9IHRoaXM7CgogICAgICB0aGlzLmlPQ2hhcnQucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldElPQ2hhcnRCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjguaU9DaGFydExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldERpYWJldGVzQ2hhcnRCeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0RGlhYmV0ZXNDaGFydEJ5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMjkgPSB0aGlzOwoKICAgICAgdGhpcy5kaWFiZXRlc0NoYXJ0LnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXREaWFiZXRlc0NoYXJ0QnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI5LmRpYWJldGVzQ2hhcnRMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnZXREaWV0Q2hhcnRCeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0RGlldENoYXJ0QnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMzMCA9IHRoaXM7CgogICAgICB0aGlzLmRpZXRDaGFydC5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0RGlldENoYXJ0QnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMwLmRpZXRDaGFydExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkOiBmdW5jdGlvbiBnZXRDdXJyZW50TWVkaWNhdGlvbnNCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczMxID0gdGhpczsKCiAgICAgIHRoaXMuY3VycmVudE1lZGljYXRpb25zLnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRDdXJyZW50TWVkaWNhdGlvbnNCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMzEuY3VycmVudE1lZGljYXRpb25zTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZDogZnVuY3Rpb24gZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczMyID0gdGhpczsKCiAgICAgIHRoaXMucGFzdE1lZGljYWxIaXN0b3J5LnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzMi5wYXN0TWVkaWNhbEhpc3RvcnlMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBmb3JtYXR0ZWRTeXN0ZW1TdWJzdGFuY2U6IGZ1bmN0aW9uIGZvcm1hdHRlZFN5c3RlbVN1YnN0YW5jZShkYXRhKSB7CiAgICAgIC8vdGhpcy5wYXRpZW50SGlzdG9yeS5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50SGlzdG9yeS5sc3RQZXJzb25hbEhpc3RvcnkgPSBkYXRhLmxzdFBlcnNvbmFsSGlzdG9yeTsKICAgICAgdGhpcy5wYXRpZW50SGlzdG9yeS5sc3RGYW1pbHlIaXN0b3J5ID0gZGF0YS5sc3RGYW1pbHlIaXN0b3J5OwogICAgICB0aGlzLnBhdGllbnRIaXN0b3J5LmxzdFN5c3RlbXNSZXZpZXcgPSBkYXRhLmxzdFN5c3RlbXNSZXZpZXc7CiAgICAgIHRoaXMucGF0aWVudEhpc3RvcnkubHN0U3Vic3RhbmNlVXNlID0gZGF0YS5sc3RTdWJzdGFuY2VVc2U7CiAgICAgIHRoaXMucGF0aWVudEhpc3RvcnkubHN0UmVwcm9kdWN0aXZlSGlzdG9yeSA9IGRhdGEubHN0UmVwcm9kdWN0aXZlSGlzdG9yeTsKICAgIH0sCiAgICBnZXRDb25zdW1lZE1lZGljaW5lQnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldENvbnN1bWVkTWVkaWNpbmVCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczMzID0gdGhpczsKCiAgICAgIHRoaXMuY29uc3VtZWRNZWRpY2luZS5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0Q29uc3VtZWRNZWRpY2luZUJ5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzMy5jb25zdW1lZE1lZGljaW5lTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgaGlkZUhpc3Rvcnk6IGZ1bmN0aW9uIGhpZGVIaXN0b3J5KCkgewogICAgICAvL3RoaXMuJGVtaXQoJ2hpZGVIaXN0b3J5JykKICAgICAgdGhpcy4kcGFyZW50LmhpZGVIaXN0b3J5KCk7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwYXRpZW50SWRGb3JUcmVhdG1lbnQnKTsKICAgIH0sCiAgICBmb3JtYXREYXRlOiBmdW5jdGlvbiBmb3JtYXREYXRlKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CiAgICB9LAogICAgZm9ybWF0RGF0ZVRpbWU6IGZ1bmN0aW9uIGZvcm1hdERhdGVUaW1lKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIGg6bW06c3MgYSIpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/components/PatientHistory.js"],"names":["PatientProfileService","ComplaintSetupService","FoodService","OnExaminationSetupService","DietChartTemplateSetupService","DietChartSetupService","MedicineSetupService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","DiagnosisSetupService","CommonService","moment","Validation","FilterService","FilterMatchMode","FilterOperator","data","filteredItems","active","expandedRows","isFemale","complaintSetup","chiefComplainDialog","chiefComplain","chiefComplainList","compliantList","foodSetup","allergyDetailsDialog","allergyDetails","allergyDetailsList","foodList","allergyTypeList","onExaminationDialog","onExamination","patientOnExaminationList","onExaminationList","iOChartDialog","iOChart","iOChartList","diabetesChartDialog","diabetesChart","aAdmissionServiceDetails","diabetesChartList","diabetesMealList","dietChartDialog","dietChart","dietChartList","dietChartTemplateList","dietChartTempList","currentMedicationsDialog","currentMedications","currentMedicationsList","medicineList","treatmentRulesList","treatmentDurationList","treatmentDoseList","pastMedicalHistoryDialog","pastMedicalHistory","pastMedicalHistoryList","diagnosisList","patientHistory","lstPersonalHistory","lstFamilyHistory","lstSystemsReview","lstSubstanceUse","lstReproductiveHistory","consumedMedicineDialog","consumedMedicineList","consumedMedicine","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","created","patientProfileService","complaintSetupService","foodService","onExaminationSetupService","dietChartTemplateSetupService","dietChartSetupService","medicineSetupService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","diagnosisSetupService","commonService","validation","methods","hideDialog","getComplainsByPatientId","patient_id","then","getComplain","getActiveCombo","addComplain","compilants_name","compliants_group_id","is_favourite","add","result","status","$toast","severity","summary","detail","res","life","searchComplain","event","setTimeout","query","trim","length","filter","item","text","toLowerCase","startsWith","newChiefComplain","addChiefComplain","JSON","parse","localStorage","getItem","toString","ddlcomplain","cdfrom_date","from_date","String","format","isComplainExist","el","complainId","isDuplicate","compilants_id","complainSave","patient_complain_id","complainUpdate","getAllergyDetailsByPatientId","getFood","addFood","food_name","searchFood","newAllergyDetails","addAllergyDetails","ddlfood","type","isFoodExist","foodId","food_id","allergyDetailsSave","patient_allergy_details_id","allergyDetailsUpdate","newOnExamination","getOnExaminationsPopup","addOnExamination","requred","popupOnExaminationsData","forEach","element","on_examination_result","onExaminationSave","patientId","getOnExaminationByPatientId","newIOChart","addIOChart","iOChartSave","getIOChartByPatientId","newDiabetesChart","addDiabetesChart","meal","before","after","diabetesChartSave","getDiabetesChartByPatientId","newDietChart","getDietChartByTemplateId","diet_chart_template_id","getByDietChartTemplateId","addDietChart","dietChartSave","getDietChartByPatientId","newCurrentMedications","searchMedicine","slice","addCurrentMedications","medicine_id","ddlmedicine","treatment_rules_id","treatment_duration_id","treatment_dose_id","isIdExists","patient_current_medications_id","currentMedicationsSave","getCurrentMedicationsByPatientId","confirmDeleteCurrentMedications","$confirm","require","message","header","icon","acceptClass","accept","deleteCurrentMedications","reject","currentMedicationsDelete","newConsumedMedicine","addConsumedMedicine","consumedMedicineSave","getConsumedMedicineByPatientId","newPastMedicalHistory","addPastMedicalHistory","diagnosis_id","patient_past_history_id","pastHistorySave","getPastHistoryByPatientId","confirmDeletePastMedicalHistory","deletePastMedicalHistory","pastHistoryDelete","patientHistorySave","hideHistory","historyCollection","gender","removeItem","setItem","getAll","GetAllAllergyType","GetAllDiabetesMeal","getSystemSubstance","formattedSystemSubstance","push","_on_examination_name","on_examination_id","onExaminationPopupDialog","$parent","formatDate","formatDateTime"],"mappings":"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","sourcesContent":["import PatientProfileService from \"../../service/profiles/PatientProfileService\";\r\nimport ComplaintSetupService from \"../../service/setup/ComplaintSetupService\";\r\nimport FoodService from \"../../service/setup/FoodService\";\r\nimport OnExaminationSetupService from \"../../service/setup/OnExaminationSetupService\";\r\nimport DietChartTemplateSetupService from \"../../service/setup/DietChartTemplateSetupService\";\r\nimport DietChartSetupService from \"../../service/setup/DietChartSetupService\";\r\nimport MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\nimport DiagnosisSetupService from \"../../service/setup/DiagnosisSetupService\";\r\nimport CommonService from \"../../service/CommonService\";\r\n\r\nimport moment from \"moment\";\r\nimport Validation from \"../../scripts/validation\";\r\nimport { FilterService, FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n\r\nexport default {\r\n  //props: ['hideHistory'],\r\n  data() {\r\n    return {\r\n      filteredItems: null,\r\n      active: 0,\r\n      expandedRows: [],\r\n      isFemale: false,\r\n\r\n      complaintSetup: {},\r\n      chiefComplainDialog: false,\r\n      chiefComplain: {},\r\n      chiefComplainList: [],\r\n      compliantList: [],\r\n\r\n      foodSetup: {},\r\n      allergyDetailsDialog: false,\r\n      allergyDetails: {},\r\n      allergyDetailsList: [],\r\n      foodList: [],\r\n      allergyTypeList: [],\r\n\r\n      onExaminationDialog: false,\r\n      onExamination: {},\r\n      patientOnExaminationList: [],\r\n      onExaminationList: [],\r\n\r\n      iOChartDialog: false,\r\n      iOChart: {},\r\n      iOChartList: [],\r\n\r\n      diabetesChartDialog: false,\r\n      diabetesChart: {\r\n        aAdmissionServiceDetails: {}\r\n      },\r\n      diabetesChartList: [],\r\n      diabetesMealList: [],\r\n\r\n      dietChartDialog: false,\r\n      dietChart: {},\r\n      dietChartList: [],\r\n      dietChartTemplateList: [],\r\n      dietChartTempList: [],\r\n\r\n      currentMedicationsDialog: false,\r\n      currentMedications: {},\r\n      currentMedicationsList: [],\r\n      medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n\r\n      pastMedicalHistoryDialog: false,\r\n      pastMedicalHistory: {},\r\n      pastMedicalHistoryList: [],\r\n      diagnosisList: [],\r\n\r\n      patientHistory: {\r\n        lstPersonalHistory: [],\r\n        lstFamilyHistory: [],\r\n        lstSystemsReview: [],\r\n        lstSubstanceUse: [],\r\n        lstReproductiveHistory: [],\r\n      },\r\n\r\n      consumedMedicineDialog: false,\r\n      consumedMedicineList : [],\r\n      consumedMedicine: {},\r\n\r\n      submitted: false,\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    this.patientProfileService = new PatientProfileService();\r\n    this.complaintSetupService = new ComplaintSetupService();\r\n    this.foodService = new FoodService();\r\n    this.onExaminationSetupService = new OnExaminationSetupService();\r\n    this.dietChartTemplateSetupService = new DietChartTemplateSetupService();\r\n    this.dietChartSetupService = new DietChartSetupService();\r\n    this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n    this.diagnosisSetupService = new DiagnosisSetupService();\r\n    this.commonService = new CommonService();\r\n    this.validation = new Validation();\r\n  },\r\n  methods: {\r\n    hideDialog() {\r\n      this.chiefComplainDialog = false;\r\n      this.chiefComplain = {};\r\n\r\n      this.foodSetup = {};\r\n      this.allergyDetailsDialog = false;\r\n      this.allergyDetails = {};\r\n\r\n      this.onExaminationDialog = false;\r\n      // this.onExamination = {};\r\n\r\n      this.iOChartDialog = false;\r\n      this.iOChart = {};\r\n\r\n      this.diabetesChartDialog = false;\r\n      this.diabetesChart = {\r\n        aAdmissionServiceDetails: {},\r\n      };\r\n\r\n      this.dietChartDialog = false;\r\n      this.dietChart = {};\r\n\r\n      this.currentMedicationsDialog = false;\r\n      this.currentMedications = {};\r\n\r\n      this.pastMedicalHistoryDialog = false;\r\n      this.pastMedicalHistory = {};\r\n\r\n      this.consumedMedicineDialog  = false;\r\n      this.consumedMedicine = {};\r\n\r\n      this.submitted = false;\r\n    },\r\n\r\n    // Get Previous Chief Complain\r\n    getComplainsByPatientId(patient_id) {\r\n      this.chiefComplain.patient_id = patient_id;\r\n      this.patientProfileService.getComplainsByPatientId(patient_id).then((data) => (this.chiefComplainList = data.data));\r\n    },\r\n    // Get, Add Complain\r\n    getComplain() {\r\n      this.complaintSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.compliantList = data.data));\r\n    },\r\n    async addComplain() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.complaintSetup.compilants_name) {\r\n          return;\r\n        } else {\r\n          this.complaintSetup.compliants_group_id = \"1\"\r\n          this.complaintSetup.is_favourite = true;\r\n          let result = await this.complaintSetupService.add(this.complaintSetup);\r\n          if (result.status === 200) {\r\n            this.getComplain();\r\n            return result.data;\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add Chief Complain\r\n    searchComplain(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.compliantList];\r\n        }\r\n        else {\r\n          //start with\r\n          this.filteredItems = this.compliantList.filter((item) => {\r\n            return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          });\r\n        }\r\n      }, 250);\r\n    },\r\n    newChiefComplain() {\r\n      this.chiefComplainDialog = true;\r\n    },\r\n    async addChiefComplain() {\r\n      this.submitted = true;\r\n      this.chiefComplain.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.chiefComplain.ddlcomplain) {\r\n        return;\r\n      } else if (!this.chiefComplain.patient_id) {\r\n        return;\r\n      } else if (!this.chiefComplain.cdfrom_date) {\r\n        return;\r\n      } else {\r\n        this.chiefComplain.from_date = moment(\r\n          String(this.chiefComplain.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        // complain is exist check start\r\n        if (!this.chiefComplain.ddlcomplain.value) {\r\n          var isComplainExist = this.compliantList.filter(function (el) {\r\n            return el.text == this.chiefComplain.ddlcomplain;\r\n          }, this);\r\n\r\n          if (isComplainExist.length == 0) {\r\n            this.complaintSetup.compilants_name = this.chiefComplain.ddlcomplain;\r\n            var complainId = await this.addComplain();\r\n            this.chiefComplain.ddlcomplain = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.chiefComplain.ddlcomplain.value = complainId.toString();\r\n          } else {\r\n            this.chiefComplain.ddlcomplain = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.chiefComplain.ddlcomplain.value = isComplainExist[0].value;\r\n          }\r\n        }\r\n        // complain is exist check end\r\n\r\n        var isDuplicate = this.chiefComplainList.filter(function (el) {\r\n          return el.compilants_id == this.chiefComplain.ddlcomplain.value;\r\n        }, this);\r\n        this.chiefComplain.compilants_id = this.chiefComplain.ddlcomplain.value;\r\n        if (isDuplicate.length == 0) {\r\n          let result = await this.patientProfileService.complainSave(this.chiefComplain);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          this.chiefComplain.patient_complain_id = isDuplicate[0].patient_complain_id;\r\n          let result = await this.patientProfileService.complainUpdate(this.chiefComplain);\r\n          if (result.status === 202) {\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    // Get Previous Allergy Details\r\n    getAllergyDetailsByPatientId(patient_id) {\r\n      this.allergyDetails.patient_id = patient_id;\r\n      this.patientProfileService.getAllergyDetailsByPatientId(patient_id).then((data) => (this.allergyDetailsList = data.data));\r\n    },\r\n    // Get, Add Food\r\n    getFood() {\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => (this.foodList = data.data));\r\n    },\r\n    async addFood() {\r\n      try {\r\n        if (!this.foodSetup.food_name) {\r\n          return;\r\n        } else {\r\n          this.foodSetup.active = true;\r\n          let result = await this.foodService.add(this.foodSetup);\r\n          if (result.status === 200) {\r\n            this.getFood();\r\n            return result.data;\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add Allergy Details\r\n    searchFood(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.foodList];\r\n        }\r\n        else {\r\n          //start with\r\n          this.filteredItems = this.foodList.filter((item) => {\r\n            return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          });\r\n        }\r\n      }, 250);\r\n    },\r\n    newAllergyDetails() {\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n    async addAllergyDetails() {\r\n      this.submitted = true;\r\n      this.allergyDetails.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.allergyDetails.ddlfood) {\r\n        return;\r\n      } else if (!this.allergyDetails.patient_id) {\r\n        return;\r\n      } else if (!this.allergyDetails.type) {\r\n        return;\r\n      } else if (!this.allergyDetails.cdfrom_date) {\r\n        return;\r\n      } else {\r\n        this.allergyDetails.from_date = moment(\r\n          String(this.allergyDetails.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        // food is exist check start\r\n        if (!this.allergyDetails.ddlfood.value) {\r\n          var isFoodExist = this.foodList.filter(function (el) {\r\n            return el.text == this.allergyDetails.ddlfood;\r\n          }, this);\r\n\r\n          if (isFoodExist.length == 0) {\r\n            this.foodSetup.food_name = this.allergyDetails.ddlfood;\r\n            var foodId = await this.addFood();\r\n            this.allergyDetails.ddlfood = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.allergyDetails.ddlfood.value = foodId.toString();\r\n          } else {\r\n            this.allergyDetails.ddlfood = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.allergyDetails.ddlfood.value = isFoodExist[0].value;\r\n          }\r\n        }\r\n        // food is exist check end\r\n\r\n        var isDuplicate = this.allergyDetailsList.filter(function (el) {\r\n          return el.food_id == this.allergyDetails.ddlfood.value;\r\n        }, this);\r\n        this.allergyDetails.food_id = this.allergyDetails.ddlfood.value;\r\n        if (isDuplicate.length == 0) {\r\n          let result = await this.patientProfileService.allergyDetailsSave(this.allergyDetails);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getAllergyDetailsByPatientId(this.allergyDetails.patient_id);\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          this.allergyDetails.patient_allergy_details_id = isDuplicate[0].patient_allergy_details_id;\r\n          let result = await this.patientProfileService.allergyDetailsUpdate(this.allergyDetails);\r\n          if (result.status === 202) {\r\n            this.getAllergyDetailsByPatientId(this.allergyDetails.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add On Examination\r\n    newOnExamination() {\r\n      this.getOnExaminationsPopup();\r\n      this.onExaminationDialog = true;\r\n    },\r\n    async addOnExamination() {\r\n      this.submitted = true;\r\n      this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (!element.on_examination_result) {\r\n          this.requred = \"required\";\r\n        }\r\n      });\r\n\r\n      if (this.requred) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Required\",\r\n          detail: \"Please fill in the required fields\",\r\n          life: 10000,\r\n        });\r\n        return;\r\n      }\r\n      if (this.requred) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.onExaminationSave(this.popupOnExaminationsData);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getOnExaminationByPatientId(patientId);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add I/O Chart\r\n    newIOChart() {\r\n      this.iOChartDialog = true;\r\n    },\r\n    async addIOChart() {\r\n      this.submitted = true;\r\n      this.iOChart.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.iOChart.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.iOChartSave(this.iOChart);\r\n        if (result.status === 201) {\r\n          this.getIOChartByPatientId(this.iOChart.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Diabetes Chart\r\n    newDiabetesChart() {\r\n      this.diabetesChartDialog = true;\r\n    },\r\n    async addDiabetesChart() {\r\n      this.submitted = true;\r\n      this.diabetesChart.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.diabetesChart.meal) {\r\n        return;\r\n      } else if (!this.diabetesChart.before) {\r\n        return;\r\n      } else if (!this.diabetesChart.after) {\r\n        return;\r\n      } else if (!this.diabetesChart.patient_id) {\r\n        return;\r\n      } else {\r\n        //var admission_id = JSON.parse(localStorage.getItem(\"admissionIdForDiabetesService\"));\r\n        //this.diabetesChart.aAdmissionServiceDetails.admission_id = String(admission_id);\r\n        let result = await this.patientProfileService.diabetesChartSave(this.diabetesChart);\r\n        if (result.status === 201) {\r\n          this.getDiabetesChartByPatientId(this.diabetesChart.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add Diet Chart\r\n    newDietChart() {\r\n      this.dietChartDialog = true;\r\n    },\r\n    getDietChartByTemplateId() {\r\n      if (!this.dietChart.diet_chart_template_id) {\r\n        return\r\n      } else {\r\n        this.dietChartSetupService\r\n          .getByDietChartTemplateId(this.dietChart.diet_chart_template_id)\r\n          .then((data) => (this.dietChartTempList = data.data));\r\n      }\r\n    },\r\n    async addDietChart() {\r\n      this.submitted = true;\r\n      if (this.dietChartTempList.length <= 0) {\r\n        return;\r\n      } else {\r\n        var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n        this.dietChartTempList.forEach(element => {\r\n          element.patient_id = patientId.toString()\r\n        });\r\n\r\n        let result = await this.patientProfileService.dietChartSave(this.dietChartTempList);\r\n        if (result.status === 201) {\r\n          //var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getDietChartByPatientId(patientId);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add Current Medications\r\n    newCurrentMedications() {\r\n      this.currentMedicationsDialog = true;\r\n    },\r\n    searchMedicine(event) {\r\n      setTimeout(() => {\r\n          if (!event.query.trim().length) {\r\n              this.filteredItems = [...this.medicineList];\r\n          }\r\n          else {\r\n              // start with\r\n              // this.filteredItems = this.medicineList.filter((item) => {\r\n              //     return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n              // });\r\n\r\n              // contains\r\n              this.filteredItems = FilterService.filter(this.medicineList, ['text'], event.query.toLowerCase(), FilterMatchMode.CONTAINS).slice(0, 10);\r\n          }\r\n      }, 250);\r\n  },\r\n    async addCurrentMedications() {\r\n      this.submitted = true;\r\n      this.currentMedications.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      this.currentMedications.medicine_id = this.currentMedications.ddlmedicine.value;\r\n      if (!this.currentMedications.ddlmedicine) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_rules_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_duration_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_dose_id) {\r\n        return;\r\n      } else if (!this.currentMedications.patient_id) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.currentMedicationsList, 'medicine_id', this.currentMedications.medicine_id, 'patient_current_medications_id', this.currentMedications.patient_current_medications_id, this)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.currentMedicationsSave(this.currentMedications);\r\n        if (result.status === 201) {\r\n          this.getCurrentMedicationsByPatientId(this.currentMedications.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeleteCurrentMedications(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deleteCurrentMedications(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deleteCurrentMedications(data) {\r\n      let result = await this.patientProfileService.currentMedicationsDelete(data);\r\n      if (result.status === 202) {\r\n        this.getCurrentMedicationsByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    // Consumed Medicine\r\n    newConsumedMedicine() {\r\n      this.consumedMedicineDialog = true;\r\n    },\r\n    async addConsumedMedicine() {\r\n      this.submitted = true;\r\n      this.consumedMedicine.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      this.consumedMedicine.medicine_id = this.consumedMedicine.ddlmedicine.value;\r\n      if (!this.consumedMedicine.ddlmedicine) {\r\n        return;\r\n      } else if (!this.consumedMedicine.treatment_dose_id) {\r\n        return;\r\n      } else if (!this.consumedMedicine.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.consumedMedicineSave(this.consumedMedicine);\r\n        if (result.status === 201) {\r\n          this.getConsumedMedicineByPatientId(this.consumedMedicine.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Past Medical History\r\n    newPastMedicalHistory() {\r\n      this.pastMedicalHistoryDialog = true;\r\n    },\r\n    async addPastMedicalHistory() {\r\n      this.submitted = true;\r\n      this.pastMedicalHistory.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.pastMedicalHistory.diagnosis_id) {\r\n        return;\r\n      } else if (!this.pastMedicalHistory.patient_id) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.pastMedicalHistoryList, 'diagnosis_id', this.pastMedicalHistory.diagnosis_id, 'patient_past_history_id', this.pastMedicalHistory.patient_past_history_id, this)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.pastHistorySave(this.pastMedicalHistory);\r\n        if (result.status === 201) {\r\n          this.getPastHistoryByPatientId(this.pastMedicalHistory.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeletePastMedicalHistory(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deletePastMedicalHistory(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deletePastMedicalHistory(data) {\r\n      let result = await this.patientProfileService.pastHistoryDelete(data);\r\n      if (result.status === 202) {\r\n        this.getPastHistoryByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    async patientHistorySave() {\r\n      this.patientHistory.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      //this.submitted = true;\r\n      if (!this.patientHistory.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.patientHistorySave(this.patientHistory, this);\r\n        if (result.status === 201) {\r\n          this.hideHistory();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // collect history\r\n    historyCollection(data) {\r\n      if (data.gender == \"Female\") {\r\n        this.isFemale = true;\r\n      } else {\r\n        this.isFemale = false;\r\n      }\r\n\r\n      //localStorage.setItem('admissionIdForDiabetesService', data.admission_id);\r\n\r\n      localStorage.removeItem('patientIdForTreatment');\r\n      localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n\r\n      // use for Dialog //\r\n      this.getComplain();\r\n\r\n      this.getFood();\r\n\r\n      this.onExaminationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.onExaminationList = data.data));\r\n\r\n      this.medicineSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.medicineList = data.data));\r\n\r\n      this.treatmentRulesSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n      this.treatmentDurationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n      this.treatmentDoseSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDoseList = data.data));\r\n\r\n      this.diagnosisSetupService\r\n        .getAll()\r\n        .then((data) => (this.diagnosisList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllAllergyType()\r\n        .then((data) => (this.allergyTypeList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllDiabetesMeal()\r\n        .then((data) => (this.diabetesMealList = data.data));\r\n\r\n      this.dietChartTemplateSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.dietChartTemplateList = data.data));\r\n      // use for Dialog //\r\n\r\n      // collect history patient wise //\r\n      this.getComplainsByPatientId(data.patient_id);\r\n\r\n      this.getAllergyDetailsByPatientId(data.patient_id);\r\n\r\n      this.getOnExaminationByPatientId(data.patient_id);\r\n\r\n      this.getIOChartByPatientId(data.patient_id);\r\n\r\n      this.getDiabetesChartByPatientId(data.patient_id);\r\n\r\n      this.getDietChartByPatientId(data.patient_id);\r\n\r\n      this.getCurrentMedicationsByPatientId(data.patient_id);\r\n\r\n      this.getPastHistoryByPatientId(data.patient_id);\r\n\r\n      this.patientProfileService.getSystemSubstance(data.patient_id).then((data) => this.formattedSystemSubstance(data.data));\r\n\r\n      this.getConsumedMedicineByPatientId(data.patient_id);\r\n      // collect history patient wise //\r\n    },\r\n\r\n    getOnExaminationsPopup() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n\r\n      this.popupOnExaminationsData = [];\r\n      this.onExaminationList.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          _on_examination_name: element.text,\r\n          on_examination_id: element.value,\r\n          on_examination_result: String(1),\r\n          patient_id: patientId.toString()\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n\r\n    getOnExaminationByPatientId(patient_id) {\r\n      this.onExamination.patient_id = patient_id;\r\n      this.patientProfileService.getOnExaminationByPatientId(patient_id).then((data) => (this.patientOnExaminationList = data.data));\r\n    },\r\n\r\n    getIOChartByPatientId(patient_id) {\r\n      this.iOChart.patient_id = patient_id;\r\n      this.patientProfileService.getIOChartByPatientId(patient_id).then((data) => (this.iOChartList = data.data));\r\n    },\r\n\r\n    getDiabetesChartByPatientId(patient_id) {\r\n      this.diabetesChart.patient_id = patient_id;\r\n      this.patientProfileService.getDiabetesChartByPatientId(patient_id).then((data) => (this.diabetesChartList = data.data));\r\n    },\r\n\r\n    getDietChartByPatientId(patient_id) {\r\n      this.dietChart.patient_id = patient_id;\r\n      this.patientProfileService.getDietChartByPatientId(patient_id).then((data) => (this.dietChartList = data.data));\r\n    },\r\n\r\n    getCurrentMedicationsByPatientId(patient_id) {\r\n      this.currentMedications.patient_id = patient_id;\r\n      this.patientProfileService.getCurrentMedicationsByPatientId(patient_id).then((data) => (this.currentMedicationsList = data.data));\r\n    },\r\n\r\n    getPastHistoryByPatientId(patient_id) {\r\n      this.pastMedicalHistory.patient_id = patient_id;\r\n      this.patientProfileService.getPastHistoryByPatientId(patient_id).then((data) => (this.pastMedicalHistoryList = data.data));\r\n    },\r\n\r\n    formattedSystemSubstance(data) {\r\n      //this.patientHistory.patient_id = patient_id;\r\n      this.patientHistory.lstPersonalHistory = data.lstPersonalHistory;\r\n      this.patientHistory.lstFamilyHistory = data.lstFamilyHistory;\r\n      this.patientHistory.lstSystemsReview = data.lstSystemsReview;\r\n      this.patientHistory.lstSubstanceUse = data.lstSubstanceUse;\r\n      this.patientHistory.lstReproductiveHistory = data.lstReproductiveHistory;\r\n    },\r\n\r\n    getConsumedMedicineByPatientId(patient_id) {\r\n      this.consumedMedicine.patient_id = patient_id;\r\n      this.patientProfileService.getConsumedMedicineByPatientId(patient_id).then((data) => (this.consumedMedicineList = data.data));\r\n    },\r\n\r\n    hideHistory() {\r\n      //this.$emit('hideHistory')\r\n      this.$parent.hideHistory()\r\n      localStorage.removeItem('patientIdForTreatment');\r\n    },\r\n\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY\");\r\n    },\r\n    formatDateTime(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n  },\r\n};"]}]}