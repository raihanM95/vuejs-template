{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\components\\Prescription.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\components\\Prescription.js","mtime":1670215733246},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOi9TVk4gUFJPSkVDVFMvRVJQX0hvc3BpdGFsX0NsaWVudC90cnVuay9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRjovU1ZOIFBST0pFQ1RTL0VSUF9Ib3NwaXRhbF9DbGllbnQvdHJ1bmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3RhcnRzLXdpdGguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IFZhbGlkYXRpb24gZnJvbSAiLi4vLi4vc2NyaXB0cy92YWxpZGF0aW9uIjsKaW1wb3J0IHsgRmlsdGVyU2VydmljZSwgRmlsdGVyTWF0Y2hNb2RlLCBGaWx0ZXJPcGVyYXRvciB9IGZyb20gInByaW1ldnVlL2FwaSI7IC8vIFByZXNjcmlwdGlvbgoKaW1wb3J0IEFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2RvY3Rvci1wYW5lbC9BcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UiOwppbXBvcnQgQWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3ByZXNjcmlwdGlvbi9BZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlIjsgLy8gUHJlc2NyaXB0aW9uIFRyZWF0bWVudAoKaW1wb3J0IE1lZGljaW5lU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvTWVkaWNpbmVTZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSI7CmltcG9ydCBUcmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlIjsgLy8gSGlzdG9yeQoKaW1wb3J0IFBhdGllbnRQcm9maWxlU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3Byb2ZpbGVzL1BhdGllbnRQcm9maWxlU2VydmljZSI7CmltcG9ydCBDb21wbGFpbnRTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Db21wbGFpbnRTZXR1cFNlcnZpY2UiOwppbXBvcnQgRm9vZFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Gb29kU2VydmljZSI7CmltcG9ydCBPbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvT25FeGFtaW5hdGlvblNldHVwU2VydmljZSI7CmltcG9ydCBEaWV0Q2hhcnRUZW1wbGF0ZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IERpZXRDaGFydFNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpZXRDaGFydFNldHVwU2VydmljZSI7CmltcG9ydCBEaWFnbm9zaXNTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9EaWFnbm9zaXNTZXR1cFNlcnZpY2UiOwppbXBvcnQgQ29tbW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL0NvbW1vblNlcnZpY2UiOyAvLyBBZHZpY2UKCmltcG9ydCBBZHZpY2VTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9BZHZpY2VTZXR1cFNlcnZpY2UiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpbHRlcmVkSXRlbXM6IG51bGwsCiAgICAgIHN1Ym1pdHRlZDogZmFsc2UsCiAgICAgIGZpbHRlcnM6IHsKICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICB9LAogICAgICAgIG5hbWU6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuU1RBUlRTX1dJVEgKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGluaXRGaWx0ZXJzOiBmdW5jdGlvbiBpbml0RmlsdGVycygpIHsKICAgICAgICB0aGlzLmZpbHRlcnMgPSB7CiAgICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLkNPTlRBSU5TCiAgICAgICAgICB9LAogICAgICAgICAgbmFtZTogewogICAgICAgICAgICBvcGVyYXRvcjogRmlsdGVyT3BlcmF0b3IuQU5ELAogICAgICAgICAgICBjb25zdHJhaW50czogW3sKICAgICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgICAgICB9XQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0sCiAgICAgIC8vIFByZXNjcmlwdGlvbgogICAgICBhZG1pdHRlZFBhdGllbnRJbmZvOiB7fSwKICAgICAgcHJlc2NyaXB0aW9uRGF0YUxpc3Q6IFtdLAogICAgICB0ZW1wRGF0YTogW10sCiAgICAgIGhlYWRlck5hbWU6ICJTZWN0aW9ucyIsCiAgICAgIGFkbWlzc2lvblByZXNjcmlwdGlvbkluZm86IHsKICAgICAgICBhbGxBZHZpY2U6IGZhbHNlLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb246IFtdLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudDogW10sCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9LAogICAgICAvLyBQcmVzY3JpcHRpb24gVHJlYXRtZW50CiAgICAgIHRyZWF0bWVudEFkZERpYWxvZzogZmFsc2UsCiAgICAgIHRyZWF0bWVudERpYWxvZzogZmFsc2UsCiAgICAgIGRvc2U6IHt9LAogICAgICB0cmVhdG1lbnREb3NlU2V0dXA6IHt9LAogICAgICB0cmVhdG1lbnRTZXR1cDoge30sCiAgICAgIG1lZGljaW5lTGlzdDogW10sCiAgICAgIHRyZWF0bWVudFJ1bGVzTGlzdDogW10sCiAgICAgIHRyZWF0bWVudER1cmF0aW9uTGlzdDogW10sCiAgICAgIHRyZWF0bWVudERvc2VMaXN0OiBbXSwKICAgICAgLy8gU2VjdGlvbgogICAgICBTZWN0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgLy8gSGlzdG9yeQogICAgICBjb21wbGFpbnRTZXR1cDoge30sCiAgICAgIGNoaWVmQ29tcGxhaW5EaWFsb2c6IGZhbHNlLAogICAgICBjb21wbGlhbnRMaXN0OiBbXSwKICAgICAgY2hpZWZDb21wbGFpbjoge30sCiAgICAgIGNoaWVmQ29tcGxhaW5MaXN0OiBbXSwKICAgICAgZm9vZFNldHVwOiB7fSwKICAgICAgYWxsZXJneURldGFpbHNEaWFsb2c6IGZhbHNlLAogICAgICBhbGxlcmd5RGV0YWlsczoge30sCiAgICAgIGZvb2RMaXN0OiBbXSwKICAgICAgYWxsZXJneVR5cGVMaXN0OiBbXSwKICAgICAgb25FeGFtaW5hdGlvbkRpYWxvZzogZmFsc2UsCiAgICAgIG9uRXhhbWluYXRpb246IHt9LAogICAgICBwYXRpZW50T25FeGFtaW5hdGlvbkxpc3Q6IFtdLAogICAgICBvbkV4YW1pbmF0aW9uTGlzdDogW10sCiAgICAgIGlPQ2hhcnREaWFsb2c6IGZhbHNlLAogICAgICBpT0NoYXJ0OiB7fSwKICAgICAgaU9DaGFydExpc3Q6IFtdLAogICAgICBkaWFiZXRlc0NoYXJ0RGlhbG9nOiBmYWxzZSwKICAgICAgZGlhYmV0ZXNDaGFydDogewogICAgICAgIGFBZG1pc3Npb25TZXJ2aWNlRGV0YWlsczoge30KICAgICAgfSwKICAgICAgZGlhYmV0ZXNDaGFydExpc3Q6IFtdLAogICAgICBkaWFiZXRlc01lYWxMaXN0OiBbXSwKICAgICAgZGlldENoYXJ0RGlhbG9nOiBmYWxzZSwKICAgICAgZGlldENoYXJ0OiB7fSwKICAgICAgZGlldENoYXJ0TGlzdDogW10sCiAgICAgIGRpZXRDaGFydFRlbXBsYXRlTGlzdDogW10sCiAgICAgIGRpZXRDaGFydFRlbXBMaXN0OiBbXSwKICAgICAgY3VycmVudE1lZGljYXRpb25zRGlhbG9nOiBmYWxzZSwKICAgICAgY3VycmVudE1lZGljYXRpb25zOiB7fSwKICAgICAgY3VycmVudE1lZGljYXRpb25zTGlzdDogW10sCiAgICAgIHBhc3RNZWRpY2FsSGlzdG9yeURpYWxvZzogZmFsc2UsCiAgICAgIHBhc3RNZWRpY2FsSGlzdG9yeToge30sCiAgICAgIHBhc3RNZWRpY2FsSGlzdG9yeUxpc3Q6IFtdLAogICAgICBkaWFnbm9zaXNMaXN0OiBbXSwKICAgICAgcGF0aWVudExhdGVzdEhpc3Rvcnk6IHsKICAgICAgICBsc3RQYXRpZW50T25FeGFtaW5hdGlvbjogW10sCiAgICAgICAgbHN0UGF0aWVudEFsbGVyZ3lEZXRhaWxzOiBbXSwKICAgICAgICBsc3RQYXRpZW50RGlhYmV0ZXNDaGFydDogW10sCiAgICAgICAgbHN0UGF0aWVudERpZXRDaGFydDogW10KICAgICAgfSwKICAgICAgZGVwYXJ0bWVudF9pZDogIiIsCiAgICAgIG5ld0FkdmljZURpYWxvZzogZmFsc2UsCiAgICAgIGFkdmljZVNldHVwOiB7fQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICAvLyBwYXN0IGRhdGUteWVhciBkaXNhYmxlZAogICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTsKICAgIHZhciBtb250aCA9IHRvZGF5LmdldE1vbnRoKCk7CiAgICB2YXIgeWVhciA9IHRvZGF5LmdldEZ1bGxZZWFyKCk7CiAgICB2YXIgcHJldk1vbnRoID0gbW9udGggPT09IDAgPyAxMSA6IG1vbnRoIC0gMDsKICAgIHZhciBwcmV2WWVhciA9IHByZXZNb250aCA9PT0gMTEgPyB5ZWFyIC0gMCA6IHllYXI7CiAgICB0aGlzLm1pbkRhdGUgPSBuZXcgRGF0ZSgpOwogICAgdGhpcy5taW5EYXRlLnNldE1vbnRoKHByZXZNb250aCk7CiAgICB0aGlzLm1pbkRhdGUuc2V0RnVsbFllYXIocHJldlllYXIpOyAvLyBQcmVzY3JpcHRpb24KCiAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvblNlcnZpY2UgPSBuZXcgQWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZSgpOwogICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UgPSBuZXcgQXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlKCk7IC8vIFByZXNjcmlwdGlvbiBUcmVhdG1lbnQKCiAgICB0aGlzLm1lZGljaW5lU2V0dXBTZXJ2aWNlID0gbmV3IE1lZGljaW5lU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgPSBuZXcgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSgpOyAvLyBIaXN0b3J5CgogICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UgPSBuZXcgUGF0aWVudFByb2ZpbGVTZXJ2aWNlKCk7CiAgICB0aGlzLmNvbXBsYWludFNldHVwU2VydmljZSA9IG5ldyBDb21wbGFpbnRTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZm9vZFNlcnZpY2UgPSBuZXcgRm9vZFNlcnZpY2UoKTsKICAgIHRoaXMub25FeGFtaW5hdGlvblNldHVwU2VydmljZSA9IG5ldyBPbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmRpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlID0gbmV3IERpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmRpZXRDaGFydFNldHVwU2VydmljZSA9IG5ldyBEaWV0Q2hhcnRTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlID0gbmV3IERpYWdub3Npc1NldHVwU2VydmljZSgpOwogICAgdGhpcy5jb21tb25TZXJ2aWNlID0gbmV3IENvbW1vblNlcnZpY2UoKTsKICAgIHRoaXMudmFsaWRhdGlvbiA9IG5ldyBWYWxpZGF0aW9uKCk7IC8vIEFkdmljZQoKICAgIHRoaXMuYWR2aWNlU2V0dXBTZXJ2aWNlID0gbmV3IEFkdmljZVNldHVwU2VydmljZSgpOyAvLyBzaG9ydGN1dCBrZXkgc3RhcnQKCiAgICB2YXIgdGhhdCA9IHRoaXM7CgogICAgZG9jdW1lbnQub25rZXl1cCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA3MykgewogICAgICAgIHRoYXQuZ2V0SW52ZXN0aWdhdGlvbigpOwogICAgICB9IGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLndoaWNoID09IDg0KSB7CiAgICAgICAgdGhhdC5nZXRUcmVhdG1lbnQoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2NSkgewogICAgICAgIHRoYXQuZ2V0QWR2aWNlKCk7CiAgICAgIH0gLy8gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUuc2hpZnRLZXkpIHsKICAgICAgLy8gfQoKICAgIH07IC8vIHNob3J0Y3V0IGtleSBlbmQKCgogICAgdGhpcy51c2VySW5mbyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJbmZvIikpOwoKICAgIGlmICh0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZCkgewogICAgICB0aGlzLmdldFByZXNjcmlwdGlvbkRhdGEoKTsKICAgICAgdGhpcy5kb2N0b3JfaWQgPSB0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZDsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmRvY3Rvcl9pZCA9IHRoaXMuZG9jdG9yX2lkOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZ2V0UHJlc2NyaXB0aW9uRGF0YTogZnVuY3Rpb24gZ2V0UHJlc2NyaXB0aW9uRGF0YSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8vdGhpcy51c2VySW5mbyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJbmZvIikpOwogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmVzY3JpcHRpb25EYXRhQnlEb2N0b3JJZCh0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgaGlkZURpYWxvZzogZnVuY3Rpb24gaGlkZURpYWxvZygpIHsKICAgICAgdmFyIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKS50b1N0cmluZygpOyAvLyBDaGllZiBDb21wbGFpbgoKICAgICAgdGhpcy5jaGllZkNvbXBsYWluRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbiA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsgLy8gT24gRXhhbWluYXRpb24KCiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IGZhbHNlOyAvLyB0aGlzLm9uRXhhbWluYXRpb24gPSB7CiAgICAgIC8vICAgcGF0aWVudF9pZDogcGF0aWVudElkCiAgICAgIC8vIH07CgogICAgICB0aGlzLlNlY3Rpb25EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy50cmVhdG1lbnRBZGREaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cCA9IHt9OwogICAgICB0aGlzLnRyZWF0bWVudERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmZvb2RTZXR1cCA9IHt9OwogICAgICB0aGlzLmFsbGVyZ3lEZXRhaWxzRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHMgPSB7CiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkCiAgICAgIH07CiAgICAgIHRoaXMuaU9DaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmlPQ2hhcnQgPSB7CiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkCiAgICAgIH07CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmRpYWJldGVzQ2hhcnQgPSB7CiAgICAgICAgYUFkbWlzc2lvblNlcnZpY2VEZXRhaWxzOiB7fSwKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5kaWV0Q2hhcnREaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5kaWV0Q2hhcnQgPSB7CiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkCiAgICAgIH07CiAgICAgIHRoaXMubmV3QWR2aWNlRGlhbG9nID0gZmFsc2UsIHRoaXMuYWR2aWNlU2V0dXAgPSB7fTsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgIH0sCiAgICAvLyBHZXQgUHJldmlvdXMgQ2hpZWYgQ29tcGxhaW4KICAgIGdldENvbXBsYWluc0J5UGF0aWVudElkOiBmdW5jdGlvbiBnZXRDb21wbGFpbnNCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5jaGllZkNvbXBsYWluTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gR2V0LCBBZGQgQ29tcGxhaW4KICAgIGdldENvbXBsYWluOiBmdW5jdGlvbiBnZXRDb21wbGFpbigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLmNvbXBsYWludFNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLmNvbXBsaWFudExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGFkZENvbXBsYWluOiBmdW5jdGlvbiBhZGRDb21wbGFpbigpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXM0LnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXM0LmNvbXBsYWludFNldHVwLmNvbXBpbGFudHNfbmFtZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNC5jb21wbGFpbnRTZXR1cFNlcnZpY2UuYWRkKF90aGlzNC5jb21wbGFpbnRTZXR1cCk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCEocmVzdWx0LnN0YXR1cyA9PT0gMjAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzNC5nZXRDb21wbGFpbigpOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHJlc3VsdC5kYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIF90aGlzNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE3OwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKCiAgICAgICAgICAgICAgICBfdGhpczQuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfY29udGV4dC50MCwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxLCAxN11dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gQWRkIENoaWVmIENvbXBsYWluCiAgICBzZWFyY2hDb21wbGFpbjogZnVuY3Rpb24gc2VhcmNoQ29tcGxhaW4oZXZlbnQpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWV2ZW50LnF1ZXJ5LnRyaW0oKS5sZW5ndGgpIHsKICAgICAgICAgIF90aGlzNS5maWx0ZXJlZEl0ZW1zID0gX3RvQ29uc3VtYWJsZUFycmF5KF90aGlzNS5jb21wbGlhbnRMaXN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy9zdGFydCB3aXRoCiAgICAgICAgICBfdGhpczUuZmlsdGVyZWRJdGVtcyA9IF90aGlzNS5jb21wbGlhbnRMaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS50ZXh0LnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChldmVudC5xdWVyeS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgMjUwKTsKICAgIH0sCiAgICBuZXdDaGllZkNvbXBsYWluOiBmdW5jdGlvbiBuZXdDaGllZkNvbXBsYWluKCkgewogICAgICB0aGlzLmNoaWVmQ29tcGxhaW5EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZENoaWVmQ29tcGxhaW46IGZ1bmN0aW9uIGFkZENoaWVmQ29tcGxhaW4oKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIGlzQ29tcGxhaW5FeGlzdCwgY29tcGxhaW5JZCwgaXNEdXBsaWNhdGUsIHJlc3VsdCwgX3Jlc3VsdDsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzNi5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXM2LmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKS50b1N0cmluZygpOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczYuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbikgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKF90aGlzNi5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgaWYgKF90aGlzNi5jaGllZkNvbXBsYWluLmNkZnJvbV9kYXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIF90aGlzNi5jaGllZkNvbXBsYWluLmZyb21fZGF0ZSA9IG1vbWVudChTdHJpbmcoX3RoaXM2LmNoaWVmQ29tcGxhaW4uY2Rmcm9tX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsgLy8gY29tcGxhaW4gaXMgZXhpc3QgY2hlY2sgc3RhcnQKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW4udmFsdWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaXNDb21wbGFpbkV4aXN0ID0gX3RoaXM2LmNvbXBsaWFudExpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZWwudGV4dCA9PSB0aGlzLmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW47CiAgICAgICAgICAgICAgICB9LCBfdGhpczYpOwoKICAgICAgICAgICAgICAgIGlmICghKGlzQ29tcGxhaW5FeGlzdC5sZW5ndGggPT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXM2LmNvbXBsYWludFNldHVwLmNvbXBpbGFudHNfbmFtZSA9IF90aGlzNi5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyMTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczYuYWRkQ29tcGxhaW4oKTsKCiAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICAgIGNvbXBsYWluSWQgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzNi5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluID0gewogICAgICAgICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXM2LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW4udmFsdWUgPSBjb21wbGFpbklkLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI4OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgICAgICBfdGhpczYuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbiA9IHsKICAgICAgICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF90aGlzNi5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluLnZhbHVlID0gaXNDb21wbGFpbkV4aXN0WzBdLnZhbHVlOwoKICAgICAgICAgICAgICBjYXNlIDI4OgogICAgICAgICAgICAgICAgLy8gY29tcGxhaW4gaXMgZXhpc3QgY2hlY2sgZW5kCiAgICAgICAgICAgICAgICBpc0R1cGxpY2F0ZSA9IF90aGlzNi5jaGllZkNvbXBsYWluTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC5jb21waWxhbnRzX2lkID09IHRoaXMuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbi52YWx1ZTsKICAgICAgICAgICAgICAgIH0sIF90aGlzNik7CiAgICAgICAgICAgICAgICBfdGhpczYuY2hpZWZDb21wbGFpbi5jb21waWxhbnRzX2lkID0gX3RoaXM2LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW4udmFsdWU7CgogICAgICAgICAgICAgICAgaWYgKCEoaXNEdXBsaWNhdGUubGVuZ3RoID09IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzM7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2LnBhdGllbnRQcm9maWxlU2VydmljZS5jb21wbGFpblNhdmUoX3RoaXM2LmNoaWVmQ29tcGxhaW4pOwoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNi5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChfdGhpczYuY2hpZWZDb21wbGFpbi5wYXRpZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNi5oaWRlRGlhbG9nKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzc6CiAgICAgICAgICAgICAgICBfdGhpczYuY2hpZWZDb21wbGFpbi5wYXRpZW50X2NvbXBsYWluX2lkID0gaXNEdXBsaWNhdGVbMF0ucGF0aWVudF9jb21wbGFpbl9pZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDA7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2LnBhdGllbnRQcm9maWxlU2VydmljZS5jb21wbGFpblVwZGF0ZShfdGhpczYuY2hpZWZDb21wbGFpbik7CgogICAgICAgICAgICAgIGNhc2UgNDA6CiAgICAgICAgICAgICAgICBfcmVzdWx0ID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKF9yZXN1bHQuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM2LmdldENvbXBsYWluc0J5UGF0aWVudElkKF90aGlzNi5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM2LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJVcGRhdGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9yZXN1bHQuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfcmVzdWx0LmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0MjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEdldCBQcmV2aW91cyBsc3RQYXRpZW50T25FeGFtaW5hdGlvbiwgbHN0UGF0aWVudEFsbGVyZ3lEZXRhaWxzLCBsc3RQYXRpZW50RGlhYmV0ZXNDaGFydCwgbHN0UGF0aWVudERpZXRDaGFydCwKICAgIGdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbjogZnVuY3Rpb24gZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHZhciBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKHBhdGllbnRJZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczcucGF0aWVudExhdGVzdEhpc3RvcnkgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIEFkZCBPbiBFeGFtaW5hdGlvbgogICAgbmV3T25FeGFtaW5hdGlvbjogZnVuY3Rpb24gbmV3T25FeGFtaW5hdGlvbigpIHsKICAgICAgdGhpcy5nZXRPbkV4YW1pbmF0aW9uc1BvcHVwKCk7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZ2V0T25FeGFtaW5hdGlvbnNQb3B1cDogZnVuY3Rpb24gZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICB2YXIgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwogICAgICB0aGlzLnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhID0gW107CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzOC5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5wdXNoKHsKICAgICAgICAgIF9vbl9leGFtaW5hdGlvbl9uYW1lOiBlbGVtZW50LnRleHQsCiAgICAgICAgICBvbl9leGFtaW5hdGlvbl9pZDogZWxlbWVudC52YWx1ZSwKICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX3Jlc3VsdDogU3RyaW5nKDEpLAogICAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkLnRvU3RyaW5nKCkKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvblBvcHVwRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBhZGRPbkV4YW1pbmF0aW9uOiBmdW5jdGlvbiBhZGRPbkV4YW1pbmF0aW9uKCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzOS5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXM5LnJlcXVyZWQgPSAiIjsKCiAgICAgICAgICAgICAgICBfdGhpczkucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICBpZiAoIWVsZW1lbnQub25fZXhhbWluYXRpb25fcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM5LnJlcXVyZWQgPSAicmVxdWlyZWQiOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoIV90aGlzOS5yZXF1cmVkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXM5LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlJlcXVpcmVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiUGxlYXNlIGZpbGwgaW4gdGhlIHJlcXVpcmVkIGZpZWxkcyIsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGlmICghX3RoaXM5LnJlcXVyZWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczkucGF0aWVudFByb2ZpbGVTZXJ2aWNlLm9uRXhhbWluYXRpb25TYXZlKF90aGlzOS5wb3B1cE9uRXhhbWluYXRpb25zRGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzOS5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzOS5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzOS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBHZXQsIEFkZCBGb29kCiAgICBnZXRGb29kOiBmdW5jdGlvbiBnZXRGb29kKCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICB0aGlzLmZvb2RTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczEwLmZvb2RMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBhZGRGb29kOiBmdW5jdGlvbiBhZGRGb29kKCkgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDA7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTEuZm9vZFNldHVwLmZvb2RfbmFtZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX3RoaXMxMS5mb29kU2V0dXAuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczExLmZvb2RTZXJ2aWNlLmFkZChfdGhpczExLmZvb2RTZXR1cCk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMxMS5nZXRGb29kKCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHJlc3VsdC5kYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIF90aGlzMTEuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDE3OwogICAgICAgICAgICAgICAgX2NvbnRleHQ0LnQwID0gX2NvbnRleHQ0WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICAgIF90aGlzMTEuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfY29udGV4dDQudDAsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCwgbnVsbCwgW1swLCAxN11dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gQWRkIEFsbGVyZ3kgRGV0YWlscwogICAgc2VhcmNoRm9vZDogZnVuY3Rpb24gc2VhcmNoRm9vZChldmVudCkgewogICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWV2ZW50LnF1ZXJ5LnRyaW0oKS5sZW5ndGgpIHsKICAgICAgICAgIF90aGlzMTIuZmlsdGVyZWRJdGVtcyA9IF90b0NvbnN1bWFibGVBcnJheShfdGhpczEyLmZvb2RMaXN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy9zdGFydCB3aXRoCiAgICAgICAgICBfdGhpczEyLmZpbHRlcmVkSXRlbXMgPSBfdGhpczEyLmZvb2RMaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS50ZXh0LnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChldmVudC5xdWVyeS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgMjUwKTsKICAgIH0sCiAgICBuZXdBbGxlcmd5RGV0YWlsczogZnVuY3Rpb24gbmV3QWxsZXJneURldGFpbHMoKSB7CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHNEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZEFsbGVyZ3lEZXRhaWxzOiBmdW5jdGlvbiBhZGRBbGxlcmd5RGV0YWlscygpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIGlzRm9vZEV4aXN0LCBmb29kSWQsIGlzRHVwbGljYXRlLCByZXN1bHQsIF9yZXN1bHQyOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMxMy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTMuYWxsZXJneURldGFpbHMuZGRsZm9vZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTMuYWxsZXJneURldGFpbHMucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMy5hbGxlcmd5RGV0YWlscy50eXBlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLmNkZnJvbV9kYXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIF90aGlzMTMuYWxsZXJneURldGFpbHMuZnJvbV9kYXRlID0gbW9tZW50KFN0cmluZyhfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLmNkZnJvbV9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7IC8vIGZvb2QgaXMgZXhpc3QgY2hlY2sgc3RhcnQKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5kZGxmb29kLnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMzI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlzRm9vZEV4aXN0ID0gX3RoaXMxMy5mb29kTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC50ZXh0ID09IHRoaXMuYWxsZXJneURldGFpbHMuZGRsZm9vZDsKICAgICAgICAgICAgICAgIH0sIF90aGlzMTMpOwoKICAgICAgICAgICAgICAgIGlmICghKGlzRm9vZEV4aXN0Lmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczEzLmZvb2RTZXR1cC5mb29kX25hbWUgPSBfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLmRkbGZvb2Q7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTMuYWRkRm9vZCgpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgZm9vZElkID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICBfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLmRkbGZvb2QgPSB7CiAgICAgICAgICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLmRkbGZvb2QudmFsdWUgPSBmb29kSWQudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMzI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICAgIF90aGlzMTMuYWxsZXJneURldGFpbHMuZGRsZm9vZCA9IHsKICAgICAgICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF90aGlzMTMuYWxsZXJneURldGFpbHMuZGRsZm9vZC52YWx1ZSA9IGlzRm9vZEV4aXN0WzBdLnZhbHVlOwoKICAgICAgICAgICAgICBjYXNlIDMyOgogICAgICAgICAgICAgICAgLy8gZm9vZCBpcyBleGlzdCBjaGVjayBlbmQKICAgICAgICAgICAgICAgIGlzRHVwbGljYXRlID0gX3RoaXMxMy5wYXRpZW50TGF0ZXN0SGlzdG9yeS5sc3RQYXRpZW50QWxsZXJneURldGFpbHMuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZWwuZm9vZF9pZCA9PSB0aGlzLmFsbGVyZ3lEZXRhaWxzLmRkbGZvb2QudmFsdWU7CiAgICAgICAgICAgICAgICB9LCBfdGhpczEzKTsKICAgICAgICAgICAgICAgIF90aGlzMTMuYWxsZXJneURldGFpbHMuZm9vZF9pZCA9IF90aGlzMTMuYWxsZXJneURldGFpbHMuZGRsZm9vZC52YWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShpc0R1cGxpY2F0ZS5sZW5ndGggPT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA0MTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzNzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczEzLnBhdGllbnRQcm9maWxlU2VydmljZS5hbGxlcmd5RGV0YWlsc1NhdmUoX3RoaXMxMy5hbGxlcmd5RGV0YWlscyk7CgogICAgICAgICAgICAgIGNhc2UgMzc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDUuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTMuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczEzLmhpZGVEaWFsb2coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA0NjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDQxOgogICAgICAgICAgICAgICAgX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2FsbGVyZ3lfZGV0YWlsc19pZCA9IGlzRHVwbGljYXRlWzBdLnBhdGllbnRfYWxsZXJneV9kZXRhaWxzX2lkOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA0NDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczEzLnBhdGllbnRQcm9maWxlU2VydmljZS5hbGxlcmd5RGV0YWlsc1VwZGF0ZShfdGhpczEzLmFsbGVyZ3lEZXRhaWxzKTsKCiAgICAgICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgICAgIF9yZXN1bHQyID0gX2NvbnRleHQ1LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKF9yZXN1bHQyLnN0YXR1cyA9PT0gMjAyKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTMuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczEzLmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiVXBkYXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfcmVzdWx0Mi5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczEzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfcmVzdWx0Mi5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQyLnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0NjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEFkZCBJTyBDaGFydAogICAgbmV3SU9DaGFydDogZnVuY3Rpb24gbmV3SU9DaGFydCgpIHsKICAgICAgdGhpcy5pT0NoYXJ0RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBhZGRJT0NoYXJ0OiBmdW5jdGlvbiBhZGRJT0NoYXJ0KCkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICB2YXIgcmVzdWx0LCBwYXRpZW50SWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMTQuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNC5pT0NoYXJ0LnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczE0LnBhdGllbnRQcm9maWxlU2VydmljZS5pT0NoYXJ0U2F2ZShfdGhpczE0LmlPQ2hhcnQpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDYuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTQuZ2V0SU9DaGFydEJ5UGF0aWVudElkKHBhdGllbnRJZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE0LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTQuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTQuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBBZGQgRGlhYmV0ZXMgQ2hhcnQKICAgIG5ld0RpYWJldGVzQ2hhcnQ6IGZ1bmN0aW9uIG5ld0RpYWJldGVzQ2hhcnQoKSB7CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkRGlhYmV0ZXNDaGFydDogZnVuY3Rpb24gYWRkRGlhYmV0ZXNDaGFydCgpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIHBhdGllbnRJZCwgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczE1LnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTUuZGlhYmV0ZXNDaGFydC5tZWFsKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNS5kaWFiZXRlc0NoYXJ0LmJlZm9yZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTUuZGlhYmV0ZXNDaGFydC5hZnRlcikgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICAvL3ZhciBhZG1pc3Npb25faWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhZG1pc3Npb25JZEZvckRpYWJldGVzU2VydmljZSIpKTsKICAgICAgICAgICAgICAgIC8vdGhpcy5kaWFiZXRlc0NoYXJ0LmFBZG1pc3Npb25TZXJ2aWNlRGV0YWlscy5hZG1pc3Npb25faWQgPSBTdHJpbmcoYWRtaXNzaW9uX2lkKTsKICAgICAgICAgICAgICAgIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKTsKICAgICAgICAgICAgICAgIF90aGlzMTUuZGlhYmV0ZXNDaGFydC5wYXRpZW50X2lkID0gU3RyaW5nKHBhdGllbnRJZCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTUucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmRpYWJldGVzQ2hhcnRTYXZlKF90aGlzMTUuZGlhYmV0ZXNDaGFydCk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDcuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTUuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE1LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTUuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTUuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gQWRkIERpZXQgQ2hhcnQKICAgIG5ld0RpZXRDaGFydDogZnVuY3Rpb24gbmV3RGlldENoYXJ0KCkgewogICAgICB0aGlzLmRpZXRDaGFydERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZ2V0RGlldENoYXJ0QnlUZW1wbGF0ZUlkOiBmdW5jdGlvbiBnZXREaWV0Q2hhcnRCeVRlbXBsYXRlSWQoKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5kaWV0Q2hhcnQuZGlldF9jaGFydF90ZW1wbGF0ZV9pZCkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRpZXRDaGFydFNldHVwU2VydmljZS5nZXRCeURpZXRDaGFydFRlbXBsYXRlSWQodGhpcy5kaWV0Q2hhcnQuZGlldF9jaGFydF90ZW1wbGF0ZV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgcmV0dXJuIF90aGlzMTYuZGlldENoYXJ0VGVtcExpc3QgPSBkYXRhLmRhdGE7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBhZGREaWV0Q2hhcnQ6IGZ1bmN0aW9uIGFkZERpZXRDaGFydCgpIHsKICAgICAgdmFyIF90aGlzMTcgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7CiAgICAgICAgdmFyIHBhdGllbnRJZCwgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczE3LnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKCEoX3RoaXMxNy5kaWV0Q2hhcnRUZW1wTGlzdC5sZW5ndGggPD0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKTsKCiAgICAgICAgICAgICAgICBfdGhpczE3LmRpZXRDaGFydFRlbXBMaXN0LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYXRpZW50X2lkID0gcGF0aWVudElkLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDk7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZGlldENoYXJ0U2F2ZShfdGhpczE3LmRpZXRDaGFydFRlbXBMaXN0KTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ4LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbigpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxNy5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczE3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIFRyZWF0bWVudAogICAgc2VhcmNoTWVkaWNpbmU6IGZ1bmN0aW9uIHNlYXJjaE1lZGljaW5lKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczE4ID0gdGhpczsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghZXZlbnQucXVlcnkudHJpbSgpLmxlbmd0aCkgewogICAgICAgICAgX3RoaXMxOC5maWx0ZXJlZEl0ZW1zID0gX3RvQ29uc3VtYWJsZUFycmF5KF90aGlzMTgubWVkaWNpbmVMaXN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gc3RhcnQgd2l0aAogICAgICAgICAgLy8gdGhpcy5maWx0ZXJlZEl0ZW1zID0gdGhpcy5tZWRpY2luZUxpc3QuZmlsdGVyKChpdGVtKSA9PiB7CiAgICAgICAgICAvLyAgICAgcmV0dXJuIGl0ZW0udGV4dC50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoZXZlbnQucXVlcnkudG9Mb3dlckNhc2UoKSk7CiAgICAgICAgICAvLyB9KTsKICAgICAgICAgIC8vIGNvbnRhaW5zCiAgICAgICAgICBfdGhpczE4LmZpbHRlcmVkSXRlbXMgPSBGaWx0ZXJTZXJ2aWNlLmZpbHRlcihfdGhpczE4Lm1lZGljaW5lTGlzdCwgWyd0ZXh0J10sIGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKCksIEZpbHRlck1hdGNoTW9kZS5DT05UQUlOUykuc2xpY2UoMCwgMTApOwogICAgICAgIH0KICAgICAgfSwgMjUwKTsKICAgIH0sCiAgICBnZXRUcmVhdG1lbnQ6IGZ1bmN0aW9uIGdldFRyZWF0bWVudCgpIHsKICAgICAgdGhpcy50cmVhdG1lbnRBZGREaWFsb2cgPSB0cnVlOyAvLyB0aGlzLmhlYWRlck5hbWUgPSAiTWVkaWNpbmUiOwogICAgICAvLyB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIC8vIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgLy8gdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICAvLyB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdFRyZWF0bWVudC5mb3JFYWNoKChlbGVtZW50KSA9PiB7CiAgICAgIC8vICAgdGhpcy50ZW1wRGF0YS5wdXNoKHsKICAgICAgLy8gICAgIF9tZWRpY2luZV90eXBlX25hbWU6IGVsZW1lbnQuX21lZGljaW5lX3R5cGVfbmFtZSwKICAgICAgLy8gICAgIF9tZWRpY2luZV9uYW1lOiBlbGVtZW50Ll9tZWRpY2luZV9uYW1lLAogICAgICAvLyAgICAgbmFtZTogZWxlbWVudC5fbWVkaWNpbmVfdHlwZV9uYW1lICsgIiAiICsgZWxlbWVudC5fbWVkaWNpbmVfbmFtZSArICIgIiArIGVsZW1lbnQuX3RyZWF0bWVudF9kb3NlX25hbWUgKyAiICIgKyBlbGVtZW50Ll90cmVhdG1lbnRfcnVsZV9uYW1lICsgIiAiICsgZWxlbWVudC5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgIC8vICAgICBpZDogZWxlbWVudC5tZWRpY2luZV9pZCwKICAgICAgLy8gICAgIF90cmVhdG1lbnRfZG9zZV9uYW1lOiBlbGVtZW50Ll90cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAvLyAgICAgdHJlYXRtZW50X2Rvc2VfaWQ6IGVsZW1lbnQudHJlYXRtZW50X2Rvc2VfaWQsCiAgICAgIC8vICAgICBfdHJlYXRtZW50X3J1bGVfbmFtZTogZWxlbWVudC5fdHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgLy8gICAgIHRyZWF0bWVudF9ydWxlc19pZDogZWxlbWVudC50cmVhdG1lbnRfcnVsZXNfaWQsCiAgICAgIC8vICAgICBfdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IGVsZW1lbnQuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAvLyAgICAgdHJlYXRtZW50X2R1cmF0aW9uX2lkOiBlbGVtZW50LnRyZWF0bWVudF9kdXJhdGlvbl9pZCwKICAgICAgLy8gICAgIGRlc2NyaXB0aW9uOiBlbGVtZW50LmRlc2NyaXB0aW9uLAogICAgICAvLyAgIH0pOwogICAgICAvLyB9KTsKICAgIH0sCiAgICAvLyBTdGFydCBUcmVhdG1lbnQgRG9zZQogICAgc2VhcmNoRG9zZTogZnVuY3Rpb24gc2VhcmNoRG9zZShldmVudCkgewogICAgICB2YXIgX3RoaXMxOSA9IHRoaXM7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWV2ZW50LnF1ZXJ5LnRyaW0oKS5sZW5ndGgpIHsKICAgICAgICAgIF90aGlzMTkuZmlsdGVyZWRJdGVtcyA9IF90b0NvbnN1bWFibGVBcnJheShfdGhpczE5LnRyZWF0bWVudERvc2VMaXN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy9zdGFydCB3aXRoCiAgICAgICAgICBfdGhpczE5LmZpbHRlcmVkSXRlbXMgPSBfdGhpczE5LnRyZWF0bWVudERvc2VMaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaXRlbS50ZXh0LnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChldmVudC5xdWVyeS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgMjUwKTsKICAgIH0sCiAgICBhZGREb3NlOiBmdW5jdGlvbiBhZGREb3NlKCkgewogICAgICB2YXIgX3RoaXMyMCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgICB2YXIgYURvc2UsIGRvc2VfaWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIwLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGFEb3NlID0gX3RoaXMyMC50cmVhdG1lbnREb3NlTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC50ZXh0ID09IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2U7CiAgICAgICAgICAgICAgICB9LCBfdGhpczIwKTsKCiAgICAgICAgICAgICAgICBpZiAoIWFEb3NlLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMjAuZG9zZSA9IHsKICAgICAgICAgICAgICAgICAgdGV4dDogYURvc2UudGV4dCwKICAgICAgICAgICAgICAgICAgdmFsdWU6IGFEb3NlLnZhbHVlCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBfdGhpczIwLnRyZWF0bWVudERvc2VTZXR1cC50cmVhdG1lbnRfZG9zZV9uYW1lID0gX3RoaXMyMC50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIwLmFkZE5ld0Rvc2UoKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgZG9zZV9pZCA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICAgICAgX3RoaXMyMC5kb3NlID0gewogICAgICAgICAgICAgICAgICB0ZXh0OiBfdGhpczIwLnRyZWF0bWVudERvc2VTZXR1cC50cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAgICAgICAgICAgICB2YWx1ZTogZG9zZV9pZC50b1N0cmluZygpCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX3RoaXMyMC5kb3NlID0gewogICAgICAgICAgICAgICAgICB0ZXh0OiBfdGhpczIwLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnRleHQsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiBfdGhpczIwLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnZhbHVlCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgYWRkTmV3RG9zZTogZnVuY3Rpb24gYWRkTmV3RG9zZSgpIHsKICAgICAgdmFyIF90aGlzMjEgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczIxLnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDEwLnByZXYgPSAxOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIxLnRyZWF0bWVudERvc2VTZXR1cC50cmVhdG1lbnRfZG9zZV9uYW1lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMS50cmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlLmFkZChfdGhpczIxLnRyZWF0bWVudERvc2VTZXR1cCk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0MTAuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIShyZXN1bHQuc3RhdHVzID09PSAyMDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIxLmdldFRyZWF0bWVudERvc2VMaXN0KCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQuZGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfdGhpczIxLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAucHJldiA9IDE3OwogICAgICAgICAgICAgICAgX2NvbnRleHQxMC50MCA9IF9jb250ZXh0MTBbImNhdGNoIl0oMSk7CgogICAgICAgICAgICAgICAgX3RoaXMyMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0MTAudDAsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEwLCBudWxsLCBbWzEsIDE3XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBFbmQgVHJlYXRtZW50IERvc2UKICAgIHNhdmVUcmVhdG1lbnQ6IGZ1bmN0aW9uIHNhdmVUcmVhdG1lbnQoKSB7CiAgICAgIHZhciBfdGhpczIyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMSgpIHsKICAgICAgICB2YXIgYU1lZGljaW5lOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMyMi5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIyLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmIChfdGhpczIyLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcykgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMi50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24pIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMi50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIGFNZWRpY2luZSA9IF90aGlzMjIuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZWwubWVkaWNpbmVfaWQgPT09IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudmFsdWU7CiAgICAgICAgICAgICAgICB9LCBfdGhpczIyKTsKCiAgICAgICAgICAgICAgICBpZiAoYU1lZGljaW5lLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAyMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMi5hZGREb3NlKCk7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBfdGhpczIyLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50LnB1c2goewogICAgICAgICAgICAgICAgICBuYW1lOiBfdGhpczIyLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnRleHQsCiAgICAgICAgICAgICAgICAgIG1lZGljaW5lX2lkOiBfdGhpczIyLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnZhbHVlLAogICAgICAgICAgICAgICAgICBfdHJlYXRtZW50X2Rvc2VfbmFtZTogX3RoaXMyMi5kb3NlLnRleHQsCiAgICAgICAgICAgICAgICAgIHRyZWF0bWVudF9kb3NlX2lkOiBfdGhpczIyLmRvc2UudmFsdWUsCiAgICAgICAgICAgICAgICAgIF90cmVhdG1lbnRfcnVsZV9uYW1lOiBfdGhpczIyLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy50ZXh0LAogICAgICAgICAgICAgICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IF90aGlzMjIudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnZhbHVlLAogICAgICAgICAgICAgICAgICBfdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IF90aGlzMjIudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnRleHQsCiAgICAgICAgICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogX3RoaXMyMi50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udmFsdWUsCiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfdGhpczIyLnRyZWF0bWVudFNldHVwLmRlc2NyaXB0aW9uCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgIF90aGlzMjIuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTEpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBFZGl0IFRyZWF0bWVudAogICAgZWRpdFRyZWF0bWVudDogZnVuY3Rpb24gZWRpdFRyZWF0bWVudChkYXRhLCBpbmRleCkgewogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRlc2NyaXB0aW9uID0gZGF0YS5kZXNjcmlwdGlvbjsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5tZWRpY2luZU5hbWUgPSBkYXRhLm5hbWU7CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAgIHJlZmlkOiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAgIHZhbHVlOiBkYXRhLnRyZWF0bWVudF9kdXJhdGlvbl9pZCwKICAgICAgICByZWZpZDogbnVsbAogICAgICB9OwogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9kb3NlX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X2Rvc2VfaWQsCiAgICAgICAgcmVmaWQ6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy50cmVhdG1lbnREaWFsb2cgPSB0cnVlOwogICAgICB0aGlzLnRyZWF0bWVudEluZGV4ID0gaW5kZXg7CiAgICB9LAogICAgdHJlYXRtZW50RWRpdFNhdmU6IGZ1bmN0aW9uIHRyZWF0bWVudEVkaXRTYXZlKCkgewogICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvL3RoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0ubmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudGV4dDsKICAgICAgICAvL3RoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0ubWVkaWNpbmVfaWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnZhbHVlOwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0uX3RyZWF0bWVudF9ydWxlX25hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy50ZXh0OwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X3J1bGVzX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudmFsdWU7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbi50ZXh0OwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X2R1cmF0aW9uX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udmFsdWU7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5fdHJlYXRtZW50X2Rvc2VfbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudGV4dDsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLnRyZWF0bWVudF9kb3NlX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZS52YWx1ZTsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLmRlc2NyaXB0aW9uID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZXNjcmlwdGlvbjsKICAgICAgICB0aGlzLnRyZWF0bWVudERpYWxvZyA9IGZhbHNlOwogICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICAvLyBJbnZlc3RpZ2F0aW9uCiAgICBnZXRJbnZlc3RpZ2F0aW9uOiBmdW5jdGlvbiBnZXRJbnZlc3RpZ2F0aW9uKCkgewogICAgICB2YXIgX3RoaXMyMyA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiSW52ZXN0aWdhdGlvbiI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0SW52ZXN0aWdhdGlvbi5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMyMy50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuaW52ZXN0aW5nYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmludmVzdGlnYXRpb25faWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuU2VjdGlvbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgLy8gQWR2aWNlCiAgICBnZXRBZHZpY2U6IGZ1bmN0aW9uIGdldEFkdmljZSgpIHsKICAgICAgdmFyIF90aGlzMjQgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIkFkdmljZSI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IHRydWU7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RBZHZpY2VzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczI0LnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5hZHZpY2VfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmFkdmljZV9pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5TZWN0aW9uRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICAvLyBBZGQgTmV3IEFkdmljZQogICAgbmV3QWR2aWNlOiBmdW5jdGlvbiBuZXdBZHZpY2UoKSB7CiAgICAgIHRoaXMuU2VjdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLm5ld0FkdmljZURpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQWR2aWNlOiBmdW5jdGlvbiBhZGRBZHZpY2UoKSB7CiAgICAgIHZhciBfdGhpczI1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgICB2YXIgaXNFeGlzdCwgYUFkdmljZSwgYWR2aWNlX2lkOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaXNFeGlzdCA9IF90aGlzMjUuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZWwubmFtZSA9PSB0aGlzLmFkdmljZVNldHVwLmFkdmljZV9uYW1lOwogICAgICAgICAgICAgICAgfSwgX3RoaXMyNSk7CgogICAgICAgICAgICAgICAgaWYgKGlzRXhpc3QubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBhQWR2aWNlID0gX3RoaXMyNS5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RBZHZpY2VzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmFkdmljZV9uYW1lID09IHRoaXMuYWR2aWNlU2V0dXAuYWR2aWNlX25hbWU7CiAgICAgICAgICAgICAgICB9LCBfdGhpczI1KTsKCiAgICAgICAgICAgICAgICBpZiAoIWFBZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMjUuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UucHVzaCh7CiAgICAgICAgICAgICAgICAgIG5hbWU6IGFBZHZpY2VbMF0uYWR2aWNlX25hbWUsCiAgICAgICAgICAgICAgICAgIGFkdmljZV9pZDogYUFkdmljZVswXS5hZHZpY2VfaWQKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF90aGlzMjUuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIC8vdGhpcy5hZHZpY2VTZXR1cC5hZHZpY2VfZ3JvdXBfaWQgPSAiIjsKICAgICAgICAgICAgICAgIF90aGlzMjUuYWR2aWNlU2V0dXAuY29uc3VsdGFuY3lfZGVwYXJ0bWVudF9pZCA9IF90aGlzMjUuZGVwYXJ0bWVudF9pZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjUuYWRkTmV3QWR2aWNlKCk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBhZHZpY2VfaWQgPSBfY29udGV4dDEyLnNlbnQ7CgogICAgICAgICAgICAgICAgX3RoaXMyNS5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgbmFtZTogX3RoaXMyNS5hZHZpY2VTZXR1cC5hZHZpY2VfbmFtZSwKICAgICAgICAgICAgICAgICAgYWR2aWNlX2lkOiBhZHZpY2VfaWQudG9TdHJpbmcoKQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgX3RoaXMyNS5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgX3RoaXMyNS5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGFkZE5ld0FkdmljZTogZnVuY3Rpb24gYWRkTmV3QWR2aWNlKCkgewogICAgICB2YXIgX3RoaXMyNiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTMoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTMucHJldiA9IF9jb250ZXh0MTMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMjYuc3VibWl0dGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTMucHJldiA9IDE7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjYuYWR2aWNlU2V0dXAuYWR2aWNlX25hbWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjYuYWR2aWNlU2V0dXAuY29uc3VsdGFuY3lfZGVwYXJ0bWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjYuYWR2aWNlU2V0dXBTZXJ2aWNlLmFkZChfdGhpczI2LmFkdmljZVNldHVwKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0MTMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIShyZXN1bHQuc3RhdHVzID09PSAyMDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczI2LmdldFByZXNjcmlwdGlvbkRhdGEoKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoInJldHVybiIsIHJlc3VsdC5kYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIF90aGlzMjYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSAyNDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMy5wcmV2ID0gMjE7CiAgICAgICAgICAgICAgICBfY29udGV4dDEzLnQwID0gX2NvbnRleHQxM1siY2F0Y2giXSgxKTsKCiAgICAgICAgICAgICAgICBfdGhpczI2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogX2NvbnRleHQxMy50MCwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTMsIG51bGwsIFtbMSwgMjFdXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEFkZCBhbGwgYWR2aWNlIGNoZWNrYm94CiAgICBhZGRBbGxBZHZpY2U6IGZ1bmN0aW9uIGFkZEFsbEFkdmljZSgpIHsKICAgICAgdmFyIF90aGlzMjcgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uYWxsQWR2aWNlKSB7CiAgICAgICAgdGhpcy50ZW1wRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICB2YXIgYUFkdmljZSA9IF90aGlzMjcuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICByZXR1cm4gZWwuYWR2aWNlX2lkID09PSBlbGVtZW50LmlkOwogICAgICAgICAgfSwgX3RoaXMyNyk7CgogICAgICAgICAgaWYgKCFhQWR2aWNlLmxlbmd0aCkgewogICAgICAgICAgICBfdGhpczI3LmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGVsZW1lbnQubmFtZSwKICAgICAgICAgICAgICBhZHZpY2VfaWQ6IGVsZW1lbnQuaWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBBZGQgdmFsdWUgCiAgICBnZXRWYWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWUoZGF0YSkgewogICAgICBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJJbnZlc3RpZ2F0aW9uIikgewogICAgICAgIHZhciBhSW52ZXN0aWdhdGlvbiA9IHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5pbnZlc3RpZ2F0aW9uX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFJbnZlc3RpZ2F0aW9uLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb24ucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgaW52ZXN0aWdhdGlvbl9pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiTWVkaWNpbmUiKSB7CiAgICAgICAgdmFyIGFNZWRpY2luZSA9IHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLm1lZGljaW5lX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFNZWRpY2luZS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQucHVzaCh7CiAgICAgICAgICAgIF9tZWRpY2luZV90eXBlX25hbWU6IGRhdGEuX21lZGljaW5lX3R5cGVfbmFtZSwKICAgICAgICAgICAgbmFtZTogZGF0YS5fbWVkaWNpbmVfbmFtZSwKICAgICAgICAgICAgbWVkaWNpbmVfaWQ6IGRhdGEuaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZG9zZV9uYW1lOiBkYXRhLl90cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAgICAgICB0cmVhdG1lbnRfZG9zZV9pZDogZGF0YS50cmVhdG1lbnRfZG9zZV9pZCwKICAgICAgICAgICAgX3RyZWF0bWVudF9ydWxlX25hbWU6IGRhdGEuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9ydWxlc19pZDogZGF0YS50cmVhdG1lbnRfcnVsZXNfaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZHVyYXRpb25fbmFtZTogZGF0YS5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogZGF0YS50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJBZHZpY2UiKSB7CiAgICAgICAgdmFyIGFBZHZpY2UgPSB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5hZHZpY2VfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUFkdmljZS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgYWR2aWNlX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyBEZWxldGUgZnJvbSB0ZW1wIGxpc3QKICAgIGRlbGV0ZUl0ZW06IGZ1bmN0aW9uIGRlbGV0ZUl0ZW0obHN0LCBkYXRhKSB7CiAgICAgIGxzdC5zcGxpY2UobHN0LmZpbmRJbmRleChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpID09PSBkYXRhOwogICAgICB9KSwgMSk7CiAgICB9LAogICAgcHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBwcmVzY3JpcHRpb24oZGF0YSkgewogICAgICB2YXIgX3RoaXMyOCA9IHRoaXM7CgogICAgICB0aGlzLmRlcGFydG1lbnRfaWQgPSBkYXRhLmRlcGFydG1lbnRfaWQ7IC8vdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFkbWlzc2lvbl9pZCA9IGRhdGEuYWRtaXNzaW9uX2lkOwogICAgICAvL3RoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5hZG1pc3Npb25fbm8gPSBkYXRhLmFkbWlzc2lvbl9ubzsKICAgICAgLy9sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWRtaXNzaW9uSWRGb3JEaWFiZXRlc1NlcnZpY2UnLCBkYXRhLmFkbWlzc2lvbl9pZCk7CgogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8ucGF0aWVudF9pZCA9IGRhdGEucGF0aWVudF9pZDsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BhdGllbnRJZEZvclRyZWF0bWVudCcsIGRhdGEucGF0aWVudF9pZCk7IC8vIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5yZWdpc3RyYXRpb25fbm8gPSBkYXRhLnJlZ2lzdHJhdGlvbl9ubzsKICAgICAgLy8gdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLnBhdGllbnRfbmFtZSA9IGRhdGEucGF0aWVudF9uYW1lOwogICAgICAvLyB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8uZ2VuZGVyID0gZGF0YS5nZW5kZXI7CiAgICAgIC8vIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5hZ2VfeWVhciA9IGRhdGEuYWdlX3llYXI7CiAgICAgIC8vIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5hZ2VfbW9udGggPSBkYXRhLmFnZV9tb250aDsKICAgICAgLy8gdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV9kYXkgPSBkYXRhLmFnZV9kYXk7CgogICAgICB0aGlzLmdldENvbXBsYWluc0J5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7IC8vIFVzZSBmb3IgRGlhbG9nIC8vCgogICAgICB0aGlzLmdldENvbXBsYWluKCk7CiAgICAgIHRoaXMuZ2V0Rm9vZCgpOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjgub25FeGFtaW5hdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOyAvLyB0aGlzLmRpYWdub3Npc1NldHVwU2VydmljZQogICAgICAvLyAgIC5nZXRBbGwoKQogICAgICAvLyAgIC50aGVuKChkYXRhKSA9PiAodGhpcy5kaWFnbm9zaXNMaXN0ID0gZGF0YS5kYXRhKSk7CgogICAgICB0aGlzLmNvbW1vblNlcnZpY2UuR2V0QWxsQWxsZXJneVR5cGUoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjguYWxsZXJneVR5cGVMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy5jb21tb25TZXJ2aWNlLkdldEFsbERpYWJldGVzTWVhbCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyOC5kaWFiZXRlc01lYWxMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy5kaWV0Q2hhcnRUZW1wbGF0ZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyOC5kaWV0Q2hhcnRUZW1wbGF0ZUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOyAvLyBVc2UgZm9yIERpYWxvZyAvLwoKICAgICAgaWYgKGRhdGEuYWRtaXNzaW9uX2lkKSB7CiAgICAgICAgLy8gUHJldmlvdXMgUHJlc2NyaXB0aW9uIERhdGEKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvblNlcnZpY2UuZ2V0UHJldmlvdXNQcmVzY3JpcHRpb25EYXRhQWRtaXNzaW9uSWQoZGF0YS5hZG1pc3Npb25faWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIHJldHVybiBfdGhpczI4LnByZXZpb3VzUHJlc2NyaXB0aW9uRGF0YUZvcm1hdHRlZChkYXRhLmRhdGEpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKCFkYXRhLmFkbWlzc2lvbl9pZCAmJiBkYXRhLnBhdGllbnRfaWQpIHsKICAgICAgICAvLyBQcmV2aW91cyBQcmVzY3JpcHRpb24gRGF0YQogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIHJldHVybiBfdGhpczI4LnByZXZpb3VzUHJlc2NyaXB0aW9uRGF0YUZvcm1hdHRlZChkYXRhLmRhdGEpOwogICAgICAgIH0pOwogICAgICB9IC8vIFByZXNjcmlwdGlvbiBUcmVhdG1lbnQKCgogICAgICB0aGlzLm1lZGljaW5lU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI4Lm1lZGljaW5lTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjgudHJlYXRtZW50UnVsZXNMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy50cmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyOC50cmVhdG1lbnREdXJhdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmdldFRyZWF0bWVudERvc2VMaXN0KCk7CiAgICB9LAogICAgZ2V0VHJlYXRtZW50RG9zZUxpc3Q6IGZ1bmN0aW9uIGdldFRyZWF0bWVudERvc2VMaXN0KCkgewogICAgICB2YXIgX3RoaXMyOSA9IHRoaXM7CgogICAgICB0aGlzLnRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjkudHJlYXRtZW50RG9zZUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIHByZXZpb3VzUHJlc2NyaXB0aW9uRGF0YUZvcm1hdHRlZDogZnVuY3Rpb24gcHJldmlvdXNQcmVzY3JpcHRpb25EYXRhRm9ybWF0dGVkKGRhdGEpIHsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmNkcHJlc2NyaXB0aW9uX2RhdGUgPSBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKTsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudCA9IGRhdGEubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50OwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlID0gZGF0YS5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2U7CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uID0gZGF0YS5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOwogICAgfSwKICAgIG5ld1ByZXNjcmlwdGlvbjogZnVuY3Rpb24gbmV3UHJlc2NyaXB0aW9uKCkgewogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiU2VjdGlvbnMiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvID0gewogICAgICAgIGNkcHJlc2NyaXB0aW9uX2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGFsbEFkdmljZTogZmFsc2UsCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbjogW10sCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50OiBbXSwKICAgICAgICBsc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2U6IFtdCiAgICAgIH0sIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICB9LAogICAgZm9ybWF0RGF0ZTogZnVuY3Rpb24gZm9ybWF0RGF0ZSh2YWx1ZSkgewogICAgICByZXR1cm4gbW9tZW50KFN0cmluZyh2YWx1ZSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgfSwKICAgIGZvcm1hdERhdGVUaW1lOiBmdW5jdGlvbiBmb3JtYXREYXRlVGltZSh2YWx1ZSkgewogICAgICByZXR1cm4gbW9tZW50KFN0cmluZyh2YWx1ZSkpLmZvcm1hdCgiTU0vREQvWVlZWSBoOm1tOnNzIGEiKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/components/Prescription.js"],"names":["moment","Validation","FilterService","FilterMatchMode","FilterOperator","AppointmentPrescriptionService","AdmissionPrescriptionService","MedicineSetupService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","PatientProfileService","ComplaintSetupService","FoodService","OnExaminationSetupService","DietChartTemplateSetupService","DietChartSetupService","DiagnosisSetupService","CommonService","AdviceSetupService","data","filteredItems","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","admittedPatientInfo","prescriptionDataList","tempData","headerName","admissionPrescriptionInfo","allAdvice","lstAdmissionPrescriptionInvestigation","lstAdmissionPrescriptionTreatment","lstAdmissionPrescriptionAdvice","treatmentAddDialog","treatmentDialog","dose","treatmentDoseSetup","treatmentSetup","medicineList","treatmentRulesList","treatmentDurationList","treatmentDoseList","SectionDialog","complaintSetup","chiefComplainDialog","compliantList","chiefComplain","chiefComplainList","foodSetup","allergyDetailsDialog","allergyDetails","foodList","allergyTypeList","onExaminationDialog","onExamination","patientOnExaminationList","onExaminationList","iOChartDialog","iOChart","iOChartList","diabetesChartDialog","diabetesChart","aAdmissionServiceDetails","diabetesChartList","diabetesMealList","dietChartDialog","dietChart","dietChartList","dietChartTemplateList","dietChartTempList","currentMedicationsDialog","currentMedications","currentMedicationsList","pastMedicalHistoryDialog","pastMedicalHistory","pastMedicalHistoryList","diagnosisList","patientLatestHistory","lstPatientOnExamination","lstPatientAllergyDetails","lstPatientDiabetesChart","lstPatientDietChart","department_id","newAdviceDialog","adviceSetup","created","today","Date","month","getMonth","year","getFullYear","prevMonth","prevYear","minDate","setMonth","setFullYear","admissionPrescriptionService","appointmentPrescriptionService","medicineSetupService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","patientProfileService","complaintSetupService","foodService","onExaminationSetupService","dietChartTemplateSetupService","dietChartSetupService","diagnosisSetupService","commonService","validation","adviceSetupService","that","document","onkeyup","e","ctrlKey","altKey","which","getInvestigation","getTreatment","getAdvice","userInfo","JSON","parse","localStorage","getItem","doctor_id","getPrescriptionData","methods","getPrescriptionDataByDoctorId","then","hideDialog","patientId","toString","patient_id","getComplainsByPatientId","getComplain","getActiveCombo","addComplain","compilants_name","add","result","status","$toast","severity","summary","detail","res","life","searchComplain","event","setTimeout","query","trim","length","filter","item","text","toLowerCase","startsWith","newChiefComplain","addChiefComplain","ddlcomplain","cdfrom_date","from_date","String","format","isComplainExist","el","complainId","isDuplicate","compilants_id","complainSave","patient_complain_id","complainUpdate","getLatestHistoryByPatientIdForPrescription","newOnExamination","getOnExaminationsPopup","popupOnExaminationsData","forEach","element","push","_on_examination_name","on_examination_id","on_examination_result","onExaminationPopupDialog","addOnExamination","requred","onExaminationSave","getFood","addFood","food_name","active","searchFood","newAllergyDetails","addAllergyDetails","ddlfood","type","isFoodExist","foodId","food_id","allergyDetailsSave","patient_allergy_details_id","allergyDetailsUpdate","newIOChart","addIOChart","iOChartSave","getIOChartByPatientId","newDiabetesChart","addDiabetesChart","meal","before","after","diabetesChartSave","newDietChart","getDietChartByTemplateId","diet_chart_template_id","getByDietChartTemplateId","addDietChart","dietChartSave","searchMedicine","slice","searchDose","addDose","ddltreatment_dose","aDose","treatment_dose_name","addNewDose","dose_id","getTreatmentDoseList","saveTreatment","ddlmedicine","ddltreatment_rules","ddltreatment_duration","aMedicine","medicine_id","_treatment_dose_name","treatment_dose_id","_treatment_rule_name","treatment_rules_id","_treatment_duration_name","treatment_duration_id","description","editTreatment","index","medicineName","refid","treatmentIndex","treatmentEditSave","isAdvice","lstInvestigation","investingation_name","id","investigation_id","lstAdvices","advice_name","advice_id","newAdvice","addAdvice","isExist","aAdvice","consultancy_department_id","addNewAdvice","addAllAdvice","getValue","aInvestigation","_medicine_type_name","_medicine_name","deleteItem","lst","splice","findIndex","i","prescription","setItem","GetAllAllergyType","GetAllDiabetesMeal","admission_id","getPreviousPrescriptionDataAdmissionId","previousPrescriptionDataFormatted","getPreviousPrescriptionDataByPatientId","cdprescription_date","newPrescription","formatDate","formatDateTime"],"mappings":"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","sourcesContent":["import moment from \"moment\";\r\nimport Validation from \"../../scripts/validation\";\r\nimport { FilterService, FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n\r\n// Prescription\r\nimport AppointmentPrescriptionService from \"../../service/doctor-panel/AppointmentPrescriptionService\";\r\nimport AdmissionPrescriptionService from \"../../service/prescription/AdmissionPrescriptionService\";\r\n// Prescription Treatment\r\nimport MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\n// History\r\nimport PatientProfileService from \"../../service/profiles/PatientProfileService\";\r\nimport ComplaintSetupService from \"../../service/setup/ComplaintSetupService\";\r\nimport FoodService from \"../../service/setup/FoodService\";\r\nimport OnExaminationSetupService from \"../../service/setup/OnExaminationSetupService\";\r\nimport DietChartTemplateSetupService from \"../../service/setup/DietChartTemplateSetupService\";\r\nimport DietChartSetupService from \"../../service/setup/DietChartSetupService\";\r\nimport DiagnosisSetupService from \"../../service/setup/DiagnosisSetupService\";\r\nimport CommonService from \"../../service/CommonService\";\r\n// Advice\r\nimport AdviceSetupService from \"../../service/setup/AdviceSetupService\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      filteredItems: null,\r\n      submitted: false,\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n\r\n      // Prescription\r\n      admittedPatientInfo: {},\r\n      prescriptionDataList: [],\r\n      tempData: [],\r\n      headerName: \"Sections\",\r\n      admissionPrescriptionInfo: {\r\n        allAdvice: false,\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n      // Prescription Treatment\r\n      treatmentAddDialog: false,\r\n      treatmentDialog: false,\r\n      dose: {},\r\n      treatmentDoseSetup: {},\r\n      treatmentSetup: {},\r\n      medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n\r\n      // Section\r\n      SectionDialog: false,\r\n\r\n      // History\r\n      complaintSetup: {},\r\n      chiefComplainDialog: false,\r\n      compliantList: [],\r\n      chiefComplain: {},\r\n      chiefComplainList: [],\r\n\r\n      foodSetup: {},\r\n      allergyDetailsDialog: false,\r\n      allergyDetails: {},\r\n      foodList: [],\r\n      allergyTypeList: [],\r\n\r\n      onExaminationDialog: false,\r\n      onExamination: {},\r\n      patientOnExaminationList: [],\r\n      onExaminationList: [],\r\n\r\n      iOChartDialog: false,\r\n      iOChart: {},\r\n      iOChartList: [],\r\n\r\n      diabetesChartDialog: false,\r\n      diabetesChart: {\r\n        aAdmissionServiceDetails: {}\r\n      },\r\n      diabetesChartList: [],\r\n      diabetesMealList: [],\r\n\r\n      dietChartDialog: false,\r\n      dietChart: {},\r\n      dietChartList: [],\r\n      dietChartTemplateList: [],\r\n      dietChartTempList: [],\r\n\r\n      currentMedicationsDialog: false,\r\n      currentMedications: {},\r\n      currentMedicationsList: [],\r\n\r\n      pastMedicalHistoryDialog: false,\r\n      pastMedicalHistory: {},\r\n      pastMedicalHistoryList: [],\r\n      diagnosisList: [],\r\n\r\n      patientLatestHistory: {\r\n        lstPatientOnExamination: [],\r\n        lstPatientAllergyDetails: [],\r\n        lstPatientDiabetesChart: [],\r\n        lstPatientDietChart: [],\r\n      },\r\n\r\n      department_id: \"\",\r\n      newAdviceDialog: false,\r\n      adviceSetup: {},\r\n    };\r\n  },\r\n  created() {\r\n    // past date-year disabled\r\n    let today = new Date();\r\n    let month = today.getMonth();\r\n    let year = today.getFullYear();\r\n    let prevMonth = (month === 0) ? 11 : month - 0;\r\n    let prevYear = (prevMonth === 11) ? year - 0 : year;\r\n    this.minDate = new Date();\r\n    this.minDate.setMonth(prevMonth);\r\n    this.minDate.setFullYear(prevYear);\r\n\r\n    // Prescription\r\n    this.admissionPrescriptionService = new AdmissionPrescriptionService();\r\n    this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n\r\n    // Prescription Treatment\r\n    this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n\r\n    // History\r\n    this.patientProfileService = new PatientProfileService();\r\n\r\n    this.complaintSetupService = new ComplaintSetupService();\r\n    this.foodService = new FoodService();\r\n    this.onExaminationSetupService = new OnExaminationSetupService();\r\n    this.dietChartTemplateSetupService = new DietChartTemplateSetupService();\r\n    this.dietChartSetupService = new DietChartSetupService();\r\n\r\n    this.diagnosisSetupService = new DiagnosisSetupService();\r\n    this.commonService = new CommonService();\r\n    this.validation = new Validation();\r\n\r\n    // Advice\r\n    this.adviceSetupService = new AdviceSetupService();\r\n\r\n    // shortcut key start\r\n    let that = this;\r\n    document.onkeyup = function (e) {\r\n      if (e.ctrlKey && e.altKey && e.which == 73) {\r\n        that.getInvestigation();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 84) {\r\n        that.getTreatment();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 65) {\r\n        that.getAdvice();\r\n      }\r\n      // else if (e.ctrlKey && e.altKey && e.shiftKey) {\r\n\r\n      // }\r\n    };\r\n    // shortcut key end\r\n\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n\r\n    if (this.userInfo.doctor_id) {\r\n      this.getPrescriptionData();\r\n\r\n      this.doctor_id = this.userInfo.doctor_id;\r\n      this.admissionPrescriptionInfo.doctor_id = this.doctor_id;\r\n    }\r\n  },\r\n  methods: {\r\n    getPrescriptionData() {\r\n      //this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n      this.appointmentPrescriptionService\r\n        .getPrescriptionDataByDoctorId(this.userInfo.doctor_id)\r\n        .then((data) => (this.prescriptionDataList = data.data));\r\n    },\r\n\r\n    hideDialog() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n\r\n      // Chief Complain\r\n      this.chiefComplainDialog = false;\r\n      this.chiefComplain = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      // On Examination\r\n      this.onExaminationDialog = false;\r\n      // this.onExamination = {\r\n      //   patient_id: patientId\r\n      // };\r\n\r\n      this.SectionDialog = false;\r\n      this.treatmentAddDialog = false;\r\n      this.treatmentSetup = {};\r\n      this.treatmentDialog = false;\r\n\r\n      this.foodSetup = {};\r\n      this.allergyDetailsDialog = false;\r\n      this.allergyDetails = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.iOChartDialog = false;\r\n      this.iOChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.diabetesChartDialog = false;\r\n      this.diabetesChart = {\r\n        aAdmissionServiceDetails: {},\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.dietChartDialog = false;\r\n      this.dietChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.newAdviceDialog = false,\r\n        this.adviceSetup = {};\r\n\r\n      this.submitted = false;\r\n    },\r\n    // Get Previous Chief Complain\r\n    getComplainsByPatientId(patient_id) {\r\n      this.chiefComplain.patient_id = patient_id;\r\n      this.patientProfileService.getComplainsByPatientId(patient_id).then((data) => (this.chiefComplainList = data.data));\r\n    },\r\n    // Get, Add Complain\r\n    getComplain() {\r\n      this.complaintSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.compliantList = data.data));\r\n    },\r\n    async addComplain() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.complaintSetup.compilants_name) {\r\n          return;\r\n        } else {\r\n          //this.complaintSetup.compliants_group_id = \"1\"\r\n          //this.complaintSetup.is_favourite = true;\r\n          let result = await this.complaintSetupService.add(this.complaintSetup);\r\n          if (result.status === 200) {\r\n            this.getComplain();\r\n            return result.data;\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    // Add Chief Complain\r\n    searchComplain(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.compliantList];\r\n        }\r\n        else {\r\n          //start with\r\n          this.filteredItems = this.compliantList.filter((item) => {\r\n            return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          });\r\n        }\r\n      }, 250);\r\n    },\r\n    newChiefComplain() {\r\n      this.chiefComplainDialog = true;\r\n    },\r\n    async addChiefComplain() {\r\n      this.submitted = true;\r\n      this.chiefComplain.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.chiefComplain.ddlcomplain) {\r\n        return;\r\n      } else if (!this.chiefComplain.patient_id) {\r\n        return;\r\n      } else if (!this.chiefComplain.cdfrom_date) {\r\n        return;\r\n      } else {\r\n        this.chiefComplain.from_date = moment(\r\n          String(this.chiefComplain.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        // complain is exist check start\r\n        if (!this.chiefComplain.ddlcomplain.value) {\r\n          var isComplainExist = this.compliantList.filter(function (el) {\r\n            return el.text == this.chiefComplain.ddlcomplain;\r\n          }, this);\r\n\r\n          if (isComplainExist.length == 0) {\r\n            this.complaintSetup.compilants_name = this.chiefComplain.ddlcomplain;\r\n            var complainId = await this.addComplain();\r\n            this.chiefComplain.ddlcomplain = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.chiefComplain.ddlcomplain.value = complainId.toString();\r\n          } else {\r\n            this.chiefComplain.ddlcomplain = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.chiefComplain.ddlcomplain.value = isComplainExist[0].value;\r\n          }\r\n        }\r\n        // complain is exist check end\r\n\r\n        var isDuplicate = this.chiefComplainList.filter(function (el) {\r\n          return el.compilants_id == this.chiefComplain.ddlcomplain.value;\r\n        }, this);\r\n        this.chiefComplain.compilants_id = this.chiefComplain.ddlcomplain.value;\r\n        if (isDuplicate.length == 0) {\r\n          let result = await this.patientProfileService.complainSave(this.chiefComplain);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          this.chiefComplain.patient_complain_id = isDuplicate[0].patient_complain_id;\r\n          let result = await this.patientProfileService.complainUpdate(this.chiefComplain);\r\n          if (result.status === 202) {\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n\r\n      // var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      // this.chiefComplain.patient_id = patientId;\r\n      // this.submitted = true;\r\n      // if (!this.chiefComplain.compilants_id) {\r\n      //   return;\r\n      // } else if (!this.chiefComplain.patient_id) {\r\n      //   return;\r\n      // } else if (!this.chiefComplain.cdfrom_date) {\r\n      //   return;\r\n      // } else if (this.validation.isIdExists(this.chiefComplainList, 'compilants_id', this.chiefComplain.compilants_id, 'patient_complain_id', this.chiefComplain.patient_complain_id, this)) {\r\n      //   return;\r\n      // } else {\r\n      //   this.chiefComplain.from_date = moment(\r\n      //     String(this.chiefComplain.cdfrom_date)\r\n      //   ).format(\"YYYY-MM-DD\");\r\n      //   if (!this.chiefComplain.patient_complain_id) {\r\n      //     let result = await this.patientProfileService.complainSave(this.chiefComplain);\r\n      //     if (result.status === 201) {\r\n      //       this.$toast.add({\r\n      //         severity: \"success\",\r\n      //         summary: \"Success\",\r\n      //         detail: \"Saved Successfully\",\r\n      //         life: 10000,\r\n      //       });\r\n      //       this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n      //       this.hideDialog();\r\n      //     } else if (result.status === 401) {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Error\",\r\n      //         detail: result.data,\r\n      //         life: 10000,\r\n      //       });\r\n      //     } else {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Failed\",\r\n      //         detail: result.res,\r\n      //         life: 10000,\r\n      //       });\r\n      //     }\r\n      //   } else {\r\n      //     let result = await this.patientProfileService.complainUpdate(this.chiefComplain);\r\n      //     if (result.status === 202) {\r\n      //       this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n      //       this.hideDialog();\r\n      //       this.$toast.add({\r\n      //         severity: \"success\",\r\n      //         summary: \"Success\",\r\n      //         detail: \"Updated Successfully\",\r\n      //         life: 10000,\r\n      //       });\r\n      //     } else if (result.status === 401) {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Error\",\r\n      //         detail: result.data,\r\n      //         life: 10000,\r\n      //       });\r\n      //     } else {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Failed\",\r\n      //         detail: result.res,\r\n      //         life: 10000,\r\n      //       });\r\n      //     }\r\n      //   }\r\n      // }\r\n    },\r\n\r\n    // Get Previous lstPatientOnExamination, lstPatientAllergyDetails, lstPatientDiabetesChart, lstPatientDietChart,\r\n    getLatestHistoryByPatientIdForPrescription() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      this.patientProfileService.getLatestHistoryByPatientIdForPrescription(patientId).then((data) => (this.patientLatestHistory = data.data));\r\n    },\r\n\r\n    // Add On Examination\r\n    newOnExamination() {\r\n      this.getOnExaminationsPopup();\r\n      this.onExaminationDialog = true;\r\n    },\r\n    getOnExaminationsPopup() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n\r\n      this.popupOnExaminationsData = [];\r\n      this.onExaminationList.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          _on_examination_name: element.text,\r\n          on_examination_id: element.value,\r\n          on_examination_result: String(1),\r\n          patient_id: patientId.toString()\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n    async addOnExamination() {\r\n      this.submitted = true;\r\n      this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (!element.on_examination_result) {\r\n          this.requred = \"required\";\r\n        }\r\n      });\r\n\r\n      if (this.requred) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Required\",\r\n          detail: \"Please fill in the required fields\",\r\n          life: 10000,\r\n        });\r\n        return;\r\n      }\r\n      if (this.requred) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.onExaminationSave(this.popupOnExaminationsData);\r\n        if (result.status === 201) {\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Get, Add Food\r\n    getFood() {\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => (this.foodList = data.data));\r\n    },\r\n    async addFood() {\r\n      try {\r\n        if (!this.foodSetup.food_name) {\r\n          return;\r\n        } else {\r\n          this.foodSetup.active = true;\r\n          let result = await this.foodService.add(this.foodSetup);\r\n          if (result.status === 200) {\r\n            this.getFood();\r\n            return result.data;\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add Allergy Details\r\n    searchFood(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.foodList];\r\n        }\r\n        else {\r\n          //start with\r\n          this.filteredItems = this.foodList.filter((item) => {\r\n            return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          });\r\n        }\r\n      }, 250);\r\n    },\r\n    newAllergyDetails() {\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n    async addAllergyDetails() {\r\n      this.submitted = true;\r\n      this.allergyDetails.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.allergyDetails.ddlfood) {\r\n        return;\r\n      } else if (!this.allergyDetails.patient_id) {\r\n        return;\r\n      } else if (!this.allergyDetails.type) {\r\n        return;\r\n      } else if (!this.allergyDetails.cdfrom_date) {\r\n        return;\r\n      } else {\r\n        this.allergyDetails.from_date = moment(\r\n          String(this.allergyDetails.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        // food is exist check start\r\n        if (!this.allergyDetails.ddlfood.value) {\r\n          var isFoodExist = this.foodList.filter(function (el) {\r\n            return el.text == this.allergyDetails.ddlfood;\r\n          }, this);\r\n\r\n          if (isFoodExist.length == 0) {\r\n            this.foodSetup.food_name = this.allergyDetails.ddlfood;\r\n            var foodId = await this.addFood();\r\n            this.allergyDetails.ddlfood = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.allergyDetails.ddlfood.value = foodId.toString();\r\n          } else {\r\n            this.allergyDetails.ddlfood = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.allergyDetails.ddlfood.value = isFoodExist[0].value;\r\n          }\r\n        }\r\n        // food is exist check end\r\n\r\n        var isDuplicate = this.patientLatestHistory.lstPatientAllergyDetails.filter(function (el) {\r\n          return el.food_id == this.allergyDetails.ddlfood.value;\r\n        }, this);\r\n        this.allergyDetails.food_id = this.allergyDetails.ddlfood.value;\r\n        if (isDuplicate.length == 0) {\r\n          let result = await this.patientProfileService.allergyDetailsSave(this.allergyDetails);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getLatestHistoryByPatientIdForPrescription();\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          this.allergyDetails.patient_allergy_details_id = isDuplicate[0].patient_allergy_details_id;\r\n          let result = await this.patientProfileService.allergyDetailsUpdate(this.allergyDetails);\r\n          if (result.status === 202) {\r\n            this.getLatestHistoryByPatientIdForPrescription();\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add IO Chart\r\n    newIOChart() {\r\n      this.iOChartDialog = true;\r\n    },\r\n    async addIOChart() {\r\n      this.submitted = true;\r\n      if (!this.iOChart.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.iOChartSave(this.iOChart);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getIOChartByPatientId(patientId);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add Diabetes Chart\r\n    newDiabetesChart() {\r\n      this.diabetesChartDialog = true;\r\n    },\r\n    async addDiabetesChart() {\r\n      this.submitted = true;\r\n      if (!this.diabetesChart.meal) {\r\n        return;\r\n      } else if (!this.diabetesChart.before) {\r\n        return;\r\n      } else if (!this.diabetesChart.after) {\r\n        return;\r\n      } else {\r\n        //var admission_id = JSON.parse(localStorage.getItem(\"admissionIdForDiabetesService\"));\r\n        //this.diabetesChart.aAdmissionServiceDetails.admission_id = String(admission_id);\r\n        var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n        this.diabetesChart.patient_id = String(patientId);\r\n        let result = await this.patientProfileService.diabetesChartSave(this.diabetesChart);\r\n        if (result.status === 201) {\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add Diet Chart\r\n    newDietChart() {\r\n      this.dietChartDialog = true;\r\n    },\r\n    getDietChartByTemplateId() {\r\n      if (!this.dietChart.diet_chart_template_id) {\r\n        return\r\n      } else {\r\n        this.dietChartSetupService\r\n          .getByDietChartTemplateId(this.dietChart.diet_chart_template_id)\r\n          .then((data) => (this.dietChartTempList = data.data));\r\n      }\r\n    },\r\n    async addDietChart() {\r\n      this.submitted = true;\r\n      if (this.dietChartTempList.length <= 0) {\r\n        return;\r\n      } else {\r\n        var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n        this.dietChartTempList.forEach(element => {\r\n          element.patient_id = patientId.toString()\r\n        });\r\n\r\n        let result = await this.patientProfileService.dietChartSave(this.dietChartTempList);\r\n        if (result.status === 201) {\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Treatment\r\n    searchMedicine(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.medicineList];\r\n        }\r\n        else {\r\n          // start with\r\n          // this.filteredItems = this.medicineList.filter((item) => {\r\n          //     return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          // });\r\n\r\n          // contains\r\n          this.filteredItems = FilterService.filter(this.medicineList, ['text'], event.query.toLowerCase(), FilterMatchMode.CONTAINS).slice(0, 10);\r\n        }\r\n      }, 250);\r\n    },\r\n    getTreatment() {\r\n      this.treatmentAddDialog = true;\r\n      // this.headerName = \"Medicine\";\r\n      // this.filters['global'].value = \"\";\r\n      // this.isAdvice = false;\r\n      // this.tempData = [];\r\n      // this.prescriptionDataList.lstTreatment.forEach((element) => {\r\n      //   this.tempData.push({\r\n      //     _medicine_type_name: element._medicine_type_name,\r\n      //     _medicine_name: element._medicine_name,\r\n      //     name: element._medicine_type_name + \" \" + element._medicine_name + \" \" + element._treatment_dose_name + \" \" + element._treatment_rule_name + \" \" + element._treatment_duration_name,\r\n      //     id: element.medicine_id,\r\n      //     _treatment_dose_name: element._treatment_dose_name,\r\n      //     treatment_dose_id: element.treatment_dose_id,\r\n      //     _treatment_rule_name: element._treatment_rule_name,\r\n      //     treatment_rules_id: element.treatment_rules_id,\r\n      //     _treatment_duration_name: element._treatment_duration_name,\r\n      //     treatment_duration_id: element.treatment_duration_id,\r\n      //     description: element.description,\r\n      //   });\r\n      // });\r\n    },\r\n    // Start Treatment Dose\r\n    searchDose(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.treatmentDoseList];\r\n        }\r\n        else {\r\n          //start with\r\n          this.filteredItems = this.treatmentDoseList.filter((item) => {\r\n            return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          });\r\n        }\r\n      }, 250);\r\n    },\r\n    async addDose() {\r\n      if (!this.treatmentSetup.ddltreatment_dose.value) {\r\n        var aDose =\r\n          this.treatmentDoseList.filter(\r\n            function (el) {\r\n              return el.text == this.treatmentSetup.ddltreatment_dose;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (aDose.length) {\r\n          this.dose = {\r\n            text: aDose.text,\r\n            value: aDose.value\r\n          }\r\n        }\r\n        else {\r\n          this.treatmentDoseSetup.treatment_dose_name = this.treatmentSetup.ddltreatment_dose;\r\n          var dose_id = await this.addNewDose();\r\n          this.dose = {\r\n            text: this.treatmentDoseSetup.treatment_dose_name,\r\n            value: dose_id.toString()\r\n          }\r\n        }\r\n      }\r\n      else {\r\n        this.dose = {\r\n          text: this.treatmentSetup.ddltreatment_dose.text,\r\n          value: this.treatmentSetup.ddltreatment_dose.value\r\n        }\r\n      }\r\n    },\r\n\r\n    async addNewDose() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.treatmentDoseSetup.treatment_dose_name) {\r\n          return;\r\n        } else {\r\n          let result = await this.treatmentDoseSetupService.add(this.treatmentDoseSetup);\r\n          if (result.status === 200) {\r\n            this.getTreatmentDoseList();\r\n            return result.data;\r\n          }\r\n          else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    // End Treatment Dose\r\n    async saveTreatment() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddlmedicine) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === this.treatmentSetup.ddlmedicine.value;\r\n            },\r\n            this\r\n          );\r\n        \r\n        if (!aMedicine.length) {\r\n          await this.addDose();\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            name: this.treatmentSetup.ddlmedicine.text,\r\n            medicine_id: this.treatmentSetup.ddlmedicine.value,\r\n            _treatment_dose_name: this.dose.text,\r\n            treatment_dose_id: this.dose.value,\r\n            _treatment_rule_name: this.treatmentSetup.ddltreatment_rules.text,\r\n            treatment_rules_id: this.treatmentSetup.ddltreatment_rules.value,\r\n            _treatment_duration_name: this.treatmentSetup.ddltreatment_duration.text,\r\n            treatment_duration_id: this.treatmentSetup.ddltreatment_duration.value,\r\n            description: this.treatmentSetup.description,\r\n          });\r\n        }\r\n        this.hideDialog();\r\n      }\r\n    },\r\n    // Edit Treatment\r\n    editTreatment(data, index) {\r\n      this.treatmentSetup.description = data.description;\r\n      this.treatmentSetup.medicineName = data.name;\r\n      this.treatmentSetup.ddltreatment_rules = {\r\n        text: data._treatment_rule_name,\r\n        value: data.treatment_rules_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_duration = {\r\n        text: data._treatment_duration_name,\r\n        value: data.treatment_duration_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_dose = {\r\n        text: data._treatment_dose_name,\r\n        value: data.treatment_dose_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentDialog = true;\r\n      this.treatmentIndex = index\r\n    },\r\n    treatmentEditSave() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].name = this.treatmentSetup.ddlmedicine.text;\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].medicine_id = this.treatmentSetup.ddlmedicine.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_rule_name = this.treatmentSetup.ddltreatment_rules.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_rules_id = this.treatmentSetup.ddltreatment_rules.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_duration_name = this.treatmentSetup.ddltreatment_duration.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_duration_id = this.treatmentSetup.ddltreatment_duration.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_dose_name = this.treatmentSetup.ddltreatment_dose.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_dose_id = this.treatmentSetup.ddltreatment_dose.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].description = this.treatmentSetup.description;\r\n\r\n        this.treatmentDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n\r\n    // Investigation\r\n    getInvestigation() {\r\n      this.headerName = \"Investigation\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstInvestigation.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.investingation_name,\r\n          id: element.investigation_id,\r\n        });\r\n      });\r\n\r\n      this.SectionDialog = true;\r\n    },\r\n\r\n    // Advice\r\n    getAdvice() {\r\n      this.headerName = \"Advice\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = true;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstAdvices.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.advice_name,\r\n          id: element.advice_id,\r\n        });\r\n      });\r\n      this.SectionDialog = true;\r\n    },\r\n\r\n    // Add New Advice\r\n    newAdvice() {\r\n      this.SectionDialog = false;\r\n      this.newAdviceDialog = true;\r\n    },\r\n    async addAdvice() {\r\n      var isExist =\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n          function (el) {\r\n            return el.name == this.adviceSetup.advice_name;\r\n          },\r\n          this\r\n        );\r\n\r\n      if (!isExist.length) {\r\n        var aAdvice =\r\n          this.prescriptionDataList.lstAdvices.filter(\r\n            function (el) {\r\n              return el.advice_name == this.adviceSetup.advice_name;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (aAdvice.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: aAdvice[0].advice_name,\r\n            advice_id: aAdvice[0].advice_id,\r\n          });\r\n\r\n          this.hideDialog();\r\n        }\r\n        else {\r\n          //this.adviceSetup.advice_group_id = \"\";\r\n          this.adviceSetup.consultancy_department_id = this.department_id;\r\n          var advice_id = await this.addNewAdvice();\r\n\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: this.adviceSetup.advice_name,\r\n            advice_id: advice_id.toString(),\r\n          });\r\n          this.hideDialog();\r\n        }\r\n      }\r\n      else {\r\n        this.hideDialog();\r\n      }\r\n    },\r\n\r\n    async addNewAdvice() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.adviceSetup.advice_name) {\r\n          return;\r\n        } else if (!this.adviceSetup.consultancy_department_id) {\r\n          return;\r\n        } else {\r\n          let result = await this.adviceSetupService.add(this.adviceSetup);\r\n          if (result.status === 200) {\r\n            this.getPrescriptionData();\r\n            return result.data;\r\n          }\r\n          else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add all advice checkbox\r\n    addAllAdvice() {\r\n      if (!this.admissionPrescriptionInfo.allAdvice) {\r\n        this.tempData.forEach((element) => {\r\n          var aAdvice =\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n              function (el) {\r\n                return el.advice_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aAdvice.length) {\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n              name: element.name,\r\n              advice_id: element.id,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add value \r\n    getValue(data) {\r\n      if (this.headerName == \"Investigation\") {\r\n        var aInvestigation =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.filter(\r\n            function (el) {\r\n              return el.investigation_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aInvestigation.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.push(\r\n            {\r\n              name: data.name,\r\n              investigation_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Medicine\") {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            _medicine_type_name: data._medicine_type_name,\r\n            name: data._medicine_name,\r\n            medicine_id: data.id,\r\n            _treatment_dose_name: data._treatment_dose_name,\r\n            treatment_dose_id: data.treatment_dose_id,\r\n            _treatment_rule_name: data._treatment_rule_name,\r\n            treatment_rules_id: data.treatment_rules_id,\r\n            _treatment_duration_name: data._treatment_duration_name,\r\n            treatment_duration_id: data.treatment_duration_id,\r\n            description: data.description,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Advice\") {\r\n        var aAdvice =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n            function (el) {\r\n              return el.advice_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aAdvice.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: data.name,\r\n            advice_id: data.id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Delete from temp list\r\n    deleteItem(lst, data) {\r\n      lst.splice(\r\n        lst.findIndex((i) => i === data),\r\n        1\r\n      );\r\n    },\r\n\r\n    prescription(data) {\r\n      this.department_id = data.department_id;\r\n      //this.admittedPatientInfo.admission_id = data.admission_id;\r\n      //this.admittedPatientInfo.admission_no = data.admission_no;\r\n      //localStorage.setItem('admissionIdForDiabetesService', data.admission_id);\r\n      this.admittedPatientInfo.patient_id = data.patient_id;\r\n      localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      // this.admittedPatientInfo.registration_no = data.registration_no;\r\n      // this.admittedPatientInfo.patient_name = data.patient_name;\r\n      // this.admittedPatientInfo.gender = data.gender;\r\n      // this.admittedPatientInfo.age_year = data.age_year;\r\n      // this.admittedPatientInfo.age_month = data.age_month;\r\n      // this.admittedPatientInfo.age_day = data.age_day;\r\n\r\n      this.getComplainsByPatientId(data.patient_id);\r\n      this.getLatestHistoryByPatientIdForPrescription();\r\n\r\n      // Use for Dialog //\r\n      this.getComplain();\r\n\r\n      this.getFood();\r\n\r\n      this.onExaminationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.onExaminationList = data.data));\r\n\r\n      // this.diagnosisSetupService\r\n      //   .getAll()\r\n      //   .then((data) => (this.diagnosisList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllAllergyType()\r\n        .then((data) => (this.allergyTypeList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllDiabetesMeal()\r\n        .then((data) => (this.diabetesMealList = data.data));\r\n\r\n      this.dietChartTemplateSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.dietChartTemplateList = data.data));\r\n      // Use for Dialog //\r\n\r\n      if (data.admission_id) {\r\n        // Previous Prescription Data\r\n        this.admissionPrescriptionService\r\n          .getPreviousPrescriptionDataAdmissionId(data.admission_id)\r\n          .then((data) => this.previousPrescriptionDataFormatted(data.data));\r\n      } else if (!data.admission_id && data.patient_id) {\r\n        // Previous Prescription Data\r\n        this.admissionPrescriptionService\r\n          .getPreviousPrescriptionDataByPatientId(data.patient_id)\r\n          .then((data) => this.previousPrescriptionDataFormatted(data.data));\r\n      }\r\n\r\n      // Prescription Treatment\r\n      this.medicineSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.medicineList = data.data));\r\n\r\n      this.treatmentRulesSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n      this.treatmentDurationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n      this.getTreatmentDoseList();\r\n    },\r\n    getTreatmentDoseList(){\r\n      this.treatmentDoseSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDoseList = data.data));\r\n    },\r\n    previousPrescriptionDataFormatted(data) {\r\n      this.admissionPrescriptionInfo.cdprescription_date = moment(String(new Date())).format(\"MM/DD/YYYY\");\r\n\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment = data.lstAdmissionPrescriptionTreatment;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice = data.lstAdmissionPrescriptionAdvice;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation = data.lstAdmissionPrescriptionInvestigation;\r\n    },\r\n\r\n    newPrescription() {\r\n      this.headerName = \"Sections\";\r\n      this.filters['global'].value = \"\";\r\n      this.tempData = [];\r\n\r\n      this.admissionPrescriptionInfo = {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        allAdvice: false,\r\n\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n        this.submitted = false;\r\n    },\r\n\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY\");\r\n    },\r\n    formatDateTime(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n  },\r\n};"]}]}