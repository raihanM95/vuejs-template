{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\thread-loader\\dist\\cjs.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\doctor-panel\\AppointmentPrescription.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\doctor-panel\\AppointmentPrescription.js","mtime":1663240634801},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L1NWTiBQUk9KRUNUUy9FUlBfSG9zcGl0YWxfQ2xpZW50L3RydW5rL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLWluZGV4LmpzIjsKaW1wb3J0IENvbW1vblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9Db21tb25TZXJ2aWNlIjsKaW1wb3J0IERvY3RvckFwcG9pbnRtZW50U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2Zyb250LWRlc2svRG9jdG9yQXBwb2ludG1lbnRTZXJ2aWNlIjsKaW1wb3J0IEZpZ3VyZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0ZpZ3VyZVNldHVwU2VydmljZSI7CmltcG9ydCBBcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9kb2N0b3ItcGFuZWwvQXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlIjsKaW1wb3J0IE1lZGljaW5lVHlwZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL01lZGljaW5lVHlwZVNldHVwU2VydmljZSI7CmltcG9ydCBNZWRpY2luZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL01lZGljaW5lU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvVHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSI7CmltcG9ydCBUcmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSI7CmltcG9ydCBQcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcmVwb3J0L1ByZXNjcmlwdGlvblJlcG9ydFNlcnZpY2UiOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCB7IEZpbHRlck1hdGNoTW9kZSwgRmlsdGVyT3BlcmF0b3IgfSBmcm9tICJwcmltZXZ1ZS9hcGkiOwppbXBvcnQgRW1wbG95ZWVTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9FbXBsb3llZVNldHVwU2VydmljZSI7CmltcG9ydCBQYXRpZW50UmVnaXN0cmF0aW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2Zyb250LWRlc2svUGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UiOwppbXBvcnQgUGF0aWVudFJlcG9ydFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9yZXBvcnQvUGF0aWVudFJlcG9ydFNlcnZpY2UiOwppbXBvcnQgUGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2Zyb250LWRlc2svUGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0U2VydmljZSI7CmltcG9ydCBEaWFnbm9zaXNSZXBvcnRTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcmVwb3J0L0RpYWdub3Npc1JlcG9ydFNlcnZpY2UiOwppbXBvcnQgUGF0aWVudFByb2ZpbGVTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcHJvZmlsZXMvUGF0aWVudFByb2ZpbGVTZXJ2aWNlIjsKaW1wb3J0IERpYWdub3Npc1NldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpYWdub3Npc1NldHVwU2VydmljZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZXhwYW5kZWRSb3dzOiBbXSwKICAgICAgYWN0aXZlOiAwLAogICAgICBpbnZlc3RpZ2F0aW9uUmVzdWx0TGlzdDogW10sCiAgICAgIHBhdGllbnQ6IHsKICAgICAgICBhZ2VfeWVhcjogIjAiLAogICAgICAgIGFnZV9tb250aDogIjAiLAogICAgICAgIGFnZV9kYXk6ICIwIgogICAgICB9LAogICAgICBpc0Fzc2lzdGFudDogZmFsc2UsCiAgICAgIGRhdGFMaXN0OiB0cnVlLAogICAgICBpc0hpc3Rvcnk6IGZhbHNlLAogICAgICBpc0ZlbWFsZTogZmFsc2UsCiAgICAgIGlzQWR2aWNlOiBmYWxzZSwKICAgICAgY3VycmVudE1lZGljYXRpb25zRGlhbG9nOiBmYWxzZSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nOiBmYWxzZSwKICAgICAgb25FeGFtaW5hdGlvbkRpYWxvZzogZmFsc2UsCiAgICAgIG9uRXhhbWluYXRpb25Qb3B1cERpYWxvZzogZmFsc2UsCiAgICAgIC8vZWRpdE9uRXhhbWluYXRpb25EaWFsb2c6IGZhbHNlLAogICAgICBmaWd1cmVEaWFsb2c6IGZhbHNlLAogICAgICBmYW1pbHlIaXN0b3J5RGlhbG9nOiBmYWxzZSwKICAgICAgdHJlYXRtZW50QWRkRGlhbG9nOiBmYWxzZSwKICAgICAgdHJlYXRtZW50RGlhbG9nOiBmYWxzZSwKICAgICAgcHJldlByZXNjcmlwdGlvbkRpYWxvZzogZmFsc2UsCiAgICAgIGRpYWdub3Npc0xpc3Q6IFtdLAogICAgICBjdXJyZW50TWVkaWNhdGlvbnNMaXN0OiBbXSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5TGlzdDogW10sCiAgICAgIGFwcG9pbm1lbnRTdGF0dXNMaXN0OiBbXSwKICAgICAgcGF0aWVudHNSZWxhdGl2ZUxpc3Q6IFtdLAogICAgICBkb2N0b3JBcHBvaW50bWVudExpc3Q6IFtdLAogICAgICBwcmVzY3JpcHRpb25EYXRhTGlzdDogW10sCiAgICAgIHByZXZQcmVzY3JpcHRpb25MaXN0OiBbXSwKICAgICAgaGVhZGVyTmFtZTogIlNlY3Rpb25zIiwKICAgICAgdGVtcERhdGE6IFtdLAogICAgICBwYXRpZW50SGlzdG9yeTogewogICAgICAgIGxzdFBlcnNvbmFsSGlzdG9yeTogW10sCiAgICAgICAgbHN0RmFtaWx5SGlzdG9yeTogW10sCiAgICAgICAgbHN0U3lzdGVtc1JldmlldzogW10sCiAgICAgICAgbHN0U3Vic3RhbmNlVXNlOiBbXSwKICAgICAgICBsc3RSZXByb2R1Y3RpdmVIaXN0b3J5OiBbXQogICAgICB9LAogICAgICBjdXJyZW50TWVkaWNhdGlvbnM6IHt9LAogICAgICBwYXN0TWVkaWNhbEhpc3Rvcnk6IHt9LAogICAgICBhcHBvaW50bWVudEluZm86IHt9LAogICAgICBvbkV4YW1pbmF0aW9uOiB7fSwKICAgICAgZmlndXJlOiB7fSwKICAgICAgZmFtaWx5SGlzdG9yeToge30sCiAgICAgIHRyZWF0bWVudFNldHVwOiB7fSwKICAgICAgZG9jdG9yQXBwb2ludG1lbnQ6IHsKICAgICAgICBjZGZyb21kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZHRvZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgLy8gY2R0b2RhdGU6IG1vbWVudCgKICAgICAgICAvLyAgIFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpCiAgICAgICAgLy8gKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBhcHBvaW5tZW50X3N0YXR1czogIkFjdGl2ZSIKICAgICAgfSwKICAgICAgLy9UZXN0CiAgICAgIC8vIGRvY3RvckFwcG9pbnRtZW50OiB7CiAgICAgIC8vICAgY2Rmcm9tZGF0ZTogIjAxLzAxLzIwMjEiLAogICAgICAvLyAgIGNkdG9kYXRlOiAiMDEvMDEvMjAyMiIsCiAgICAgIC8vICAgYXBwb2lubWVudF9zdGF0dXM6ICJBbGwiLAogICAgICAvLyB9LAogICAgICBhcHBvaW50bWVudFByZXNjcmlwdGlvbjogewogICAgICAgIGNkcHJlc2NyaXB0aW9uX2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGNkZm9sb3d1cF9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSArIDcpKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGZpZ3VyZV9zaG93X2luX3ByZXNjcmlwdGlvbjogdHJ1ZSwKICAgICAgICBmYW1pbHlIaXN0b3J5X3Nob3dfaW5fcHJlc2NyaXB0aW9uOiB0cnVlLAogICAgICAgIHBhc3RIaXN0b3J5X3Nob3dfaW5fcHJlc2NyaXB0aW9uOiB0cnVlLAogICAgICAgIGFsbEFkdmljZTogZmFsc2UsCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkNvbXBsaWFudHM6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25PbkV4YW1pbmF0aW9uOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmlndXJlOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbjogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkRpYWdub3NpczogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZhbWlseUhpc3Rvcnk6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25QYXN0SGlzdG9yeTogW10sCiAgICAgICAgbHN0TnV0cml0aW9uOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9LAogICAgICBtZWRpY2luZVR5cGVMaXN0OiBbXSwKICAgICAgbWVkaWNpbmVMaXN0OiBbXSwKICAgICAgdHJlYXRtZW50UnVsZXNMaXN0OiBbXSwKICAgICAgdHJlYXRtZW50RHVyYXRpb25MaXN0OiBbXSwKICAgICAgdHJlYXRtZW50RG9zZUxpc3Q6IFtdLAogICAgICAvLyBjYW52YXMKICAgICAgY2FudmFzOiBudWxsLAogICAgICBjb250ZXh0OiBudWxsLAogICAgICBpc0RyYXdpbmc6IGZhbHNlLAogICAgICBzdGFydFg6IDAsCiAgICAgIHN0YXJ0WTogMCwKICAgICAgcG9pbnRzOiBbXSwKICAgICAgLy8KICAgICAgc3VibWl0dGVkOiBmYWxzZSwKICAgICAgZmlsdGVyczogewogICAgICAgIGdsb2JhbDogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5DT05UQUlOUwogICAgICAgIH0sCiAgICAgICAgbmFtZTogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5pdEZpbHRlcnM6IGZ1bmN0aW9uIGluaXRGaWx0ZXJzKCkgewogICAgICAgIHRoaXMuZmlsdGVycyA9IHsKICAgICAgICAgIGdsb2JhbDogewogICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICAgIH0sCiAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgIG9wZXJhdG9yOiBGaWx0ZXJPcGVyYXRvci5BTkQsCiAgICAgICAgICAgIGNvbnN0cmFpbnRzOiBbewogICAgICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLlNUQVJUU19XSVRICiAgICAgICAgICAgIH1dCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIC8vIHBhc3QgZGF0ZS15ZWFyIGRpc2FibGVkCiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgdmFyIG1vbnRoID0gdG9kYXkuZ2V0TW9udGgoKTsKICAgIHZhciB5ZWFyID0gdG9kYXkuZ2V0RnVsbFllYXIoKTsKICAgIHZhciBwcmV2TW9udGggPSBtb250aCA9PT0gMCA/IDExIDogbW9udGggLSAwOwogICAgdmFyIHByZXZZZWFyID0gcHJldk1vbnRoID09PSAxMSA/IHllYXIgLSAwIDogeWVhcjsKICAgIHRoaXMubWluRGF0ZSA9IG5ldyBEYXRlKCk7CiAgICB0aGlzLm1pbkRhdGUuc2V0TW9udGgocHJldk1vbnRoKTsKICAgIHRoaXMubWluRGF0ZS5zZXRGdWxsWWVhcihwcmV2WWVhcik7CiAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UoKTsKICAgIHRoaXMuZmlndXJlU2V0dXBTZXJ2aWNlID0gbmV3IEZpZ3VyZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudFNlcnZpY2UgPSBuZXcgRG9jdG9yQXBwb2ludG1lbnRTZXJ2aWNlKCk7CiAgICB0aGlzLmNvbW1vblNlcnZpY2UgPSBuZXcgQ29tbW9uU2VydmljZSgpOwogICAgdGhpcy5tZWRpY2luZVR5cGVTZXR1cFNlcnZpY2UgPSBuZXcgTWVkaWNpbmVUeXBlU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLm1lZGljaW5lU2V0dXBTZXJ2aWNlID0gbmV3IE1lZGljaW5lU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgPSBuZXcgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5wcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlID0gbmV3IFByZXNjcmlwdGlvblJlcG9ydFNlcnZpY2UoKTsKICAgIHRoaXMuZW1wbG95ZWVTZXR1cFNlcnZpY2UgPSBuZXcgRW1wbG95ZWVTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMucGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UgPSBuZXcgUGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UoKTsKICAgIHRoaXMucGF0aWVudFJlcG9ydFNlcnZpY2UgPSBuZXcgUGF0aWVudFJlcG9ydFNlcnZpY2UoKTsKICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0U2VydmljZSA9IG5ldyBQYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3RTZXJ2aWNlKCk7CiAgICB0aGlzLmRpYWdub3Npc1JlcG9ydFNlcnZpY2UgPSBuZXcgRGlhZ25vc2lzUmVwb3J0U2VydmljZSgpOwogICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UgPSBuZXcgUGF0aWVudFByb2ZpbGVTZXJ2aWNlKCk7CiAgICB0aGlzLmRpYWdub3Npc1NldHVwU2VydmljZSA9IG5ldyBEaWFnbm9zaXNTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMudXNlckluZm8gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySW5mbyIpKTsKICAgIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlLmdldEFsbCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLmRpYWdub3Npc0xpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxBcHBvaW5tZW50U3RhdHVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMuYXBwb2lubWVudFN0YXR1c0xpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxQYXRpZW50c1JlbGF0aXZlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLnBhdGllbnRzUmVsYXRpdmVMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CgogICAgaWYgKHRoaXMudXNlckluZm8uZG9jdG9yX2lkKSB7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlLmdldFByZXNjcmlwdGlvbkRhdGFCeURvY3RvcklkKHRoaXMudXNlckluZm8uZG9jdG9yX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy5kb2N0b3JfaWQgPSB0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZDsKICAgICAgdGhpcy5zaG93KCk7CiAgICB9CgogICAgaWYgKHRoaXMudXNlckluZm8uZW1wbG95ZWVfaWQpIHsKICAgICAgdGhpcy5lbXBsb3llZVNldHVwU2VydmljZS5nZXRCeUlkKHRoaXMudXNlckluZm8uZW1wbG95ZWVfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMuZW1wbG95ZWVGb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9CgogICAgdGhpcy5tZWRpY2luZVR5cGVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy5tZWRpY2luZVR5cGVMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLm1lZGljaW5lU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMubWVkaWNpbmVMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLnRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMudHJlYXRtZW50UnVsZXNMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMudHJlYXRtZW50RHVyYXRpb25MaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLnRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy50cmVhdG1lbnREb3NlTGlzdCA9IGRhdGEuZGF0YTsKICAgIH0pOyAvL3RoaXMuc2hvdygpOwoKICAgIHRoaXMubmV3UHJlc2NyaXB0aW9uKCk7CiAgICB2YXIgdGhhdCA9IHRoaXM7CgogICAgZG9jdW1lbnQub25rZXl1cCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2NykgewogICAgICAgIHRoYXQuZ2V0UGF0aWVudENvbXBsYWludHMoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2OSkgewogICAgICAgIHRoYXQuZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpOwogICAgICAgIHRoYXQuZ2V0T25FeGFtaW5hdGlvbnMoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA3MCkgewogICAgICAgIHRoYXQuZ2V0RmlndXJlKCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzMpIHsKICAgICAgICB0aGF0LmdldEludmVzdGlnYXRpb24oKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2OCkgewogICAgICAgIHRoYXQuZ2V0RGlhZ25vc2lzKCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzIpIHsKICAgICAgICB0aGF0LmdldEZhbWlseUhpc3RvcnkoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4MCkgewogICAgICAgIHRoYXQuZ2V0UGFzdEhpc3RvcnkoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4NCkgewogICAgICAgIHRoYXQuZ2V0VHJlYXRtZW50KCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNjUpIHsKICAgICAgICB0aGF0LmdldEFkdmljZSgpOwogICAgICB9IC8vIGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLnNoaWZ0S2V5KSB7CiAgICAgIC8vIH0KCiAgICB9OwoKICAgIHZhciBwcmVzY3JpcHRpb25EYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJlc2NyaXB0aW9uRGF0YScpKTsKCiAgICBpZiAocHJlc2NyaXB0aW9uRGF0YSkgewogICAgICB0aGlzLnByZXNjcmlwdGlvbihwcmVzY3JpcHRpb25EYXRhKTsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3ByZXNjcmlwdGlvbkRhdGEnKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGVtcGxveWVlRm9ybWF0dGVkOiBmdW5jdGlvbiBlbXBsb3llZUZvcm1hdHRlZChkYXRhKSB7CiAgICAgIHRoaXMuZG9jdG9yX2lkID0gZGF0YS5hc3Npc3RhbnRfb2ZfZG9jdG9yX2lkOwogICAgICB0aGlzLmlzQXNzaXN0YW50ID0gdHJ1ZTsKICAgICAgdGhpcy5zaG93KCk7CiAgICB9LAogICAgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KCkgewogICAgICB0aGlzLmRvY3RvckFwcG9pbnRtZW50ID0gewogICAgICAgIGNkZnJvbWRhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGNkdG9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICAvLyBjZHRvZGF0ZTogbW9tZW50KAogICAgICAgIC8vICAgU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSArIDcpKSkKICAgICAgICAvLyApLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGFwcG9pbm1lbnRfc3RhdHVzOiAiQWN0aXZlIgogICAgICB9OyAvLyB0aGlzLmRhdGFMaXN0ID0gdHJ1ZTsKICAgICAgLy8gdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKCiAgICAgIHRoaXMuc2hvdygpOwogICAgfSwKICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLmRvY3RvckFwcG9pbnRtZW50LmNkZnJvbWRhdGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuZG9jdG9yQXBwb2ludG1lbnQuY2R0b2RhdGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuZG9jdG9yQXBwb2ludG1lbnQuYXBwb2lubWVudF9zdGF0dXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudC5mcm9tZGF0ZSA9IG1vbWVudChTdHJpbmcodGhpcy5kb2N0b3JBcHBvaW50bWVudC5jZGZyb21kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudC50b2RhdGUgPSBtb21lbnQoU3RyaW5nKHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuY2R0b2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICB0aGlzLmRvY3RvckFwcG9pbnRtZW50U2VydmljZS5nZXREeW5hbWljRG9jdG9yV2lzZSh0aGlzLmRvY3RvckFwcG9pbnRtZW50LmZyb21kYXRlLCB0aGlzLmRvY3RvckFwcG9pbnRtZW50LnRvZGF0ZSwgdGhpcy5kb2N0b3JBcHBvaW50bWVudC5hcHBvaW5tZW50X3N0YXR1cywgdGhpcy5kb2N0b3JfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuZG9jdG9yQXBwb2ludG1lbnRMaXN0ID0gZGF0YS5kYXRhOwogICAgICAgIH0pOwogICAgICB9CgogICAgICB0aGlzLmRhdGFMaXN0ID0gdHJ1ZTsKICAgICAgdGhpcy5pc0hpc3RvcnkgPSBmYWxzZTsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgIH0sCiAgICAvLwogICAgaXNOYW1lRXhpc3RzOiBmdW5jdGlvbiBpc05hbWVFeGlzdHMobGlzdCwgY29sdW1uLCB2YWx1ZSkgewogICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7CiAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIGlmIChlbGVtZW50W2NvbHVtbl0gPT0gdmFsdWUpIHsKICAgICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICB0aGlzLiR0b2FzdC5hZGQoewogICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgZGV0YWlsOiAiRHVwbGljYXRlIERhdGEiLAogICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBuZXdDdXJyZW50TWVkaWNhdGlvbnM6IGZ1bmN0aW9uIG5ld0N1cnJlbnRNZWRpY2F0aW9ucygpIHsKICAgICAgdGhpcy5jdXJyZW50TWVkaWNhdGlvbnNEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZEN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gYWRkQ3VycmVudE1lZGljYXRpb25zKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLmN1cnJlbnRNZWRpY2F0aW9ucy5tZWRpY2luZV9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczMuY3VycmVudE1lZGljYXRpb25zLnRyZWF0bWVudF9ydWxlc19pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGlmIChfdGhpczMuY3VycmVudE1lZGljYXRpb25zLnRyZWF0bWVudF9kdXJhdGlvbl9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgaWYgKF90aGlzMy5jdXJyZW50TWVkaWNhdGlvbnMudHJlYXRtZW50X2Rvc2VfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIGlmIChfdGhpczMuY3VycmVudE1lZGljYXRpb25zLnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIGlmICghX3RoaXMzLmlzTmFtZUV4aXN0cyhfdGhpczMuY3VycmVudE1lZGljYXRpb25zTGlzdCwgJ21lZGljaW5lX2lkJywgX3RoaXMzLmN1cnJlbnRNZWRpY2F0aW9ucy5tZWRpY2luZV9pZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmN1cnJlbnRNZWRpY2F0aW9uc1NhdmUoX3RoaXMzLmN1cnJlbnRNZWRpY2F0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzLmdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKF90aGlzMy5jdXJyZW50TWVkaWNhdGlvbnMucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczMuY3VycmVudE1lZGljYXRpb25zRGlhbG9nID0gZmFsc2U7CgogICAgICAgICAgICAgICAgICBfdGhpczMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY29uZmlybURlbGV0ZUN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gY29uZmlybURlbGV0ZUN1cnJlbnRNZWRpY2F0aW9ucyhkYXRhKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy4kY29uZmlybS5yZXF1aXJlKHsKICAgICAgICBtZXNzYWdlOiAnRG8geW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgcmVjb3JkPycsCiAgICAgICAgaGVhZGVyOiAnRGVsZXRlIENvbmZpcm1hdGlvbicsCiAgICAgICAgaWNvbjogJ3BpIHBpLWluZm8tY2lyY2xlJywKICAgICAgICBhY2NlcHRDbGFzczogJ3AtYnV0dG9uLWRhbmdlcicsCiAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICBfdGhpczQuZGVsZXRlQ3VycmVudE1lZGljYXRpb25zKGRhdGEpOwogICAgICAgIH0sCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QoKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZWxldGVDdXJyZW50TWVkaWNhdGlvbnM6IGZ1bmN0aW9uIGRlbGV0ZUN1cnJlbnRNZWRpY2F0aW9ucyhkYXRhKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNS5wYXRpZW50UHJvZmlsZVNlcnZpY2UuY3VycmVudE1lZGljYXRpb25zRGVsZXRlKGRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAyKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNS5nZXRDdXJyZW50TWVkaWNhdGlvbnNCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM1LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbmV3UGFzdE1lZGljYWxIaXN0b3J5OiBmdW5jdGlvbiBuZXdQYXN0TWVkaWNhbEhpc3RvcnkoKSB7CiAgICAgIHRoaXMucGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBhZGRQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGFkZFBhc3RNZWRpY2FsSGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2LnBhc3RNZWRpY2FsSGlzdG9yeS5kaWFnbm9zaXNfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczYucGFzdE1lZGljYWxIaXN0b3J5LnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGlmICghX3RoaXM2LmlzTmFtZUV4aXN0cyhfdGhpczYucGFzdE1lZGljYWxIaXN0b3J5TGlzdCwgJ2RpYWdub3Npc19pZCcsIF90aGlzNi5wYXN0TWVkaWNhbEhpc3RvcnkuZGlhZ25vc2lzX2lkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5wYXRpZW50UHJvZmlsZVNlcnZpY2UucGFzdEhpc3RvcnlTYXZlKF90aGlzNi5wYXN0TWVkaWNhbEhpc3RvcnkpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQzLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczYuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChfdGhpczYucGFzdE1lZGljYWxIaXN0b3J5LnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM2LnBhc3RNZWRpY2FsSGlzdG9yeURpYWxvZyA9IGZhbHNlOwoKICAgICAgICAgICAgICAgICAgX3RoaXM2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY29uZmlybURlbGV0ZVBhc3RNZWRpY2FsSGlzdG9yeTogZnVuY3Rpb24gY29uZmlybURlbGV0ZVBhc3RNZWRpY2FsSGlzdG9yeShkYXRhKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdGhpcy4kY29uZmlybS5yZXF1aXJlKHsKICAgICAgICBtZXNzYWdlOiAnRG8geW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgcmVjb3JkPycsCiAgICAgICAgaGVhZGVyOiAnRGVsZXRlIENvbmZpcm1hdGlvbicsCiAgICAgICAgaWNvbjogJ3BpIHBpLWluZm8tY2lyY2xlJywKICAgICAgICBhY2NlcHRDbGFzczogJ3AtYnV0dG9uLWRhbmdlcicsCiAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICBfdGhpczcuZGVsZXRlUGFzdE1lZGljYWxIaXN0b3J5KGRhdGEpOwogICAgICAgIH0sCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QoKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZWxldGVQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGRlbGV0ZVBhc3RNZWRpY2FsSGlzdG9yeShkYXRhKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOC5wYXRpZW50UHJvZmlsZVNlcnZpY2UucGFzdEhpc3RvcnlEZWxldGUoZGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM4LmdldFBhc3RIaXN0b3J5QnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGhpZGVIaXN0b3J5OiBmdW5jdGlvbiBoaWRlSGlzdG9yeSgpIHsKICAgICAgdGhpcy5pc0hpc3RvcnkgPSBmYWxzZTsKICAgIH0sCiAgICBwYXRpZW50SGlzdG9yeVNhdmU6IGZ1bmN0aW9uIHBhdGllbnRIaXN0b3J5U2F2ZSgpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM5LnBhdGllbnRIaXN0b3J5LnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczkucGF0aWVudFByb2ZpbGVTZXJ2aWNlLnBhdGllbnRIaXN0b3J5U2F2ZShfdGhpczkucGF0aWVudEhpc3RvcnksIF90aGlzOSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NS5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM5LmhpZGVIaXN0b3J5KCk7CgogICAgICAgICAgICAgICAgICBfdGhpczkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzOS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGhpc3RvcnlDb2xsZWN0aW9uOiBmdW5jdGlvbiBoaXN0b3J5Q29sbGVjdGlvbihkYXRhKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIGlmIChkYXRhLmFQYXRpZW50LmdlbmRlciA9PSAiRmVtYWxlIikgewogICAgICAgIHRoaXMuaXNGZW1hbGUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNGZW1hbGUgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5jdXJyZW50TWVkaWNhdGlvbnMucGF0aWVudF9pZCA9IGRhdGEuYVBhdGllbnQucGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9pZCA9IGRhdGEuYVBhdGllbnQucGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50SGlzdG9yeS5wYXRpZW50X2lkID0gZGF0YS5hUGF0aWVudC5wYXRpZW50X2lkOwogICAgICB0aGlzLmdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKGRhdGEuYVBhdGllbnQucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChkYXRhLmFQYXRpZW50LnBhdGllbnRfaWQpOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRTeXN0ZW1TdWJzdGFuY2UoZGF0YS5hUGF0aWVudC5wYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTAuZm9ybWF0dGVkU3lzdGVtU3Vic3RhbmNlKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgICB0aGlzLnBhdGllbnRSZWdpc3RyYXRpb25TZXJ2aWNlLmdldEJ5SWQoZGF0YS5hUGF0aWVudC5wYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTAucGF0aWVudEluZm9Gb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0U2VydmljZS5wYXRpZW50V2lzZShkYXRhLmFQYXRpZW50LnBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMC5pbnZlc3RpZ2F0aW9uUmVzdWx0TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuaXNIaXN0b3J5ID0gdHJ1ZTsKICAgIH0sCiAgICBmb3JtYXR0ZWRTeXN0ZW1TdWJzdGFuY2U6IGZ1bmN0aW9uIGZvcm1hdHRlZFN5c3RlbVN1YnN0YW5jZShkYXRhKSB7CiAgICAgIHRoaXMucGF0aWVudEhpc3RvcnkubHN0UGVyc29uYWxIaXN0b3J5ID0gZGF0YS5sc3RQZXJzb25hbEhpc3Rvcnk7CiAgICAgIHRoaXMucGF0aWVudEhpc3RvcnkubHN0RmFtaWx5SGlzdG9yeSA9IGRhdGEubHN0RmFtaWx5SGlzdG9yeTsKICAgICAgdGhpcy5wYXRpZW50SGlzdG9yeS5sc3RTeXN0ZW1zUmV2aWV3ID0gZGF0YS5sc3RTeXN0ZW1zUmV2aWV3OwogICAgICB0aGlzLnBhdGllbnRIaXN0b3J5LmxzdFN1YnN0YW5jZVVzZSA9IGRhdGEubHN0U3Vic3RhbmNlVXNlOwogICAgICB0aGlzLnBhdGllbnRIaXN0b3J5LmxzdFJlcHJvZHVjdGl2ZUhpc3RvcnkgPSBkYXRhLmxzdFJlcHJvZHVjdGl2ZUhpc3Rvcnk7CiAgICB9LAogICAgZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczExLmN1cnJlbnRNZWRpY2F0aW9uc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFBhc3RIaXN0b3J5QnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldFBhc3RIaXN0b3J5QnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CgogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5wYXN0TWVkaWNhbEhpc3RvcnlMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBwYXRpZW50SW5mb0Zvcm1hdHRlZDogZnVuY3Rpb24gcGF0aWVudEluZm9Gb3JtYXR0ZWQoZGF0YSkgewogICAgICB0aGlzLnBhdGllbnQgPSBkYXRhOwogICAgICB0aGlzLnBhdGllbnQuZG9iID0gbW9tZW50KFN0cmluZyhkYXRhLmRvYikpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgfSwKICAgIGZvcm1hdERhdGUyOiBmdW5jdGlvbiBmb3JtYXREYXRlMih2YWx1ZSkgewogICAgICByZXR1cm4gbW9tZW50KFN0cmluZyh2YWx1ZSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgfSwKICAgIHJlcG9ydFByaW50OiBmdW5jdGlvbiByZXBvcnRQcmludChiYXJjb2RlX29yX2xldmVsLCB0ZW1wbGF0ZV9uYW1lKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIHRoaXMuZGlhZ25vc2lzUmVwb3J0U2VydmljZS5HZXRJbnZlc3RpZ2F0aW9uUmVwb3J0VGVtcGxhdGVXaXNlKGJhcmNvZGVfb3JfbGV2ZWwsIHRlbXBsYXRlX25hbWUsIHRoaXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMy5jb21tb25TZXJ2aWNlLkRvd25sb2FkZmlsZShkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBwcmVzY3JpcHRpb246IGZ1bmN0aW9uIHByZXNjcmlwdGlvbihkYXRhKSB7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRJbmZvLmFwcG9pbm1lbnRfaWQgPSBkYXRhLmFwcG9pbm1lbnRfaWQ7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRJbmZvLnBhdGllbnRSZWcgPSBkYXRhLmFQYXRpZW50LnJlZ2lzdHJhdGlvbl9ubzsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8ucGF0aWVudE5hbWUgPSBkYXRhLmFQYXRpZW50LmZpcnN0X25hbWUgKyAiICIgKyBkYXRhLmFQYXRpZW50Lmxhc3RfbmFtZTsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8ucGF0aWVudEdlbmRlciA9IGRhdGEuYVBhdGllbnQuZ2VuZGVyOwogICAgICB0aGlzLmFwcG9pbnRtZW50SW5mby5wYXRpZW50QWdlWWVhciA9IGRhdGEuYVBhdGllbnQuYWdlX3llYXI7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRJbmZvLnBhdGllbnRBZ2VNb250aCA9IGRhdGEuYVBhdGllbnQuYWdlX21vbnRoOwogICAgICB0aGlzLmFwcG9pbnRtZW50SW5mby5wYXRpZW50QWdlRGF5ID0gZGF0YS5hUGF0aWVudC5hZ2VfZGF5OyAvLyB2YXIgcGF0aWVudERPQiA9IG1vbWVudChTdHJpbmcoZGF0YS5hUGF0aWVudC5kb2IpKS5mb3JtYXQoCiAgICAgIC8vICAgIk1NL0REL1lZWVkiCiAgICAgIC8vICk7CiAgICAgIC8vdGhpcy5hcHBvaW50bWVudEluZm8uYWdlID0gTWF0aC5mbG9vcihtb21lbnQobmV3IERhdGUoKSkuZGlmZihtb21lbnQocGF0aWVudERPQiwgIk1NL0REL1lZWVkiKSwgJ3llYXJzJywgdHJ1ZSkpOwogICAgICAvL3RoaXMuYXBwb2ludG1lbnRJbmZvLmFnZSA9IG1vbWVudChwYXRpZW50RE9CLCAiTU0vREQvWVlZWSIpLmZyb21Ob3coKS5zcGxpdCgiICIpWzBdOwoKICAgICAgdGhpcy5kYXRhTGlzdCA9IGZhbHNlOwogICAgfSwKICAgIHZpZXdQYXRpZW50UHJvZmlsZTogZnVuY3Rpb24gdmlld1BhdGllbnRQcm9maWxlKHBhdGllbnRfaWQpIHsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BhdGllbnRJZF9mb3JfcHJvZmlsZScsIHBhdGllbnRfaWQpOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL3BhdGllbnQtcHJvZmlsZSIpOwogICAgfSwKICAgIHByZXZpb3VzUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBwcmV2aW91c1ByZXNjcmlwdGlvbihwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKCiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlLmdldFBhdGllbnRXaXNlUHJlc2NyaXB0aW9uTGlzdChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTQucHJldlByZXNjcmlwdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnByZXZQcmVzY3JpcHRpb25EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGRvd25sb2FkUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBkb3dubG9hZFByZXNjcmlwdGlvbihhcHBvaW5tZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczE1ID0gdGhpczsKCiAgICAgIHRoaXMucHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZS5HZXRQZXNjcmlwdGlvbihhcHBvaW5tZW50X2lkLCB0aGlzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTUuY29tbW9uU2VydmljZS5Eb3dubG9hZGZpbGUoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgZm9ybWF0RGF0ZTogZnVuY3Rpb24gZm9ybWF0RGF0ZSh2YWx1ZSkgewogICAgICByZXR1cm4gbW9tZW50KFN0cmluZyh2YWx1ZSkpLmZvcm1hdCgiTU0vREQvWVlZWSBoOm1tOnNzIGEiKTsKICAgIH0sCiAgICBjaGVja0RhdGU6IGZ1bmN0aW9uIGNoZWNrRGF0ZShkYXRlKSB7CiAgICAgIHZhciB0b2RheSA9IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgICB2YXIgYXBwdERhdGUgPSBtb21lbnQoU3RyaW5nKGRhdGUpKS5mb3JtYXQoIk1NL0REL1lZWVkiKTsKCiAgICAgIGlmICh0b2RheSA9PSBhcHB0RGF0ZSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIC8vCiAgICBnZXRQYXRpZW50Q29tcGxhaW50czogZnVuY3Rpb24gZ2V0UGF0aWVudENvbXBsYWludHMoKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJQYXRpZW50IENvbXBsYWludHMiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdENvbXBsYWludC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxNi50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuY29tcGlsYW50c19uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuY29tcGlsYW50c19pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwOiBmdW5jdGlvbiBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwKCkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICB0aGlzLnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0T25FeGFtaW5hdGlvbi5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxNy5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQub25fZXhhbWluYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX2lkLAogICAgICAgICAgb25fZXhhbWluYXRpb25fcmVzdWx0OiAxCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25Qb3B1cERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZ2V0T25FeGFtaW5hdGlvbnM6IGZ1bmN0aW9uIGdldE9uRXhhbWluYXRpb25zKCkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgICAvL3RoaXMuZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpOwogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiT24gRXhhbWluYXRpb25zIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RPbkV4YW1pbmF0aW9uLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczE4LnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5vbl9leGFtaW5hdGlvbl9uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQub25fZXhhbWluYXRpb25faWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0RmlndXJlOiBmdW5jdGlvbiBnZXRGaWd1cmUoKSB7CiAgICAgIHZhciBfdGhpczE5ID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJGaWd1cmUiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdEZpZ3VyZVNldHVwLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczE5LnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5maWd1cmVfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmZpZ3VyZV9pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRJbnZlc3RpZ2F0aW9uOiBmdW5jdGlvbiBnZXRJbnZlc3RpZ2F0aW9uKCkgewogICAgICB2YXIgX3RoaXMyMCA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiSW52ZXN0aWdhdGlvbiI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0SW52ZXN0aWdhdGlvbi5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMyMC50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuaW52ZXN0aW5nYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmludmVzdGlnYXRpb25faWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0RGlhZ25vc2lzOiBmdW5jdGlvbiBnZXREaWFnbm9zaXMoKSB7CiAgICAgIHZhciBfdGhpczIxID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJEaWFnbm9zaXMiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdERpYWdub3Npcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMyMS50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuZGlhZ25vc2lzX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5kaWFnbm9zaXNfaWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0RmFtaWx5SGlzdG9yeTogZnVuY3Rpb24gZ2V0RmFtaWx5SGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzMjIgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIkZhbWlseSBIaXN0b3J5IjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3REaWFnbm9zaXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzMjIudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50LmRpYWdub3Npc19uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuZGlhZ25vc2lzX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFBhc3RIaXN0b3J5OiBmdW5jdGlvbiBnZXRQYXN0SGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzMjMgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIlBhc3QgSGlzdG9yeSI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0RGlhZ25vc2lzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczIzLnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5kaWFnbm9zaXNfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmRpYWdub3Npc19pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBmaWx0ZXJNZWRpY2luZVR5cGVXaXNlOiBmdW5jdGlvbiBmaWx0ZXJNZWRpY2luZVR5cGVXaXNlKCkgewogICAgICBpZiAodGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlKSB7CiAgICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlLnRleHQ7CiAgICAgICAgcmV0dXJuIHRoaXMubWVkaWNpbmVMaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5yZWZpZCA9PT0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlLnZhbHVlOwogICAgICAgIH0sIHRoaXMpOwogICAgICB9CiAgICB9LAogICAgZ2V0VHJlYXRtZW50OiBmdW5jdGlvbiBnZXRUcmVhdG1lbnQoKSB7CiAgICAgIHRoaXMudHJlYXRtZW50QWRkRGlhbG9nID0gdHJ1ZTsgLy8gdGhpcy5oZWFkZXJOYW1lID0gIk1lZGljaW5lIjsKICAgICAgLy8gdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICAvLyB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIC8vIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgLy8gdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RUcmVhdG1lbnQuZm9yRWFjaCgoZWxlbWVudCkgPT4gewogICAgICAvLyAgIHRoaXMudGVtcERhdGEucHVzaCh7CiAgICAgIC8vICAgICBfbWVkaWNpbmVfdHlwZV9uYW1lOiBlbGVtZW50Ll9tZWRpY2luZV90eXBlX25hbWUsCiAgICAgIC8vICAgICBfbWVkaWNpbmVfbmFtZTogZWxlbWVudC5fbWVkaWNpbmVfbmFtZSwKICAgICAgLy8gICAgIG5hbWU6IGVsZW1lbnQuX21lZGljaW5lX3R5cGVfbmFtZSArICIgIiArIGVsZW1lbnQuX21lZGljaW5lX25hbWUgKyAiICIgKyBlbGVtZW50Ll90cmVhdG1lbnRfZG9zZV9uYW1lICsgIiAiICsgZWxlbWVudC5fdHJlYXRtZW50X3J1bGVfbmFtZSArICIgIiArIGVsZW1lbnQuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAvLyAgICAgaWQ6IGVsZW1lbnQubWVkaWNpbmVfaWQsCiAgICAgIC8vICAgICBfdHJlYXRtZW50X2Rvc2VfbmFtZTogZWxlbWVudC5fdHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgLy8gICAgIHRyZWF0bWVudF9kb3NlX2lkOiBlbGVtZW50LnRyZWF0bWVudF9kb3NlX2lkLAogICAgICAvLyAgICAgX3RyZWF0bWVudF9ydWxlX25hbWU6IGVsZW1lbnQuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgIC8vICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IGVsZW1lbnQudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAvLyAgICAgX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lOiBlbGVtZW50Ll90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgLy8gICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogZWxlbWVudC50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgIC8vICAgICBkZXNjcmlwdGlvbjogZWxlbWVudC5kZXNjcmlwdGlvbiwKICAgICAgLy8gICB9KTsKICAgICAgLy8gfSk7CiAgICB9LAogICAgc2F2ZVRyZWF0bWVudDogZnVuY3Rpb24gc2F2ZVRyZWF0bWVudCgpIHsKICAgICAgZGVidWdnZXI7CiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZV90eXBlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcykgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGFNZWRpY2luZSA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwubWVkaWNpbmVfaWQgPT09IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudmFsdWU7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYU1lZGljaW5lLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50LnB1c2goewogICAgICAgICAgICBfbWVkaWNpbmVfdHlwZV9uYW1lOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lX3R5cGUudGV4dCwKICAgICAgICAgICAgbmFtZTogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS50ZXh0LAogICAgICAgICAgICBtZWRpY2luZV9pZDogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS52YWx1ZSwKICAgICAgICAgICAgX3RyZWF0bWVudF9kb3NlX25hbWU6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudGV4dCwKICAgICAgICAgICAgdHJlYXRtZW50X2Rvc2VfaWQ6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudmFsdWUsCiAgICAgICAgICAgIF90cmVhdG1lbnRfcnVsZV9uYW1lOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy50ZXh0LAogICAgICAgICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnZhbHVlLAogICAgICAgICAgICBfdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnRleHQsCiAgICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udmFsdWUsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIgogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmhpZGVEaWFsb2coKTsKICAgICAgfQogICAgfSwKICAgIGdldEFkdmljZTogZnVuY3Rpb24gZ2V0QWR2aWNlKCkgewogICAgICB2YXIgX3RoaXMyNCA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiQWR2aWNlIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gdHJ1ZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdEFkdmljZXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzMjQudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50LmFkdmljZV9uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuYWR2aWNlX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGFkZE9uRXhhbWluYXRpb25Gcm9tUG9wdXA6IGZ1bmN0aW9uIGFkZE9uRXhhbWluYXRpb25Gcm9tUG9wdXAoKSB7CiAgICAgIHZhciBfdGhpczI1ID0gdGhpczsKCiAgICAgIC8vdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAvL3RoaXMucmVxdXJlZCA9ICIiOwogICAgICB0aGlzLnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBpZiAoZWxlbWVudC5vbl9leGFtaW5hdGlvbl9yZXN1bHQpIHsKICAgICAgICAgIC8vdGhpcy5yZXF1cmVkID0gInJlcXVpcmVkIjsKICAgICAgICAgIHZhciBhT25FeGFtaW5hdGlvbnMgPSBfdGhpczI1LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25PbkV4YW1pbmF0aW9uLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgcmV0dXJuIGVsLm9uX2V4YW1pbmF0aW9uX2lkID09PSBlbGVtZW50LmlkOwogICAgICAgICAgfSwgX3RoaXMyNSk7CgogICAgICAgICAgaWYgKCFhT25FeGFtaW5hdGlvbnMubGVuZ3RoKSB7CiAgICAgICAgICAgIF90aGlzMjUuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb24ucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogZWxlbWVudC5uYW1lLAogICAgICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX2lkOiBlbGVtZW50LmlkLAogICAgICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX3Jlc3VsdDogZWxlbWVudC5vbl9leGFtaW5hdGlvbl9yZXN1bHQudG9TdHJpbmcoKQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOyAvLyBpZiAodGhpcy5yZXF1cmVkKSB7CiAgICAgIC8vICAgdGhpcy4kdG9hc3QuYWRkKHsKICAgICAgLy8gICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAvLyAgICAgc3VtbWFyeTogIlJlcXVpcmVkIiwKICAgICAgLy8gICAgIGRldGFpbDogIlBsZWFzZSBmaWxsIGluIHRoZSByZXF1aXJlZCBmaWVsZHMiLAogICAgICAvLyAgICAgbGlmZTogMTAwMDAsCiAgICAgIC8vICAgfSk7CiAgICAgIC8vICAgcmV0dXJuOwogICAgICAvLyB9CgogICAgICB0aGlzLm9uRXhhbWluYXRpb25Qb3B1cERpYWxvZyA9IGZhbHNlOwogICAgfSwKICAgIC8vIGFkZCBhbGwgYWR2aWNlIGNoZWNrYm94CiAgICBhZGRBbGxBZHZpY2U6IGZ1bmN0aW9uIGFkZEFsbEFkdmljZSgpIHsKICAgICAgdmFyIF90aGlzMjYgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmFsbEFkdmljZSkgewogICAgICAgIHRoaXMudGVtcERhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgdmFyIGFBZHZpY2UgPSBfdGhpczI2LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25BZHZpY2UuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICByZXR1cm4gZWwuYWR2aWNlX2lkID09PSBlbGVtZW50LmlkOwogICAgICAgICAgfSwgX3RoaXMyNik7CgogICAgICAgICAgaWYgKCFhQWR2aWNlLmxlbmd0aCkgewogICAgICAgICAgICBfdGhpczI2LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25BZHZpY2UucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogZWxlbWVudC5uYW1lLAogICAgICAgICAgICAgIGFkdmljZV9pZDogZWxlbWVudC5pZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIGFkZCB2YWx1ZSAKICAgIGdldFZhbHVlOiBmdW5jdGlvbiBnZXRWYWx1ZShkYXRhKSB7CiAgICAgIHZhciBfdGhpczI3ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIlBhdGllbnQgQ29tcGxhaW50cyIpIHsKICAgICAgICB2YXIgYUNvbXBsaWFudHMgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25Db21wbGlhbnRzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5jb21waWxhbnRzX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFDb21wbGlhbnRzLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQ29tcGxpYW50cy5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICBjb21waWxhbnRzX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJPbiBFeGFtaW5hdGlvbnMiKSB7CiAgICAgICAgdmFyIGFPbkV4YW1pbmF0aW9ucyA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb24uZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLm9uX2V4YW1pbmF0aW9uX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFPbkV4YW1pbmF0aW9ucy5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMub25FeGFtaW5hdGlvbi5sYWJlbCA9IGRhdGEubmFtZTsKICAgICAgICAgIHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9pZCA9IGRhdGEuaWQ7CiAgICAgICAgICB0aGlzLm9uRXhhbWluYXRpb24ub25fZXhhbWluYXRpb25fcmVzdWx0ID0gMTsKICAgICAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiRmlndXJlIikgewogICAgICAgIHZhciBhRmlndXJlID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmlndXJlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5maWd1cmVfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUZpZ3VyZS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuZmlndXJlRGlhbG9nID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZmlndXJlLm5hbWUgPSBkYXRhLm5hbWU7CiAgICAgICAgICB0aGlzLmZpZ3VyZS5maWd1cmVfaWQgPSBkYXRhLmlkOwogICAgICAgICAgdGhpcy5maWd1cmVTZXR1cFNlcnZpY2UuZ2V0QnlJZChkYXRhLmlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczI3LmdldEZpZ3VyZUZvcm1hdHRlZChkYXRhLmRhdGEpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiSW52ZXN0aWdhdGlvbiIpIHsKICAgICAgICB2YXIgYUludmVzdGlnYXRpb24gPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5pbnZlc3RpZ2F0aW9uX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFJbnZlc3RpZ2F0aW9uLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbi5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICBpbnZlc3RpZ2F0aW9uX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJEaWFnbm9zaXMiKSB7CiAgICAgICAgdmFyIGFEaWFnbm9zaXMgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25EaWFnbm9zaXMuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmRpYWdub3Npc19pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhRGlhZ25vc2lzLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRGlhZ25vc2lzLnB1c2goewogICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgICAgIGRpYWdub3Npc19pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiRmFtaWx5IEhpc3RvcnkiKSB7CiAgICAgICAgdmFyIGFGYW1pbHlIaXN0b3J5ID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmFtaWx5SGlzdG9yeS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuZGlhZ25vc2lzX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFGYW1pbHlIaXN0b3J5Lmxlbmd0aCkgewogICAgICAgICAgdGhpcy5mYW1pbHlIaXN0b3J5LmRpYWdub3Npc19pZCA9IGRhdGEuaWQ7CiAgICAgICAgICB0aGlzLmZhbWlseUhpc3RvcnkubmFtZSA9IGRhdGEubmFtZTsKICAgICAgICAgIHRoaXMuZmFtaWx5SGlzdG9yeURpYWxvZyA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiUGFzdCBIaXN0b3J5IikgewogICAgICAgIHZhciBhUGFzdEhpc3RvcnkgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25QYXN0SGlzdG9yeS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuZGlhZ25vc2lzX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFQYXN0SGlzdG9yeS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblBhc3RIaXN0b3J5LnB1c2goewogICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgICAgIGRpYWdub3Npc19pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnNob3dJblByZXNjcmlwdGlvbih0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25QYXN0SGlzdG9yeSwgIXRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ucGFzdEhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb24pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIk1lZGljaW5lIikgewogICAgICAgIHZhciBhTWVkaWNpbmUgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnQuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLm1lZGljaW5lX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFNZWRpY2luZS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudC5wdXNoKHsKICAgICAgICAgICAgX21lZGljaW5lX3R5cGVfbmFtZTogZGF0YS5fbWVkaWNpbmVfdHlwZV9uYW1lLAogICAgICAgICAgICBuYW1lOiBkYXRhLl9tZWRpY2luZV9uYW1lLAogICAgICAgICAgICBtZWRpY2luZV9pZDogZGF0YS5pZCwKICAgICAgICAgICAgX3RyZWF0bWVudF9kb3NlX25hbWU6IGRhdGEuX3RyZWF0bWVudF9kb3NlX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9kb3NlX2lkOiBkYXRhLnRyZWF0bWVudF9kb3NlX2lkLAogICAgICAgICAgICBfdHJlYXRtZW50X3J1bGVfbmFtZTogZGF0YS5fdHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgICAgICAgdHJlYXRtZW50X3J1bGVzX2lkOiBkYXRhLnRyZWF0bWVudF9ydWxlc19pZCwKICAgICAgICAgICAgX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lOiBkYXRhLl90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgICAgICAgdHJlYXRtZW50X2R1cmF0aW9uX2lkOiBkYXRhLnRyZWF0bWVudF9kdXJhdGlvbl9pZCwKICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIkFkdmljZSIpIHsKICAgICAgICB2YXIgYUFkdmljZSA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkFkdmljZS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuYWR2aWNlX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFBZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25BZHZpY2UucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgYWR2aWNlX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBoaWRlRGlhbG9nOiBmdW5jdGlvbiBoaWRlRGlhbG9nKCkgewogICAgICB0aGlzLmN1cnJlbnRNZWRpY2F0aW9uc0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnBhc3RNZWRpY2FsSGlzdG9yeURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uUG9wdXBEaWFsb2cgPSBmYWxzZTsgLy90aGlzLmVkaXRPbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7CgogICAgICB0aGlzLmZpZ3VyZURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmZhbWlseUhpc3RvcnlEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy50cmVhdG1lbnRBZGREaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy50cmVhdG1lbnREaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5wcmV2UHJlc2NyaXB0aW9uRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICB9LAogICAgYWRkT25FeGFtaW5hdGlvbjogZnVuY3Rpb24gYWRkT25FeGFtaW5hdGlvbigpIHsKICAgICAgaWYgKCF0aGlzLmlzRWRpdCkgewogICAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgaWYgKCF0aGlzLm9uRXhhbWluYXRpb24ub25fZXhhbWluYXRpb25fcmVzdWx0KSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb24ucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IHRoaXMub25FeGFtaW5hdGlvbi5sYWJlbCwKICAgICAgICAgICAgb25fZXhhbWluYXRpb25faWQ6IHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9pZCwKICAgICAgICAgICAgb25fZXhhbWluYXRpb25fcmVzdWx0OiB0aGlzLm9uRXhhbWluYXRpb24ub25fZXhhbWluYXRpb25fcmVzdWx0LnRvU3RyaW5nKCkKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmlzRWRpdCkgewogICAgICAgIHRoaXMub25FeGFtaW5hdGlvbkVkaXRTYXZlKCk7CiAgICAgICAgdGhpcy5pc0VkaXQgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGdldEZpZ3VyZUZvcm1hdHRlZDogZnVuY3Rpb24gZ2V0RmlndXJlRm9ybWF0dGVkKGRhdGEpIHsKICAgICAgdGhpcy5maWd1cmUuZmlndXJlX2ltYWdlID0gImRhdGE6aW1hZ2UvanBnO2Jhc2U2NCwiICsgZGF0YS5maWd1cmVfaW1hZ2U7IC8vIGNhbnZhcwoKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdm0uY2FudmFzID0gdm0uJHJlZnMuY2FudmFzOwogICAgICB2bS5jb250ZXh0ID0gdm0uY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgIHZtLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWRvd24iLCB2bS5tb3VzZWRvd24pOwogICAgICB2bS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIiwgdm0ubW91c2Vtb3ZlKTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2V1cCIsIHZtLm1vdXNldXApOwogICAgICB2bS5pbWcgPSBuZXcgSW1hZ2UoKTsKCiAgICAgIHZtLmltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdm0uY29udGV4dC5kcmF3SW1hZ2Uodm0uaW1nLCAwLCAwLCAzMDAsIDIwMCk7IC8vIE9yIGF0IHdoYXRldmVyIG9mZnNldCB5b3UgbGlrZSBhbmQgc2V0IGhlaWdodCwgd2lkdGgKICAgICAgfTsKCiAgICAgIHZtLmltZy5zcmMgPSB0aGlzLmZpZ3VyZS5maWd1cmVfaW1hZ2U7CiAgICB9LAogICAgLy8gY2FudmFzCiAgICBtb3VzZWRvd246IGZ1bmN0aW9uIG1vdXNlZG93bihlKSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZhciByZWN0ID0gdm0uY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICB2YXIgeCA9IGUuY2xpZW50WCAtIHJlY3QubGVmdDsKICAgICAgdmFyIHkgPSBlLmNsaWVudFkgLSByZWN0LnRvcDsKICAgICAgdm0uaXNEcmF3aW5nID0gdHJ1ZTsKICAgICAgdm0uc3RhcnRYID0geDsKICAgICAgdm0uc3RhcnRZID0geTsKICAgICAgdm0ucG9pbnRzLnB1c2goewogICAgICAgIHg6IHgsCiAgICAgICAgeTogeQogICAgICB9KTsKICAgIH0sCiAgICBtb3VzZW1vdmU6IGZ1bmN0aW9uIG1vdXNlbW92ZShlKSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZhciByZWN0ID0gdm0uY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICB2YXIgeCA9IGUuY2xpZW50WCAtIHJlY3QubGVmdDsKICAgICAgdmFyIHkgPSBlLmNsaWVudFkgLSByZWN0LnRvcDsKCiAgICAgIGlmICh2bS5pc0RyYXdpbmcpIHsKICAgICAgICB2bS5jb250ZXh0LmJlZ2luUGF0aCgpOwogICAgICAgIHZtLmNvbnRleHQubW92ZVRvKHZtLnN0YXJ0WCwgdm0uc3RhcnRZKTsKICAgICAgICB2bS5jb250ZXh0LmxpbmVUbyh4LCB5KTsKICAgICAgICB2bS5jb250ZXh0LmxpbmVXaWR0aCA9IDE7CiAgICAgICAgdm0uY29udGV4dC5saW5lQ2FwID0gInJvdW5kIjsKICAgICAgICB2bS5jb250ZXh0LnN0cm9rZVN0eWxlID0gInJnYmEoMCwwLDAsMSkiOwogICAgICAgIHZtLmNvbnRleHQuc3Ryb2tlKCk7CiAgICAgICAgdm0uc3RhcnRYID0geDsKICAgICAgICB2bS5zdGFydFkgPSB5OwogICAgICAgIHZtLnBvaW50cy5wdXNoKHsKICAgICAgICAgIHg6IHgsCiAgICAgICAgICB5OiB5CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBtb3VzZXVwOiBmdW5jdGlvbiBtb3VzZXVwKCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS5pc0RyYXdpbmcgPSBmYWxzZTsKCiAgICAgIGlmICh2bS5wb2ludHMubGVuZ3RoID4gMCkgewogICAgICAgIGxvY2FsU3RvcmFnZVsicG9pbnRzIl0gPSBKU09OLnN0cmluZ2lmeSh2bS5wb2ludHMpOwogICAgICB9CiAgICB9LAogICAgcmVzZXRDYW52YXM6IGZ1bmN0aW9uIHJlc2V0Q2FudmFzKCkgewogICAgICAvLyB2YXIgdm0gPSB0aGlzOwogICAgICAvLyB2bS5jYW52YXMud2lkdGggPSB2bS5jYW52YXMud2lkdGg7CiAgICAgIC8vIHZtLnBvaW50cy5sZW5ndGggPSAwOyAvLyByZXNldCBwb2ludHMgYXJyYXkKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdm0uY2FudmFzID0gdm0uJHJlZnMuY2FudmFzOwogICAgICB2bS5jb250ZXh0ID0gdm0uY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgIHZtLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJtb3VzZWRvd24iLCB2bS5tb3VzZWRvd24pOwogICAgICB2bS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vtb3ZlIiwgdm0ubW91c2Vtb3ZlKTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2V1cCIsIHZtLm1vdXNldXApOwogICAgICB2bS5pbWcgPSBuZXcgSW1hZ2UoKTsKCiAgICAgIHZtLmltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdm0uY29udGV4dC5kcmF3SW1hZ2Uodm0uaW1nLCAwLCAwLCAzMDAsIDIwMCk7IC8vIE9yIGF0IHdoYXRldmVyIG9mZnNldCB5b3UgbGlrZSBhbmQgc2V0IGhlaWdodCwgd2lkdGgKICAgICAgfTsKCiAgICAgIHZtLmltZy5zcmMgPSB0aGlzLmZpZ3VyZS5maWd1cmVfaW1hZ2U7CiAgICAgIHZtLmNhbnZhcy53aWR0aCA9IHRoaXMuY2FudmFzLndpZHRoOwogICAgICB2bS5wb2ludHMubGVuZ3RoID0gMDsgLy8gcmVzZXQgcG9pbnRzIGFycmF5CiAgICB9LAogICAgLy8gc2F2ZUltYWdlKCkgewogICAgLy8gICB2YXIgdm0gPSB0aGlzOwogICAgLy8gICB2YXIgZGF0YVVSTCA9IHZtLmNhbnZhcy50b0RhdGFVUkwoKTsKICAgIC8vICAgdmFyIGltZyA9IHZtLiRyZWZzLmltZzsKICAgIC8vICAgaW1nLnNyYyA9IGRhdGFVUkw7CiAgICAvLyB9LAogICAgLy8KICAgIGFkZEZpZ3VyZTogZnVuY3Rpb24gYWRkRmlndXJlKCkgewogICAgICB2YXIgZGF0YVVSTCA9IHRoaXMuY2FudmFzLnRvRGF0YVVSTCgpOwogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GaWd1cmUucHVzaCh7CiAgICAgICAgbmFtZTogdGhpcy5maWd1cmUubmFtZSwKICAgICAgICBmaWd1cmVfaWQ6IHRoaXMuZmlndXJlLmZpZ3VyZV9pZCwKICAgICAgICBmaWd1cmVfaW1hZ2U6IGRhdGFVUkwuc3BsaXQoIiwiKVsxXQogICAgICB9KTsKICAgICAgdGhpcy5maWd1cmVEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5zaG93SW5QcmVzY3JpcHRpb24odGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmlndXJlLCAhdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5maWd1cmVfc2hvd19pbl9wcmVzY3JpcHRpb24pOwogICAgfSwKICAgIGFkZEZhbWlseUhpc3Rvcnk6IGZ1bmN0aW9uIGFkZEZhbWlseUhpc3RvcnkoKSB7CiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy5mYW1pbHlIaXN0b3J5LnJlbGF0aXZlX3JhbGF0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZhbWlseUhpc3RvcnkucHVzaCh7CiAgICAgICAgICBkaWFnbm9zaXNfaWQ6IHRoaXMuZmFtaWx5SGlzdG9yeS5kaWFnbm9zaXNfaWQsCiAgICAgICAgICBuYW1lOiB0aGlzLmZhbWlseUhpc3RvcnkubmFtZSwKICAgICAgICAgIHJlbGF0aXZlX3JhbGF0aW9uOiB0aGlzLmZhbWlseUhpc3RvcnkucmVsYXRpdmVfcmFsYXRpb24KICAgICAgICB9KTsKICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgICAgIHRoaXMuZmFtaWx5SGlzdG9yeURpYWxvZyA9IGZhbHNlOwogICAgICAgIHRoaXMuc2hvd0luUHJlc2NyaXB0aW9uKHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZhbWlseUhpc3RvcnksICF0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmZhbWlseUhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb24pOwogICAgICB9CiAgICB9LAogICAgZWRpdFRyZWF0bWVudDogZnVuY3Rpb24gZWRpdFRyZWF0bWVudChkYXRhLCBpbmRleCkgewogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLm1lZGljaW5lTmFtZSA9IGRhdGEubmFtZTsgLy8gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZSA9IHsKICAgICAgLy8gICB0ZXh0OiBkYXRhLm5hbWUsCiAgICAgIC8vICAgdmFsdWU6IGRhdGEubWVkaWNpbmVfaWQsCiAgICAgIC8vICAgcmVmaWQ6IG51bGwsCiAgICAgIC8vIH07CgogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcyA9IHsKICAgICAgICB0ZXh0OiBkYXRhLl90cmVhdG1lbnRfcnVsZV9uYW1lLAogICAgICAgIHZhbHVlOiBkYXRhLnRyZWF0bWVudF9ydWxlc19pZCwKICAgICAgICByZWZpZDogbnVsbAogICAgICB9OwogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbiA9IHsKICAgICAgICB0ZXh0OiBkYXRhLl90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgICB2YWx1ZTogZGF0YS50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgICAgcmVmaWQ6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZSA9IHsKICAgICAgICB0ZXh0OiBkYXRhLl90cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAgIHZhbHVlOiBkYXRhLnRyZWF0bWVudF9kb3NlX2lkLAogICAgICAgIHJlZmlkOiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gdHJ1ZTsKICAgICAgdGhpcy50cmVhdG1lbnRJbmRleCA9IGluZGV4OwogICAgfSwKICAgIHRyZWF0bWVudEVkaXRTYXZlOiBmdW5jdGlvbiB0cmVhdG1lbnRFZGl0U2F2ZSgpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcykgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy90aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0ubmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudGV4dDsKICAgICAgICAvL3RoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5tZWRpY2luZV9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudmFsdWU7CiAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfcnVsZV9uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudGV4dDsKICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X3J1bGVzX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudmFsdWU7CiAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnRleHQ7CiAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLnRyZWF0bWVudF9kdXJhdGlvbl9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnZhbHVlOwogICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5fdHJlYXRtZW50X2Rvc2VfbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudGV4dDsKICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X2Rvc2VfaWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnZhbHVlOwogICAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gZmFsc2U7CiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGVkaXRPbkV4YW1pbmF0aW9uOiBmdW5jdGlvbiBlZGl0T25FeGFtaW5hdGlvbihkYXRhLCBpbmRleCkgewogICAgICB0aGlzLm9uRXhhbWluYXRpb24ubGFiZWwgPSBkYXRhLm5hbWU7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQgPSBkYXRhLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdDsgLy90aGlzLmVkaXRPbkV4YW1pbmF0aW9uRGlhbG9nID0gdHJ1ZTsKCiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IHRydWU7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkluZGV4ID0gaW5kZXg7CiAgICAgIHRoaXMuaXNFZGl0ID0gdHJ1ZTsKICAgIH0sCiAgICBvbkV4YW1pbmF0aW9uRWRpdFNhdmU6IGZ1bmN0aW9uIG9uRXhhbWluYXRpb25FZGl0U2F2ZSgpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLm9uRXhhbWluYXRpb24ub25fZXhhbWluYXRpb25fcmVzdWx0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb25bdGhpcy5vbkV4YW1pbmF0aW9uSW5kZXhdLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdCA9IHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQudG9TdHJpbmcoKTsgLy90aGlzLmVkaXRPbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7CgogICAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVJdGVtOiBmdW5jdGlvbiBkZWxldGVJdGVtKGxzdCwgZGF0YSkgewogICAgICBsc3Quc3BsaWNlKGxzdC5maW5kSW5kZXgoZnVuY3Rpb24gKGkpIHsKICAgICAgICByZXR1cm4gaSA9PT0gZGF0YTsKICAgICAgfSksIDEpOwogICAgfSwKICAgIHNob3dJblByZXNjcmlwdGlvbjogZnVuY3Rpb24gc2hvd0luUHJlc2NyaXB0aW9uKGxzdCwgdmFsKSB7CiAgICAgIGxzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgZWxlbWVudC5zaG93X2luX3ByZXNjcmlwdGlvbiA9ICF2YWw7CiAgICAgIH0pOwogICAgfSwKICAgIGFkZDogZnVuY3Rpb24gYWRkKCkgewogICAgICB2YXIgX3RoaXMyOCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDA7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkNvbXBsaWFudHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogIlBsZWFzZSBhZGQgUGF0aWVudCBDb21wbGFpbnRzIiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb24ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMjguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQbGVhc2UgYWRkIE9uIEV4YW1pbmF0aW9uIiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIF90aGlzMjguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uYXBwb2lubWVudF9pZCA9IF90aGlzMjguYXBwb2ludG1lbnRJbmZvLmFwcG9pbm1lbnRfaWQ7CiAgICAgICAgICAgICAgICBfdGhpczI4LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLnByZXNjcmlwdGlvbl9kYXRlID0gbW9tZW50KFN0cmluZyhfdGhpczI4LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmNkcHJlc2NyaXB0aW9uX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5jZGZvbG93dXBfZGF0ZSkgewogICAgICAgICAgICAgICAgICBfdGhpczI4LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmZvbG93dXBfZGF0ZSA9IG1vbWVudChTdHJpbmcoX3RoaXMyOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5jZGZvbG93dXBfZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyOC5hcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UuYWRkKF90aGlzMjguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24sIF90aGlzMjgpOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ2LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBfdGhpczI4LmRvd25sb2FkUHJlc2NyaXB0aW9uKF90aGlzMjguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uYXBwb2lubWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczI4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlByZXNjcmliZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjgubmV3UHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczI4LnJlc2V0KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczI4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gMjA7CiAgICAgICAgICAgICAgICBfY29udGV4dDYudDAgPSBfY29udGV4dDZbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgX3RoaXMyOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0Ni50MCwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2LCBudWxsLCBbWzAsIDIwXV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdQcmVzY3JpcHRpb246IGZ1bmN0aW9uIG5ld1ByZXNjcmlwdGlvbigpIHsKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIlNlY3Rpb25zIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbiA9IHt9OwogICAgICB0aGlzLmZpZ3VyZSA9IHt9OwogICAgICB0aGlzLmZhbWlseUhpc3RvcnkgPSB7fTsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbiA9IHsKICAgICAgICBjZHByZXNjcmlwdGlvbl9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZGZvbG93dXBfZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBmaWd1cmVfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgZmFtaWx5SGlzdG9yeV9zaG93X2luX3ByZXNjcmlwdGlvbjogdHJ1ZSwKICAgICAgICBwYXN0SGlzdG9yeV9zaG93X2luX3ByZXNjcmlwdGlvbjogdHJ1ZSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQ29tcGxpYW50czogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb246IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GaWd1cmU6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRGlhZ25vc2lzOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmFtaWx5SGlzdG9yeTogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvblBhc3RIaXN0b3J5OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9OwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfQogIH0KfTs="},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/doctor-panel/AppointmentPrescription.js"],"names":["CommonService","DoctorAppointmentService","FigureSetupService","AppointmentPrescriptionService","MedicineTypeSetupService","MedicineSetupService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","PrescriptionReportService","moment","FilterMatchMode","FilterOperator","EmployeeSetupService","PatientRegistrationService","PatientReportService","PatientInvestigationRequestService","DiagnosisReportService","PatientProfileService","DiagnosisSetupService","data","expandedRows","active","investigationResultList","patient","age_year","age_month","age_day","isAssistant","dataList","isHistory","isFemale","isAdvice","currentMedicationsDialog","pastMedicalHistoryDialog","onExaminationDialog","onExaminationPopupDialog","figureDialog","familyHistoryDialog","treatmentAddDialog","treatmentDialog","prevPrescriptionDialog","diagnosisList","currentMedicationsList","pastMedicalHistoryList","appoinmentStatusList","patientsRelativeList","doctorAppointmentList","prescriptionDataList","prevPrescriptionList","headerName","tempData","patientHistory","lstPersonalHistory","lstFamilyHistory","lstSystemsReview","lstSubstanceUse","lstReproductiveHistory","currentMedications","pastMedicalHistory","appointmentInfo","onExamination","figure","familyHistory","treatmentSetup","doctorAppointment","cdfromdate","String","Date","format","cdtodate","appoinment_status","appointmentPrescription","cdprescription_date","cdfolowup_date","setDate","getDate","figure_show_in_prescription","familyHistory_show_in_prescription","pastHistory_show_in_prescription","allAdvice","lstAppoinmentPrescriptionCompliants","lstAppoinmentPrescriptionOnExamination","lstAppoinmentPrescriptionFigure","lstAppoinmentPrescriptionInvestigation","lstAppoinmentPrescriptionDiagnosis","lstAppoinmentPrescriptionFamilyHistory","lstAppoinmentPrescriptionPastHistory","lstNutrition","lstAppoinmentPrescriptionTreatment","lstAppoinmentPrescriptionAdvice","medicineTypeList","medicineList","treatmentRulesList","treatmentDurationList","treatmentDoseList","canvas","context","isDrawing","startX","startY","points","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","created","today","month","getMonth","year","getFullYear","prevMonth","prevYear","minDate","setMonth","setFullYear","appointmentPrescriptionService","figureSetupService","doctorAppointmentService","commonService","medicineTypeSetupService","medicineSetupService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","prescriptionReportService","employeeSetupService","patientRegistrationService","patientReportService","patientInvestigationRequestService","diagnosisReportService","patientProfileService","diagnosisSetupService","userInfo","JSON","parse","localStorage","getItem","getAll","then","GetAllAppoinmentStatus","GetAllPatientsRelatives","doctor_id","getPrescriptionDataByDoctorId","show","employee_id","getById","employeeFormatted","getActiveCombo","newPrescription","that","document","onkeyup","e","ctrlKey","altKey","which","getPatientComplaints","getOnExaminationsPopup","getOnExaminations","getFigure","getInvestigation","getDiagnosis","getFamilyHistory","getPastHistory","getTreatment","getAdvice","prescriptionData","prescription","removeItem","methods","assistant_of_doctor_id","reset","fromdate","todate","getDynamicDoctorWise","isNameExists","list","column","result","forEach","element","$toast","add","severity","summary","detail","life","newCurrentMedications","addCurrentMedications","medicine_id","treatment_rules_id","treatment_duration_id","treatment_dose_id","patient_id","currentMedicationsSave","status","getCurrentMedicationsByPatientId","res","confirmDeleteCurrentMedications","$confirm","require","message","header","icon","acceptClass","accept","deleteCurrentMedications","reject","currentMedicationsDelete","newPastMedicalHistory","addPastMedicalHistory","diagnosis_id","pastHistorySave","getPastHistoryByPatientId","confirmDeletePastMedicalHistory","deletePastMedicalHistory","pastHistoryDelete","hideHistory","patientHistorySave","historyCollection","aPatient","gender","getSystemSubstance","formattedSystemSubstance","patientInfoFormatted","patientWise","dob","formatDate2","reportPrint","barcode_or_level","template_name","GetInvestigationReportTemplateWise","Downloadfile","appoinment_id","patientReg","registration_no","patientName","first_name","last_name","patientGender","patientAgeYear","patientAgeMonth","patientAgeDay","viewPatientProfile","setItem","$router","push","previousPrescription","getPatientWisePrescriptionList","downloadPrescription","GetPescription","formatDate","checkDate","date","apptDate","lstComplaint","compilants_name","id","compilants_id","popupOnExaminationsData","lstOnExamination","on_examination_name","on_examination_id","on_examination_result","lstFigureSetup","figure_name","figure_id","lstInvestigation","investingation_name","investigation_id","lstDiagnosis","diagnosis_name","filterMedicineTypeWise","ddlmedicine_type","text","filter","el","refid","saveTreatment","ddlmedicine","ddltreatment_rules","ddltreatment_duration","ddltreatment_dose","aMedicine","length","_medicine_type_name","_treatment_dose_name","_treatment_rule_name","_treatment_duration_name","description","hideDialog","lstAdvices","advice_name","advice_id","addOnExaminationFromPopup","aOnExaminations","toString","addAllAdvice","aAdvice","getValue","aCompliants","label","aFigure","getFigureFormatted","aInvestigation","aDiagnosis","aFamilyHistory","aPastHistory","showInPrescription","_medicine_name","addOnExamination","isEdit","onExaminationEditSave","figure_image","vm","$refs","getContext","addEventListener","mousedown","mousemove","mouseup","img","Image","onload","drawImage","src","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","beginPath","moveTo","lineTo","lineWidth","lineCap","strokeStyle","stroke","stringify","resetCanvas","width","addFigure","dataURL","toDataURL","split","addFamilyHistory","relative_ralation","editTreatment","index","medicineName","treatmentIndex","treatmentEditSave","editOnExamination","onExaminationIndex","deleteItem","lst","splice","findIndex","i","val","show_in_prescription","prescription_date","folowup_date"],"mappings":"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","sourcesContent":["import CommonService from \"../../service/CommonService\";\r\nimport DoctorAppointmentService from \"../../service/front-desk/DoctorAppointmentService\";\r\nimport FigureSetupService from \"../../service/setup/FigureSetupService\";\r\nimport AppointmentPrescriptionService from \"../../service/doctor-panel/AppointmentPrescriptionService\";\r\nimport MedicineTypeSetupService from \"../../service/setup/MedicineTypeSetupService\";\r\nimport MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\nimport PrescriptionReportService from \"../../service/report/PrescriptionReportService\";\r\nimport moment from \"moment\";\r\nimport { FilterMatchMode, FilterOperator } from \"primevue/api\";\r\nimport EmployeeSetupService from \"../../service/setup/EmployeeSetupService\";\r\nimport PatientRegistrationService from \"../../service/front-desk/PatientRegistrationService\";\r\nimport PatientReportService from \"../../service/report/PatientReportService\";\r\nimport PatientInvestigationRequestService from \"../../service/front-desk/PatientInvestigationRequestService\";\r\nimport DiagnosisReportService from \"../../service/report/DiagnosisReportService\";\r\nimport PatientProfileService from \"../../service/profiles/PatientProfileService\";\r\nimport DiagnosisSetupService from \"../../service/setup/DiagnosisSetupService\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      expandedRows: [],\r\n      active: 0,\r\n      investigationResultList: [],\r\n      patient: {\r\n        age_year: \"0\",\r\n        age_month: \"0\",\r\n        age_day: \"0\",\r\n      },\r\n      isAssistant: false,\r\n      dataList: true,\r\n      isHistory: false,\r\n      isFemale: false,\r\n      isAdvice: false,\r\n      currentMedicationsDialog: false,\r\n      pastMedicalHistoryDialog: false,\r\n      onExaminationDialog: false,\r\n      onExaminationPopupDialog: false,\r\n      //editOnExaminationDialog: false,\r\n      figureDialog: false,\r\n      familyHistoryDialog: false,\r\n      treatmentAddDialog: false,\r\n      treatmentDialog: false,\r\n      prevPrescriptionDialog: false,\r\n      diagnosisList: [],\r\n      currentMedicationsList: [],\r\n      pastMedicalHistoryList: [],\r\n      appoinmentStatusList: [],\r\n      patientsRelativeList: [],\r\n      doctorAppointmentList: [],\r\n      prescriptionDataList: [],\r\n      prevPrescriptionList: [],\r\n      headerName: \"Sections\",\r\n      tempData: [],\r\n      patientHistory: {\r\n        lstPersonalHistory: [],\r\n        lstFamilyHistory: [],\r\n        lstSystemsReview: [],\r\n        lstSubstanceUse: [],\r\n        lstReproductiveHistory: [],\r\n      },\r\n      currentMedications: {},\r\n      pastMedicalHistory: {},\r\n      appointmentInfo: {},\r\n      onExamination: {},\r\n      figure: {},\r\n      familyHistory: {},\r\n      treatmentSetup: {},\r\n      doctorAppointment: {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdtodate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n        appoinment_status: \"Active\",\r\n      },\r\n\r\n      //Test\r\n      // doctorAppointment: {\r\n      //   cdfromdate: \"01/01/2021\",\r\n      //   cdtodate: \"01/01/2022\",\r\n      //   appoinment_status: \"All\",\r\n      // },\r\n\r\n      appointmentPrescription: {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        figure_show_in_prescription: true,\r\n        familyHistory_show_in_prescription: true,\r\n        pastHistory_show_in_prescription: true,\r\n        allAdvice: false,\r\n\r\n        lstAppoinmentPrescriptionCompliants: [],\r\n        lstAppoinmentPrescriptionOnExamination: [],\r\n        lstAppoinmentPrescriptionFigure: [],\r\n        lstAppoinmentPrescriptionInvestigation: [],\r\n        lstAppoinmentPrescriptionDiagnosis: [],\r\n        lstAppoinmentPrescriptionFamilyHistory: [],\r\n        lstAppoinmentPrescriptionPastHistory: [],\r\n        lstNutrition: [],\r\n        lstAppoinmentPrescriptionTreatment: [],\r\n        lstAppoinmentPrescriptionAdvice: [],\r\n      },\r\n      medicineTypeList: [],\r\n      medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n      // canvas\r\n      canvas: null,\r\n      context: null,\r\n      isDrawing: false,\r\n      startX: 0,\r\n      startY: 0,\r\n      points: [],\r\n      //\r\n      submitted: false,\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    // past date-year disabled\r\n    let today = new Date();\r\n    let month = today.getMonth();\r\n    let year = today.getFullYear();\r\n    let prevMonth = (month === 0) ? 11 : month - 0;\r\n    let prevYear = (prevMonth === 11) ? year - 0 : year;\r\n    this.minDate = new Date();\r\n    this.minDate.setMonth(prevMonth);\r\n    this.minDate.setFullYear(prevYear);\r\n\r\n    this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n    this.figureSetupService = new FigureSetupService();\r\n    this.doctorAppointmentService = new DoctorAppointmentService();\r\n    this.commonService = new CommonService();\r\n    this.medicineTypeSetupService = new MedicineTypeSetupService();\r\n    this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n    this.prescriptionReportService = new PrescriptionReportService();\r\n    this.employeeSetupService = new EmployeeSetupService();\r\n    this.patientRegistrationService = new PatientRegistrationService();\r\n    this.patientReportService = new PatientReportService();\r\n    this.patientInvestigationRequestService = new PatientInvestigationRequestService();\r\n    this.diagnosisReportService = new DiagnosisReportService();\r\n    this.patientProfileService = new PatientProfileService();\r\n    this.diagnosisSetupService = new DiagnosisSetupService();\r\n\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n\r\n    this.diagnosisSetupService\r\n      .getAll()\r\n      .then((data) => (this.diagnosisList = data.data));\r\n\r\n    this.commonService\r\n      .GetAllAppoinmentStatus()\r\n      .then((data) => (this.appoinmentStatusList = data.data));\r\n\r\n    this.commonService\r\n      .GetAllPatientsRelatives()\r\n      .then((data) => (this.patientsRelativeList = data.data));\r\n\r\n    if (this.userInfo.doctor_id) {\r\n      this.appointmentPrescriptionService\r\n        .getPrescriptionDataByDoctorId(this.userInfo.doctor_id)\r\n        .then((data) => (this.prescriptionDataList = data.data));\r\n\r\n      this.doctor_id = this.userInfo.doctor_id;\r\n      this.show();\r\n    }\r\n    if (this.userInfo.employee_id) {\r\n      this.employeeSetupService\r\n        .getById(this.userInfo.employee_id)\r\n        .then((data) => this.employeeFormatted(data.data));\r\n    }\r\n\r\n    this.medicineTypeSetupService.getActiveCombo().then((data) => (this.medicineTypeList = data.data));\r\n\r\n    this.medicineSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.medicineList = data.data));\r\n\r\n    this.treatmentRulesSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n    this.treatmentDurationSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n    this.treatmentDoseSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentDoseList = data.data));\r\n\r\n    //this.show();\r\n    this.newPrescription();\r\n\r\n    let that = this;\r\n    document.onkeyup = function (e) {\r\n      if (e.ctrlKey && e.altKey && e.which == 67) {\r\n        that.getPatientComplaints();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 69) {\r\n        that.getOnExaminationsPopup();\r\n        that.getOnExaminations();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 70) {\r\n        that.getFigure();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 73) {\r\n        that.getInvestigation();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 68) {\r\n        that.getDiagnosis();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 72) {\r\n        that.getFamilyHistory();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 80) {\r\n        that.getPastHistory();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 84) {\r\n        that.getTreatment();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 65) {\r\n        that.getAdvice();\r\n      }\r\n      // else if (e.ctrlKey && e.altKey && e.shiftKey) {\r\n\r\n      // }\r\n    };\r\n\r\n    var prescriptionData = JSON.parse(localStorage.getItem('prescriptionData'));\r\n    if (prescriptionData) {\r\n      this.prescription(prescriptionData);\r\n      localStorage.removeItem('prescriptionData');\r\n    }\r\n  },\r\n  methods: {\r\n    employeeFormatted(data) {\r\n      this.doctor_id = data.assistant_of_doctor_id;\r\n      this.isAssistant = true;\r\n      this.show();\r\n    },\r\n    reset() {\r\n      this.doctorAppointment = {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdtodate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n        appoinment_status: \"Active\",\r\n      };\r\n\r\n      // this.dataList = true;\r\n      // this.submitted = false;\r\n      this.show();\r\n    },\r\n    show() {\r\n      this.submitted = true;\r\n      if (!this.doctorAppointment.cdfromdate) {\r\n        return;\r\n      } else if (!this.doctorAppointment.cdtodate) {\r\n        return;\r\n      } else if (!this.doctorAppointment.appoinment_status) {\r\n        return;\r\n      } else {\r\n        this.doctorAppointment.fromdate = moment(\r\n          String(this.doctorAppointment.cdfromdate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.doctorAppointment.todate = moment(\r\n          String(this.doctorAppointment.cdtodate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.doctorAppointmentService\r\n          .getDynamicDoctorWise(\r\n            this.doctorAppointment.fromdate,\r\n            this.doctorAppointment.todate,\r\n            this.doctorAppointment.appoinment_status,\r\n            this.doctor_id\r\n          )\r\n          .then((data) => (this.doctorAppointmentList = data.data));\r\n      }\r\n      this.dataList = true;\r\n      this.isHistory = false;\r\n      this.submitted = false;\r\n    },\r\n    //\r\n    isNameExists(list, column, value) {\r\n      var result = false;\r\n      list.forEach((element) => {\r\n        if (element[column] == value) {\r\n          result = true;\r\n        }\r\n      });\r\n      if (result) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Error\",\r\n          detail: \"Duplicate Data\",\r\n          life: 10000,\r\n        });\r\n      }\r\n      return result;\r\n    },\r\n    newCurrentMedications() {\r\n      this.currentMedicationsDialog = true;\r\n    },\r\n    async addCurrentMedications() {\r\n      if (!this.currentMedications.medicine_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_rules_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_duration_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_dose_id) {\r\n        return;\r\n      } else if (!this.currentMedications.patient_id) {\r\n        return;\r\n      } else if (this.isNameExists(this.currentMedicationsList, 'medicine_id', this.currentMedications.medicine_id)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.currentMedicationsSave(this.currentMedications);\r\n        if (result.status === 201) {\r\n          this.getCurrentMedicationsByPatientId(this.currentMedications.patient_id);\r\n          this.currentMedicationsDialog = false;\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeleteCurrentMedications(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deleteCurrentMedications(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deleteCurrentMedications(data) {\r\n      let result = await this.patientProfileService.currentMedicationsDelete(data);\r\n      if (result.status === 202) {\r\n        this.getCurrentMedicationsByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    newPastMedicalHistory() {\r\n      this.pastMedicalHistoryDialog = true;\r\n    },\r\n    async addPastMedicalHistory() {\r\n      //this.pastMedicalHistory\r\n      if (!this.pastMedicalHistory.diagnosis_id) {\r\n        return;\r\n      } else if (!this.pastMedicalHistory.patient_id) {\r\n        return;\r\n      } else if (this.isNameExists(this.pastMedicalHistoryList, 'diagnosis_id', this.pastMedicalHistory.diagnosis_id)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.pastHistorySave(this.pastMedicalHistory);\r\n        if (result.status === 201) {\r\n          this.getPastHistoryByPatientId(this.pastMedicalHistory.patient_id);\r\n          this.pastMedicalHistoryDialog = false;\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeletePastMedicalHistory(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deletePastMedicalHistory(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deletePastMedicalHistory(data) {\r\n      let result = await this.patientProfileService.pastHistoryDelete(data);\r\n      if (result.status === 202) {\r\n        this.getPastHistoryByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    hideHistory() {\r\n      this.isHistory = false;\r\n    },\r\n    async patientHistorySave() {\r\n      if (!this.patientHistory.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.patientHistorySave(this.patientHistory, this);\r\n        if (result.status === 201) {\r\n          this.hideHistory();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    historyCollection(data) {\r\n      if (data.aPatient.gender == \"Female\") {\r\n        this.isFemale = true;\r\n      } else {\r\n        this.isFemale = false;\r\n      }\r\n      this.currentMedications.patient_id = data.aPatient.patient_id;\r\n      this.pastMedicalHistory.patient_id = data.aPatient.patient_id;\r\n      this.patientHistory.patient_id = data.aPatient.patient_id;\r\n      this.getCurrentMedicationsByPatientId(data.aPatient.patient_id);\r\n      this.getPastHistoryByPatientId(data.aPatient.patient_id);\r\n      this.patientProfileService.getSystemSubstance(data.aPatient.patient_id).then((data) => this.formattedSystemSubstance(data.data));\r\n      this.patientRegistrationService.getById(data.aPatient.patient_id).then((data) => this.patientInfoFormatted(data.data));\r\n      this.patientInvestigationRequestService.patientWise(data.aPatient.patient_id).then((data) => this.investigationResultList = data.data);\r\n\r\n      this.isHistory = true;\r\n    },\r\n    formattedSystemSubstance(data) {\r\n      this.patientHistory.lstPersonalHistory = data.lstPersonalHistory;\r\n      this.patientHistory.lstFamilyHistory = data.lstFamilyHistory;\r\n      this.patientHistory.lstSystemsReview = data.lstSystemsReview;\r\n      this.patientHistory.lstSubstanceUse = data.lstSubstanceUse;\r\n      this.patientHistory.lstReproductiveHistory = data.lstReproductiveHistory;\r\n    },\r\n    getCurrentMedicationsByPatientId(patient_id) {\r\n      this.patientProfileService.getCurrentMedicationsByPatientId(patient_id).then((data) => (this.currentMedicationsList = data.data));\r\n    },\r\n    getPastHistoryByPatientId(patient_id) {\r\n      this.patientProfileService.getPastHistoryByPatientId(patient_id).then((data) => (this.pastMedicalHistoryList = data.data));\r\n    },\r\n    patientInfoFormatted(data) {\r\n      this.patient = data;\r\n      this.patient.dob = moment(String(data.dob)).format(\"MM/DD/YYYY\");\r\n    },\r\n    formatDate2(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY\");\r\n    },\r\n    reportPrint(barcode_or_level, template_name) {\r\n      this.diagnosisReportService.GetInvestigationReportTemplateWise(barcode_or_level, template_name, this).then((data) => this.commonService.Downloadfile(data.data));\r\n    },\r\n    prescription(data) {\r\n      this.appointmentInfo.appoinment_id = data.appoinment_id;\r\n      this.appointmentInfo.patientReg = data.aPatient.registration_no;\r\n      this.appointmentInfo.patientName =\r\n        data.aPatient.first_name + \" \" + data.aPatient.last_name;\r\n      this.appointmentInfo.patientGender = data.aPatient.gender;\r\n      this.appointmentInfo.patientAgeYear = data.aPatient.age_year;\r\n      this.appointmentInfo.patientAgeMonth = data.aPatient.age_month;\r\n      this.appointmentInfo.patientAgeDay = data.aPatient.age_day;\r\n\r\n      // var patientDOB = moment(String(data.aPatient.dob)).format(\r\n      //   \"MM/DD/YYYY\"\r\n      // );\r\n\r\n      //this.appointmentInfo.age = Math.floor(moment(new Date()).diff(moment(patientDOB, \"MM/DD/YYYY\"), 'years', true));\r\n      //this.appointmentInfo.age = moment(patientDOB, \"MM/DD/YYYY\").fromNow().split(\" \")[0];\r\n\r\n      this.dataList = false;\r\n    },\r\n    viewPatientProfile(patient_id) {\r\n      localStorage.setItem('patientId_for_profile', patient_id);\r\n      this.$router.push(\"/patient-profile\");\r\n    },\r\n    previousPrescription(patient_id) {\r\n      this.appointmentPrescriptionService\r\n        .getPatientWisePrescriptionList(patient_id)\r\n        .then((data) => (this.prevPrescriptionList = data.data));\r\n\r\n      this.prevPrescriptionDialog = true;\r\n    },\r\n    downloadPrescription(appoinment_id) {\r\n      this.prescriptionReportService.GetPescription(appoinment_id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n    checkDate(date) {\r\n      var today = moment(String(new Date())).format(\"MM/DD/YYYY\");\r\n      var apptDate = moment(String(date)).format(\"MM/DD/YYYY\");\r\n      if (today == apptDate) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    },\r\n\r\n    //\r\n    getPatientComplaints() {\r\n      this.headerName = \"Patient Complaints\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstComplaint.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.compilants_name,\r\n          id: element.compilants_id,\r\n        });\r\n      });\r\n    },\r\n    getOnExaminationsPopup() {\r\n      this.popupOnExaminationsData = [];\r\n      this.prescriptionDataList.lstOnExamination.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          name: element.on_examination_name,\r\n          id: element.on_examination_id,\r\n          on_examination_result: 1,\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n    getOnExaminations() {\r\n      //this.getOnExaminationsPopup();\r\n      this.headerName = \"On Examinations\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstOnExamination.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.on_examination_name,\r\n          id: element.on_examination_id,\r\n        });\r\n      });\r\n    },\r\n    getFigure() {\r\n      this.headerName = \"Figure\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstFigureSetup.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.figure_name,\r\n          id: element.figure_id,\r\n        });\r\n      });\r\n    },\r\n    getInvestigation() {\r\n      this.headerName = \"Investigation\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstInvestigation.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.investingation_name,\r\n          id: element.investigation_id,\r\n        });\r\n      });\r\n    },\r\n    getDiagnosis() {\r\n      this.headerName = \"Diagnosis\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getFamilyHistory() {\r\n      this.headerName = \"Family History\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getPastHistory() {\r\n      this.headerName = \"Past History\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    filterMedicineTypeWise() {\r\n      if (this.treatmentSetup.ddlmedicine_type) {\r\n        this.treatmentSetup.ddlmedicine_type.text;\r\n        return this.medicineList.filter(function (el) {\r\n          return el.refid === this.treatmentSetup.ddlmedicine_type.value;\r\n        }, this);\r\n      }\r\n    },\r\n    getTreatment() {\r\n      this.treatmentAddDialog = true;\r\n\r\n      // this.headerName = \"Medicine\";\r\n      // this.filters['global'].value = \"\";\r\n      // this.isAdvice = false;\r\n      // this.tempData = [];\r\n      // this.prescriptionDataList.lstTreatment.forEach((element) => {\r\n      //   this.tempData.push({\r\n      //     _medicine_type_name: element._medicine_type_name,\r\n      //     _medicine_name: element._medicine_name,\r\n      //     name: element._medicine_type_name + \" \" + element._medicine_name + \" \" + element._treatment_dose_name + \" \" + element._treatment_rule_name + \" \" + element._treatment_duration_name,\r\n      //     id: element.medicine_id,\r\n      //     _treatment_dose_name: element._treatment_dose_name,\r\n      //     treatment_dose_id: element.treatment_dose_id,\r\n      //     _treatment_rule_name: element._treatment_rule_name,\r\n      //     treatment_rules_id: element.treatment_rules_id,\r\n      //     _treatment_duration_name: element._treatment_duration_name,\r\n      //     treatment_duration_id: element.treatment_duration_id,\r\n      //     description: element.description,\r\n      //   });\r\n      // });\r\n    },\r\n    saveTreatment() {\r\n      debugger;\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddlmedicine_type) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddlmedicine) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        var aMedicine =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === this.treatmentSetup.ddlmedicine.value;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.push({\r\n            _medicine_type_name: this.treatmentSetup.ddlmedicine_type.text,\r\n            name: this.treatmentSetup.ddlmedicine.text,\r\n            medicine_id: this.treatmentSetup.ddlmedicine.value,\r\n            _treatment_dose_name: this.treatmentSetup.ddltreatment_dose.text,\r\n            treatment_dose_id: this.treatmentSetup.ddltreatment_dose.value,\r\n            _treatment_rule_name: this.treatmentSetup.ddltreatment_rules.text,\r\n            treatment_rules_id: this.treatmentSetup.ddltreatment_rules.value,\r\n            _treatment_duration_name: this.treatmentSetup.ddltreatment_duration.text,\r\n            treatment_duration_id: this.treatmentSetup.ddltreatment_duration.value,\r\n            description: \"\",\r\n          });\r\n        }\r\n        this.hideDialog();\r\n      }\r\n    },\r\n    getAdvice() {\r\n      this.headerName = \"Advice\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = true;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstAdvices.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.advice_name,\r\n          id: element.advice_id,\r\n        });\r\n      });\r\n    },\r\n    addOnExaminationFromPopup() {\r\n      //this.submitted = true;\r\n      //this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (element.on_examination_result) {\r\n          //this.requred = \"required\";\r\n          var aOnExaminations =\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.filter(\r\n              function (el) {\r\n                return el.on_examination_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aOnExaminations.length) {\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.push({\r\n              name: element.name,\r\n              on_examination_id: element.id,\r\n              on_examination_result:\r\n                element.on_examination_result.toString(),\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      // if (this.requred) {\r\n      //   this.$toast.add({\r\n      //     severity: \"error\",\r\n      //     summary: \"Required\",\r\n      //     detail: \"Please fill in the required fields\",\r\n      //     life: 10000,\r\n      //   });\r\n      //   return;\r\n      // }\r\n\r\n      this.onExaminationPopupDialog = false;\r\n    },\r\n    // add all advice checkbox\r\n    addAllAdvice() {\r\n      if (!this.appointmentPrescription.allAdvice) {\r\n        this.tempData.forEach((element) => {\r\n          var aAdvice =\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.filter(\r\n              function (el) {\r\n                return el.advice_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aAdvice.length) {\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.push({\r\n              name: element.name,\r\n              advice_id: element.id,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // add value \r\n    getValue(data) {\r\n      if (this.headerName == \"Patient Complaints\") {\r\n        var aCompliants =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionCompliants.filter(\r\n            function (el) {\r\n              return el.compilants_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aCompliants.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionCompliants.push(\r\n            {\r\n              name: data.name,\r\n              compilants_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"On Examinations\") {\r\n        var aOnExaminations =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.filter(\r\n            function (el) {\r\n              return el.on_examination_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aOnExaminations.length) {\r\n          this.onExamination.label = data.name;\r\n          this.onExamination.on_examination_id = data.id;\r\n          this.onExamination.on_examination_result = 1;\r\n          this.onExaminationDialog = true;\r\n        }\r\n      } else if (this.headerName == \"Figure\") {\r\n        var aFigure =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFigure.filter(\r\n            function (el) {\r\n              return el.figure_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aFigure.length) {\r\n          this.figureDialog = true;\r\n          this.figure.name = data.name;\r\n          this.figure.figure_id = data.id;\r\n          this.figureSetupService\r\n            .getById(data.id)\r\n            .then((data) => this.getFigureFormatted(data.data));\r\n        }\r\n      } else if (this.headerName == \"Investigation\") {\r\n        var aInvestigation =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionInvestigation.filter(\r\n            function (el) {\r\n              return el.investigation_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aInvestigation.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionInvestigation.push(\r\n            {\r\n              name: data.name,\r\n              investigation_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Diagnosis\") {\r\n        var aDiagnosis =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionDiagnosis.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aDiagnosis.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionDiagnosis.push({\r\n            name: data.name,\r\n            diagnosis_id: data.id,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Family History\") {\r\n        var aFamilyHistory =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aFamilyHistory.length) {\r\n          this.familyHistory.diagnosis_id = data.id;\r\n          this.familyHistory.name = data.name;\r\n          this.familyHistoryDialog = true;\r\n        }\r\n      } else if (this.headerName == \"Past History\") {\r\n        var aPastHistory =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aPastHistory.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory.push(\r\n            {\r\n              name: data.name,\r\n              diagnosis_id: data.id,\r\n            }\r\n          );\r\n          this.showInPrescription(\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory,\r\n            !this.appointmentPrescription.pastHistory_show_in_prescription\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Medicine\") {\r\n        var aMedicine =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.push({\r\n            _medicine_type_name: data._medicine_type_name,\r\n            name: data._medicine_name,\r\n            medicine_id: data.id,\r\n            _treatment_dose_name: data._treatment_dose_name,\r\n            treatment_dose_id: data.treatment_dose_id,\r\n            _treatment_rule_name: data._treatment_rule_name,\r\n            treatment_rules_id: data.treatment_rules_id,\r\n            _treatment_duration_name: data._treatment_duration_name,\r\n            treatment_duration_id: data.treatment_duration_id,\r\n            description: data.description,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Advice\") {\r\n        var aAdvice =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.filter(\r\n            function (el) {\r\n              return el.advice_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aAdvice.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.push({\r\n            name: data.name,\r\n            advice_id: data.id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    hideDialog() {\r\n      this.currentMedicationsDialog = false;\r\n      this.pastMedicalHistoryDialog = false;\r\n      this.onExaminationDialog = false;\r\n      this.onExaminationPopupDialog = false;\r\n      //this.editOnExaminationDialog = false;\r\n      this.figureDialog = false;\r\n      this.familyHistoryDialog = false;\r\n      this.treatmentAddDialog = false;\r\n      this.treatmentDialog = false;\r\n      this.prevPrescriptionDialog = false;\r\n      this.submitted = false;\r\n    },\r\n    addOnExamination() {\r\n      if (!this.isEdit) {\r\n        this.submitted = true;\r\n        if (!this.onExamination.on_examination_result) {\r\n          return;\r\n        } else {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.push(\r\n            {\r\n              name: this.onExamination.label,\r\n              on_examination_id: this.onExamination.on_examination_id,\r\n              on_examination_result:\r\n                this.onExamination.on_examination_result.toString(),\r\n            }\r\n          );\r\n          this.submitted = false;\r\n          this.onExaminationDialog = false;\r\n        }\r\n      } else if (this.isEdit) {\r\n        this.onExaminationEditSave();\r\n        this.isEdit = false;\r\n      }\r\n\r\n    },\r\n    getFigureFormatted(data) {\r\n      this.figure.figure_image = \"data:image/jpg;base64,\" + data.figure_image;\r\n      // canvas\r\n      var vm = this;\r\n      vm.canvas = vm.$refs.canvas;\r\n      vm.context = vm.canvas.getContext(\"2d\");\r\n      vm.canvas.addEventListener(\"mousedown\", vm.mousedown);\r\n      vm.canvas.addEventListener(\"mousemove\", vm.mousemove);\r\n      document.addEventListener(\"mouseup\", vm.mouseup);\r\n\r\n      vm.img = new Image();\r\n      vm.img.onload = function () {\r\n        vm.context.drawImage(vm.img, 0, 0, 300, 200); // Or at whatever offset you like and set height, width\r\n      };\r\n\r\n      vm.img.src = this.figure.figure_image;\r\n    },\r\n    // canvas\r\n    mousedown(e) {\r\n      var vm = this;\r\n      var rect = vm.canvas.getBoundingClientRect();\r\n      var x = e.clientX - rect.left;\r\n      var y = e.clientY - rect.top;\r\n\r\n      vm.isDrawing = true;\r\n      vm.startX = x;\r\n      vm.startY = y;\r\n      vm.points.push({\r\n        x: x,\r\n        y: y,\r\n      });\r\n    },\r\n    mousemove(e) {\r\n      var vm = this;\r\n      var rect = vm.canvas.getBoundingClientRect();\r\n      var x = e.clientX - rect.left;\r\n      var y = e.clientY - rect.top;\r\n\r\n      if (vm.isDrawing) {\r\n        vm.context.beginPath();\r\n        vm.context.moveTo(vm.startX, vm.startY);\r\n        vm.context.lineTo(x, y);\r\n        vm.context.lineWidth = 1;\r\n        vm.context.lineCap = \"round\";\r\n        vm.context.strokeStyle = \"rgba(0,0,0,1)\";\r\n        vm.context.stroke();\r\n\r\n        vm.startX = x;\r\n        vm.startY = y;\r\n\r\n        vm.points.push({\r\n          x: x,\r\n          y: y,\r\n        });\r\n      }\r\n    },\r\n    mouseup() {\r\n      var vm = this;\r\n      vm.isDrawing = false;\r\n      if (vm.points.length > 0) {\r\n        localStorage[\"points\"] = JSON.stringify(vm.points);\r\n      }\r\n    },\r\n    resetCanvas() {\r\n      // var vm = this;\r\n      // vm.canvas.width = vm.canvas.width;\r\n      // vm.points.length = 0; // reset points array\r\n\r\n      var vm = this;\r\n      vm.canvas = vm.$refs.canvas;\r\n      vm.context = vm.canvas.getContext(\"2d\");\r\n      vm.canvas.addEventListener(\"mousedown\", vm.mousedown);\r\n      vm.canvas.addEventListener(\"mousemove\", vm.mousemove);\r\n      document.addEventListener(\"mouseup\", vm.mouseup);\r\n\r\n      vm.img = new Image();\r\n      vm.img.onload = function () {\r\n        vm.context.drawImage(vm.img, 0, 0, 300, 200); // Or at whatever offset you like and set height, width\r\n      };\r\n\r\n      vm.img.src = this.figure.figure_image;\r\n\r\n      vm.canvas.width = this.canvas.width;\r\n      vm.points.length = 0; // reset points array\r\n    },\r\n    // saveImage() {\r\n    //   var vm = this;\r\n    //   var dataURL = vm.canvas.toDataURL();\r\n    //   var img = vm.$refs.img;\r\n    //   img.src = dataURL;\r\n    // },\r\n    //\r\n    addFigure() {\r\n      var dataURL = this.canvas.toDataURL();\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionFigure.push({\r\n        name: this.figure.name,\r\n        figure_id: this.figure.figure_id,\r\n        figure_image: dataURL.split(\",\")[1],\r\n      });\r\n      this.figureDialog = false;\r\n      this.showInPrescription(\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionFigure,\r\n        !this.appointmentPrescription.figure_show_in_prescription\r\n      );\r\n    },\r\n    addFamilyHistory() {\r\n      this.submitted = true;\r\n      if (!this.familyHistory.relative_ralation) {\r\n        return;\r\n      } else {\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory.push(\r\n          {\r\n            diagnosis_id: this.familyHistory.diagnosis_id,\r\n            name: this.familyHistory.name,\r\n            relative_ralation: this.familyHistory.relative_ralation,\r\n          }\r\n        );\r\n        this.submitted = false;\r\n        this.familyHistoryDialog = false;\r\n        this.showInPrescription(\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory,\r\n          !this.appointmentPrescription.familyHistory_show_in_prescription\r\n        );\r\n      }\r\n    },\r\n    editTreatment(data, index) {\r\n      this.treatmentSetup.medicineName = data.name;\r\n      // this.treatmentSetup.ddlmedicine = {\r\n      //   text: data.name,\r\n      //   value: data.medicine_id,\r\n      //   refid: null,\r\n      // };\r\n      this.treatmentSetup.ddltreatment_rules = {\r\n        text: data._treatment_rule_name,\r\n        value: data.treatment_rules_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_duration = {\r\n        text: data._treatment_duration_name,\r\n        value: data.treatment_duration_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_dose = {\r\n        text: data._treatment_dose_name,\r\n        value: data.treatment_dose_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentDialog = true;\r\n      this.treatmentIndex = index\r\n    },\r\n    treatmentEditSave() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        //this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].name = this.treatmentSetup.ddlmedicine.text;\r\n        //this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].medicine_id = this.treatmentSetup.ddlmedicine.value;\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_rule_name = this.treatmentSetup.ddltreatment_rules.text;\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_rules_id = this.treatmentSetup.ddltreatment_rules.value;\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_duration_name = this.treatmentSetup.ddltreatment_duration.text;\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_duration_id = this.treatmentSetup.ddltreatment_duration.value;\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_dose_name = this.treatmentSetup.ddltreatment_dose.text;\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_dose_id = this.treatmentSetup.ddltreatment_dose.value;\r\n\r\n        this.treatmentDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n    editOnExamination(data, index) {\r\n      this.onExamination.label = data.name;\r\n      this.onExamination.on_examination_result = data.on_examination_result;\r\n      //this.editOnExaminationDialog = true;\r\n      this.onExaminationDialog = true;\r\n      this.onExaminationIndex = index;\r\n      this.isEdit = true;\r\n    },\r\n    onExaminationEditSave() {\r\n      this.submitted = true;\r\n      if (!this.onExamination.on_examination_result) {\r\n        return;\r\n      } else {\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination[this.onExaminationIndex].on_examination_result = this.onExamination.on_examination_result.toString();\r\n        //this.editOnExaminationDialog = false;\r\n        this.onExaminationDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n    deleteItem(lst, data) {\r\n      lst.splice(\r\n        lst.findIndex((i) => i === data),\r\n        1\r\n      );\r\n    },\r\n    showInPrescription(lst, val) {\r\n      lst.forEach((element) => {\r\n        element.show_in_prescription = !val;\r\n      });\r\n    },\r\n    async add() {\r\n      try {\r\n        if (\r\n          !this.appointmentPrescription.lstAppoinmentPrescriptionCompliants\r\n            .length\r\n        ) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Please add Patient Complaints\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (\r\n          !this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination\r\n            .length\r\n        ) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Please add On Examination\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else {\r\n          this.appointmentPrescription.appoinment_id =\r\n            this.appointmentInfo.appoinment_id;\r\n\r\n          this.appointmentPrescription.prescription_date = moment(\r\n            String(this.appointmentPrescription.cdprescription_date)\r\n          ).format(\"YYYY-MM-DD\");\r\n\r\n          if (this.appointmentPrescription.cdfolowup_date) {\r\n            this.appointmentPrescription.folowup_date = moment(\r\n              String(this.appointmentPrescription.cdfolowup_date)\r\n            ).format(\"YYYY-MM-DD\");\r\n          }\r\n\r\n          let result = await this.appointmentPrescriptionService.add(\r\n            this.appointmentPrescription, this\r\n          );\r\n          if (result.status === 200) {\r\n            this.downloadPrescription(this.appointmentPrescription.appoinment_id);\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Prescribed Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.newPrescription();\r\n            this.reset();\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    newPrescription() {\r\n      this.headerName = \"Sections\";\r\n      this.filters['global'].value = \"\";\r\n      this.tempData = [];\r\n      this.onExamination = {};\r\n      this.figure = {};\r\n      this.familyHistory = {};\r\n      this.appointmentPrescription = {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        figure_show_in_prescription: true,\r\n        familyHistory_show_in_prescription: true,\r\n        pastHistory_show_in_prescription: true,\r\n\r\n        lstAppoinmentPrescriptionCompliants: [],\r\n        lstAppoinmentPrescriptionOnExamination: [],\r\n        lstAppoinmentPrescriptionFigure: [],\r\n        lstAppoinmentPrescriptionInvestigation: [],\r\n        lstAppoinmentPrescriptionDiagnosis: [],\r\n        lstAppoinmentPrescriptionFamilyHistory: [],\r\n        lstAppoinmentPrescriptionPastHistory: [],\r\n        lstAppoinmentPrescriptionTreatment: [],\r\n        lstAppoinmentPrescriptionAdvice: [],\r\n      };\r\n\r\n      this.submitted = false;\r\n    },\r\n  },\r\n};"]}]}