{"remainingRequest":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\src\\scripts\\doctor-panel\\AppointmentPrescription.js","dependencies":[{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\src\\scripts\\doctor-panel\\AppointmentPrescription.js","mtime":1636272545146},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L1NWTiBQUk9KRUNUUy9EaWFnbm9zdGljQ2VudGVyTWFuYWdlbWVudF9DbGllbnQvdHJ1bmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgQ29tbW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL0NvbW1vblNlcnZpY2UiOwppbXBvcnQgRG9jdG9yQXBwb2ludG1lbnRTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvZnJvbnQtZGVzay9Eb2N0b3JBcHBvaW50bWVudFNlcnZpY2UiOwppbXBvcnQgRmlndXJlU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvRmlndXJlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IEFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2RvY3Rvci1wYW5lbC9BcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UiOyAvL2ltcG9ydCBNZWRpY2luZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL01lZGljaW5lU2V0dXBTZXJ2aWNlIjsKCmltcG9ydCBUcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvVHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UiOwppbXBvcnQgUHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3JlcG9ydC9QcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwppbXBvcnQgeyBGaWx0ZXJNYXRjaE1vZGUsIEZpbHRlck9wZXJhdG9yIH0gZnJvbSAicHJpbWV2dWUvYXBpIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRhTGlzdDogdHJ1ZSwKICAgICAgaXNBZHZpY2U6IGZhbHNlLAogICAgICBvbkV4YW1pbmF0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgb25FeGFtaW5hdGlvblBvcHVwRGlhbG9nOiBmYWxzZSwKICAgICAgLy9lZGl0T25FeGFtaW5hdGlvbkRpYWxvZzogZmFsc2UsCiAgICAgIGZpZ3VyZURpYWxvZzogZmFsc2UsCiAgICAgIGZhbWlseUhpc3RvcnlEaWFsb2c6IGZhbHNlLAogICAgICB0cmVhdG1lbnREaWFsb2c6IGZhbHNlLAogICAgICBwcmV2UHJlc2NyaXB0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgYXBwb2lubWVudFN0YXR1c0xpc3Q6IFtdLAogICAgICBwYXRpZW50c1JlbGF0aXZlTGlzdDogW10sCiAgICAgIGRvY3RvckFwcG9pbnRtZW50TGlzdDogW10sCiAgICAgIHByZXNjcmlwdGlvbkRhdGFMaXN0OiBbXSwKICAgICAgcHJldlByZXNjcmlwdGlvbkxpc3Q6IFtdLAogICAgICBoZWFkZXJOYW1lOiAiU2VjdGlvbnMiLAogICAgICB0ZW1wRGF0YTogW10sCiAgICAgIGFwcG9pbnRtZW50SW5mbzoge30sCiAgICAgIG9uRXhhbWluYXRpb246IHt9LAogICAgICBmaWd1cmU6IHt9LAogICAgICBmYW1pbHlIaXN0b3J5OiB7fSwKICAgICAgdHJlYXRtZW50U2V0dXA6IHt9LAogICAgICBkb2N0b3JBcHBvaW50bWVudDogewogICAgICAgIGNkZnJvbWRhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGNkdG9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSArIDcpKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGFwcG9pbm1lbnRfc3RhdHVzOiAiQWN0aXZlIgogICAgICB9LAogICAgICAvL1Rlc3QKICAgICAgLy8gZG9jdG9yQXBwb2ludG1lbnQ6IHsKICAgICAgLy8gICBjZGZyb21kYXRlOiAiMDEvMDEvMjAyMSIsCiAgICAgIC8vICAgY2R0b2RhdGU6ICIwMS8wMS8yMDIyIiwKICAgICAgLy8gICBhcHBvaW5tZW50X3N0YXR1czogIkFsbCIsCiAgICAgIC8vIH0sCiAgICAgIGFwcG9pbnRtZW50UHJlc2NyaXB0aW9uOiB7CiAgICAgICAgY2RwcmVzY3JpcHRpb25fZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgY2Rmb2xvd3VwX2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpICsgNykpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgZmlndXJlX3Nob3dfaW5fcHJlc2NyaXB0aW9uOiB0cnVlLAogICAgICAgIGZhbWlseUhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgcGFzdEhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgYWxsQWR2aWNlOiBmYWxzZSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQ29tcGxpYW50czogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb246IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GaWd1cmU6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRGlhZ25vc2lzOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmFtaWx5SGlzdG9yeTogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvblBhc3RIaXN0b3J5OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9LAogICAgICAvL21lZGljaW5lTGlzdDogW10sCiAgICAgIHRyZWF0bWVudFJ1bGVzTGlzdDogW10sCiAgICAgIHRyZWF0bWVudER1cmF0aW9uTGlzdDogW10sCiAgICAgIHRyZWF0bWVudERvc2VMaXN0OiBbXSwKICAgICAgLy8gY2FudmFzCiAgICAgIGNhbnZhczogbnVsbCwKICAgICAgY29udGV4dDogbnVsbCwKICAgICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgICAgc3RhcnRYOiAwLAogICAgICBzdGFydFk6IDAsCiAgICAgIHBvaW50czogW10sCiAgICAgIC8vCiAgICAgIHN1Ym1pdHRlZDogZmFsc2UsCiAgICAgIGZpbHRlcnM6IHsKICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICB9LAogICAgICAgIG5hbWU6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuU1RBUlRTX1dJVEgKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGluaXRGaWx0ZXJzOiBmdW5jdGlvbiBpbml0RmlsdGVycygpIHsKICAgICAgICB0aGlzLmZpbHRlcnMgPSB7CiAgICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLkNPTlRBSU5TCiAgICAgICAgICB9LAogICAgICAgICAgbmFtZTogewogICAgICAgICAgICBvcGVyYXRvcjogRmlsdGVyT3BlcmF0b3IuQU5ELAogICAgICAgICAgICBjb25zdHJhaW50czogW3sKICAgICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgICAgICB9XQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UoKTsKICAgIHRoaXMuZmlndXJlU2V0dXBTZXJ2aWNlID0gbmV3IEZpZ3VyZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudFNlcnZpY2UgPSBuZXcgRG9jdG9yQXBwb2ludG1lbnRTZXJ2aWNlKCk7CiAgICB0aGlzLmNvbW1vblNlcnZpY2UgPSBuZXcgQ29tbW9uU2VydmljZSgpOyAvL3RoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UgPSBuZXcgTWVkaWNpbmVTZXR1cFNlcnZpY2UoKTsKCiAgICB0aGlzLnRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgPSBuZXcgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5wcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlID0gbmV3IFByZXNjcmlwdGlvblJlcG9ydFNlcnZpY2UoKTsKICAgIHRoaXMudXNlckluZm8gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySW5mbyIpKTsKICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxBcHBvaW5tZW50U3RhdHVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMuYXBwb2lubWVudFN0YXR1c0xpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxQYXRpZW50c1JlbGF0aXZlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLnBhdGllbnRzUmVsYXRpdmVMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmVzY3JpcHRpb25EYXRhQnlEb2N0b3JJZCh0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsgLy8KICAgIC8vIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UKICAgIC8vICAgLmdldEFjdGl2ZUNvbWJvKCkKICAgIC8vICAgLnRoZW4oKGRhdGEpID0+ICh0aGlzLm1lZGljaW5lTGlzdCA9IGRhdGEuZGF0YSkpOwoKICAgIHRoaXMudHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy50cmVhdG1lbnRSdWxlc0xpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMudHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy50cmVhdG1lbnREdXJhdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLnRyZWF0bWVudERvc2VMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLnNob3coKTsKICAgIHRoaXMubmV3UHJlc2NyaXB0aW9uKCk7CiAgICB2YXIgdGhhdCA9IHRoaXM7CgogICAgZG9jdW1lbnQub25rZXl1cCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2NykgewogICAgICAgIHRoYXQuZ2V0UGF0aWVudENvbXBsYWludHMoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2OSkgewogICAgICAgIHRoYXQuZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpOwogICAgICAgIHRoYXQuZ2V0T25FeGFtaW5hdGlvbnMoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA3MCkgewogICAgICAgIHRoYXQuZ2V0RmlndXJlKCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzMpIHsKICAgICAgICB0aGF0LmdldEludmVzdGlnYXRpb24oKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2OCkgewogICAgICAgIHRoYXQuZ2V0RGlhZ25vc2lzKCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzIpIHsKICAgICAgICB0aGF0LmdldEZhbWlseUhpc3RvcnkoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4MCkgewogICAgICAgIHRoYXQuZ2V0UGFzdEhpc3RvcnkoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4NCkgewogICAgICAgIHRoYXQuZ2V0VHJlYXRtZW50KCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNjUpIHsKICAgICAgICB0aGF0LmdldEFkdmljZSgpOwogICAgICB9IC8vIGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLnNoaWZ0S2V5KSB7CiAgICAgIC8vIH0KCiAgICB9OwoKICAgIHZhciBwcmVzY3JpcHRpb25EYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJlc2NyaXB0aW9uRGF0YScpKTsKCiAgICBpZiAocHJlc2NyaXB0aW9uRGF0YSkgewogICAgICB0aGlzLnByZXNjcmlwdGlvbihwcmVzY3JpcHRpb25EYXRhKTsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3ByZXNjcmlwdGlvbkRhdGEnKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudCA9IHsKICAgICAgICBjZGZyb21kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZHRvZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBhcHBvaW5tZW50X3N0YXR1czogIkFjdGl2ZSIKICAgICAgfTsgLy8gdGhpcy5kYXRhTGlzdCA9IHRydWU7CiAgICAgIC8vIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CgogICAgICB0aGlzLnNob3coKTsKICAgIH0sCiAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy5kb2N0b3JBcHBvaW50bWVudC5jZGZyb21kYXRlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmRvY3RvckFwcG9pbnRtZW50LmNkdG9kYXRlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmRvY3RvckFwcG9pbnRtZW50LmFwcG9pbm1lbnRfc3RhdHVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuZnJvbWRhdGUgPSBtb21lbnQoU3RyaW5nKHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuY2Rmcm9tZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQudG9kYXRlID0gbW9tZW50KFN0cmluZyh0aGlzLmRvY3RvckFwcG9pbnRtZW50LmNkdG9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudFNlcnZpY2UuZ2V0RHluYW1pY0RvY3Rvcldpc2UodGhpcy5kb2N0b3JBcHBvaW50bWVudC5mcm9tZGF0ZSwgdGhpcy5kb2N0b3JBcHBvaW50bWVudC50b2RhdGUsIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuYXBwb2lubWVudF9zdGF0dXMsIHRoaXMudXNlckluZm8uZG9jdG9yX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLmRvY3RvckFwcG9pbnRtZW50TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgICB9KTsgLy9UZXN0CiAgICAgICAgLy8gdGhpcy5kb2N0b3JBcHBvaW50bWVudFNlcnZpY2UKICAgICAgICAvLyAgIC5nZXREeW5hbWljRG9jdG9yV2lzZSgKICAgICAgICAvLyAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudC5mcm9tZGF0ZSwKICAgICAgICAvLyAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudC50b2RhdGUsCiAgICAgICAgLy8gICAgIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuYXBwb2lubWVudF9zdGF0dXMsCiAgICAgICAgLy8gICAgIHRoaXMudXNlckluZm8uZG9jdG9yX2lkCiAgICAgICAgLy8gICApCiAgICAgICAgLy8gICAudGhlbigoZGF0YSkgPT4gdGhpcy5wcmVzY3JpcHRpb24oZGF0YS5kYXRhKSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZGF0YUxpc3QgPSB0cnVlOwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfSwKICAgIHByZXNjcmlwdGlvbjogZnVuY3Rpb24gcHJlc2NyaXB0aW9uKGRhdGEpIHsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8uYXBwb2lubWVudF9pZCA9IGRhdGEuYXBwb2lubWVudF9pZDsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8ucGF0aWVudFJlZyA9IGRhdGEuYVBhdGllbnQucmVnaXN0cmF0aW9uX25vOwogICAgICB0aGlzLmFwcG9pbnRtZW50SW5mby5wYXRpZW50TmFtZSA9IGRhdGEuYVBhdGllbnQuZmlyc3RfbmFtZSArICIgIiArIGRhdGEuYVBhdGllbnQubGFzdF9uYW1lOwogICAgICB0aGlzLmFwcG9pbnRtZW50SW5mby5wYXRpZW50R2VuZGVyID0gZGF0YS5hUGF0aWVudC5nZW5kZXI7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRJbmZvLnBhdGllbnRBZ2VZZWFyID0gZGF0YS5hUGF0aWVudC5hZ2VfeWVhcjsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8ucGF0aWVudEFnZU1vbnRoID0gZGF0YS5hUGF0aWVudC5hZ2VfbW9udGg7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRJbmZvLnBhdGllbnRBZ2VEYXkgPSBkYXRhLmFQYXRpZW50LmFnZV9kYXk7IC8vIHZhciBwYXRpZW50RE9CID0gbW9tZW50KFN0cmluZyhkYXRhLmFQYXRpZW50LmRvYikpLmZvcm1hdCgKICAgICAgLy8gICAiTU0vREQvWVlZWSIKICAgICAgLy8gKTsKICAgICAgLy90aGlzLmFwcG9pbnRtZW50SW5mby5hZ2UgPSBNYXRoLmZsb29yKG1vbWVudChuZXcgRGF0ZSgpKS5kaWZmKG1vbWVudChwYXRpZW50RE9CLCAiTU0vREQvWVlZWSIpLCAneWVhcnMnLCB0cnVlKSk7CiAgICAgIC8vdGhpcy5hcHBvaW50bWVudEluZm8uYWdlID0gbW9tZW50KHBhdGllbnRET0IsICJNTS9ERC9ZWVlZIikuZnJvbU5vdygpLnNwbGl0KCIgIilbMF07CgogICAgICB0aGlzLmRhdGFMaXN0ID0gZmFsc2U7CiAgICB9LAogICAgcHJldmlvdXNQcmVzY3JpcHRpb246IGZ1bmN0aW9uIHByZXZpb3VzUHJlc2NyaXB0aW9uKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZS5nZXRQYXRpZW50V2lzZVByZXNjcmlwdGlvbkxpc3QocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMucHJldlByZXNjcmlwdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnByZXZQcmVzY3JpcHRpb25EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGRvd25sb2FkUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBkb3dubG9hZFByZXNjcmlwdGlvbihhcHBvaW5tZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy5wcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlLkdldFBlc2NyaXB0aW9uKGFwcG9pbm1lbnRfaWQsIHRoaXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LmNvbW1vblNlcnZpY2UuRG93bmxvYWRmaWxlKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgfSwKICAgIGZvcm1hdERhdGU6IGZ1bmN0aW9uIGZvcm1hdERhdGUodmFsdWUpIHsKICAgICAgcmV0dXJuIG1vbWVudChTdHJpbmcodmFsdWUpKS5mb3JtYXQoIk1NL0REL1lZWVkgaDptbTpzcyBhIik7CiAgICB9LAogICAgLy8KICAgIGdldFBhdGllbnRDb21wbGFpbnRzOiBmdW5jdGlvbiBnZXRQYXRpZW50Q29tcGxhaW50cygpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiUGF0aWVudCBDb21wbGFpbnRzIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RDb21wbGFpbnQuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzNS50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuY29tcGlsYW50c19uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuY29tcGlsYW50c19pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwOiBmdW5jdGlvbiBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwKCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHRoaXMucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RPbkV4YW1pbmF0aW9uLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczYucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5vbl9leGFtaW5hdGlvbl9pZCwKICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX3Jlc3VsdDogMQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uUG9wdXBEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGdldE9uRXhhbWluYXRpb25zOiBmdW5jdGlvbiBnZXRPbkV4YW1pbmF0aW9ucygpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICAvL3RoaXMuZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpOwogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiT24gRXhhbWluYXRpb25zIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RPbkV4YW1pbmF0aW9uLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczcudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5vbl9leGFtaW5hdGlvbl9pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRGaWd1cmU6IGZ1bmN0aW9uIGdldEZpZ3VyZSgpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiRmlndXJlIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RGaWd1cmVTZXR1cC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXM4LnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5maWd1cmVfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmZpZ3VyZV9pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRJbnZlc3RpZ2F0aW9uOiBmdW5jdGlvbiBnZXRJbnZlc3RpZ2F0aW9uKCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJJbnZlc3RpZ2F0aW9uIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RJbnZlc3RpZ2F0aW9uLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczkudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50LmludmVzdGluZ2F0aW9uX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5pbnZlc3RpZ2F0aW9uX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldERpYWdub3NpczogZnVuY3Rpb24gZ2V0RGlhZ25vc2lzKCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiRGlhZ25vc2lzIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3REaWFnbm9zaXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzMTAudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50LmRpYWdub3Npc19uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuZGlhZ25vc2lzX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEZhbWlseUhpc3Rvcnk6IGZ1bmN0aW9uIGdldEZhbWlseUhpc3RvcnkoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJGYW1pbHkgSGlzdG9yeSI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0RGlhZ25vc2lzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczExLnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5kaWFnbm9zaXNfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmRpYWdub3Npc19pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRQYXN0SGlzdG9yeTogZnVuY3Rpb24gZ2V0UGFzdEhpc3RvcnkoKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJQYXN0IEhpc3RvcnkiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdERpYWdub3Npcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxMi50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuZGlhZ25vc2lzX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5kaWFnbm9zaXNfaWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0VHJlYXRtZW50OiBmdW5jdGlvbiBnZXRUcmVhdG1lbnQoKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJNZWRpY2luZSI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0VHJlYXRtZW50LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczEzLnRlbXBEYXRhLnB1c2goewogICAgICAgICAgX21lZGljaW5lX3R5cGVfbmFtZTogZWxlbWVudC5fbWVkaWNpbmVfdHlwZV9uYW1lLAogICAgICAgICAgX21lZGljaW5lX25hbWU6IGVsZW1lbnQuX21lZGljaW5lX25hbWUsCiAgICAgICAgICBuYW1lOiBlbGVtZW50Ll9tZWRpY2luZV90eXBlX25hbWUgKyAiICIgKyBlbGVtZW50Ll9tZWRpY2luZV9uYW1lICsgIiAiICsgZWxlbWVudC5fdHJlYXRtZW50X2Rvc2VfbmFtZSArICIgIiArIGVsZW1lbnQuX3RyZWF0bWVudF9ydWxlX25hbWUgKyAiICIgKyBlbGVtZW50Ll90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50Lm1lZGljaW5lX2lkLAogICAgICAgICAgX3RyZWF0bWVudF9kb3NlX25hbWU6IGVsZW1lbnQuX3RyZWF0bWVudF9kb3NlX25hbWUsCiAgICAgICAgICB0cmVhdG1lbnRfZG9zZV9pZDogZWxlbWVudC50cmVhdG1lbnRfZG9zZV9pZCwKICAgICAgICAgIF90cmVhdG1lbnRfcnVsZV9uYW1lOiBlbGVtZW50Ll90cmVhdG1lbnRfcnVsZV9uYW1lLAogICAgICAgICAgdHJlYXRtZW50X3J1bGVzX2lkOiBlbGVtZW50LnRyZWF0bWVudF9ydWxlc19pZCwKICAgICAgICAgIF90cmVhdG1lbnRfZHVyYXRpb25fbmFtZTogZWxlbWVudC5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgICAgICB0cmVhdG1lbnRfZHVyYXRpb25faWQ6IGVsZW1lbnQudHJlYXRtZW50X2R1cmF0aW9uX2lkLAogICAgICAgICAgZGVzY3JpcHRpb246IGVsZW1lbnQuZGVzY3JpcHRpb24KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0QWR2aWNlOiBmdW5jdGlvbiBnZXRBZHZpY2UoKSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJBZHZpY2UiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSB0cnVlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0QWR2aWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxNC50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuYWR2aWNlX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5hZHZpY2VfaWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgYWRkT25FeGFtaW5hdGlvbkZyb21Qb3B1cDogZnVuY3Rpb24gYWRkT25FeGFtaW5hdGlvbkZyb21Qb3B1cCgpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgLy90aGlzLnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgIC8vdGhpcy5yZXF1cmVkID0gIiI7CiAgICAgIHRoaXMucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIGlmIChlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX3Jlc3VsdCkgewogICAgICAgICAgLy90aGlzLnJlcXVyZWQgPSAicmVxdWlyZWQiOwogICAgICAgICAgdmFyIGFPbkV4YW1pbmF0aW9ucyA9IF90aGlzMTUuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb24uZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICByZXR1cm4gZWwub25fZXhhbWluYXRpb25faWQgPT09IGVsZW1lbnQuaWQ7CiAgICAgICAgICB9LCBfdGhpczE1KTsKCiAgICAgICAgICBpZiAoIWFPbkV4YW1pbmF0aW9ucy5sZW5ndGgpIHsKICAgICAgICAgICAgX3RoaXMxNS5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uT25FeGFtaW5hdGlvbi5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiBlbGVtZW50Lm5hbWUsCiAgICAgICAgICAgICAgb25fZXhhbWluYXRpb25faWQ6IGVsZW1lbnQuaWQsCiAgICAgICAgICAgICAgb25fZXhhbWluYXRpb25fcmVzdWx0OiBlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX3Jlc3VsdC50b1N0cmluZygpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7IC8vIGlmICh0aGlzLnJlcXVyZWQpIHsKICAgICAgLy8gICB0aGlzLiR0b2FzdC5hZGQoewogICAgICAvLyAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgIC8vICAgICBzdW1tYXJ5OiAiUmVxdWlyZWQiLAogICAgICAvLyAgICAgZGV0YWlsOiAiUGxlYXNlIGZpbGwgaW4gdGhlIHJlcXVpcmVkIGZpZWxkcyIsCiAgICAgIC8vICAgICBsaWZlOiAxMDAwMCwKICAgICAgLy8gICB9KTsKICAgICAgLy8gICByZXR1cm47CiAgICAgIC8vIH0KCiAgICAgIHRoaXMub25FeGFtaW5hdGlvblBvcHVwRGlhbG9nID0gZmFsc2U7CiAgICB9LAogICAgLy8gYWRkIGFsbCBhZHZpY2UgY2hlY2tib3gKICAgIGFkZEFsbEFkdmljZTogZnVuY3Rpb24gYWRkQWxsQWR2aWNlKCkgewogICAgICB2YXIgX3RoaXMxNiA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uYWxsQWR2aWNlKSB7CiAgICAgICAgdGhpcy50ZW1wRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICB2YXIgYUFkdmljZSA9IF90aGlzMTYuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkFkdmljZS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgIHJldHVybiBlbC5hZHZpY2VfaWQgPT09IGVsZW1lbnQuaWQ7CiAgICAgICAgICB9LCBfdGhpczE2KTsKCiAgICAgICAgICBpZiAoIWFBZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICAgIF90aGlzMTYuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkFkdmljZS5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiBlbGVtZW50Lm5hbWUsCiAgICAgICAgICAgICAgYWR2aWNlX2lkOiBlbGVtZW50LmlkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8gYWRkIHZhbHVlIAogICAgZ2V0VmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMTcgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiUGF0aWVudCBDb21wbGFpbnRzIikgewogICAgICAgIHZhciBhQ29tcGxpYW50cyA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkNvbXBsaWFudHMuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmNvbXBpbGFudHNfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUNvbXBsaWFudHMubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25Db21wbGlhbnRzLnB1c2goewogICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgICAgIGNvbXBpbGFudHNfaWQ6IGRhdGEuaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIk9uIEV4YW1pbmF0aW9ucyIpIHsKICAgICAgICB2YXIgYU9uRXhhbWluYXRpb25zID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uT25FeGFtaW5hdGlvbi5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwub25fZXhhbWluYXRpb25faWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYU9uRXhhbWluYXRpb25zLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uLmxhYmVsID0gZGF0YS5uYW1lOwogICAgICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uLm9uX2V4YW1pbmF0aW9uX2lkID0gZGF0YS5pZDsKICAgICAgICAgIHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQgPSAxOwogICAgICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJGaWd1cmUiKSB7CiAgICAgICAgdmFyIGFGaWd1cmUgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GaWd1cmUuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmZpZ3VyZV9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhRmlndXJlLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5maWd1cmVEaWFsb2cgPSB0cnVlOwogICAgICAgICAgdGhpcy5maWd1cmUubmFtZSA9IGRhdGEubmFtZTsKICAgICAgICAgIHRoaXMuZmlndXJlLmZpZ3VyZV9pZCA9IGRhdGEuaWQ7CiAgICAgICAgICB0aGlzLmZpZ3VyZVNldHVwU2VydmljZS5nZXRCeUlkKGRhdGEuaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMTcuZ2V0RmlndXJlRm9ybWF0dGVkKGRhdGEuZGF0YSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJJbnZlc3RpZ2F0aW9uIikgewogICAgICAgIHZhciBhSW52ZXN0aWdhdGlvbiA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkludmVzdGlnYXRpb24uZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmludmVzdGlnYXRpb25faWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUludmVzdGlnYXRpb24ubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uLnB1c2goewogICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgICAgIGludmVzdGlnYXRpb25faWQ6IGRhdGEuaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIkRpYWdub3NpcyIpIHsKICAgICAgICB2YXIgYURpYWdub3NpcyA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkRpYWdub3Npcy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuZGlhZ25vc2lzX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFEaWFnbm9zaXMubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25EaWFnbm9zaXMucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgZGlhZ25vc2lzX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJGYW1pbHkgSGlzdG9yeSIpIHsKICAgICAgICB2YXIgYUZhbWlseUhpc3RvcnkgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GYW1pbHlIaXN0b3J5LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5kaWFnbm9zaXNfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUZhbWlseUhpc3RvcnkubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmZhbWlseUhpc3RvcnkuZGlhZ25vc2lzX2lkID0gZGF0YS5pZDsKICAgICAgICAgIHRoaXMuZmFtaWx5SGlzdG9yeS5uYW1lID0gZGF0YS5uYW1lOwogICAgICAgICAgdGhpcy5mYW1pbHlIaXN0b3J5RGlhbG9nID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJQYXN0IEhpc3RvcnkiKSB7CiAgICAgICAgdmFyIGFQYXN0SGlzdG9yeSA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblBhc3RIaXN0b3J5LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5kaWFnbm9zaXNfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYVBhc3RIaXN0b3J5Lmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uUGFzdEhpc3RvcnkucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgZGlhZ25vc2lzX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc2hvd0luUHJlc2NyaXB0aW9uKHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblBhc3RIaXN0b3J5LCAhdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5wYXN0SGlzdG9yeV9zaG93X2luX3ByZXNjcmlwdGlvbik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiTWVkaWNpbmUiKSB7CiAgICAgICAgdmFyIGFNZWRpY2luZSA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwubWVkaWNpbmVfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYU1lZGljaW5lLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50LnB1c2goewogICAgICAgICAgICBfbWVkaWNpbmVfdHlwZV9uYW1lOiBkYXRhLl9tZWRpY2luZV90eXBlX25hbWUsCiAgICAgICAgICAgIG5hbWU6IGRhdGEuX21lZGljaW5lX25hbWUsCiAgICAgICAgICAgIG1lZGljaW5lX2lkOiBkYXRhLmlkLAogICAgICAgICAgICBfdHJlYXRtZW50X2Rvc2VfbmFtZTogZGF0YS5fdHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgICAgICAgdHJlYXRtZW50X2Rvc2VfaWQ6IGRhdGEudHJlYXRtZW50X2Rvc2VfaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfcnVsZV9uYW1lOiBkYXRhLl90cmVhdG1lbnRfcnVsZV9uYW1lLAogICAgICAgICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IGRhdGEudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAgICAgICBfdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IGRhdGEuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAgICAgICB0cmVhdG1lbnRfZHVyYXRpb25faWQ6IGRhdGEudHJlYXRtZW50X2R1cmF0aW9uX2lkLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiQWR2aWNlIikgewogICAgICAgIHZhciBhQWR2aWNlID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5hZHZpY2VfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUFkdmljZS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkFkdmljZS5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICBhZHZpY2VfaWQ6IGRhdGEuaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGhpZGVEaWFsb2c6IGZ1bmN0aW9uIGhpZGVEaWFsb2coKSB7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25Qb3B1cERpYWxvZyA9IGZhbHNlOyAvL3RoaXMuZWRpdE9uRXhhbWluYXRpb25EaWFsb2cgPSBmYWxzZTsKCiAgICAgIHRoaXMuZmlndXJlRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuZmFtaWx5SGlzdG9yeURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnRyZWF0bWVudERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnByZXZQcmVzY3JpcHRpb25EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgIH0sCiAgICBhZGRPbkV4YW1pbmF0aW9uOiBmdW5jdGlvbiBhZGRPbkV4YW1pbmF0aW9uKCkgewogICAgICBpZiAoIXRoaXMuaXNFZGl0KSB7CiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgICBpZiAoIXRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uT25FeGFtaW5hdGlvbi5wdXNoKHsKICAgICAgICAgICAgbmFtZTogdGhpcy5vbkV4YW1pbmF0aW9uLmxhYmVsLAogICAgICAgICAgICBvbl9leGFtaW5hdGlvbl9pZDogdGhpcy5vbkV4YW1pbmF0aW9uLm9uX2V4YW1pbmF0aW9uX2lkLAogICAgICAgICAgICBvbl9leGFtaW5hdGlvbl9yZXN1bHQ6IHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQudG9TdHJpbmcoKQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaXNFZGl0KSB7CiAgICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRWRpdFNhdmUoKTsKICAgICAgICB0aGlzLmlzRWRpdCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgZ2V0RmlndXJlRm9ybWF0dGVkOiBmdW5jdGlvbiBnZXRGaWd1cmVGb3JtYXR0ZWQoZGF0YSkgewogICAgICB0aGlzLmZpZ3VyZS5maWd1cmVfaW1hZ2UgPSAiZGF0YTppbWFnZS9qcGc7YmFzZTY0LCIgKyBkYXRhLmZpZ3VyZV9pbWFnZTsgLy8gY2FudmFzCgogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS5jYW52YXMgPSB2bS4kcmVmcy5jYW52YXM7CiAgICAgIHZtLmNvbnRleHQgPSB2bS5jYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgdm0uY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIHZtLm1vdXNlZG93bik7CiAgICAgIHZtLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLCB2bS5tb3VzZW1vdmUpOwogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwgdm0ubW91c2V1cCk7CiAgICAgIHZtLmltZyA9IG5ldyBJbWFnZSgpOwoKICAgICAgdm0uaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2bS5jb250ZXh0LmRyYXdJbWFnZSh2bS5pbWcsIDAsIDAsIDMwMCwgMjAwKTsgLy8gT3IgYXQgd2hhdGV2ZXIgb2Zmc2V0IHlvdSBsaWtlIGFuZCBzZXQgaGVpZ2h0LCB3aWR0aAogICAgICB9OwoKICAgICAgdm0uaW1nLnNyYyA9IHRoaXMuZmlndXJlLmZpZ3VyZV9pbWFnZTsKICAgIH0sCiAgICAvLyBjYW52YXMKICAgIG1vdXNlZG93bjogZnVuY3Rpb24gbW91c2Vkb3duKGUpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdmFyIHJlY3QgPSB2bS5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHZhciB4ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0OwogICAgICB2YXIgeSA9IGUuY2xpZW50WSAtIHJlY3QudG9wOwogICAgICB2bS5pc0RyYXdpbmcgPSB0cnVlOwogICAgICB2bS5zdGFydFggPSB4OwogICAgICB2bS5zdGFydFkgPSB5OwogICAgICB2bS5wb2ludHMucHVzaCh7CiAgICAgICAgeDogeCwKICAgICAgICB5OiB5CiAgICAgIH0pOwogICAgfSwKICAgIG1vdXNlbW92ZTogZnVuY3Rpb24gbW91c2Vtb3ZlKGUpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdmFyIHJlY3QgPSB2bS5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHZhciB4ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0OwogICAgICB2YXIgeSA9IGUuY2xpZW50WSAtIHJlY3QudG9wOwoKICAgICAgaWYgKHZtLmlzRHJhd2luZykgewogICAgICAgIHZtLmNvbnRleHQuYmVnaW5QYXRoKCk7CiAgICAgICAgdm0uY29udGV4dC5tb3ZlVG8odm0uc3RhcnRYLCB2bS5zdGFydFkpOwogICAgICAgIHZtLmNvbnRleHQubGluZVRvKHgsIHkpOwogICAgICAgIHZtLmNvbnRleHQubGluZVdpZHRoID0gMTsKICAgICAgICB2bS5jb250ZXh0LmxpbmVDYXAgPSAicm91bmQiOwogICAgICAgIHZtLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSAicmdiYSgwLDAsMCwxKSI7CiAgICAgICAgdm0uY29udGV4dC5zdHJva2UoKTsKICAgICAgICB2bS5zdGFydFggPSB4OwogICAgICAgIHZtLnN0YXJ0WSA9IHk7CiAgICAgICAgdm0ucG9pbnRzLnB1c2goewogICAgICAgICAgeDogeCwKICAgICAgICAgIHk6IHkKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIG1vdXNldXA6IGZ1bmN0aW9uIG1vdXNldXAoKSB7CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLmlzRHJhd2luZyA9IGZhbHNlOwoKICAgICAgaWYgKHZtLnBvaW50cy5sZW5ndGggPiAwKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlWyJwb2ludHMiXSA9IEpTT04uc3RyaW5naWZ5KHZtLnBvaW50cyk7CiAgICAgIH0KICAgIH0sCiAgICByZXNldENhbnZhczogZnVuY3Rpb24gcmVzZXRDYW52YXMoKSB7CiAgICAgIC8vIHZhciB2bSA9IHRoaXM7CiAgICAgIC8vIHZtLmNhbnZhcy53aWR0aCA9IHZtLmNhbnZhcy53aWR0aDsKICAgICAgLy8gdm0ucG9pbnRzLmxlbmd0aCA9IDA7IC8vIHJlc2V0IHBvaW50cyBhcnJheQogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS5jYW52YXMgPSB2bS4kcmVmcy5jYW52YXM7CiAgICAgIHZtLmNvbnRleHQgPSB2bS5jYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgdm0uY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIHZtLm1vdXNlZG93bik7CiAgICAgIHZtLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJtb3VzZW1vdmUiLCB2bS5tb3VzZW1vdmUpOwogICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXVwIiwgdm0ubW91c2V1cCk7CiAgICAgIHZtLmltZyA9IG5ldyBJbWFnZSgpOwoKICAgICAgdm0uaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2bS5jb250ZXh0LmRyYXdJbWFnZSh2bS5pbWcsIDAsIDAsIDMwMCwgMjAwKTsgLy8gT3IgYXQgd2hhdGV2ZXIgb2Zmc2V0IHlvdSBsaWtlIGFuZCBzZXQgaGVpZ2h0LCB3aWR0aAogICAgICB9OwoKICAgICAgdm0uaW1nLnNyYyA9IHRoaXMuZmlndXJlLmZpZ3VyZV9pbWFnZTsKICAgICAgdm0uY2FudmFzLndpZHRoID0gdGhpcy5jYW52YXMud2lkdGg7CiAgICAgIHZtLnBvaW50cy5sZW5ndGggPSAwOyAvLyByZXNldCBwb2ludHMgYXJyYXkKICAgIH0sCiAgICAvLyBzYXZlSW1hZ2UoKSB7CiAgICAvLyAgIHZhciB2bSA9IHRoaXM7CiAgICAvLyAgIHZhciBkYXRhVVJMID0gdm0uY2FudmFzLnRvRGF0YVVSTCgpOwogICAgLy8gICB2YXIgaW1nID0gdm0uJHJlZnMuaW1nOwogICAgLy8gICBpbWcuc3JjID0gZGF0YVVSTDsKICAgIC8vIH0sCiAgICAvLwogICAgYWRkRmlndXJlOiBmdW5jdGlvbiBhZGRGaWd1cmUoKSB7CiAgICAgIHZhciBkYXRhVVJMID0gdGhpcy5jYW52YXMudG9EYXRhVVJMKCk7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZpZ3VyZS5wdXNoKHsKICAgICAgICBuYW1lOiB0aGlzLmZpZ3VyZS5uYW1lLAogICAgICAgIGZpZ3VyZV9pZDogdGhpcy5maWd1cmUuZmlndXJlX2lkLAogICAgICAgIGZpZ3VyZV9pbWFnZTogZGF0YVVSTC5zcGxpdCgiLCIpWzFdCiAgICAgIH0pOwogICAgICB0aGlzLmZpZ3VyZURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnNob3dJblByZXNjcmlwdGlvbih0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GaWd1cmUsICF0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmZpZ3VyZV9zaG93X2luX3ByZXNjcmlwdGlvbik7CiAgICB9LAogICAgYWRkRmFtaWx5SGlzdG9yeTogZnVuY3Rpb24gYWRkRmFtaWx5SGlzdG9yeSgpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLmZhbWlseUhpc3RvcnkucmVsYXRpdmVfcmFsYXRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmFtaWx5SGlzdG9yeS5wdXNoKHsKICAgICAgICAgIGRpYWdub3Npc19pZDogdGhpcy5mYW1pbHlIaXN0b3J5LmRpYWdub3Npc19pZCwKICAgICAgICAgIG5hbWU6IHRoaXMuZmFtaWx5SGlzdG9yeS5uYW1lLAogICAgICAgICAgcmVsYXRpdmVfcmFsYXRpb246IHRoaXMuZmFtaWx5SGlzdG9yeS5yZWxhdGl2ZV9yYWxhdGlvbgogICAgICAgIH0pOwogICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgICAgdGhpcy5mYW1pbHlIaXN0b3J5RGlhbG9nID0gZmFsc2U7CiAgICAgICAgdGhpcy5zaG93SW5QcmVzY3JpcHRpb24odGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmFtaWx5SGlzdG9yeSwgIXRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uZmFtaWx5SGlzdG9yeV9zaG93X2luX3ByZXNjcmlwdGlvbik7CiAgICAgIH0KICAgIH0sCiAgICBlZGl0VHJlYXRtZW50OiBmdW5jdGlvbiBlZGl0VHJlYXRtZW50KGRhdGEsIGluZGV4KSB7CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAubWVkaWNpbmVOYW1lID0gZGF0YS5uYW1lOyAvLyB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lID0gewogICAgICAvLyAgIHRleHQ6IGRhdGEubmFtZSwKICAgICAgLy8gICB2YWx1ZTogZGF0YS5tZWRpY2luZV9pZCwKICAgICAgLy8gICByZWZpZDogbnVsbCwKICAgICAgLy8gfTsKCiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAgIHJlZmlkOiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAgIHZhbHVlOiBkYXRhLnRyZWF0bWVudF9kdXJhdGlvbl9pZCwKICAgICAgICByZWZpZDogbnVsbAogICAgICB9OwogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9kb3NlX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X2Rvc2VfaWQsCiAgICAgICAgcmVmaWQ6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy50cmVhdG1lbnREaWFsb2cgPSB0cnVlOwogICAgICB0aGlzLnRyZWF0bWVudEluZGV4ID0gaW5kZXg7CiAgICB9LAogICAgdHJlYXRtZW50RWRpdFNhdmU6IGZ1bmN0aW9uIHRyZWF0bWVudEVkaXRTYXZlKCkgewogICAgICAvL3RoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS50ZXh0OwogICAgICAvL3RoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5tZWRpY2luZV9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudmFsdWU7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5fdHJlYXRtZW50X3J1bGVfbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnRleHQ7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS50cmVhdG1lbnRfcnVsZXNfaWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy52YWx1ZTsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnRleHQ7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS50cmVhdG1lbnRfZHVyYXRpb25faWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbi52YWx1ZTsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfZG9zZV9uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZS50ZXh0OwogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X2Rvc2VfaWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnZhbHVlOwogICAgICB0aGlzLnRyZWF0bWVudERpYWxvZyA9IGZhbHNlOwogICAgfSwKICAgIGVkaXRPbkV4YW1pbmF0aW9uOiBmdW5jdGlvbiBlZGl0T25FeGFtaW5hdGlvbihkYXRhLCBpbmRleCkgewogICAgICB0aGlzLm9uRXhhbWluYXRpb24ubGFiZWwgPSBkYXRhLm5hbWU7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQgPSBkYXRhLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdDsgLy90aGlzLmVkaXRPbkV4YW1pbmF0aW9uRGlhbG9nID0gdHJ1ZTsKCiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IHRydWU7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkluZGV4ID0gaW5kZXg7CiAgICAgIHRoaXMuaXNFZGl0ID0gdHJ1ZTsKICAgIH0sCiAgICBvbkV4YW1pbmF0aW9uRWRpdFNhdmU6IGZ1bmN0aW9uIG9uRXhhbWluYXRpb25FZGl0U2F2ZSgpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLm9uRXhhbWluYXRpb24ub25fZXhhbWluYXRpb25fcmVzdWx0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb25bdGhpcy5vbkV4YW1pbmF0aW9uSW5kZXhdLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdCA9IHRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQudG9TdHJpbmcoKTsgLy90aGlzLmVkaXRPbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7CgogICAgICAgIHRoaXMub25FeGFtaW5hdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVJdGVtOiBmdW5jdGlvbiBkZWxldGVJdGVtKGxzdCwgZGF0YSkgewogICAgICBsc3Quc3BsaWNlKGxzdC5maW5kSW5kZXgoZnVuY3Rpb24gKGkpIHsKICAgICAgICByZXR1cm4gaSA9PT0gZGF0YTsKICAgICAgfSksIDEpOwogICAgfSwKICAgIHNob3dJblByZXNjcmlwdGlvbjogZnVuY3Rpb24gc2hvd0luUHJlc2NyaXB0aW9uKGxzdCwgdmFsKSB7CiAgICAgIGxzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgZWxlbWVudC5zaG93X2luX3ByZXNjcmlwdGlvbiA9ICF2YWw7CiAgICAgIH0pOwogICAgfSwKICAgIGFkZDogZnVuY3Rpb24gYWRkKCkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkNvbXBsaWFudHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb24ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX3RoaXMxOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5hcHBvaW5tZW50X2lkID0gX3RoaXMxOC5hcHBvaW50bWVudEluZm8uYXBwb2lubWVudF9pZDsKICAgICAgICAgICAgICAgIF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ucHJlc2NyaXB0aW9uX2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uY2RwcmVzY3JpcHRpb25fZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczE4LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmNkZm9sb3d1cF9kYXRlKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uZm9sb3d1cF9kYXRlID0gbW9tZW50KFN0cmluZyhfdGhpczE4LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmNkZm9sb3d1cF9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlLmFkZChfdGhpczE4LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLCBfdGhpczE4KTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBfdGhpczE4LmRvd25sb2FkUHJlc2NyaXB0aW9uKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uYXBwb2lubWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiUHJlc2NyaWJlZCBTdWNlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczE4Lm5ld1ByZXNjcmlwdGlvbigpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxOC5yZXNldCgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE4OwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKCiAgICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfY29udGV4dC50MCwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCAxOF1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbmV3UHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBuZXdQcmVzY3JpcHRpb24oKSB7CiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJTZWN0aW9ucyI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLm9uRXhhbWluYXRpb24gPSB7fTsKICAgICAgdGhpcy5maWd1cmUgPSB7fTsKICAgICAgdGhpcy5mYW1pbHlIaXN0b3J5ID0ge307CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24gPSB7CiAgICAgICAgY2RwcmVzY3JpcHRpb25fZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgY2Rmb2xvd3VwX2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpICsgNykpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgZmlndXJlX3Nob3dfaW5fcHJlc2NyaXB0aW9uOiB0cnVlLAogICAgICAgIGZhbWlseUhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgcGFzdEhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkNvbXBsaWFudHM6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25PbkV4YW1pbmF0aW9uOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmlndXJlOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbjogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkRpYWdub3NpczogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZhbWlseUhpc3Rvcnk6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25QYXN0SGlzdG9yeTogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudDogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkFkdmljZTogW10KICAgICAgfTsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["F:/SVN PROJECTS/DiagnosticCenterManagement_Client/trunk/src/scripts/doctor-panel/AppointmentPrescription.js"],"names":["CommonService","DoctorAppointmentService","FigureSetupService","AppointmentPrescriptionService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","PrescriptionReportService","moment","FilterMatchMode","FilterOperator","data","dataList","isAdvice","onExaminationDialog","onExaminationPopupDialog","figureDialog","familyHistoryDialog","treatmentDialog","prevPrescriptionDialog","appoinmentStatusList","patientsRelativeList","doctorAppointmentList","prescriptionDataList","prevPrescriptionList","headerName","tempData","appointmentInfo","onExamination","figure","familyHistory","treatmentSetup","doctorAppointment","cdfromdate","String","Date","format","cdtodate","setDate","getDate","appoinment_status","appointmentPrescription","cdprescription_date","cdfolowup_date","figure_show_in_prescription","familyHistory_show_in_prescription","pastHistory_show_in_prescription","allAdvice","lstAppoinmentPrescriptionCompliants","lstAppoinmentPrescriptionOnExamination","lstAppoinmentPrescriptionFigure","lstAppoinmentPrescriptionInvestigation","lstAppoinmentPrescriptionDiagnosis","lstAppoinmentPrescriptionFamilyHistory","lstAppoinmentPrescriptionPastHistory","lstAppoinmentPrescriptionTreatment","lstAppoinmentPrescriptionAdvice","treatmentRulesList","treatmentDurationList","treatmentDoseList","canvas","context","isDrawing","startX","startY","points","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","created","appointmentPrescriptionService","figureSetupService","doctorAppointmentService","commonService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","prescriptionReportService","userInfo","JSON","parse","localStorage","getItem","GetAllAppoinmentStatus","then","GetAllPatientsRelatives","getPrescriptionDataByDoctorId","doctor_id","getActiveCombo","show","newPrescription","that","document","onkeyup","e","ctrlKey","altKey","which","getPatientComplaints","getOnExaminationsPopup","getOnExaminations","getFigure","getInvestigation","getDiagnosis","getFamilyHistory","getPastHistory","getTreatment","getAdvice","prescriptionData","prescription","removeItem","methods","reset","fromdate","todate","getDynamicDoctorWise","appoinment_id","patientReg","aPatient","registration_no","patientName","first_name","last_name","patientGender","gender","patientAgeYear","age_year","patientAgeMonth","age_month","patientAgeDay","age_day","previousPrescription","patient_id","getPatientWisePrescriptionList","downloadPrescription","GetPescription","Downloadfile","formatDate","lstComplaint","forEach","element","push","compilants_name","id","compilants_id","popupOnExaminationsData","lstOnExamination","on_examination_name","on_examination_id","on_examination_result","lstFigureSetup","figure_name","figure_id","lstInvestigation","investingation_name","investigation_id","lstDiagnosis","diagnosis_name","diagnosis_id","lstTreatment","_medicine_type_name","_medicine_name","_treatment_dose_name","_treatment_rule_name","_treatment_duration_name","medicine_id","treatment_dose_id","treatment_rules_id","treatment_duration_id","description","lstAdvices","advice_name","advice_id","addOnExaminationFromPopup","aOnExaminations","filter","el","length","toString","addAllAdvice","aAdvice","getValue","aCompliants","label","aFigure","getById","getFigureFormatted","aInvestigation","aDiagnosis","aFamilyHistory","aPastHistory","showInPrescription","aMedicine","hideDialog","addOnExamination","isEdit","onExaminationEditSave","figure_image","vm","$refs","getContext","addEventListener","mousedown","mousemove","mouseup","img","Image","onload","drawImage","src","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","beginPath","moveTo","lineTo","lineWidth","lineCap","strokeStyle","stroke","stringify","resetCanvas","width","addFigure","dataURL","toDataURL","split","addFamilyHistory","relative_ralation","editTreatment","index","medicineName","ddltreatment_rules","text","refid","ddltreatment_duration","ddltreatment_dose","treatmentIndex","treatmentEditSave","editOnExamination","onExaminationIndex","deleteItem","lst","splice","findIndex","i","val","show_in_prescription","add","prescription_date","folowup_date","result","status","$toast","severity","summary","detail","life","res"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,aAAP,MAA0B,6BAA1B;AACA,OAAOC,wBAAP,MAAqC,mDAArC;AACA,OAAOC,kBAAP,MAA+B,wCAA/B;AACA,OAAOC,8BAAP,MAA2C,2DAA3C,C,CACA;;AACA,OAAOC,0BAAP,MAAuC,gDAAvC;AACA,OAAOC,6BAAP,MAA0C,mDAA1C;AACA,OAAOC,yBAAP,MAAsC,+CAAtC;AACA,OAAOC,yBAAP,MAAsC,gDAAtC;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAASC,eAAT,EAA0BC,cAA1B,QAAgD,cAAhD;AAEA,eAAe;AACbC,EAAAA,IADa,kBACN;AACL,WAAO;AACLC,MAAAA,QAAQ,EAAE,IADL;AAELC,MAAAA,QAAQ,EAAE,KAFL;AAGLC,MAAAA,mBAAmB,EAAE,KAHhB;AAILC,MAAAA,wBAAwB,EAAE,KAJrB;AAKL;AACAC,MAAAA,YAAY,EAAE,KANT;AAOLC,MAAAA,mBAAmB,EAAE,KAPhB;AAQLC,MAAAA,eAAe,EAAE,KARZ;AASLC,MAAAA,sBAAsB,EAAE,KATnB;AAULC,MAAAA,oBAAoB,EAAE,EAVjB;AAWLC,MAAAA,oBAAoB,EAAE,EAXjB;AAYLC,MAAAA,qBAAqB,EAAE,EAZlB;AAaLC,MAAAA,oBAAoB,EAAE,EAbjB;AAcLC,MAAAA,oBAAoB,EAAE,EAdjB;AAeLC,MAAAA,UAAU,EAAE,UAfP;AAgBLC,MAAAA,QAAQ,EAAE,EAhBL;AAiBLC,MAAAA,eAAe,EAAE,EAjBZ;AAkBLC,MAAAA,aAAa,EAAE,EAlBV;AAmBLC,MAAAA,MAAM,EAAE,EAnBH;AAoBLC,MAAAA,aAAa,EAAE,EApBV;AAqBLC,MAAAA,cAAc,EAAE,EArBX;AAsBLC,MAAAA,iBAAiB,EAAE;AACjBC,QAAAA,UAAU,EAAEzB,MAAM,CAAC0B,MAAM,CAAC,IAAIC,IAAJ,EAAD,CAAP,CAAN,CAA2BC,MAA3B,CAAkC,YAAlC,CADK;AAEjBC,QAAAA,QAAQ,EAAE7B,MAAM,CACd0B,MAAM,CAAC,IAAIC,IAAJ,CAAS,IAAIA,IAAJ,GAAWG,OAAX,CAAmB,IAAIH,IAAJ,GAAWI,OAAX,KAAuB,CAA1C,CAAT,CAAD,CADQ,CAAN,CAERH,MAFQ,CAED,YAFC,CAFO;AAKjBI,QAAAA,iBAAiB,EAAE;AALF,OAtBd;AA8BL;AACA;AACA;AACA;AACA;AACA;AAEAC,MAAAA,uBAAuB,EAAE;AACvBC,QAAAA,mBAAmB,EAAElC,MAAM,CAAC0B,MAAM,CAAC,IAAIC,IAAJ,EAAD,CAAP,CAAN,CAA2BC,MAA3B,CAAkC,YAAlC,CADE;AAEvBO,QAAAA,cAAc,EAAEnC,MAAM,CACpB0B,MAAM,CAAC,IAAIC,IAAJ,CAAS,IAAIA,IAAJ,GAAWG,OAAX,CAAmB,IAAIH,IAAJ,GAAWI,OAAX,KAAuB,CAA1C,CAAT,CAAD,CADc,CAAN,CAEdH,MAFc,CAEP,YAFO,CAFO;AAMvBQ,QAAAA,2BAA2B,EAAE,IANN;AAOvBC,QAAAA,kCAAkC,EAAE,IAPb;AAQvBC,QAAAA,gCAAgC,EAAE,IARX;AASvBC,QAAAA,SAAS,EAAE,KATY;AAWvBC,QAAAA,mCAAmC,EAAE,EAXd;AAYvBC,QAAAA,sCAAsC,EAAE,EAZjB;AAavBC,QAAAA,+BAA+B,EAAE,EAbV;AAcvBC,QAAAA,sCAAsC,EAAE,EAdjB;AAevBC,QAAAA,kCAAkC,EAAE,EAfb;AAgBvBC,QAAAA,sCAAsC,EAAE,EAhBjB;AAiBvBC,QAAAA,oCAAoC,EAAE,EAjBf;AAkBvBC,QAAAA,kCAAkC,EAAE,EAlBb;AAmBvBC,QAAAA,+BAA+B,EAAE;AAnBV,OArCpB;AA0DL;AACAC,MAAAA,kBAAkB,EAAE,EA3Df;AA4DLC,MAAAA,qBAAqB,EAAE,EA5DlB;AA6DLC,MAAAA,iBAAiB,EAAE,EA7Dd;AA8DL;AACAC,MAAAA,MAAM,EAAE,IA/DH;AAgELC,MAAAA,OAAO,EAAE,IAhEJ;AAiELC,MAAAA,SAAS,EAAE,KAjEN;AAkELC,MAAAA,MAAM,EAAE,CAlEH;AAmELC,MAAAA,MAAM,EAAE,CAnEH;AAoELC,MAAAA,MAAM,EAAE,EApEH;AAqEL;AACAC,MAAAA,SAAS,EAAE,KAtEN;AAuELC,MAAAA,OAAO,EAAE;AACPC,QAAAA,MAAM,EAAE;AAAEC,UAAAA,KAAK,EAAE,IAAT;AAAeC,UAAAA,SAAS,EAAE7D,eAAe,CAAC8D;AAA1C,SADD;AAEPC,QAAAA,IAAI,EAAE;AAAEH,UAAAA,KAAK,EAAE,IAAT;AAAeC,UAAAA,SAAS,EAAE7D,eAAe,CAACgE;AAA1C;AAFC,OAvEJ;AA2ELC,MAAAA,WA3EK,yBA2ES;AACZ,aAAKP,OAAL,GAAe;AACbC,UAAAA,MAAM,EAAE;AAAEC,YAAAA,KAAK,EAAE,IAAT;AAAeC,YAAAA,SAAS,EAAE7D,eAAe,CAAC8D;AAA1C,WADK;AAEbC,UAAAA,IAAI,EAAE;AACJG,YAAAA,QAAQ,EAAEjE,cAAc,CAACkE,GADrB;AAEJC,YAAAA,WAAW,EAAE,CACX;AAAER,cAAAA,KAAK,EAAE,IAAT;AAAeC,cAAAA,SAAS,EAAE7D,eAAe,CAACgE;AAA1C,aADW;AAFT;AAFO,SAAf;AASD;AArFI,KAAP;AAuFD,GAzFY;AA0FbK,EAAAA,OA1Fa,qBA0FH;AAAA;;AACR,SAAKC,8BAAL,GAAsC,IAAI5E,8BAAJ,EAAtC;AACA,SAAK6E,kBAAL,GAA0B,IAAI9E,kBAAJ,EAA1B;AACA,SAAK+E,wBAAL,GAAgC,IAAIhF,wBAAJ,EAAhC;AACA,SAAKiF,aAAL,GAAqB,IAAIlF,aAAJ,EAArB,CAJQ,CAKR;;AACA,SAAKmF,0BAAL,GAAkC,IAAI/E,0BAAJ,EAAlC;AACA,SAAKgF,6BAAL,GAAqC,IAAI/E,6BAAJ,EAArC;AACA,SAAKgF,yBAAL,GAAiC,IAAI/E,yBAAJ,EAAjC;AACA,SAAKgF,yBAAL,GAAiC,IAAI/E,yBAAJ,EAAjC;AAEA,SAAKgF,QAAL,GAAgBC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAX,CAAhB;AAEA,SAAKT,aAAL,CACGU,sBADH,GAEGC,IAFH,CAEQ,UAAClF,IAAD;AAAA,aAAW,KAAI,CAACS,oBAAL,GAA4BT,IAAI,CAACA,IAA5C;AAAA,KAFR;AAIA,SAAKuE,aAAL,CACGY,uBADH,GAEGD,IAFH,CAEQ,UAAClF,IAAD;AAAA,aAAW,KAAI,CAACU,oBAAL,GAA4BV,IAAI,CAACA,IAA5C;AAAA,KAFR;AAIA,SAAKoE,8BAAL,CACGgB,6BADH,CACiC,KAAKR,QAAL,CAAcS,SAD/C,EAEGH,IAFH,CAEQ,UAAClF,IAAD;AAAA,aAAW,KAAI,CAACY,oBAAL,GAA4BZ,IAAI,CAACA,IAA5C;AAAA,KAFR,EArBQ,CAyBR;AACA;AACA;AACA;;AAEA,SAAKwE,0BAAL,CACGc,cADH,GAEGJ,IAFH,CAEQ,UAAClF,IAAD;AAAA,aAAW,KAAI,CAAC8C,kBAAL,GAA0B9C,IAAI,CAACA,IAA1C;AAAA,KAFR;AAIA,SAAKyE,6BAAL,CACGa,cADH,GAEGJ,IAFH,CAEQ,UAAClF,IAAD;AAAA,aAAW,KAAI,CAAC+C,qBAAL,GAA6B/C,IAAI,CAACA,IAA7C;AAAA,KAFR;AAIA,SAAK0E,yBAAL,CACGY,cADH,GAEGJ,IAFH,CAEQ,UAAClF,IAAD;AAAA,aAAW,KAAI,CAACgD,iBAAL,GAAyBhD,IAAI,CAACA,IAAzC;AAAA,KAFR;AAIA,SAAKuF,IAAL;AACA,SAAKC,eAAL;AAEA,QAAIC,IAAI,GAAG,IAAX;;AACAC,IAAAA,QAAQ,CAACC,OAAT,GAAmB,UAAUC,CAAV,EAAa;AAC9B,UAAIA,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AAC1CN,QAAAA,IAAI,CAACO,oBAAL;AACD,OAFD,MAEO,IAAIJ,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACQ,sBAAL;AACAR,QAAAA,IAAI,CAACS,iBAAL;AACD,OAHM,MAGA,IAAIN,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACU,SAAL;AACD,OAFM,MAEA,IAAIP,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACW,gBAAL;AACD,OAFM,MAEA,IAAIR,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACY,YAAL;AACD,OAFM,MAEA,IAAIT,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACa,gBAAL;AACD,OAFM,MAEA,IAAIV,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACc,cAAL;AACD,OAFM,MAEA,IAAIX,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACe,YAAL;AACD,OAFM,MAEA,IAAIZ,CAAC,CAACC,OAAF,IAAaD,CAAC,CAACE,MAAf,IAAyBF,CAAC,CAACG,KAAF,IAAW,EAAxC,EAA4C;AACjDN,QAAAA,IAAI,CAACgB,SAAL;AACD,OApB6B,CAqB9B;AAEA;;AACD,KAxBD;;AA0BA,QAAIC,gBAAgB,GAAG7B,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,kBAArB,CAAX,CAAvB;;AACA,QAAI0B,gBAAJ,EAAsB;AACpB,WAAKC,YAAL,CAAkBD,gBAAlB;AACA3B,MAAAA,YAAY,CAAC6B,UAAb,CAAwB,kBAAxB;AACD;AACF,GAvKY;AAwKbC,EAAAA,OAAO,EAAE;AACPC,IAAAA,KADO,mBACC;AACN,WAAKzF,iBAAL,GAAyB;AACvBC,QAAAA,UAAU,EAAEzB,MAAM,CAAC0B,MAAM,CAAC,IAAIC,IAAJ,EAAD,CAAP,CAAN,CAA2BC,MAA3B,CAAkC,YAAlC,CADW;AAEvBC,QAAAA,QAAQ,EAAE7B,MAAM,CACd0B,MAAM,CAAC,IAAIC,IAAJ,CAAS,IAAIA,IAAJ,GAAWG,OAAX,CAAmB,IAAIH,IAAJ,GAAWI,OAAX,KAAuB,CAA1C,CAAT,CAAD,CADQ,CAAN,CAERH,MAFQ,CAED,YAFC,CAFa;AAKvBI,QAAAA,iBAAiB,EAAE;AALI,OAAzB,CADM,CASN;AACA;;AACA,WAAK0D,IAAL;AACD,KAbM;AAcPA,IAAAA,IAdO,kBAcA;AAAA;;AACL,WAAKhC,SAAL,GAAiB,IAAjB;;AACA,UAAI,CAAC,KAAKlC,iBAAL,CAAuBC,UAA5B,EAAwC;AACtC;AACD,OAFD,MAEO,IAAI,CAAC,KAAKD,iBAAL,CAAuBK,QAA5B,EAAsC;AAC3C;AACD,OAFM,MAEA,IAAI,CAAC,KAAKL,iBAAL,CAAuBQ,iBAA5B,EAA+C;AACpD;AACD,OAFM,MAEA;AACL,aAAKR,iBAAL,CAAuB0F,QAAvB,GAAkClH,MAAM,CACtC0B,MAAM,CAAC,KAAKF,iBAAL,CAAuBC,UAAxB,CADgC,CAAN,CAEhCG,MAFgC,CAEzB,YAFyB,CAAlC;AAGA,aAAKJ,iBAAL,CAAuB2F,MAAvB,GAAgCnH,MAAM,CACpC0B,MAAM,CAAC,KAAKF,iBAAL,CAAuBK,QAAxB,CAD8B,CAAN,CAE9BD,MAF8B,CAEvB,YAFuB,CAAhC;AAGA,aAAK6C,wBAAL,CACG2C,oBADH,CAEI,KAAK5F,iBAAL,CAAuB0F,QAF3B,EAGI,KAAK1F,iBAAL,CAAuB2F,MAH3B,EAII,KAAK3F,iBAAL,CAAuBQ,iBAJ3B,EAKI,KAAK+C,QAAL,CAAcS,SALlB,EAOGH,IAPH,CAOQ,UAAClF,IAAD;AAAA,iBAAW,MAAI,CAACW,qBAAL,GAA6BX,IAAI,CAACA,IAA7C;AAAA,SAPR,EAPK,CAgBL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;;AACD,WAAKC,QAAL,GAAgB,IAAhB;AACA,WAAKsD,SAAL,GAAiB,KAAjB;AACD,KAlDM;AAmDPoD,IAAAA,YAnDO,wBAmDM3G,IAnDN,EAmDY;AACjB,WAAKgB,eAAL,CAAqBkG,aAArB,GAAqClH,IAAI,CAACkH,aAA1C;AACA,WAAKlG,eAAL,CAAqBmG,UAArB,GAAkCnH,IAAI,CAACoH,QAAL,CAAcC,eAAhD;AACA,WAAKrG,eAAL,CAAqBsG,WAArB,GACEtH,IAAI,CAACoH,QAAL,CAAcG,UAAd,GAA2B,GAA3B,GAAiCvH,IAAI,CAACoH,QAAL,CAAcI,SADjD;AAEA,WAAKxG,eAAL,CAAqByG,aAArB,GAAqCzH,IAAI,CAACoH,QAAL,CAAcM,MAAnD;AACA,WAAK1G,eAAL,CAAqB2G,cAArB,GAAsC3H,IAAI,CAACoH,QAAL,CAAcQ,QAApD;AACA,WAAK5G,eAAL,CAAqB6G,eAArB,GAAuC7H,IAAI,CAACoH,QAAL,CAAcU,SAArD;AACA,WAAK9G,eAAL,CAAqB+G,aAArB,GAAqC/H,IAAI,CAACoH,QAAL,CAAcY,OAAnD,CARiB,CAUjB;AACA;AACA;AAEA;AACA;;AAEA,WAAK/H,QAAL,GAAgB,KAAhB;AACD,KArEM;AAsEPgI,IAAAA,oBAtEO,gCAsEcC,UAtEd,EAsE0B;AAAA;;AAC/B,WAAK9D,8BAAL,CACG+D,8BADH,CACkCD,UADlC,EAEGhD,IAFH,CAEQ,UAAClF,IAAD;AAAA,eAAW,MAAI,CAACa,oBAAL,GAA4Bb,IAAI,CAACA,IAA5C;AAAA,OAFR;AAIA,WAAKQ,sBAAL,GAA8B,IAA9B;AACD,KA5EM;AA6EP4H,IAAAA,oBA7EO,gCA6EclB,aA7Ed,EA6E6B;AAAA;;AAClC,WAAKvC,yBAAL,CAA+B0D,cAA/B,CAA8CnB,aAA9C,EAA6D,IAA7D,EAAmEhC,IAAnE,CAAwE,UAAClF,IAAD;AAAA,eAAW,MAAI,CAACuE,aAAL,CAAmB+D,YAAnB,CAAgCtI,IAAI,CAACA,IAArC,CAAX;AAAA,OAAxE;AACD,KA/EM;AAgFPuI,IAAAA,UAhFO,sBAgFI7E,KAhFJ,EAgFW;AAChB,aAAO7D,MAAM,CAAC0B,MAAM,CAACmC,KAAD,CAAP,CAAN,CAAsBjC,MAAtB,CAA6B,sBAA7B,CAAP;AACD,KAlFM;AAoFP;AACAuE,IAAAA,oBArFO,kCAqFgB;AAAA;;AACrB,WAAKlF,UAAL,GAAkB,oBAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0B4H,YAA1B,CAAuCC,OAAvC,CAA+C,UAACC,OAAD,EAAa;AAC1D,QAAA,MAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAACE,eADG;AAEjBC,UAAAA,EAAE,EAAEH,OAAO,CAACI;AAFK,SAAnB;AAID,OALD;AAMD,KAhGM;AAiGP7C,IAAAA,sBAjGO,oCAiGkB;AAAA;;AACvB,WAAK8C,uBAAL,GAA+B,EAA/B;AACA,WAAKnI,oBAAL,CAA0BoI,gBAA1B,CAA2CP,OAA3C,CAAmD,UAACC,OAAD,EAAa;AAC9D,QAAA,MAAI,CAACK,uBAAL,CAA6BJ,IAA7B,CAAkC;AAChC9E,UAAAA,IAAI,EAAE6E,OAAO,CAACO,mBADkB;AAEhCJ,UAAAA,EAAE,EAAEH,OAAO,CAACQ,iBAFoB;AAGhCC,UAAAA,qBAAqB,EAAE;AAHS,SAAlC;AAKD,OAND;AAQA,WAAK/I,wBAAL,GAAgC,IAAhC;AACD,KA5GM;AA6GP8F,IAAAA,iBA7GO,+BA6Ga;AAAA;;AAClB;AACA,WAAKpF,UAAL,GAAkB,iBAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0BoI,gBAA1B,CAA2CP,OAA3C,CAAmD,UAACC,OAAD,EAAa;AAC9D,QAAA,MAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAACO,mBADG;AAEjBJ,UAAAA,EAAE,EAAEH,OAAO,CAACQ;AAFK,SAAnB;AAID,OALD;AAMD,KAzHM;AA0HP/C,IAAAA,SA1HO,uBA0HK;AAAA;;AACV,WAAKrF,UAAL,GAAkB,QAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0BwI,cAA1B,CAAyCX,OAAzC,CAAiD,UAACC,OAAD,EAAa;AAC5D,QAAA,MAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAACW,WADG;AAEjBR,UAAAA,EAAE,EAAEH,OAAO,CAACY;AAFK,SAAnB;AAID,OALD;AAMD,KArIM;AAsIPlD,IAAAA,gBAtIO,8BAsIY;AAAA;;AACjB,WAAKtF,UAAL,GAAkB,eAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0B2I,gBAA1B,CAA2Cd,OAA3C,CAAmD,UAACC,OAAD,EAAa;AAC9D,QAAA,MAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAACc,mBADG;AAEjBX,UAAAA,EAAE,EAAEH,OAAO,CAACe;AAFK,SAAnB;AAID,OALD;AAMD,KAjJM;AAkJPpD,IAAAA,YAlJO,0BAkJQ;AAAA;;AACb,WAAKvF,UAAL,GAAkB,WAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0B8I,YAA1B,CAAuCjB,OAAvC,CAA+C,UAACC,OAAD,EAAa;AAC1D,QAAA,OAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAACiB,cADG;AAEjBd,UAAAA,EAAE,EAAEH,OAAO,CAACkB;AAFK,SAAnB;AAID,OALD;AAMD,KA7JM;AA8JPtD,IAAAA,gBA9JO,8BA8JY;AAAA;;AACjB,WAAKxF,UAAL,GAAkB,gBAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0B8I,YAA1B,CAAuCjB,OAAvC,CAA+C,UAACC,OAAD,EAAa;AAC1D,QAAA,OAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAACiB,cADG;AAEjBd,UAAAA,EAAE,EAAEH,OAAO,CAACkB;AAFK,SAAnB;AAID,OALD;AAMD,KAzKM;AA0KPrD,IAAAA,cA1KO,4BA0KU;AAAA;;AACf,WAAKzF,UAAL,GAAkB,cAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0B8I,YAA1B,CAAuCjB,OAAvC,CAA+C,UAACC,OAAD,EAAa;AAC1D,QAAA,OAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAACiB,cADG;AAEjBd,UAAAA,EAAE,EAAEH,OAAO,CAACkB;AAFK,SAAnB;AAID,OALD;AAMD,KArLM;AAsLPpD,IAAAA,YAtLO,0BAsLQ;AAAA;;AACb,WAAK1F,UAAL,GAAkB,UAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,KAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0BiJ,YAA1B,CAAuCpB,OAAvC,CAA+C,UAACC,OAAD,EAAa;AAC1D,QAAA,OAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjBmB,UAAAA,mBAAmB,EAAEpB,OAAO,CAACoB,mBADZ;AAEjBC,UAAAA,cAAc,EAAErB,OAAO,CAACqB,cAFP;AAGjBlG,UAAAA,IAAI,EAAE6E,OAAO,CAACoB,mBAAR,GAA8B,GAA9B,GAAoCpB,OAAO,CAACqB,cAA5C,GAA6D,GAA7D,GAAmErB,OAAO,CAACsB,oBAA3E,GAAkG,GAAlG,GAAwGtB,OAAO,CAACuB,oBAAhH,GAAuI,GAAvI,GAA6IvB,OAAO,CAACwB,wBAH1I;AAIjBrB,UAAAA,EAAE,EAAEH,OAAO,CAACyB,WAJK;AAKjBH,UAAAA,oBAAoB,EAAEtB,OAAO,CAACsB,oBALb;AAMjBI,UAAAA,iBAAiB,EAAE1B,OAAO,CAAC0B,iBANV;AAOjBH,UAAAA,oBAAoB,EAAEvB,OAAO,CAACuB,oBAPb;AAQjBI,UAAAA,kBAAkB,EAAE3B,OAAO,CAAC2B,kBARX;AASjBH,UAAAA,wBAAwB,EAAExB,OAAO,CAACwB,wBATjB;AAUjBI,UAAAA,qBAAqB,EAAE5B,OAAO,CAAC4B,qBAVd;AAWjBC,UAAAA,WAAW,EAAE7B,OAAO,CAAC6B;AAXJ,SAAnB;AAaD,OAdD;AAeD,KA1MM;AA2MP9D,IAAAA,SA3MO,uBA2MK;AAAA;;AACV,WAAK3F,UAAL,GAAkB,QAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAKxD,QAAL,GAAgB,IAAhB;AACA,WAAKa,QAAL,GAAgB,EAAhB;AACA,WAAKH,oBAAL,CAA0B4J,UAA1B,CAAqC/B,OAArC,CAA6C,UAACC,OAAD,EAAa;AACxD,QAAA,OAAI,CAAC3H,QAAL,CAAc4H,IAAd,CAAmB;AACjB9E,UAAAA,IAAI,EAAE6E,OAAO,CAAC+B,WADG;AAEjB5B,UAAAA,EAAE,EAAEH,OAAO,CAACgC;AAFK,SAAnB;AAID,OALD;AAMD,KAtNM;AAuNPC,IAAAA,yBAvNO,uCAuNqB;AAAA;;AAC1B;AACA;AACA,WAAK5B,uBAAL,CAA6BN,OAA7B,CAAqC,UAACC,OAAD,EAAa;AAChD,YAAIA,OAAO,CAACS,qBAAZ,EAAmC;AACjC;AACA,cAAIyB,eAAe,GACjB,OAAI,CAAC9I,uBAAL,CAA6BQ,sCAA7B,CAAoEuI,MAApE,CACE,UAAUC,EAAV,EAAc;AACZ,mBAAOA,EAAE,CAAC5B,iBAAH,KAAyBR,OAAO,CAACG,EAAxC;AACD,WAHH,EAIE,OAJF,CADF;;AAQA,cAAI,CAAC+B,eAAe,CAACG,MAArB,EAA6B;AAC3B,YAAA,OAAI,CAACjJ,uBAAL,CAA6BQ,sCAA7B,CAAoEqG,IAApE,CAAyE;AACvE9E,cAAAA,IAAI,EAAE6E,OAAO,CAAC7E,IADyD;AAEvEqF,cAAAA,iBAAiB,EAAER,OAAO,CAACG,EAF4C;AAGvEM,cAAAA,qBAAqB,EACnBT,OAAO,CAACS,qBAAR,CAA8B6B,QAA9B;AAJqE,aAAzE;AAMD;AACF;AACF,OApBD,EAH0B,CAyB1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAK5K,wBAAL,GAAgC,KAAhC;AACD,KA3PM;AA4PP;AACA6K,IAAAA,YA7PO,0BA6PQ;AAAA;;AACb,UAAI,CAAC,KAAKnJ,uBAAL,CAA6BM,SAAlC,EAA6C;AAC3C,aAAKrB,QAAL,CAAc0H,OAAd,CAAsB,UAACC,OAAD,EAAa;AACjC,cAAIwC,OAAO,GACT,OAAI,CAACpJ,uBAAL,CAA6Be,+BAA7B,CAA6DgI,MAA7D,CACE,UAAUC,EAAV,EAAc;AACZ,mBAAOA,EAAE,CAACJ,SAAH,KAAiBhC,OAAO,CAACG,EAAhC;AACD,WAHH,EAIE,OAJF,CADF;;AAQA,cAAI,CAACqC,OAAO,CAACH,MAAb,EAAqB;AACnB,YAAA,OAAI,CAACjJ,uBAAL,CAA6Be,+BAA7B,CAA6D8F,IAA7D,CAAkE;AAChE9E,cAAAA,IAAI,EAAE6E,OAAO,CAAC7E,IADkD;AAEhE6G,cAAAA,SAAS,EAAEhC,OAAO,CAACG;AAF6C,aAAlE;AAID;AACF,SAfD;AAgBD;AACF,KAhRM;AAiRP;AACAsC,IAAAA,QAlRO,oBAkREnL,IAlRF,EAkRQ;AAAA;;AACb,UAAI,KAAKc,UAAL,IAAmB,oBAAvB,EAA6C;AAC3C,YAAIsK,WAAW,GACb,KAAKtJ,uBAAL,CAA6BO,mCAA7B,CAAiEwI,MAAjE,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAAChC,aAAH,KAAqB9I,IAAI,CAAC6I,EAAjC;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAACuC,WAAW,CAACL,MAAjB,EAAyB;AACvB,eAAKjJ,uBAAL,CAA6BO,mCAA7B,CAAiEsG,IAAjE,CACE;AACE9E,YAAAA,IAAI,EAAE7D,IAAI,CAAC6D,IADb;AAEEiF,YAAAA,aAAa,EAAE9I,IAAI,CAAC6I;AAFtB,WADF;AAMD;AACF,OAjBD,MAiBO,IAAI,KAAK/H,UAAL,IAAmB,iBAAvB,EAA0C;AAC/C,YAAI8J,eAAe,GACjB,KAAK9I,uBAAL,CAA6BQ,sCAA7B,CAAoEuI,MAApE,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAAC5B,iBAAH,KAAyBlJ,IAAI,CAAC6I,EAArC;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAAC+B,eAAe,CAACG,MAArB,EAA6B;AAC3B,eAAK9J,aAAL,CAAmBoK,KAAnB,GAA2BrL,IAAI,CAAC6D,IAAhC;AACA,eAAK5C,aAAL,CAAmBiI,iBAAnB,GAAuClJ,IAAI,CAAC6I,EAA5C;AACA,eAAK5H,aAAL,CAAmBkI,qBAAnB,GAA2C,CAA3C;AACA,eAAKhJ,mBAAL,GAA2B,IAA3B;AACD;AACF,OAfM,MAeA,IAAI,KAAKW,UAAL,IAAmB,QAAvB,EAAiC;AACtC,YAAIwK,OAAO,GACT,KAAKxJ,uBAAL,CAA6BS,+BAA7B,CAA6DsI,MAA7D,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAACxB,SAAH,KAAiBtJ,IAAI,CAAC6I,EAA7B;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAACyC,OAAO,CAACP,MAAb,EAAqB;AACnB,eAAK1K,YAAL,GAAoB,IAApB;AACA,eAAKa,MAAL,CAAY2C,IAAZ,GAAmB7D,IAAI,CAAC6D,IAAxB;AACA,eAAK3C,MAAL,CAAYoI,SAAZ,GAAwBtJ,IAAI,CAAC6I,EAA7B;AACA,eAAKxE,kBAAL,CACGkH,OADH,CACWvL,IAAI,CAAC6I,EADhB,EAEG3D,IAFH,CAEQ,UAAClF,IAAD;AAAA,mBAAU,OAAI,CAACwL,kBAAL,CAAwBxL,IAAI,CAACA,IAA7B,CAAV;AAAA,WAFR;AAGD;AACF,OAjBM,MAiBA,IAAI,KAAKc,UAAL,IAAmB,eAAvB,EAAwC;AAC7C,YAAI2K,cAAc,GAChB,KAAK3J,uBAAL,CAA6BU,sCAA7B,CAAoEqI,MAApE,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAACrB,gBAAH,KAAwBzJ,IAAI,CAAC6I,EAApC;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAAC4C,cAAc,CAACV,MAApB,EAA4B;AAC1B,eAAKjJ,uBAAL,CAA6BU,sCAA7B,CAAoEmG,IAApE,CACE;AACE9E,YAAAA,IAAI,EAAE7D,IAAI,CAAC6D,IADb;AAEE4F,YAAAA,gBAAgB,EAAEzJ,IAAI,CAAC6I;AAFzB,WADF;AAMD;AACF,OAjBM,MAiBA,IAAI,KAAK/H,UAAL,IAAmB,WAAvB,EAAoC;AACzC,YAAI4K,UAAU,GACZ,KAAK5J,uBAAL,CAA6BW,kCAA7B,CAAgEoI,MAAhE,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAAClB,YAAH,KAAoB5J,IAAI,CAAC6I,EAAhC;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAAC6C,UAAU,CAACX,MAAhB,EAAwB;AACtB,eAAKjJ,uBAAL,CAA6BW,kCAA7B,CAAgEkG,IAAhE,CAAqE;AACnE9E,YAAAA,IAAI,EAAE7D,IAAI,CAAC6D,IADwD;AAEnE+F,YAAAA,YAAY,EAAE5J,IAAI,CAAC6I;AAFgD,WAArE;AAID;AACF,OAfM,MAeA,IAAI,KAAK/H,UAAL,IAAmB,gBAAvB,EAAyC;AAC9C,YAAI6K,cAAc,GAChB,KAAK7J,uBAAL,CAA6BY,sCAA7B,CAAoEmI,MAApE,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAAClB,YAAH,KAAoB5J,IAAI,CAAC6I,EAAhC;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAAC8C,cAAc,CAACZ,MAApB,EAA4B;AAC1B,eAAK5J,aAAL,CAAmByI,YAAnB,GAAkC5J,IAAI,CAAC6I,EAAvC;AACA,eAAK1H,aAAL,CAAmB0C,IAAnB,GAA0B7D,IAAI,CAAC6D,IAA/B;AACA,eAAKvD,mBAAL,GAA2B,IAA3B;AACD;AACF,OAdM,MAcA,IAAI,KAAKQ,UAAL,IAAmB,cAAvB,EAAuC;AAC5C,YAAI8K,YAAY,GACd,KAAK9J,uBAAL,CAA6Ba,oCAA7B,CAAkEkI,MAAlE,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAAClB,YAAH,KAAoB5J,IAAI,CAAC6I,EAAhC;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAAC+C,YAAY,CAACb,MAAlB,EAA0B;AACxB,eAAKjJ,uBAAL,CAA6Ba,oCAA7B,CAAkEgG,IAAlE,CACE;AACE9E,YAAAA,IAAI,EAAE7D,IAAI,CAAC6D,IADb;AAEE+F,YAAAA,YAAY,EAAE5J,IAAI,CAAC6I;AAFrB,WADF;AAMA,eAAKgD,kBAAL,CACE,KAAK/J,uBAAL,CAA6Ba,oCAD/B,EAEE,CAAC,KAAKb,uBAAL,CAA6BK,gCAFhC;AAID;AACF,OArBM,MAqBA,IAAI,KAAKrB,UAAL,IAAmB,UAAvB,EAAmC;AACxC,YAAIgL,SAAS,GACX,KAAKhK,uBAAL,CAA6Bc,kCAA7B,CAAgEiI,MAAhE,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAACX,WAAH,KAAmBnK,IAAI,CAAC6I,EAA/B;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAACiD,SAAS,CAACf,MAAf,EAAuB;AACrB,eAAKjJ,uBAAL,CAA6Bc,kCAA7B,CAAgE+F,IAAhE,CAAqE;AACnEmB,YAAAA,mBAAmB,EAAE9J,IAAI,CAAC8J,mBADyC;AAEnEjG,YAAAA,IAAI,EAAE7D,IAAI,CAAC+J,cAFwD;AAGnEI,YAAAA,WAAW,EAAEnK,IAAI,CAAC6I,EAHiD;AAInEmB,YAAAA,oBAAoB,EAAEhK,IAAI,CAACgK,oBAJwC;AAKnEI,YAAAA,iBAAiB,EAAEpK,IAAI,CAACoK,iBAL2C;AAMnEH,YAAAA,oBAAoB,EAAEjK,IAAI,CAACiK,oBANwC;AAOnEI,YAAAA,kBAAkB,EAAErK,IAAI,CAACqK,kBAP0C;AAQnEH,YAAAA,wBAAwB,EAAElK,IAAI,CAACkK,wBARoC;AASnEI,YAAAA,qBAAqB,EAAEtK,IAAI,CAACsK,qBATuC;AAUnEC,YAAAA,WAAW,EAAEvK,IAAI,CAACuK;AAViD,WAArE;AAYD;AACF,OAvBM,MAuBA,IAAI,KAAKzJ,UAAL,IAAmB,QAAvB,EAAiC;AACtC,YAAIoK,OAAO,GACT,KAAKpJ,uBAAL,CAA6Be,+BAA7B,CAA6DgI,MAA7D,CACE,UAAUC,EAAV,EAAc;AACZ,iBAAOA,EAAE,CAACJ,SAAH,KAAiB1K,IAAI,CAAC6I,EAA7B;AACD,SAHH,EAIE,IAJF,CADF;;AAQA,YAAI,CAACqC,OAAO,CAACH,MAAb,EAAqB;AACnB,eAAKjJ,uBAAL,CAA6Be,+BAA7B,CAA6D8F,IAA7D,CAAkE;AAChE9E,YAAAA,IAAI,EAAE7D,IAAI,CAAC6D,IADqD;AAEhE6G,YAAAA,SAAS,EAAE1K,IAAI,CAAC6I;AAFgD,WAAlE;AAID;AACF;AACF,KA9aM;AA+aPkD,IAAAA,UA/aO,wBA+aM;AACX,WAAK5L,mBAAL,GAA2B,KAA3B;AACA,WAAKC,wBAAL,GAAgC,KAAhC,CAFW,CAGX;;AACA,WAAKC,YAAL,GAAoB,KAApB;AACA,WAAKC,mBAAL,GAA2B,KAA3B;AACA,WAAKC,eAAL,GAAuB,KAAvB;AACA,WAAKC,sBAAL,GAA8B,KAA9B;AACA,WAAK+C,SAAL,GAAiB,KAAjB;AACD,KAxbM;AAybPyI,IAAAA,gBAzbO,8BAybY;AACjB,UAAI,CAAC,KAAKC,MAAV,EAAkB;AAChB,aAAK1I,SAAL,GAAiB,IAAjB;;AACA,YAAI,CAAC,KAAKtC,aAAL,CAAmBkI,qBAAxB,EAA+C;AAC7C;AACD,SAFD,MAEO;AACL,eAAKrH,uBAAL,CAA6BQ,sCAA7B,CAAoEqG,IAApE,CACE;AACE9E,YAAAA,IAAI,EAAE,KAAK5C,aAAL,CAAmBoK,KAD3B;AAEEnC,YAAAA,iBAAiB,EAAE,KAAKjI,aAAL,CAAmBiI,iBAFxC;AAGEC,YAAAA,qBAAqB,EACnB,KAAKlI,aAAL,CAAmBkI,qBAAnB,CAAyC6B,QAAzC;AAJJ,WADF;AAQA,eAAKzH,SAAL,GAAiB,KAAjB;AACA,eAAKpD,mBAAL,GAA2B,KAA3B;AACD;AACF,OAhBD,MAgBO,IAAI,KAAK8L,MAAT,EAAiB;AACtB,aAAKC,qBAAL;AACA,aAAKD,MAAL,GAAc,KAAd;AACD;AAEF,KA/cM;AAgdPT,IAAAA,kBAhdO,8BAgdYxL,IAhdZ,EAgdkB;AACvB,WAAKkB,MAAL,CAAYiL,YAAZ,GAA2B,2BAA2BnM,IAAI,CAACmM,YAA3D,CADuB,CAEvB;;AACA,UAAIC,EAAE,GAAG,IAAT;AACAA,MAAAA,EAAE,CAACnJ,MAAH,GAAYmJ,EAAE,CAACC,KAAH,CAASpJ,MAArB;AACAmJ,MAAAA,EAAE,CAAClJ,OAAH,GAAakJ,EAAE,CAACnJ,MAAH,CAAUqJ,UAAV,CAAqB,IAArB,CAAb;AACAF,MAAAA,EAAE,CAACnJ,MAAH,CAAUsJ,gBAAV,CAA2B,WAA3B,EAAwCH,EAAE,CAACI,SAA3C;AACAJ,MAAAA,EAAE,CAACnJ,MAAH,CAAUsJ,gBAAV,CAA2B,WAA3B,EAAwCH,EAAE,CAACK,SAA3C;AACA/G,MAAAA,QAAQ,CAAC6G,gBAAT,CAA0B,SAA1B,EAAqCH,EAAE,CAACM,OAAxC;AAEAN,MAAAA,EAAE,CAACO,GAAH,GAAS,IAAIC,KAAJ,EAAT;;AACAR,MAAAA,EAAE,CAACO,GAAH,CAAOE,MAAP,GAAgB,YAAY;AAC1BT,QAAAA,EAAE,CAAClJ,OAAH,CAAW4J,SAAX,CAAqBV,EAAE,CAACO,GAAxB,EAA6B,CAA7B,EAAgC,CAAhC,EAAmC,GAAnC,EAAwC,GAAxC,EAD0B,CACoB;AAC/C,OAFD;;AAIAP,MAAAA,EAAE,CAACO,GAAH,CAAOI,GAAP,GAAa,KAAK7L,MAAL,CAAYiL,YAAzB;AACD,KAheM;AAieP;AACAK,IAAAA,SAleO,qBAkeG5G,CAleH,EAkeM;AACX,UAAIwG,EAAE,GAAG,IAAT;AACA,UAAIY,IAAI,GAAGZ,EAAE,CAACnJ,MAAH,CAAUgK,qBAAV,EAAX;AACA,UAAIC,CAAC,GAAGtH,CAAC,CAACuH,OAAF,GAAYH,IAAI,CAACI,IAAzB;AACA,UAAIC,CAAC,GAAGzH,CAAC,CAAC0H,OAAF,GAAYN,IAAI,CAACO,GAAzB;AAEAnB,MAAAA,EAAE,CAACjJ,SAAH,GAAe,IAAf;AACAiJ,MAAAA,EAAE,CAAChJ,MAAH,GAAY8J,CAAZ;AACAd,MAAAA,EAAE,CAAC/I,MAAH,GAAYgK,CAAZ;AACAjB,MAAAA,EAAE,CAAC9I,MAAH,CAAUqF,IAAV,CAAe;AACbuE,QAAAA,CAAC,EAAEA,CADU;AAEbG,QAAAA,CAAC,EAAEA;AAFU,OAAf;AAID,KA/eM;AAgfPZ,IAAAA,SAhfO,qBAgfG7G,CAhfH,EAgfM;AACX,UAAIwG,EAAE,GAAG,IAAT;AACA,UAAIY,IAAI,GAAGZ,EAAE,CAACnJ,MAAH,CAAUgK,qBAAV,EAAX;AACA,UAAIC,CAAC,GAAGtH,CAAC,CAACuH,OAAF,GAAYH,IAAI,CAACI,IAAzB;AACA,UAAIC,CAAC,GAAGzH,CAAC,CAAC0H,OAAF,GAAYN,IAAI,CAACO,GAAzB;;AAEA,UAAInB,EAAE,CAACjJ,SAAP,EAAkB;AAChBiJ,QAAAA,EAAE,CAAClJ,OAAH,CAAWsK,SAAX;AACApB,QAAAA,EAAE,CAAClJ,OAAH,CAAWuK,MAAX,CAAkBrB,EAAE,CAAChJ,MAArB,EAA6BgJ,EAAE,CAAC/I,MAAhC;AACA+I,QAAAA,EAAE,CAAClJ,OAAH,CAAWwK,MAAX,CAAkBR,CAAlB,EAAqBG,CAArB;AACAjB,QAAAA,EAAE,CAAClJ,OAAH,CAAWyK,SAAX,GAAuB,CAAvB;AACAvB,QAAAA,EAAE,CAAClJ,OAAH,CAAW0K,OAAX,GAAqB,OAArB;AACAxB,QAAAA,EAAE,CAAClJ,OAAH,CAAW2K,WAAX,GAAyB,eAAzB;AACAzB,QAAAA,EAAE,CAAClJ,OAAH,CAAW4K,MAAX;AAEA1B,QAAAA,EAAE,CAAChJ,MAAH,GAAY8J,CAAZ;AACAd,QAAAA,EAAE,CAAC/I,MAAH,GAAYgK,CAAZ;AAEAjB,QAAAA,EAAE,CAAC9I,MAAH,CAAUqF,IAAV,CAAe;AACbuE,UAAAA,CAAC,EAAEA,CADU;AAEbG,UAAAA,CAAC,EAAEA;AAFU,SAAf;AAID;AACF,KAvgBM;AAwgBPX,IAAAA,OAxgBO,qBAwgBG;AACR,UAAIN,EAAE,GAAG,IAAT;AACAA,MAAAA,EAAE,CAACjJ,SAAH,GAAe,KAAf;;AACA,UAAIiJ,EAAE,CAAC9I,MAAH,CAAUyH,MAAV,GAAmB,CAAvB,EAA0B;AACxBhG,QAAAA,YAAY,CAAC,QAAD,CAAZ,GAAyBF,IAAI,CAACkJ,SAAL,CAAe3B,EAAE,CAAC9I,MAAlB,CAAzB;AACD;AACF,KA9gBM;AA+gBP0K,IAAAA,WA/gBO,yBA+gBO;AACZ;AACA;AACA;AAEA,UAAI5B,EAAE,GAAG,IAAT;AACAA,MAAAA,EAAE,CAACnJ,MAAH,GAAYmJ,EAAE,CAACC,KAAH,CAASpJ,MAArB;AACAmJ,MAAAA,EAAE,CAAClJ,OAAH,GAAakJ,EAAE,CAACnJ,MAAH,CAAUqJ,UAAV,CAAqB,IAArB,CAAb;AACAF,MAAAA,EAAE,CAACnJ,MAAH,CAAUsJ,gBAAV,CAA2B,WAA3B,EAAwCH,EAAE,CAACI,SAA3C;AACAJ,MAAAA,EAAE,CAACnJ,MAAH,CAAUsJ,gBAAV,CAA2B,WAA3B,EAAwCH,EAAE,CAACK,SAA3C;AACA/G,MAAAA,QAAQ,CAAC6G,gBAAT,CAA0B,SAA1B,EAAqCH,EAAE,CAACM,OAAxC;AAEAN,MAAAA,EAAE,CAACO,GAAH,GAAS,IAAIC,KAAJ,EAAT;;AACAR,MAAAA,EAAE,CAACO,GAAH,CAAOE,MAAP,GAAgB,YAAY;AAC1BT,QAAAA,EAAE,CAAClJ,OAAH,CAAW4J,SAAX,CAAqBV,EAAE,CAACO,GAAxB,EAA6B,CAA7B,EAAgC,CAAhC,EAAmC,GAAnC,EAAwC,GAAxC,EAD0B,CACoB;AAC/C,OAFD;;AAIAP,MAAAA,EAAE,CAACO,GAAH,CAAOI,GAAP,GAAa,KAAK7L,MAAL,CAAYiL,YAAzB;AAEAC,MAAAA,EAAE,CAACnJ,MAAH,CAAUgL,KAAV,GAAkB,KAAKhL,MAAL,CAAYgL,KAA9B;AACA7B,MAAAA,EAAE,CAAC9I,MAAH,CAAUyH,MAAV,GAAmB,CAAnB,CApBY,CAoBU;AACvB,KApiBM;AAqiBP;AACA;AACA;AACA;AACA;AACA;AACA;AACAmD,IAAAA,SA5iBO,uBA4iBK;AACV,UAAIC,OAAO,GAAG,KAAKlL,MAAL,CAAYmL,SAAZ,EAAd;AACA,WAAKtM,uBAAL,CAA6BS,+BAA7B,CAA6DoG,IAA7D,CAAkE;AAChE9E,QAAAA,IAAI,EAAE,KAAK3C,MAAL,CAAY2C,IAD8C;AAEhEyF,QAAAA,SAAS,EAAE,KAAKpI,MAAL,CAAYoI,SAFyC;AAGhE6C,QAAAA,YAAY,EAAEgC,OAAO,CAACE,KAAR,CAAc,GAAd,EAAmB,CAAnB;AAHkD,OAAlE;AAKA,WAAKhO,YAAL,GAAoB,KAApB;AACA,WAAKwL,kBAAL,CACE,KAAK/J,uBAAL,CAA6BS,+BAD/B,EAEE,CAAC,KAAKT,uBAAL,CAA6BG,2BAFhC;AAID,KAxjBM;AAyjBPqM,IAAAA,gBAzjBO,8BAyjBY;AACjB,WAAK/K,SAAL,GAAiB,IAAjB;;AACA,UAAI,CAAC,KAAKpC,aAAL,CAAmBoN,iBAAxB,EAA2C;AACzC;AACD,OAFD,MAEO;AACL,aAAKzM,uBAAL,CAA6BY,sCAA7B,CAAoEiG,IAApE,CACE;AACEiB,UAAAA,YAAY,EAAE,KAAKzI,aAAL,CAAmByI,YADnC;AAEE/F,UAAAA,IAAI,EAAE,KAAK1C,aAAL,CAAmB0C,IAF3B;AAGE0K,UAAAA,iBAAiB,EAAE,KAAKpN,aAAL,CAAmBoN;AAHxC,SADF;AAOA,aAAKhL,SAAL,GAAiB,KAAjB;AACA,aAAKjD,mBAAL,GAA2B,KAA3B;AACA,aAAKuL,kBAAL,CACE,KAAK/J,uBAAL,CAA6BY,sCAD/B,EAEE,CAAC,KAAKZ,uBAAL,CAA6BI,kCAFhC;AAID;AACF,KA5kBM;AA6kBPsM,IAAAA,aA7kBO,yBA6kBOxO,IA7kBP,EA6kBayO,KA7kBb,EA6kBoB;AACzB,WAAKrN,cAAL,CAAoBsN,YAApB,GAAmC1O,IAAI,CAAC6D,IAAxC,CADyB,CAEzB;AACA;AACA;AACA;AACA;;AACA,WAAKzC,cAAL,CAAoBuN,kBAApB,GAAyC;AACvCC,QAAAA,IAAI,EAAE5O,IAAI,CAACiK,oBAD4B;AAEvCvG,QAAAA,KAAK,EAAE1D,IAAI,CAACqK,kBAF2B;AAGvCwE,QAAAA,KAAK,EAAE;AAHgC,OAAzC;AAKA,WAAKzN,cAAL,CAAoB0N,qBAApB,GAA4C;AAC1CF,QAAAA,IAAI,EAAE5O,IAAI,CAACkK,wBAD+B;AAE1CxG,QAAAA,KAAK,EAAE1D,IAAI,CAACsK,qBAF8B;AAG1CuE,QAAAA,KAAK,EAAE;AAHmC,OAA5C;AAKA,WAAKzN,cAAL,CAAoB2N,iBAApB,GAAwC;AACtCH,QAAAA,IAAI,EAAE5O,IAAI,CAACgK,oBAD2B;AAEtCtG,QAAAA,KAAK,EAAE1D,IAAI,CAACoK,iBAF0B;AAGtCyE,QAAAA,KAAK,EAAE;AAH+B,OAAxC;AAKA,WAAKtO,eAAL,GAAuB,IAAvB;AACA,WAAKyO,cAAL,GAAsBP,KAAtB;AACD,KArmBM;AAsmBPQ,IAAAA,iBAtmBO,+BAsmBa;AAClB;AACA;AACA,WAAKnN,uBAAL,CAA6Bc,kCAA7B,CAAgE,KAAKoM,cAArE,EAAqF/E,oBAArF,GAA4G,KAAK7I,cAAL,CAAoBuN,kBAApB,CAAuCC,IAAnJ;AACA,WAAK9M,uBAAL,CAA6Bc,kCAA7B,CAAgE,KAAKoM,cAArE,EAAqF3E,kBAArF,GAA0G,KAAKjJ,cAAL,CAAoBuN,kBAApB,CAAuCjL,KAAjJ;AACA,WAAK5B,uBAAL,CAA6Bc,kCAA7B,CAAgE,KAAKoM,cAArE,EAAqF9E,wBAArF,GAAgH,KAAK9I,cAAL,CAAoB0N,qBAApB,CAA0CF,IAA1J;AACA,WAAK9M,uBAAL,CAA6Bc,kCAA7B,CAAgE,KAAKoM,cAArE,EAAqF1E,qBAArF,GAA6G,KAAKlJ,cAAL,CAAoB0N,qBAApB,CAA0CpL,KAAvJ;AACA,WAAK5B,uBAAL,CAA6Bc,kCAA7B,CAAgE,KAAKoM,cAArE,EAAqFhF,oBAArF,GAA4G,KAAK5I,cAAL,CAAoB2N,iBAApB,CAAsCH,IAAlJ;AACA,WAAK9M,uBAAL,CAA6Bc,kCAA7B,CAAgE,KAAKoM,cAArE,EAAqF5E,iBAArF,GAAyG,KAAKhJ,cAAL,CAAoB2N,iBAApB,CAAsCrL,KAA/I;AAEA,WAAKnD,eAAL,GAAuB,KAAvB;AACD,KAjnBM;AAknBP2O,IAAAA,iBAlnBO,6BAknBWlP,IAlnBX,EAknBiByO,KAlnBjB,EAknBwB;AAC7B,WAAKxN,aAAL,CAAmBoK,KAAnB,GAA2BrL,IAAI,CAAC6D,IAAhC;AACA,WAAK5C,aAAL,CAAmBkI,qBAAnB,GAA2CnJ,IAAI,CAACmJ,qBAAhD,CAF6B,CAG7B;;AACA,WAAKhJ,mBAAL,GAA2B,IAA3B;AACA,WAAKgP,kBAAL,GAA0BV,KAA1B;AACA,WAAKxC,MAAL,GAAc,IAAd;AACD,KAznBM;AA0nBPC,IAAAA,qBA1nBO,mCA0nBiB;AACtB,WAAK3I,SAAL,GAAiB,IAAjB;;AACA,UAAI,CAAC,KAAKtC,aAAL,CAAmBkI,qBAAxB,EAA+C;AAC7C;AACD,OAFD,MAEO;AACL,aAAKrH,uBAAL,CAA6BQ,sCAA7B,CAAoE,KAAK6M,kBAAzE,EAA6FhG,qBAA7F,GAAqH,KAAKlI,aAAL,CAAmBkI,qBAAnB,CAAyC6B,QAAzC,EAArH,CADK,CAEL;;AACA,aAAK7K,mBAAL,GAA2B,KAA3B;AACA,aAAKoD,SAAL,GAAiB,KAAjB;AACD;AACF,KApoBM;AAqoBP6L,IAAAA,UAroBO,sBAqoBIC,GAroBJ,EAqoBSrP,IAroBT,EAqoBe;AACpBqP,MAAAA,GAAG,CAACC,MAAJ,CACED,GAAG,CAACE,SAAJ,CAAc,UAACC,CAAD;AAAA,eAAOA,CAAC,KAAKxP,IAAb;AAAA,OAAd,CADF,EAEE,CAFF;AAID,KA1oBM;AA2oBP6L,IAAAA,kBA3oBO,8BA2oBYwD,GA3oBZ,EA2oBiBI,GA3oBjB,EA2oBsB;AAC3BJ,MAAAA,GAAG,CAAC5G,OAAJ,CAAY,UAACC,OAAD,EAAa;AACvBA,QAAAA,OAAO,CAACgH,oBAAR,GAA+B,CAACD,GAAhC;AACD,OAFD;AAGD,KA/oBM;AAgpBDE,IAAAA,GAhpBC,iBAgpBK;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,oBAGL,OAAI,CAAC7N,uBAAL,CAA6BO,mCAA7B,CACE0I,MAJG;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,oBAQL,OAAI,CAACjJ,uBAAL,CAA6BQ,sCAA7B,CACEyI,MATG;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAaN,gBAAA,OAAI,CAACjJ,uBAAL,CAA6BoF,aAA7B,GACE,OAAI,CAAClG,eAAL,CAAqBkG,aADvB;AAGA,gBAAA,OAAI,CAACpF,uBAAL,CAA6B8N,iBAA7B,GAAiD/P,MAAM,CACrD0B,MAAM,CAAC,OAAI,CAACO,uBAAL,CAA6BC,mBAA9B,CAD+C,CAAN,CAE/CN,MAF+C,CAExC,YAFwC,CAAjD;;AAIA,oBAAI,OAAI,CAACK,uBAAL,CAA6BE,cAAjC,EAAiD;AAC/C,kBAAA,OAAI,CAACF,uBAAL,CAA6B+N,YAA7B,GAA4ChQ,MAAM,CAChD0B,MAAM,CAAC,OAAI,CAACO,uBAAL,CAA6BE,cAA9B,CAD0C,CAAN,CAE1CP,MAF0C,CAEnC,YAFmC,CAA5C;AAGD;;AAxBK;AAAA,uBA0Ba,OAAI,CAAC2C,8BAAL,CAAoCuL,GAApC,CACjB,OAAI,CAAC7N,uBADY,EACa,OADb,CA1Bb;;AAAA;AA0BFgO,gBAAAA,MA1BE;;AA6BN,oBAAIA,MAAM,CAACC,MAAP,KAAkB,GAAtB,EAA2B;AACzB,kBAAA,OAAI,CAAC3H,oBAAL,CAA0B,OAAI,CAACtG,uBAAL,CAA6BoF,aAAvD;;AACA,kBAAA,OAAI,CAAC8I,MAAL,CAAYL,GAAZ,CAAgB;AACdM,oBAAAA,QAAQ,EAAE,SADI;AAEdC,oBAAAA,OAAO,EAAE,QAFK;AAGdC,oBAAAA,MAAM,EAAE,wBAHM;AAIdC,oBAAAA,IAAI,EAAE;AAJQ,mBAAhB;;AAMA,kBAAA,OAAI,CAAC5K,eAAL;;AACA,kBAAA,OAAI,CAACsB,KAAL;AACD,iBAVD,MAUO;AACL,kBAAA,OAAI,CAACkJ,MAAL,CAAYL,GAAZ,CAAgB;AACdM,oBAAAA,QAAQ,EAAE,OADI;AAEdC,oBAAAA,OAAO,EAAE,OAFK;AAGdC,oBAAAA,MAAM,EAAEL,MAAM,CAACO,GAHD;AAIdD,oBAAAA,IAAI,EAAE;AAJQ,mBAAhB;AAMD;;AA9CK;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAiDR,gBAAA,OAAI,CAACJ,MAAL,CAAYL,GAAZ,CAAgB;AACdM,kBAAAA,QAAQ,EAAE,OADI;AAEdC,kBAAAA,OAAO,EAAE,OAFK;AAGdC,kBAAAA,MAAM,aAHQ;AAIdC,kBAAAA,IAAI,EAAE;AAJQ,iBAAhB;;AAjDQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAwDX,KAxsBM;AAysBP5K,IAAAA,eAzsBO,6BAysBW;AAChB,WAAK1E,UAAL,GAAkB,UAAlB;AACA,WAAK0C,OAAL,CAAa,QAAb,EAAuBE,KAAvB,GAA+B,EAA/B;AACA,WAAK3C,QAAL,GAAgB,EAAhB;AACA,WAAKE,aAAL,GAAqB,EAArB;AACA,WAAKC,MAAL,GAAc,EAAd;AACA,WAAKC,aAAL,GAAqB,EAArB;AACA,WAAKW,uBAAL,GAA+B;AAC7BC,QAAAA,mBAAmB,EAAElC,MAAM,CAAC0B,MAAM,CAAC,IAAIC,IAAJ,EAAD,CAAP,CAAN,CAA2BC,MAA3B,CAAkC,YAAlC,CADQ;AAE7BO,QAAAA,cAAc,EAAEnC,MAAM,CACpB0B,MAAM,CAAC,IAAIC,IAAJ,CAAS,IAAIA,IAAJ,GAAWG,OAAX,CAAmB,IAAIH,IAAJ,GAAWI,OAAX,KAAuB,CAA1C,CAAT,CAAD,CADc,CAAN,CAEdH,MAFc,CAEP,YAFO,CAFa;AAM7BQ,QAAAA,2BAA2B,EAAE,IANA;AAO7BC,QAAAA,kCAAkC,EAAE,IAPP;AAQ7BC,QAAAA,gCAAgC,EAAE,IARL;AAU7BE,QAAAA,mCAAmC,EAAE,EAVR;AAW7BC,QAAAA,sCAAsC,EAAE,EAXX;AAY7BC,QAAAA,+BAA+B,EAAE,EAZJ;AAa7BC,QAAAA,sCAAsC,EAAE,EAbX;AAc7BC,QAAAA,kCAAkC,EAAE,EAdP;AAe7BC,QAAAA,sCAAsC,EAAE,EAfX;AAgB7BC,QAAAA,oCAAoC,EAAE,EAhBT;AAiB7BC,QAAAA,kCAAkC,EAAE,EAjBP;AAkB7BC,QAAAA,+BAA+B,EAAE;AAlBJ,OAA/B;AAqBA,WAAKU,SAAL,GAAiB,KAAjB;AACD;AAtuBM;AAxKI,CAAf","sourcesContent":["import CommonService from \"../../service/CommonService\";\r\nimport DoctorAppointmentService from \"../../service/front-desk/DoctorAppointmentService\";\r\nimport FigureSetupService from \"../../service/setup/FigureSetupService\";\r\nimport AppointmentPrescriptionService from \"../../service/doctor-panel/AppointmentPrescriptionService\";\r\n//import MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\nimport PrescriptionReportService from \"../../service/report/PrescriptionReportService\";\r\nimport moment from \"moment\";\r\nimport { FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      dataList: true,\r\n      isAdvice: false,\r\n      onExaminationDialog: false,\r\n      onExaminationPopupDialog: false,\r\n      //editOnExaminationDialog: false,\r\n      figureDialog: false,\r\n      familyHistoryDialog: false,\r\n      treatmentDialog: false,\r\n      prevPrescriptionDialog: false,\r\n      appoinmentStatusList: [],\r\n      patientsRelativeList: [],\r\n      doctorAppointmentList: [],\r\n      prescriptionDataList: [],\r\n      prevPrescriptionList: [],\r\n      headerName: \"Sections\",\r\n      tempData: [],\r\n      appointmentInfo: {},\r\n      onExamination: {},\r\n      figure: {},\r\n      familyHistory: {},\r\n      treatmentSetup: {},\r\n      doctorAppointment: {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n        appoinment_status: \"Active\",\r\n      },\r\n\r\n      //Test\r\n      // doctorAppointment: {\r\n      //   cdfromdate: \"01/01/2021\",\r\n      //   cdtodate: \"01/01/2022\",\r\n      //   appoinment_status: \"All\",\r\n      // },\r\n\r\n      appointmentPrescription: {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        figure_show_in_prescription: true,\r\n        familyHistory_show_in_prescription: true,\r\n        pastHistory_show_in_prescription: true,\r\n        allAdvice: false,\r\n\r\n        lstAppoinmentPrescriptionCompliants: [],\r\n        lstAppoinmentPrescriptionOnExamination: [],\r\n        lstAppoinmentPrescriptionFigure: [],\r\n        lstAppoinmentPrescriptionInvestigation: [],\r\n        lstAppoinmentPrescriptionDiagnosis: [],\r\n        lstAppoinmentPrescriptionFamilyHistory: [],\r\n        lstAppoinmentPrescriptionPastHistory: [],\r\n        lstAppoinmentPrescriptionTreatment: [],\r\n        lstAppoinmentPrescriptionAdvice: [],\r\n      },\r\n      //medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n      // canvas\r\n      canvas: null,\r\n      context: null,\r\n      isDrawing: false,\r\n      startX: 0,\r\n      startY: 0,\r\n      points: [],\r\n      //\r\n      submitted: false,\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n    this.figureSetupService = new FigureSetupService();\r\n    this.doctorAppointmentService = new DoctorAppointmentService();\r\n    this.commonService = new CommonService();\r\n    //this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n    this.prescriptionReportService = new PrescriptionReportService();\r\n\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n\r\n    this.commonService\r\n      .GetAllAppoinmentStatus()\r\n      .then((data) => (this.appoinmentStatusList = data.data));\r\n\r\n    this.commonService\r\n      .GetAllPatientsRelatives()\r\n      .then((data) => (this.patientsRelativeList = data.data));\r\n\r\n    this.appointmentPrescriptionService\r\n      .getPrescriptionDataByDoctorId(this.userInfo.doctor_id)\r\n      .then((data) => (this.prescriptionDataList = data.data));\r\n\r\n    //\r\n    // this.medicineSetupService\r\n    //   .getActiveCombo()\r\n    //   .then((data) => (this.medicineList = data.data));\r\n\r\n    this.treatmentRulesSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n    this.treatmentDurationSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n    this.treatmentDoseSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentDoseList = data.data));\r\n\r\n    this.show();\r\n    this.newPrescription();\r\n\r\n    let that = this;\r\n    document.onkeyup = function (e) {\r\n      if (e.ctrlKey && e.altKey && e.which == 67) {\r\n        that.getPatientComplaints();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 69) {\r\n        that.getOnExaminationsPopup();\r\n        that.getOnExaminations();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 70) {\r\n        that.getFigure();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 73) {\r\n        that.getInvestigation();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 68) {\r\n        that.getDiagnosis();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 72) {\r\n        that.getFamilyHistory();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 80) {\r\n        that.getPastHistory();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 84) {\r\n        that.getTreatment();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 65) {\r\n        that.getAdvice();\r\n      }\r\n      // else if (e.ctrlKey && e.altKey && e.shiftKey) {\r\n\r\n      // }\r\n    };\r\n\r\n    var prescriptionData = JSON.parse(localStorage.getItem('prescriptionData'));\r\n    if (prescriptionData) {\r\n      this.prescription(prescriptionData);\r\n      localStorage.removeItem('prescriptionData');\r\n    }\r\n  },\r\n  methods: {\r\n    reset() {\r\n      this.doctorAppointment = {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n        appoinment_status: \"Active\",\r\n      };\r\n\r\n      // this.dataList = true;\r\n      // this.submitted = false;\r\n      this.show();\r\n    },\r\n    show() {\r\n      this.submitted = true;\r\n      if (!this.doctorAppointment.cdfromdate) {\r\n        return;\r\n      } else if (!this.doctorAppointment.cdtodate) {\r\n        return;\r\n      } else if (!this.doctorAppointment.appoinment_status) {\r\n        return;\r\n      } else {\r\n        this.doctorAppointment.fromdate = moment(\r\n          String(this.doctorAppointment.cdfromdate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.doctorAppointment.todate = moment(\r\n          String(this.doctorAppointment.cdtodate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.doctorAppointmentService\r\n          .getDynamicDoctorWise(\r\n            this.doctorAppointment.fromdate,\r\n            this.doctorAppointment.todate,\r\n            this.doctorAppointment.appoinment_status,\r\n            this.userInfo.doctor_id\r\n          )\r\n          .then((data) => (this.doctorAppointmentList = data.data));\r\n\r\n        //Test\r\n        // this.doctorAppointmentService\r\n        //   .getDynamicDoctorWise(\r\n        //     this.doctorAppointment.fromdate,\r\n        //     this.doctorAppointment.todate,\r\n        //     this.doctorAppointment.appoinment_status,\r\n        //     this.userInfo.doctor_id\r\n        //   )\r\n        //   .then((data) => this.prescription(data.data));\r\n      }\r\n      this.dataList = true;\r\n      this.submitted = false;\r\n    },\r\n    prescription(data) {\r\n      this.appointmentInfo.appoinment_id = data.appoinment_id;\r\n      this.appointmentInfo.patientReg = data.aPatient.registration_no;\r\n      this.appointmentInfo.patientName =\r\n        data.aPatient.first_name + \" \" + data.aPatient.last_name;\r\n      this.appointmentInfo.patientGender = data.aPatient.gender;\r\n      this.appointmentInfo.patientAgeYear = data.aPatient.age_year;\r\n      this.appointmentInfo.patientAgeMonth = data.aPatient.age_month;\r\n      this.appointmentInfo.patientAgeDay = data.aPatient.age_day;\r\n\r\n      // var patientDOB = moment(String(data.aPatient.dob)).format(\r\n      //   \"MM/DD/YYYY\"\r\n      // );\r\n\r\n      //this.appointmentInfo.age = Math.floor(moment(new Date()).diff(moment(patientDOB, \"MM/DD/YYYY\"), 'years', true));\r\n      //this.appointmentInfo.age = moment(patientDOB, \"MM/DD/YYYY\").fromNow().split(\" \")[0];\r\n\r\n      this.dataList = false;\r\n    },\r\n    previousPrescription(patient_id) {\r\n      this.appointmentPrescriptionService\r\n        .getPatientWisePrescriptionList(patient_id)\r\n        .then((data) => (this.prevPrescriptionList = data.data));\r\n\r\n      this.prevPrescriptionDialog = true;\r\n    },\r\n    downloadPrescription(appoinment_id) {\r\n      this.prescriptionReportService.GetPescription(appoinment_id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n\r\n    //\r\n    getPatientComplaints() {\r\n      this.headerName = \"Patient Complaints\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstComplaint.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.compilants_name,\r\n          id: element.compilants_id,\r\n        });\r\n      });\r\n    },\r\n    getOnExaminationsPopup() {\r\n      this.popupOnExaminationsData = [];\r\n      this.prescriptionDataList.lstOnExamination.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          name: element.on_examination_name,\r\n          id: element.on_examination_id,\r\n          on_examination_result: 1,\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n    getOnExaminations() {\r\n      //this.getOnExaminationsPopup();\r\n      this.headerName = \"On Examinations\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstOnExamination.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.on_examination_name,\r\n          id: element.on_examination_id,\r\n        });\r\n      });\r\n    },\r\n    getFigure() {\r\n      this.headerName = \"Figure\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstFigureSetup.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.figure_name,\r\n          id: element.figure_id,\r\n        });\r\n      });\r\n    },\r\n    getInvestigation() {\r\n      this.headerName = \"Investigation\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstInvestigation.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.investingation_name,\r\n          id: element.investigation_id,\r\n        });\r\n      });\r\n    },\r\n    getDiagnosis() {\r\n      this.headerName = \"Diagnosis\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getFamilyHistory() {\r\n      this.headerName = \"Family History\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getPastHistory() {\r\n      this.headerName = \"Past History\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getTreatment() {\r\n      this.headerName = \"Medicine\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstTreatment.forEach((element) => {\r\n        this.tempData.push({\r\n          _medicine_type_name: element._medicine_type_name,\r\n          _medicine_name: element._medicine_name,\r\n          name: element._medicine_type_name + \" \" + element._medicine_name + \" \" + element._treatment_dose_name + \" \" + element._treatment_rule_name + \" \" + element._treatment_duration_name,\r\n          id: element.medicine_id,\r\n          _treatment_dose_name: element._treatment_dose_name,\r\n          treatment_dose_id: element.treatment_dose_id,\r\n          _treatment_rule_name: element._treatment_rule_name,\r\n          treatment_rules_id: element.treatment_rules_id,\r\n          _treatment_duration_name: element._treatment_duration_name,\r\n          treatment_duration_id: element.treatment_duration_id,\r\n          description: element.description,\r\n        });\r\n      });\r\n    },\r\n    getAdvice() {\r\n      this.headerName = \"Advice\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = true;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstAdvices.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.advice_name,\r\n          id: element.advice_id,\r\n        });\r\n      });\r\n    },\r\n    addOnExaminationFromPopup() {\r\n      //this.submitted = true;\r\n      //this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (element.on_examination_result) {\r\n          //this.requred = \"required\";\r\n          var aOnExaminations =\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.filter(\r\n              function (el) {\r\n                return el.on_examination_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aOnExaminations.length) {\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.push({\r\n              name: element.name,\r\n              on_examination_id: element.id,\r\n              on_examination_result:\r\n                element.on_examination_result.toString(),\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      // if (this.requred) {\r\n      //   this.$toast.add({\r\n      //     severity: \"error\",\r\n      //     summary: \"Required\",\r\n      //     detail: \"Please fill in the required fields\",\r\n      //     life: 10000,\r\n      //   });\r\n      //   return;\r\n      // }\r\n\r\n      this.onExaminationPopupDialog = false;\r\n    },\r\n    // add all advice checkbox\r\n    addAllAdvice() {\r\n      if (!this.appointmentPrescription.allAdvice) {\r\n        this.tempData.forEach((element) => {\r\n          var aAdvice =\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.filter(\r\n              function (el) {\r\n                return el.advice_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aAdvice.length) {\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.push({\r\n              name: element.name,\r\n              advice_id: element.id,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // add value \r\n    getValue(data) {\r\n      if (this.headerName == \"Patient Complaints\") {\r\n        var aCompliants =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionCompliants.filter(\r\n            function (el) {\r\n              return el.compilants_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aCompliants.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionCompliants.push(\r\n            {\r\n              name: data.name,\r\n              compilants_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"On Examinations\") {\r\n        var aOnExaminations =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.filter(\r\n            function (el) {\r\n              return el.on_examination_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aOnExaminations.length) {\r\n          this.onExamination.label = data.name;\r\n          this.onExamination.on_examination_id = data.id;\r\n          this.onExamination.on_examination_result = 1;\r\n          this.onExaminationDialog = true;\r\n        }\r\n      } else if (this.headerName == \"Figure\") {\r\n        var aFigure =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFigure.filter(\r\n            function (el) {\r\n              return el.figure_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aFigure.length) {\r\n          this.figureDialog = true;\r\n          this.figure.name = data.name;\r\n          this.figure.figure_id = data.id;\r\n          this.figureSetupService\r\n            .getById(data.id)\r\n            .then((data) => this.getFigureFormatted(data.data));\r\n        }\r\n      } else if (this.headerName == \"Investigation\") {\r\n        var aInvestigation =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionInvestigation.filter(\r\n            function (el) {\r\n              return el.investigation_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aInvestigation.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionInvestigation.push(\r\n            {\r\n              name: data.name,\r\n              investigation_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Diagnosis\") {\r\n        var aDiagnosis =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionDiagnosis.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aDiagnosis.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionDiagnosis.push({\r\n            name: data.name,\r\n            diagnosis_id: data.id,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Family History\") {\r\n        var aFamilyHistory =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aFamilyHistory.length) {\r\n          this.familyHistory.diagnosis_id = data.id;\r\n          this.familyHistory.name = data.name;\r\n          this.familyHistoryDialog = true;\r\n        }\r\n      } else if (this.headerName == \"Past History\") {\r\n        var aPastHistory =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aPastHistory.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory.push(\r\n            {\r\n              name: data.name,\r\n              diagnosis_id: data.id,\r\n            }\r\n          );\r\n          this.showInPrescription(\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory,\r\n            !this.appointmentPrescription.pastHistory_show_in_prescription\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Medicine\") {\r\n        var aMedicine =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.push({\r\n            _medicine_type_name: data._medicine_type_name,\r\n            name: data._medicine_name,\r\n            medicine_id: data.id,\r\n            _treatment_dose_name: data._treatment_dose_name,\r\n            treatment_dose_id: data.treatment_dose_id,\r\n            _treatment_rule_name: data._treatment_rule_name,\r\n            treatment_rules_id: data.treatment_rules_id,\r\n            _treatment_duration_name: data._treatment_duration_name,\r\n            treatment_duration_id: data.treatment_duration_id,\r\n            description: data.description,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Advice\") {\r\n        var aAdvice =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.filter(\r\n            function (el) {\r\n              return el.advice_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aAdvice.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.push({\r\n            name: data.name,\r\n            advice_id: data.id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    hideDialog() {\r\n      this.onExaminationDialog = false;\r\n      this.onExaminationPopupDialog = false;\r\n      //this.editOnExaminationDialog = false;\r\n      this.figureDialog = false;\r\n      this.familyHistoryDialog = false;\r\n      this.treatmentDialog = false;\r\n      this.prevPrescriptionDialog = false;\r\n      this.submitted = false;\r\n    },\r\n    addOnExamination() {\r\n      if (!this.isEdit) {\r\n        this.submitted = true;\r\n        if (!this.onExamination.on_examination_result) {\r\n          return;\r\n        } else {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.push(\r\n            {\r\n              name: this.onExamination.label,\r\n              on_examination_id: this.onExamination.on_examination_id,\r\n              on_examination_result:\r\n                this.onExamination.on_examination_result.toString(),\r\n            }\r\n          );\r\n          this.submitted = false;\r\n          this.onExaminationDialog = false;\r\n        }\r\n      } else if (this.isEdit) {\r\n        this.onExaminationEditSave();\r\n        this.isEdit = false;\r\n      }\r\n\r\n    },\r\n    getFigureFormatted(data) {\r\n      this.figure.figure_image = \"data:image/jpg;base64,\" + data.figure_image;\r\n      // canvas\r\n      var vm = this;\r\n      vm.canvas = vm.$refs.canvas;\r\n      vm.context = vm.canvas.getContext(\"2d\");\r\n      vm.canvas.addEventListener(\"mousedown\", vm.mousedown);\r\n      vm.canvas.addEventListener(\"mousemove\", vm.mousemove);\r\n      document.addEventListener(\"mouseup\", vm.mouseup);\r\n\r\n      vm.img = new Image();\r\n      vm.img.onload = function () {\r\n        vm.context.drawImage(vm.img, 0, 0, 300, 200); // Or at whatever offset you like and set height, width\r\n      };\r\n\r\n      vm.img.src = this.figure.figure_image;\r\n    },\r\n    // canvas\r\n    mousedown(e) {\r\n      var vm = this;\r\n      var rect = vm.canvas.getBoundingClientRect();\r\n      var x = e.clientX - rect.left;\r\n      var y = e.clientY - rect.top;\r\n\r\n      vm.isDrawing = true;\r\n      vm.startX = x;\r\n      vm.startY = y;\r\n      vm.points.push({\r\n        x: x,\r\n        y: y,\r\n      });\r\n    },\r\n    mousemove(e) {\r\n      var vm = this;\r\n      var rect = vm.canvas.getBoundingClientRect();\r\n      var x = e.clientX - rect.left;\r\n      var y = e.clientY - rect.top;\r\n\r\n      if (vm.isDrawing) {\r\n        vm.context.beginPath();\r\n        vm.context.moveTo(vm.startX, vm.startY);\r\n        vm.context.lineTo(x, y);\r\n        vm.context.lineWidth = 1;\r\n        vm.context.lineCap = \"round\";\r\n        vm.context.strokeStyle = \"rgba(0,0,0,1)\";\r\n        vm.context.stroke();\r\n\r\n        vm.startX = x;\r\n        vm.startY = y;\r\n\r\n        vm.points.push({\r\n          x: x,\r\n          y: y,\r\n        });\r\n      }\r\n    },\r\n    mouseup() {\r\n      var vm = this;\r\n      vm.isDrawing = false;\r\n      if (vm.points.length > 0) {\r\n        localStorage[\"points\"] = JSON.stringify(vm.points);\r\n      }\r\n    },\r\n    resetCanvas() {\r\n      // var vm = this;\r\n      // vm.canvas.width = vm.canvas.width;\r\n      // vm.points.length = 0; // reset points array\r\n\r\n      var vm = this;\r\n      vm.canvas = vm.$refs.canvas;\r\n      vm.context = vm.canvas.getContext(\"2d\");\r\n      vm.canvas.addEventListener(\"mousedown\", vm.mousedown);\r\n      vm.canvas.addEventListener(\"mousemove\", vm.mousemove);\r\n      document.addEventListener(\"mouseup\", vm.mouseup);\r\n\r\n      vm.img = new Image();\r\n      vm.img.onload = function () {\r\n        vm.context.drawImage(vm.img, 0, 0, 300, 200); // Or at whatever offset you like and set height, width\r\n      };\r\n\r\n      vm.img.src = this.figure.figure_image;\r\n\r\n      vm.canvas.width = this.canvas.width;\r\n      vm.points.length = 0; // reset points array\r\n    },\r\n    // saveImage() {\r\n    //   var vm = this;\r\n    //   var dataURL = vm.canvas.toDataURL();\r\n    //   var img = vm.$refs.img;\r\n    //   img.src = dataURL;\r\n    // },\r\n    //\r\n    addFigure() {\r\n      var dataURL = this.canvas.toDataURL();\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionFigure.push({\r\n        name: this.figure.name,\r\n        figure_id: this.figure.figure_id,\r\n        figure_image: dataURL.split(\",\")[1],\r\n      });\r\n      this.figureDialog = false;\r\n      this.showInPrescription(\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionFigure,\r\n        !this.appointmentPrescription.figure_show_in_prescription\r\n      );\r\n    },\r\n    addFamilyHistory() {\r\n      this.submitted = true;\r\n      if (!this.familyHistory.relative_ralation) {\r\n        return;\r\n      } else {\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory.push(\r\n          {\r\n            diagnosis_id: this.familyHistory.diagnosis_id,\r\n            name: this.familyHistory.name,\r\n            relative_ralation: this.familyHistory.relative_ralation,\r\n          }\r\n        );\r\n        this.submitted = false;\r\n        this.familyHistoryDialog = false;\r\n        this.showInPrescription(\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory,\r\n          !this.appointmentPrescription.familyHistory_show_in_prescription\r\n        );\r\n      }\r\n    },\r\n    editTreatment(data, index) {\r\n      this.treatmentSetup.medicineName = data.name;\r\n      // this.treatmentSetup.ddlmedicine = {\r\n      //   text: data.name,\r\n      //   value: data.medicine_id,\r\n      //   refid: null,\r\n      // };\r\n      this.treatmentSetup.ddltreatment_rules = {\r\n        text: data._treatment_rule_name,\r\n        value: data.treatment_rules_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_duration = {\r\n        text: data._treatment_duration_name,\r\n        value: data.treatment_duration_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_dose = {\r\n        text: data._treatment_dose_name,\r\n        value: data.treatment_dose_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentDialog = true;\r\n      this.treatmentIndex = index\r\n    },\r\n    treatmentEditSave() {\r\n      //this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].name = this.treatmentSetup.ddlmedicine.text;\r\n      //this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].medicine_id = this.treatmentSetup.ddlmedicine.value;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_rule_name = this.treatmentSetup.ddltreatment_rules.text;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_rules_id = this.treatmentSetup.ddltreatment_rules.value;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_duration_name = this.treatmentSetup.ddltreatment_duration.text;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_duration_id = this.treatmentSetup.ddltreatment_duration.value;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_dose_name = this.treatmentSetup.ddltreatment_dose.text;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_dose_id = this.treatmentSetup.ddltreatment_dose.value;\r\n\r\n      this.treatmentDialog = false;\r\n    },\r\n    editOnExamination(data, index) {\r\n      this.onExamination.label = data.name;\r\n      this.onExamination.on_examination_result = data.on_examination_result;\r\n      //this.editOnExaminationDialog = true;\r\n      this.onExaminationDialog = true;\r\n      this.onExaminationIndex = index;\r\n      this.isEdit = true;\r\n    },\r\n    onExaminationEditSave() {\r\n      this.submitted = true;\r\n      if (!this.onExamination.on_examination_result) {\r\n        return;\r\n      } else {\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination[this.onExaminationIndex].on_examination_result = this.onExamination.on_examination_result.toString();\r\n        //this.editOnExaminationDialog = false;\r\n        this.onExaminationDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n    deleteItem(lst, data) {\r\n      lst.splice(\r\n        lst.findIndex((i) => i === data),\r\n        1\r\n      );\r\n    },\r\n    showInPrescription(lst, val) {\r\n      lst.forEach((element) => {\r\n        element.show_in_prescription = !val;\r\n      });\r\n    },\r\n    async add() {\r\n      try {\r\n        if (\r\n          !this.appointmentPrescription.lstAppoinmentPrescriptionCompliants\r\n            .length\r\n        ) {\r\n          return;\r\n        } else if (\r\n          !this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination\r\n            .length\r\n        ) {\r\n          return;\r\n        } else {\r\n          this.appointmentPrescription.appoinment_id =\r\n            this.appointmentInfo.appoinment_id;\r\n\r\n          this.appointmentPrescription.prescription_date = moment(\r\n            String(this.appointmentPrescription.cdprescription_date)\r\n          ).format(\"YYYY-MM-DD\");\r\n\r\n          if (this.appointmentPrescription.cdfolowup_date) {\r\n            this.appointmentPrescription.folowup_date = moment(\r\n              String(this.appointmentPrescription.cdfolowup_date)\r\n            ).format(\"YYYY-MM-DD\");\r\n          }\r\n\r\n          let result = await this.appointmentPrescriptionService.add(\r\n            this.appointmentPrescription, this\r\n          );\r\n          if (result.status === 200) {\r\n            this.downloadPrescription(this.appointmentPrescription.appoinment_id)\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Sucess\",\r\n              detail: \"Prescribed Sucessfully\",\r\n              life: 10000,\r\n            });\r\n            this.newPrescription();\r\n            this.reset();\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Faild\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Faild\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    newPrescription() {\r\n      this.headerName = \"Sections\";\r\n      this.filters['global'].value = \"\";\r\n      this.tempData = [];\r\n      this.onExamination = {};\r\n      this.figure = {};\r\n      this.familyHistory = {};\r\n      this.appointmentPrescription = {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        figure_show_in_prescription: true,\r\n        familyHistory_show_in_prescription: true,\r\n        pastHistory_show_in_prescription: true,\r\n\r\n        lstAppoinmentPrescriptionCompliants: [],\r\n        lstAppoinmentPrescriptionOnExamination: [],\r\n        lstAppoinmentPrescriptionFigure: [],\r\n        lstAppoinmentPrescriptionInvestigation: [],\r\n        lstAppoinmentPrescriptionDiagnosis: [],\r\n        lstAppoinmentPrescriptionFamilyHistory: [],\r\n        lstAppoinmentPrescriptionPastHistory: [],\r\n        lstAppoinmentPrescriptionTreatment: [],\r\n        lstAppoinmentPrescriptionAdvice: [],\r\n      };\r\n\r\n      this.submitted = false;\r\n    },\r\n  },\r\n};"]}]}