{"remainingRequest":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\src\\scripts\\doctor-panel\\AppointmentPrescription.js","dependencies":[{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\src\\scripts\\doctor-panel\\AppointmentPrescription.js","mtime":1638445893639},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L1NWTiBQUk9KRUNUUy9EaWFnbm9zdGljQ2VudGVyTWFuYWdlbWVudF9DbGllbnQvdHJ1bmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgQ29tbW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL0NvbW1vblNlcnZpY2UiOwppbXBvcnQgRG9jdG9yQXBwb2ludG1lbnRTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvZnJvbnQtZGVzay9Eb2N0b3JBcHBvaW50bWVudFNlcnZpY2UiOwppbXBvcnQgRmlndXJlU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvRmlndXJlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IEFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2RvY3Rvci1wYW5lbC9BcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UiOyAvL2ltcG9ydCBNZWRpY2luZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL01lZGljaW5lU2V0dXBTZXJ2aWNlIjsKCmltcG9ydCBUcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvVHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UiOwppbXBvcnQgUHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3JlcG9ydC9QcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlIjsKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwppbXBvcnQgeyBGaWx0ZXJNYXRjaE1vZGUsIEZpbHRlck9wZXJhdG9yIH0gZnJvbSAicHJpbWV2dWUvYXBpIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRhTGlzdDogdHJ1ZSwKICAgICAgaXNBZHZpY2U6IGZhbHNlLAogICAgICBvbkV4YW1pbmF0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgb25FeGFtaW5hdGlvblBvcHVwRGlhbG9nOiBmYWxzZSwKICAgICAgLy9lZGl0T25FeGFtaW5hdGlvbkRpYWxvZzogZmFsc2UsCiAgICAgIGZpZ3VyZURpYWxvZzogZmFsc2UsCiAgICAgIGZhbWlseUhpc3RvcnlEaWFsb2c6IGZhbHNlLAogICAgICB0cmVhdG1lbnREaWFsb2c6IGZhbHNlLAogICAgICBwcmV2UHJlc2NyaXB0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgYXBwb2lubWVudFN0YXR1c0xpc3Q6IFtdLAogICAgICBwYXRpZW50c1JlbGF0aXZlTGlzdDogW10sCiAgICAgIGRvY3RvckFwcG9pbnRtZW50TGlzdDogW10sCiAgICAgIHByZXNjcmlwdGlvbkRhdGFMaXN0OiBbXSwKICAgICAgcHJldlByZXNjcmlwdGlvbkxpc3Q6IFtdLAogICAgICBoZWFkZXJOYW1lOiAiU2VjdGlvbnMiLAogICAgICB0ZW1wRGF0YTogW10sCiAgICAgIGFwcG9pbnRtZW50SW5mbzoge30sCiAgICAgIG9uRXhhbWluYXRpb246IHt9LAogICAgICBmaWd1cmU6IHt9LAogICAgICBmYW1pbHlIaXN0b3J5OiB7fSwKICAgICAgdHJlYXRtZW50U2V0dXA6IHt9LAogICAgICBkb2N0b3JBcHBvaW50bWVudDogewogICAgICAgIGNkZnJvbWRhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGNkdG9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICAvLyBjZHRvZGF0ZTogbW9tZW50KAogICAgICAgIC8vICAgU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSArIDcpKSkKICAgICAgICAvLyApLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGFwcG9pbm1lbnRfc3RhdHVzOiAiQWN0aXZlIgogICAgICB9LAogICAgICAvL1Rlc3QKICAgICAgLy8gZG9jdG9yQXBwb2ludG1lbnQ6IHsKICAgICAgLy8gICBjZGZyb21kYXRlOiAiMDEvMDEvMjAyMSIsCiAgICAgIC8vICAgY2R0b2RhdGU6ICIwMS8wMS8yMDIyIiwKICAgICAgLy8gICBhcHBvaW5tZW50X3N0YXR1czogIkFsbCIsCiAgICAgIC8vIH0sCiAgICAgIGFwcG9pbnRtZW50UHJlc2NyaXB0aW9uOiB7CiAgICAgICAgY2RwcmVzY3JpcHRpb25fZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgY2Rmb2xvd3VwX2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpICsgNykpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgZmlndXJlX3Nob3dfaW5fcHJlc2NyaXB0aW9uOiB0cnVlLAogICAgICAgIGZhbWlseUhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgcGFzdEhpc3Rvcnlfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgYWxsQWR2aWNlOiBmYWxzZSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQ29tcGxpYW50czogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb246IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GaWd1cmU6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRGlhZ25vc2lzOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmFtaWx5SGlzdG9yeTogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvblBhc3RIaXN0b3J5OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9LAogICAgICAvL21lZGljaW5lTGlzdDogW10sCiAgICAgIHRyZWF0bWVudFJ1bGVzTGlzdDogW10sCiAgICAgIHRyZWF0bWVudER1cmF0aW9uTGlzdDogW10sCiAgICAgIHRyZWF0bWVudERvc2VMaXN0OiBbXSwKICAgICAgLy8gY2FudmFzCiAgICAgIGNhbnZhczogbnVsbCwKICAgICAgY29udGV4dDogbnVsbCwKICAgICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgICAgc3RhcnRYOiAwLAogICAgICBzdGFydFk6IDAsCiAgICAgIHBvaW50czogW10sCiAgICAgIC8vCiAgICAgIHN1Ym1pdHRlZDogZmFsc2UsCiAgICAgIGZpbHRlcnM6IHsKICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICB9LAogICAgICAgIG5hbWU6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuU1RBUlRTX1dJVEgKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGluaXRGaWx0ZXJzOiBmdW5jdGlvbiBpbml0RmlsdGVycygpIHsKICAgICAgICB0aGlzLmZpbHRlcnMgPSB7CiAgICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLkNPTlRBSU5TCiAgICAgICAgICB9LAogICAgICAgICAgbmFtZTogewogICAgICAgICAgICBvcGVyYXRvcjogRmlsdGVyT3BlcmF0b3IuQU5ELAogICAgICAgICAgICBjb25zdHJhaW50czogW3sKICAgICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgICAgICB9XQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UoKTsKICAgIHRoaXMuZmlndXJlU2V0dXBTZXJ2aWNlID0gbmV3IEZpZ3VyZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudFNlcnZpY2UgPSBuZXcgRG9jdG9yQXBwb2ludG1lbnRTZXJ2aWNlKCk7CiAgICB0aGlzLmNvbW1vblNlcnZpY2UgPSBuZXcgQ29tbW9uU2VydmljZSgpOyAvL3RoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UgPSBuZXcgTWVkaWNpbmVTZXR1cFNlcnZpY2UoKTsKCiAgICB0aGlzLnRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgPSBuZXcgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5wcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlID0gbmV3IFByZXNjcmlwdGlvblJlcG9ydFNlcnZpY2UoKTsKICAgIHRoaXMudXNlckluZm8gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySW5mbyIpKTsKICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxBcHBvaW5tZW50U3RhdHVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMuYXBwb2lubWVudFN0YXR1c0xpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxQYXRpZW50c1JlbGF0aXZlcygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLnBhdGllbnRzUmVsYXRpdmVMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmVzY3JpcHRpb25EYXRhQnlEb2N0b3JJZCh0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsgLy8KICAgIC8vIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UKICAgIC8vICAgLmdldEFjdGl2ZUNvbWJvKCkKICAgIC8vICAgLnRoZW4oKGRhdGEpID0+ICh0aGlzLm1lZGljaW5lTGlzdCA9IGRhdGEuZGF0YSkpOwoKICAgIHRoaXMudHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy50cmVhdG1lbnRSdWxlc0xpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMudHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy50cmVhdG1lbnREdXJhdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsKICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLnRyZWF0bWVudERvc2VMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLnNob3coKTsKICAgIHRoaXMubmV3UHJlc2NyaXB0aW9uKCk7CiAgICB2YXIgdGhhdCA9IHRoaXM7CgogICAgZG9jdW1lbnQub25rZXl1cCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2NykgewogICAgICAgIHRoYXQuZ2V0UGF0aWVudENvbXBsYWludHMoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2OSkgewogICAgICAgIHRoYXQuZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpOwogICAgICAgIHRoYXQuZ2V0T25FeGFtaW5hdGlvbnMoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA3MCkgewogICAgICAgIHRoYXQuZ2V0RmlndXJlKCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzMpIHsKICAgICAgICB0aGF0LmdldEludmVzdGlnYXRpb24oKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA2OCkgewogICAgICAgIHRoYXQuZ2V0RGlhZ25vc2lzKCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzIpIHsKICAgICAgICB0aGF0LmdldEZhbWlseUhpc3RvcnkoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4MCkgewogICAgICAgIHRoYXQuZ2V0UGFzdEhpc3RvcnkoKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4NCkgewogICAgICAgIHRoYXQuZ2V0VHJlYXRtZW50KCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNjUpIHsKICAgICAgICB0aGF0LmdldEFkdmljZSgpOwogICAgICB9IC8vIGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLnNoaWZ0S2V5KSB7CiAgICAgIC8vIH0KCiAgICB9OwoKICAgIHZhciBwcmVzY3JpcHRpb25EYXRhID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJlc2NyaXB0aW9uRGF0YScpKTsKCiAgICBpZiAocHJlc2NyaXB0aW9uRGF0YSkgewogICAgICB0aGlzLnByZXNjcmlwdGlvbihwcmVzY3JpcHRpb25EYXRhKTsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3ByZXNjcmlwdGlvbkRhdGEnKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudCA9IHsKICAgICAgICBjZGZyb21kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZHRvZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgLy8gY2R0b2RhdGU6IG1vbWVudCgKICAgICAgICAvLyAgIFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpCiAgICAgICAgLy8gKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBhcHBvaW5tZW50X3N0YXR1czogIkFjdGl2ZSIKICAgICAgfTsgLy8gdGhpcy5kYXRhTGlzdCA9IHRydWU7CiAgICAgIC8vIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CgogICAgICB0aGlzLnNob3coKTsKICAgIH0sCiAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy5kb2N0b3JBcHBvaW50bWVudC5jZGZyb21kYXRlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmRvY3RvckFwcG9pbnRtZW50LmNkdG9kYXRlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLmRvY3RvckFwcG9pbnRtZW50LmFwcG9pbm1lbnRfc3RhdHVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuZnJvbWRhdGUgPSBtb21lbnQoU3RyaW5nKHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuY2Rmcm9tZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwogICAgICAgIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQudG9kYXRlID0gbW9tZW50KFN0cmluZyh0aGlzLmRvY3RvckFwcG9pbnRtZW50LmNkdG9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudFNlcnZpY2UuZ2V0RHluYW1pY0RvY3Rvcldpc2UodGhpcy5kb2N0b3JBcHBvaW50bWVudC5mcm9tZGF0ZSwgdGhpcy5kb2N0b3JBcHBvaW50bWVudC50b2RhdGUsIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuYXBwb2lubWVudF9zdGF0dXMsIHRoaXMudXNlckluZm8uZG9jdG9yX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMyLmRvY3RvckFwcG9pbnRtZW50TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgICB9KTsgLy9UZXN0CiAgICAgICAgLy8gdGhpcy5kb2N0b3JBcHBvaW50bWVudFNlcnZpY2UKICAgICAgICAvLyAgIC5nZXREeW5hbWljRG9jdG9yV2lzZSgKICAgICAgICAvLyAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudC5mcm9tZGF0ZSwKICAgICAgICAvLyAgICAgdGhpcy5kb2N0b3JBcHBvaW50bWVudC50b2RhdGUsCiAgICAgICAgLy8gICAgIHRoaXMuZG9jdG9yQXBwb2ludG1lbnQuYXBwb2lubWVudF9zdGF0dXMsCiAgICAgICAgLy8gICAgIHRoaXMudXNlckluZm8uZG9jdG9yX2lkCiAgICAgICAgLy8gICApCiAgICAgICAgLy8gICAudGhlbigoZGF0YSkgPT4gdGhpcy5wcmVzY3JpcHRpb24oZGF0YS5kYXRhKSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZGF0YUxpc3QgPSB0cnVlOwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfSwKICAgIHByZXNjcmlwdGlvbjogZnVuY3Rpb24gcHJlc2NyaXB0aW9uKGRhdGEpIHsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8uYXBwb2lubWVudF9pZCA9IGRhdGEuYXBwb2lubWVudF9pZDsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8ucGF0aWVudFJlZyA9IGRhdGEuYVBhdGllbnQucmVnaXN0cmF0aW9uX25vOwogICAgICB0aGlzLmFwcG9pbnRtZW50SW5mby5wYXRpZW50TmFtZSA9IGRhdGEuYVBhdGllbnQuZmlyc3RfbmFtZSArICIgIiArIGRhdGEuYVBhdGllbnQubGFzdF9uYW1lOwogICAgICB0aGlzLmFwcG9pbnRtZW50SW5mby5wYXRpZW50R2VuZGVyID0gZGF0YS5hUGF0aWVudC5nZW5kZXI7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRJbmZvLnBhdGllbnRBZ2VZZWFyID0gZGF0YS5hUGF0aWVudC5hZ2VfeWVhcjsKICAgICAgdGhpcy5hcHBvaW50bWVudEluZm8ucGF0aWVudEFnZU1vbnRoID0gZGF0YS5hUGF0aWVudC5hZ2VfbW9udGg7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRJbmZvLnBhdGllbnRBZ2VEYXkgPSBkYXRhLmFQYXRpZW50LmFnZV9kYXk7IC8vIHZhciBwYXRpZW50RE9CID0gbW9tZW50KFN0cmluZyhkYXRhLmFQYXRpZW50LmRvYikpLmZvcm1hdCgKICAgICAgLy8gICAiTU0vREQvWVlZWSIKICAgICAgLy8gKTsKICAgICAgLy90aGlzLmFwcG9pbnRtZW50SW5mby5hZ2UgPSBNYXRoLmZsb29yKG1vbWVudChuZXcgRGF0ZSgpKS5kaWZmKG1vbWVudChwYXRpZW50RE9CLCAiTU0vREQvWVlZWSIpLCAneWVhcnMnLCB0cnVlKSk7CiAgICAgIC8vdGhpcy5hcHBvaW50bWVudEluZm8uYWdlID0gbW9tZW50KHBhdGllbnRET0IsICJNTS9ERC9ZWVlZIikuZnJvbU5vdygpLnNwbGl0KCIgIilbMF07CgogICAgICB0aGlzLmRhdGFMaXN0ID0gZmFsc2U7CiAgICB9LAogICAgcHJldmlvdXNQcmVzY3JpcHRpb246IGZ1bmN0aW9uIHByZXZpb3VzUHJlc2NyaXB0aW9uKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZS5nZXRQYXRpZW50V2lzZVByZXNjcmlwdGlvbkxpc3QocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMucHJldlByZXNjcmlwdGlvbkxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnByZXZQcmVzY3JpcHRpb25EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGRvd25sb2FkUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBkb3dubG9hZFByZXNjcmlwdGlvbihhcHBvaW5tZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy5wcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlLkdldFBlc2NyaXB0aW9uKGFwcG9pbm1lbnRfaWQsIHRoaXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LmNvbW1vblNlcnZpY2UuRG93bmxvYWRmaWxlKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgfSwKICAgIGZvcm1hdERhdGU6IGZ1bmN0aW9uIGZvcm1hdERhdGUodmFsdWUpIHsKICAgICAgcmV0dXJuIG1vbWVudChTdHJpbmcodmFsdWUpKS5mb3JtYXQoIk1NL0REL1lZWVkgaDptbTpzcyBhIik7CiAgICB9LAogICAgY2hlY2tEYXRlOiBmdW5jdGlvbiBjaGVja0RhdGUoZGF0ZSkgewogICAgICB2YXIgdG9kYXkgPSBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKTsKICAgICAgdmFyIGFwcHREYXRlID0gbW9tZW50KFN0cmluZyhkYXRlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CgogICAgICBpZiAodG9kYXkgPT0gYXBwdERhdGUpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICAvLwogICAgZ2V0UGF0aWVudENvbXBsYWludHM6IGZ1bmN0aW9uIGdldFBhdGllbnRDb21wbGFpbnRzKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJQYXRpZW50IENvbXBsYWludHMiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdENvbXBsYWludC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXM1LnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5jb21waWxhbnRzX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5jb21waWxhbnRzX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldE9uRXhhbWluYXRpb25zUG9wdXA6IGZ1bmN0aW9uIGdldE9uRXhhbWluYXRpb25zUG9wdXAoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdGhpcy5wb3B1cE9uRXhhbWluYXRpb25zRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdE9uRXhhbWluYXRpb24uZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzNi5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQub25fZXhhbWluYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX2lkLAogICAgICAgICAgb25fZXhhbWluYXRpb25fcmVzdWx0OiAxCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25Qb3B1cERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZ2V0T25FeGFtaW5hdGlvbnM6IGZ1bmN0aW9uIGdldE9uRXhhbWluYXRpb25zKCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIC8vdGhpcy5nZXRPbkV4YW1pbmF0aW9uc1BvcHVwKCk7CiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJPbiBFeGFtaW5hdGlvbnMiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdE9uRXhhbWluYXRpb24uZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzNy50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQub25fZXhhbWluYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50Lm9uX2V4YW1pbmF0aW9uX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEZpZ3VyZTogZnVuY3Rpb24gZ2V0RmlndXJlKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJGaWd1cmUiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdEZpZ3VyZVNldHVwLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczgudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50LmZpZ3VyZV9uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuZmlndXJlX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEludmVzdGlnYXRpb246IGZ1bmN0aW9uIGdldEludmVzdGlnYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIkludmVzdGlnYXRpb24iOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdEludmVzdGlnYXRpb24uZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzOS50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuaW52ZXN0aW5nYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmludmVzdGlnYXRpb25faWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0RGlhZ25vc2lzOiBmdW5jdGlvbiBnZXREaWFnbm9zaXMoKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJEaWFnbm9zaXMiOwogICAgICB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdERpYWdub3Npcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxMC50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuZGlhZ25vc2lzX25hbWUsCiAgICAgICAgICBpZDogZWxlbWVudC5kaWFnbm9zaXNfaWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0RmFtaWx5SGlzdG9yeTogZnVuY3Rpb24gZ2V0RmFtaWx5SGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIkZhbWlseSBIaXN0b3J5IjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3REaWFnbm9zaXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzMTEudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50LmRpYWdub3Npc19uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuZGlhZ25vc2lzX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFBhc3RIaXN0b3J5OiBmdW5jdGlvbiBnZXRQYXN0SGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIlBhc3QgSGlzdG9yeSI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0RGlhZ25vc2lzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczEyLnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5kaWFnbm9zaXNfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmRpYWdub3Npc19pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRUcmVhdG1lbnQ6IGZ1bmN0aW9uIGdldFRyZWF0bWVudCgpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIk1lZGljaW5lIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RUcmVhdG1lbnQuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzMTMudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBfbWVkaWNpbmVfdHlwZV9uYW1lOiBlbGVtZW50Ll9tZWRpY2luZV90eXBlX25hbWUsCiAgICAgICAgICBfbWVkaWNpbmVfbmFtZTogZWxlbWVudC5fbWVkaWNpbmVfbmFtZSwKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuX21lZGljaW5lX3R5cGVfbmFtZSArICIgIiArIGVsZW1lbnQuX21lZGljaW5lX25hbWUgKyAiICIgKyBlbGVtZW50Ll90cmVhdG1lbnRfZG9zZV9uYW1lICsgIiAiICsgZWxlbWVudC5fdHJlYXRtZW50X3J1bGVfbmFtZSArICIgIiArIGVsZW1lbnQuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQubWVkaWNpbmVfaWQsCiAgICAgICAgICBfdHJlYXRtZW50X2Rvc2VfbmFtZTogZWxlbWVudC5fdHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgICAgIHRyZWF0bWVudF9kb3NlX2lkOiBlbGVtZW50LnRyZWF0bWVudF9kb3NlX2lkLAogICAgICAgICAgX3RyZWF0bWVudF9ydWxlX25hbWU6IGVsZW1lbnQuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IGVsZW1lbnQudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAgICAgX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lOiBlbGVtZW50Ll90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogZWxlbWVudC50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgICAgICBkZXNjcmlwdGlvbjogZWxlbWVudC5kZXNjcmlwdGlvbgogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRBZHZpY2U6IGZ1bmN0aW9uIGdldEFkdmljZSgpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIkFkdmljZSI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IHRydWU7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RBZHZpY2VzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczE0LnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5hZHZpY2VfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmFkdmljZV9pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBhZGRPbkV4YW1pbmF0aW9uRnJvbVBvcHVwOiBmdW5jdGlvbiBhZGRPbkV4YW1pbmF0aW9uRnJvbVBvcHVwKCkgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CgogICAgICAvL3RoaXMuc3VibWl0dGVkID0gdHJ1ZTsKICAgICAgLy90aGlzLnJlcXVyZWQgPSAiIjsKICAgICAgdGhpcy5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgaWYgKGVsZW1lbnQub25fZXhhbWluYXRpb25fcmVzdWx0KSB7CiAgICAgICAgICAvL3RoaXMucmVxdXJlZCA9ICJyZXF1aXJlZCI7CiAgICAgICAgICB2YXIgYU9uRXhhbWluYXRpb25zID0gX3RoaXMxNS5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uT25FeGFtaW5hdGlvbi5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgIHJldHVybiBlbC5vbl9leGFtaW5hdGlvbl9pZCA9PT0gZWxlbWVudC5pZDsKICAgICAgICAgIH0sIF90aGlzMTUpOwoKICAgICAgICAgIGlmICghYU9uRXhhbWluYXRpb25zLmxlbmd0aCkgewogICAgICAgICAgICBfdGhpczE1LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25PbkV4YW1pbmF0aW9uLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGVsZW1lbnQubmFtZSwKICAgICAgICAgICAgICBvbl9leGFtaW5hdGlvbl9pZDogZWxlbWVudC5pZCwKICAgICAgICAgICAgICBvbl9leGFtaW5hdGlvbl9yZXN1bHQ6IGVsZW1lbnQub25fZXhhbWluYXRpb25fcmVzdWx0LnRvU3RyaW5nKCkKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsgLy8gaWYgKHRoaXMucmVxdXJlZCkgewogICAgICAvLyAgIHRoaXMuJHRvYXN0LmFkZCh7CiAgICAgIC8vICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgLy8gICAgIHN1bW1hcnk6ICJSZXF1aXJlZCIsCiAgICAgIC8vICAgICBkZXRhaWw6ICJQbGVhc2UgZmlsbCBpbiB0aGUgcmVxdWlyZWQgZmllbGRzIiwKICAgICAgLy8gICAgIGxpZmU6IDEwMDAwLAogICAgICAvLyAgIH0pOwogICAgICAvLyAgIHJldHVybjsKICAgICAgLy8gfQoKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uUG9wdXBEaWFsb2cgPSBmYWxzZTsKICAgIH0sCiAgICAvLyBhZGQgYWxsIGFkdmljZSBjaGVja2JveAogICAgYWRkQWxsQWR2aWNlOiBmdW5jdGlvbiBhZGRBbGxBZHZpY2UoKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5hbGxBZHZpY2UpIHsKICAgICAgICB0aGlzLnRlbXBEYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgIHZhciBhQWR2aWNlID0gX3RoaXMxNi5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgcmV0dXJuIGVsLmFkdmljZV9pZCA9PT0gZWxlbWVudC5pZDsKICAgICAgICAgIH0sIF90aGlzMTYpOwoKICAgICAgICAgIGlmICghYUFkdmljZS5sZW5ndGgpIHsKICAgICAgICAgICAgX3RoaXMxNi5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGVsZW1lbnQubmFtZSwKICAgICAgICAgICAgICBhZHZpY2VfaWQ6IGVsZW1lbnQuaWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBhZGQgdmFsdWUgCiAgICBnZXRWYWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWUoZGF0YSkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJQYXRpZW50IENvbXBsYWludHMiKSB7CiAgICAgICAgdmFyIGFDb21wbGlhbnRzID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQ29tcGxpYW50cy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuY29tcGlsYW50c19pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhQ29tcGxpYW50cy5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkNvbXBsaWFudHMucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgY29tcGlsYW50c19pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiT24gRXhhbWluYXRpb25zIikgewogICAgICAgIHZhciBhT25FeGFtaW5hdGlvbnMgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25PbkV4YW1pbmF0aW9uLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5vbl9leGFtaW5hdGlvbl9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhT25FeGFtaW5hdGlvbnMubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLm9uRXhhbWluYXRpb24ubGFiZWwgPSBkYXRhLm5hbWU7CiAgICAgICAgICB0aGlzLm9uRXhhbWluYXRpb24ub25fZXhhbWluYXRpb25faWQgPSBkYXRhLmlkOwogICAgICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdCA9IDE7CiAgICAgICAgICB0aGlzLm9uRXhhbWluYXRpb25EaWFsb2cgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIkZpZ3VyZSIpIHsKICAgICAgICB2YXIgYUZpZ3VyZSA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZpZ3VyZS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuZmlndXJlX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFGaWd1cmUubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmZpZ3VyZURpYWxvZyA9IHRydWU7CiAgICAgICAgICB0aGlzLmZpZ3VyZS5uYW1lID0gZGF0YS5uYW1lOwogICAgICAgICAgdGhpcy5maWd1cmUuZmlndXJlX2lkID0gZGF0YS5pZDsKICAgICAgICAgIHRoaXMuZmlndXJlU2V0dXBTZXJ2aWNlLmdldEJ5SWQoZGF0YS5pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMxNy5nZXRGaWd1cmVGb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIkludmVzdGlnYXRpb24iKSB7CiAgICAgICAgdmFyIGFJbnZlc3RpZ2F0aW9uID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbi5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuaW52ZXN0aWdhdGlvbl9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhSW52ZXN0aWdhdGlvbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkludmVzdGlnYXRpb24ucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgaW52ZXN0aWdhdGlvbl9pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiRGlhZ25vc2lzIikgewogICAgICAgIHZhciBhRGlhZ25vc2lzID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRGlhZ25vc2lzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5kaWFnbm9zaXNfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYURpYWdub3Npcy5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkRpYWdub3Npcy5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICBkaWFnbm9zaXNfaWQ6IGRhdGEuaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIkZhbWlseSBIaXN0b3J5IikgewogICAgICAgIHZhciBhRmFtaWx5SGlzdG9yeSA9IHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZhbWlseUhpc3RvcnkuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmRpYWdub3Npc19pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhRmFtaWx5SGlzdG9yeS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuZmFtaWx5SGlzdG9yeS5kaWFnbm9zaXNfaWQgPSBkYXRhLmlkOwogICAgICAgICAgdGhpcy5mYW1pbHlIaXN0b3J5Lm5hbWUgPSBkYXRhLm5hbWU7CiAgICAgICAgICB0aGlzLmZhbWlseUhpc3RvcnlEaWFsb2cgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIlBhc3QgSGlzdG9yeSIpIHsKICAgICAgICB2YXIgYVBhc3RIaXN0b3J5ID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uUGFzdEhpc3RvcnkuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmRpYWdub3Npc19pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhUGFzdEhpc3RvcnkubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25QYXN0SGlzdG9yeS5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICBkaWFnbm9zaXNfaWQ6IGRhdGEuaWQKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5zaG93SW5QcmVzY3JpcHRpb24odGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uUGFzdEhpc3RvcnksICF0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLnBhc3RIaXN0b3J5X3Nob3dfaW5fcHJlc2NyaXB0aW9uKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJNZWRpY2luZSIpIHsKICAgICAgICB2YXIgYU1lZGljaW5lID0gdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5tZWRpY2luZV9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhTWVkaWNpbmUubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnQucHVzaCh7CiAgICAgICAgICAgIF9tZWRpY2luZV90eXBlX25hbWU6IGRhdGEuX21lZGljaW5lX3R5cGVfbmFtZSwKICAgICAgICAgICAgbmFtZTogZGF0YS5fbWVkaWNpbmVfbmFtZSwKICAgICAgICAgICAgbWVkaWNpbmVfaWQ6IGRhdGEuaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZG9zZV9uYW1lOiBkYXRhLl90cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAgICAgICB0cmVhdG1lbnRfZG9zZV9pZDogZGF0YS50cmVhdG1lbnRfZG9zZV9pZCwKICAgICAgICAgICAgX3RyZWF0bWVudF9ydWxlX25hbWU6IGRhdGEuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9ydWxlc19pZDogZGF0YS50cmVhdG1lbnRfcnVsZXNfaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZHVyYXRpb25fbmFtZTogZGF0YS5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogZGF0YS50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJBZHZpY2UiKSB7CiAgICAgICAgdmFyIGFBZHZpY2UgPSB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25BZHZpY2UuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmFkdmljZV9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhQWR2aWNlLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlLnB1c2goewogICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgICAgIGFkdmljZV9pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaGlkZURpYWxvZzogZnVuY3Rpb24gaGlkZURpYWxvZygpIHsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvblBvcHVwRGlhbG9nID0gZmFsc2U7IC8vdGhpcy5lZGl0T25FeGFtaW5hdGlvbkRpYWxvZyA9IGZhbHNlOwoKICAgICAgdGhpcy5maWd1cmVEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5mYW1pbHlIaXN0b3J5RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMucHJldlByZXNjcmlwdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfSwKICAgIGFkZE9uRXhhbWluYXRpb246IGZ1bmN0aW9uIGFkZE9uRXhhbWluYXRpb24oKSB7CiAgICAgIGlmICghdGhpcy5pc0VkaXQpIHsKICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgIGlmICghdGhpcy5vbkV4YW1pbmF0aW9uLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25PbkV4YW1pbmF0aW9uLnB1c2goewogICAgICAgICAgICBuYW1lOiB0aGlzLm9uRXhhbWluYXRpb24ubGFiZWwsCiAgICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX2lkOiB0aGlzLm9uRXhhbWluYXRpb24ub25fZXhhbWluYXRpb25faWQsCiAgICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX3Jlc3VsdDogdGhpcy5vbkV4YW1pbmF0aW9uLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdC50b1N0cmluZygpCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgICAgICB0aGlzLm9uRXhhbWluYXRpb25EaWFsb2cgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0VkaXQpIHsKICAgICAgICB0aGlzLm9uRXhhbWluYXRpb25FZGl0U2F2ZSgpOwogICAgICAgIHRoaXMuaXNFZGl0ID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBnZXRGaWd1cmVGb3JtYXR0ZWQ6IGZ1bmN0aW9uIGdldEZpZ3VyZUZvcm1hdHRlZChkYXRhKSB7CiAgICAgIHRoaXMuZmlndXJlLmZpZ3VyZV9pbWFnZSA9ICJkYXRhOmltYWdlL2pwZztiYXNlNjQsIiArIGRhdGEuZmlndXJlX2ltYWdlOyAvLyBjYW52YXMKCiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLmNhbnZhcyA9IHZtLiRyZWZzLmNhbnZhczsKICAgICAgdm0uY29udGV4dCA9IHZtLmNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICB2bS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgdm0ubW91c2Vkb3duKTsKICAgICAgdm0uY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIHZtLm1vdXNlbW92ZSk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNldXAiLCB2bS5tb3VzZXVwKTsKICAgICAgdm0uaW1nID0gbmV3IEltYWdlKCk7CgogICAgICB2bS5pbWcub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZtLmNvbnRleHQuZHJhd0ltYWdlKHZtLmltZywgMCwgMCwgMzAwLCAyMDApOyAvLyBPciBhdCB3aGF0ZXZlciBvZmZzZXQgeW91IGxpa2UgYW5kIHNldCBoZWlnaHQsIHdpZHRoCiAgICAgIH07CgogICAgICB2bS5pbWcuc3JjID0gdGhpcy5maWd1cmUuZmlndXJlX2ltYWdlOwogICAgfSwKICAgIC8vIGNhbnZhcwogICAgbW91c2Vkb3duOiBmdW5jdGlvbiBtb3VzZWRvd24oZSkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2YXIgcmVjdCA9IHZtLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgdmFyIHggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7CiAgICAgIHZhciB5ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7CiAgICAgIHZtLmlzRHJhd2luZyA9IHRydWU7CiAgICAgIHZtLnN0YXJ0WCA9IHg7CiAgICAgIHZtLnN0YXJ0WSA9IHk7CiAgICAgIHZtLnBvaW50cy5wdXNoKHsKICAgICAgICB4OiB4LAogICAgICAgIHk6IHkKICAgICAgfSk7CiAgICB9LAogICAgbW91c2Vtb3ZlOiBmdW5jdGlvbiBtb3VzZW1vdmUoZSkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2YXIgcmVjdCA9IHZtLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgdmFyIHggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7CiAgICAgIHZhciB5ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7CgogICAgICBpZiAodm0uaXNEcmF3aW5nKSB7CiAgICAgICAgdm0uY29udGV4dC5iZWdpblBhdGgoKTsKICAgICAgICB2bS5jb250ZXh0Lm1vdmVUbyh2bS5zdGFydFgsIHZtLnN0YXJ0WSk7CiAgICAgICAgdm0uY29udGV4dC5saW5lVG8oeCwgeSk7CiAgICAgICAgdm0uY29udGV4dC5saW5lV2lkdGggPSAxOwogICAgICAgIHZtLmNvbnRleHQubGluZUNhcCA9ICJyb3VuZCI7CiAgICAgICAgdm0uY29udGV4dC5zdHJva2VTdHlsZSA9ICJyZ2JhKDAsMCwwLDEpIjsKICAgICAgICB2bS5jb250ZXh0LnN0cm9rZSgpOwogICAgICAgIHZtLnN0YXJ0WCA9IHg7CiAgICAgICAgdm0uc3RhcnRZID0geTsKICAgICAgICB2bS5wb2ludHMucHVzaCh7CiAgICAgICAgICB4OiB4LAogICAgICAgICAgeTogeQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgbW91c2V1cDogZnVuY3Rpb24gbW91c2V1cCgpIHsKICAgICAgdmFyIHZtID0gdGhpczsKICAgICAgdm0uaXNEcmF3aW5nID0gZmFsc2U7CgogICAgICBpZiAodm0ucG9pbnRzLmxlbmd0aCA+IDApIHsKICAgICAgICBsb2NhbFN0b3JhZ2VbInBvaW50cyJdID0gSlNPTi5zdHJpbmdpZnkodm0ucG9pbnRzKTsKICAgICAgfQogICAgfSwKICAgIHJlc2V0Q2FudmFzOiBmdW5jdGlvbiByZXNldENhbnZhcygpIHsKICAgICAgLy8gdmFyIHZtID0gdGhpczsKICAgICAgLy8gdm0uY2FudmFzLndpZHRoID0gdm0uY2FudmFzLndpZHRoOwogICAgICAvLyB2bS5wb2ludHMubGVuZ3RoID0gMDsgLy8gcmVzZXQgcG9pbnRzIGFycmF5CiAgICAgIHZhciB2bSA9IHRoaXM7CiAgICAgIHZtLmNhbnZhcyA9IHZtLiRyZWZzLmNhbnZhczsKICAgICAgdm0uY29udGV4dCA9IHZtLmNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICB2bS5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgdm0ubW91c2Vkb3duKTsKICAgICAgdm0uY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIHZtLm1vdXNlbW92ZSk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNldXAiLCB2bS5tb3VzZXVwKTsKICAgICAgdm0uaW1nID0gbmV3IEltYWdlKCk7CgogICAgICB2bS5pbWcub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZtLmNvbnRleHQuZHJhd0ltYWdlKHZtLmltZywgMCwgMCwgMzAwLCAyMDApOyAvLyBPciBhdCB3aGF0ZXZlciBvZmZzZXQgeW91IGxpa2UgYW5kIHNldCBoZWlnaHQsIHdpZHRoCiAgICAgIH07CgogICAgICB2bS5pbWcuc3JjID0gdGhpcy5maWd1cmUuZmlndXJlX2ltYWdlOwogICAgICB2bS5jYW52YXMud2lkdGggPSB0aGlzLmNhbnZhcy53aWR0aDsKICAgICAgdm0ucG9pbnRzLmxlbmd0aCA9IDA7IC8vIHJlc2V0IHBvaW50cyBhcnJheQogICAgfSwKICAgIC8vIHNhdmVJbWFnZSgpIHsKICAgIC8vICAgdmFyIHZtID0gdGhpczsKICAgIC8vICAgdmFyIGRhdGFVUkwgPSB2bS5jYW52YXMudG9EYXRhVVJMKCk7CiAgICAvLyAgIHZhciBpbWcgPSB2bS4kcmVmcy5pbWc7CiAgICAvLyAgIGltZy5zcmMgPSBkYXRhVVJMOwogICAgLy8gfSwKICAgIC8vCiAgICBhZGRGaWd1cmU6IGZ1bmN0aW9uIGFkZEZpZ3VyZSgpIHsKICAgICAgdmFyIGRhdGFVUkwgPSB0aGlzLmNhbnZhcy50b0RhdGFVUkwoKTsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmlndXJlLnB1c2goewogICAgICAgIG5hbWU6IHRoaXMuZmlndXJlLm5hbWUsCiAgICAgICAgZmlndXJlX2lkOiB0aGlzLmZpZ3VyZS5maWd1cmVfaWQsCiAgICAgICAgZmlndXJlX2ltYWdlOiBkYXRhVVJMLnNwbGl0KCIsIilbMV0KICAgICAgfSk7CiAgICAgIHRoaXMuZmlndXJlRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuc2hvd0luUHJlc2NyaXB0aW9uKHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbkZpZ3VyZSwgIXRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uZmlndXJlX3Nob3dfaW5fcHJlc2NyaXB0aW9uKTsKICAgIH0sCiAgICBhZGRGYW1pbHlIaXN0b3J5OiBmdW5jdGlvbiBhZGRGYW1pbHlIaXN0b3J5KCkgewogICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICBpZiAoIXRoaXMuZmFtaWx5SGlzdG9yeS5yZWxhdGl2ZV9yYWxhdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GYW1pbHlIaXN0b3J5LnB1c2goewogICAgICAgICAgZGlhZ25vc2lzX2lkOiB0aGlzLmZhbWlseUhpc3RvcnkuZGlhZ25vc2lzX2lkLAogICAgICAgICAgbmFtZTogdGhpcy5mYW1pbHlIaXN0b3J5Lm5hbWUsCiAgICAgICAgICByZWxhdGl2ZV9yYWxhdGlvbjogdGhpcy5mYW1pbHlIaXN0b3J5LnJlbGF0aXZlX3JhbGF0aW9uCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgICB0aGlzLmZhbWlseUhpc3RvcnlEaWFsb2cgPSBmYWxzZTsKICAgICAgICB0aGlzLnNob3dJblByZXNjcmlwdGlvbih0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GYW1pbHlIaXN0b3J5LCAhdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5mYW1pbHlIaXN0b3J5X3Nob3dfaW5fcHJlc2NyaXB0aW9uKTsKICAgICAgfQogICAgfSwKICAgIGVkaXRUcmVhdG1lbnQ6IGZ1bmN0aW9uIGVkaXRUcmVhdG1lbnQoZGF0YSwgaW5kZXgpIHsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5tZWRpY2luZU5hbWUgPSBkYXRhLm5hbWU7IC8vIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUgPSB7CiAgICAgIC8vICAgdGV4dDogZGF0YS5uYW1lLAogICAgICAvLyAgIHZhbHVlOiBkYXRhLm1lZGljaW5lX2lkLAogICAgICAvLyAgIHJlZmlkOiBudWxsLAogICAgICAvLyB9OwoKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMgPSB7CiAgICAgICAgdGV4dDogZGF0YS5fdHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgICB2YWx1ZTogZGF0YS50cmVhdG1lbnRfcnVsZXNfaWQsCiAgICAgICAgcmVmaWQ6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24gPSB7CiAgICAgICAgdGV4dDogZGF0YS5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X2R1cmF0aW9uX2lkLAogICAgICAgIHJlZmlkOiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UgPSB7CiAgICAgICAgdGV4dDogZGF0YS5fdHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgICB2YWx1ZTogZGF0YS50cmVhdG1lbnRfZG9zZV9pZCwKICAgICAgICByZWZpZDogbnVsbAogICAgICB9OwogICAgICB0aGlzLnRyZWF0bWVudERpYWxvZyA9IHRydWU7CiAgICAgIHRoaXMudHJlYXRtZW50SW5kZXggPSBpbmRleDsKICAgIH0sCiAgICB0cmVhdG1lbnRFZGl0U2F2ZTogZnVuY3Rpb24gdHJlYXRtZW50RWRpdFNhdmUoKSB7CiAgICAgIC8vdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLm5hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnRleHQ7CiAgICAgIC8vdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLm1lZGljaW5lX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS52YWx1ZTsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfcnVsZV9uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudGV4dDsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLnRyZWF0bWVudF9ydWxlc19pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnZhbHVlOwogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0uX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udGV4dDsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLnRyZWF0bWVudF9kdXJhdGlvbl9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnZhbHVlOwogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0uX3RyZWF0bWVudF9kb3NlX25hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnRleHQ7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS50cmVhdG1lbnRfZG9zZV9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudmFsdWU7CiAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gZmFsc2U7CiAgICB9LAogICAgZWRpdE9uRXhhbWluYXRpb246IGZ1bmN0aW9uIGVkaXRPbkV4YW1pbmF0aW9uKGRhdGEsIGluZGV4KSB7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbi5sYWJlbCA9IGRhdGEubmFtZTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdCA9IGRhdGEub25fZXhhbWluYXRpb25fcmVzdWx0OyAvL3RoaXMuZWRpdE9uRXhhbWluYXRpb25EaWFsb2cgPSB0cnVlOwoKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gdHJ1ZTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uSW5kZXggPSBpbmRleDsKICAgICAgdGhpcy5pc0VkaXQgPSB0cnVlOwogICAgfSwKICAgIG9uRXhhbWluYXRpb25FZGl0U2F2ZTogZnVuY3Rpb24gb25FeGFtaW5hdGlvbkVkaXRTYXZlKCkgewogICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICBpZiAoIXRoaXMub25FeGFtaW5hdGlvbi5vbl9leGFtaW5hdGlvbl9yZXN1bHQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uT25FeGFtaW5hdGlvblt0aGlzLm9uRXhhbWluYXRpb25JbmRleF0ub25fZXhhbWluYXRpb25fcmVzdWx0ID0gdGhpcy5vbkV4YW1pbmF0aW9uLm9uX2V4YW1pbmF0aW9uX3Jlc3VsdC50b1N0cmluZygpOyAvL3RoaXMuZWRpdE9uRXhhbWluYXRpb25EaWFsb2cgPSBmYWxzZTsKCiAgICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7CiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGRlbGV0ZUl0ZW06IGZ1bmN0aW9uIGRlbGV0ZUl0ZW0obHN0LCBkYXRhKSB7CiAgICAgIGxzdC5zcGxpY2UobHN0LmZpbmRJbmRleChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpID09PSBkYXRhOwogICAgICB9KSwgMSk7CiAgICB9LAogICAgc2hvd0luUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBzaG93SW5QcmVzY3JpcHRpb24obHN0LCB2YWwpIHsKICAgICAgbHN0LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBlbGVtZW50LnNob3dfaW5fcHJlc2NyaXB0aW9uID0gIXZhbDsKICAgICAgfSk7CiAgICB9LAogICAgYWRkOiBmdW5jdGlvbiBhZGQoKSB7CiAgICAgIHZhciBfdGhpczE4ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5sc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQ29tcGxpYW50cy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMTguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQbGVhc2UgYWRkIFBhdGllbnQgQ29tcGxhaW50cyIsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24ubHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb24ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMxOC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogIlBsZWFzZSBhZGQgT24gRXhhbWluYXRpb24iLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBfdGhpczE4LmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uLmFwcG9pbm1lbnRfaWQgPSBfdGhpczE4LmFwcG9pbnRtZW50SW5mby5hcHBvaW5tZW50X2lkOwogICAgICAgICAgICAgICAgX3RoaXMxOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5wcmVzY3JpcHRpb25fZGF0ZSA9IG1vbWVudChTdHJpbmcoX3RoaXMxOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5jZHByZXNjcmlwdGlvbl9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uY2Rmb2xvd3VwX2RhdGUpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5mb2xvd3VwX2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24uY2Rmb2xvd3VwX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxOC5hcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UuYWRkKF90aGlzMTguYXBwb2ludG1lbnRQcmVzY3JpcHRpb24sIF90aGlzMTgpOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTguZG93bmxvYWRQcmVzY3JpcHRpb24oX3RoaXMxOC5hcHBvaW50bWVudFByZXNjcmlwdGlvbi5hcHBvaW5tZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQcmVzY3JpYmVkIFN1Y2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTgubmV3UHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE4LnJlc2V0KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIzOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjA7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICAgIF90aGlzMTguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzAsIDIwXV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdQcmVzY3JpcHRpb246IGZ1bmN0aW9uIG5ld1ByZXNjcmlwdGlvbigpIHsKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIlNlY3Rpb25zIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbiA9IHt9OwogICAgICB0aGlzLmZpZ3VyZSA9IHt9OwogICAgICB0aGlzLmZhbWlseUhpc3RvcnkgPSB7fTsKICAgICAgdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvbiA9IHsKICAgICAgICBjZHByZXNjcmlwdGlvbl9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBjZGZvbG93dXBfZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICBmaWd1cmVfc2hvd19pbl9wcmVzY3JpcHRpb246IHRydWUsCiAgICAgICAgZmFtaWx5SGlzdG9yeV9zaG93X2luX3ByZXNjcmlwdGlvbjogdHJ1ZSwKICAgICAgICBwYXN0SGlzdG9yeV9zaG93X2luX3ByZXNjcmlwdGlvbjogdHJ1ZSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQ29tcGxpYW50czogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvbk9uRXhhbWluYXRpb246IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25GaWd1cmU6IFtdLAogICAgICAgIGxzdEFwcG9pbm1lbnRQcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRGlhZ25vc2lzOiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uRmFtaWx5SGlzdG9yeTogW10sCiAgICAgICAgbHN0QXBwb2lubWVudFByZXNjcmlwdGlvblBhc3RIaXN0b3J5OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uVHJlYXRtZW50OiBbXSwKICAgICAgICBsc3RBcHBvaW5tZW50UHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9OwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfQogIH0KfTs="},{"version":3,"sources":["F:/SVN PROJECTS/DiagnosticCenterManagement_Client/trunk/src/scripts/doctor-panel/AppointmentPrescription.js"],"names":["CommonService","DoctorAppointmentService","FigureSetupService","AppointmentPrescriptionService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","PrescriptionReportService","moment","FilterMatchMode","FilterOperator","data","dataList","isAdvice","onExaminationDialog","onExaminationPopupDialog","figureDialog","familyHistoryDialog","treatmentDialog","prevPrescriptionDialog","appoinmentStatusList","patientsRelativeList","doctorAppointmentList","prescriptionDataList","prevPrescriptionList","headerName","tempData","appointmentInfo","onExamination","figure","familyHistory","treatmentSetup","doctorAppointment","cdfromdate","String","Date","format","cdtodate","appoinment_status","appointmentPrescription","cdprescription_date","cdfolowup_date","setDate","getDate","figure_show_in_prescription","familyHistory_show_in_prescription","pastHistory_show_in_prescription","allAdvice","lstAppoinmentPrescriptionCompliants","lstAppoinmentPrescriptionOnExamination","lstAppoinmentPrescriptionFigure","lstAppoinmentPrescriptionInvestigation","lstAppoinmentPrescriptionDiagnosis","lstAppoinmentPrescriptionFamilyHistory","lstAppoinmentPrescriptionPastHistory","lstAppoinmentPrescriptionTreatment","lstAppoinmentPrescriptionAdvice","treatmentRulesList","treatmentDurationList","treatmentDoseList","canvas","context","isDrawing","startX","startY","points","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","created","appointmentPrescriptionService","figureSetupService","doctorAppointmentService","commonService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","prescriptionReportService","userInfo","JSON","parse","localStorage","getItem","GetAllAppoinmentStatus","then","GetAllPatientsRelatives","getPrescriptionDataByDoctorId","doctor_id","getActiveCombo","show","newPrescription","that","document","onkeyup","e","ctrlKey","altKey","which","getPatientComplaints","getOnExaminationsPopup","getOnExaminations","getFigure","getInvestigation","getDiagnosis","getFamilyHistory","getPastHistory","getTreatment","getAdvice","prescriptionData","prescription","removeItem","methods","reset","fromdate","todate","getDynamicDoctorWise","appoinment_id","patientReg","aPatient","registration_no","patientName","first_name","last_name","patientGender","gender","patientAgeYear","age_year","patientAgeMonth","age_month","patientAgeDay","age_day","previousPrescription","patient_id","getPatientWisePrescriptionList","downloadPrescription","GetPescription","Downloadfile","formatDate","checkDate","date","today","apptDate","lstComplaint","forEach","element","push","compilants_name","id","compilants_id","popupOnExaminationsData","lstOnExamination","on_examination_name","on_examination_id","on_examination_result","lstFigureSetup","figure_name","figure_id","lstInvestigation","investingation_name","investigation_id","lstDiagnosis","diagnosis_name","diagnosis_id","lstTreatment","_medicine_type_name","_medicine_name","_treatment_dose_name","_treatment_rule_name","_treatment_duration_name","medicine_id","treatment_dose_id","treatment_rules_id","treatment_duration_id","description","lstAdvices","advice_name","advice_id","addOnExaminationFromPopup","aOnExaminations","filter","el","length","toString","addAllAdvice","aAdvice","getValue","aCompliants","label","aFigure","getById","getFigureFormatted","aInvestigation","aDiagnosis","aFamilyHistory","aPastHistory","showInPrescription","aMedicine","hideDialog","addOnExamination","isEdit","onExaminationEditSave","figure_image","vm","$refs","getContext","addEventListener","mousedown","mousemove","mouseup","img","Image","onload","drawImage","src","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","beginPath","moveTo","lineTo","lineWidth","lineCap","strokeStyle","stroke","stringify","resetCanvas","width","addFigure","dataURL","toDataURL","split","addFamilyHistory","relative_ralation","editTreatment","index","medicineName","ddltreatment_rules","text","refid","ddltreatment_duration","ddltreatment_dose","treatmentIndex","treatmentEditSave","editOnExamination","onExaminationIndex","deleteItem","lst","splice","findIndex","i","val","show_in_prescription","add","$toast","severity","summary","detail","life","prescription_date","folowup_date","result","status","res"],"mappings":"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","sourcesContent":["import CommonService from \"../../service/CommonService\";\r\nimport DoctorAppointmentService from \"../../service/front-desk/DoctorAppointmentService\";\r\nimport FigureSetupService from \"../../service/setup/FigureSetupService\";\r\nimport AppointmentPrescriptionService from \"../../service/doctor-panel/AppointmentPrescriptionService\";\r\n//import MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\nimport PrescriptionReportService from \"../../service/report/PrescriptionReportService\";\r\nimport moment from \"moment\";\r\nimport { FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      dataList: true,\r\n      isAdvice: false,\r\n      onExaminationDialog: false,\r\n      onExaminationPopupDialog: false,\r\n      //editOnExaminationDialog: false,\r\n      figureDialog: false,\r\n      familyHistoryDialog: false,\r\n      treatmentDialog: false,\r\n      prevPrescriptionDialog: false,\r\n      appoinmentStatusList: [],\r\n      patientsRelativeList: [],\r\n      doctorAppointmentList: [],\r\n      prescriptionDataList: [],\r\n      prevPrescriptionList: [],\r\n      headerName: \"Sections\",\r\n      tempData: [],\r\n      appointmentInfo: {},\r\n      onExamination: {},\r\n      figure: {},\r\n      familyHistory: {},\r\n      treatmentSetup: {},\r\n      doctorAppointment: {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdtodate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n        appoinment_status: \"Active\",\r\n      },\r\n\r\n      //Test\r\n      // doctorAppointment: {\r\n      //   cdfromdate: \"01/01/2021\",\r\n      //   cdtodate: \"01/01/2022\",\r\n      //   appoinment_status: \"All\",\r\n      // },\r\n\r\n      appointmentPrescription: {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        figure_show_in_prescription: true,\r\n        familyHistory_show_in_prescription: true,\r\n        pastHistory_show_in_prescription: true,\r\n        allAdvice: false,\r\n\r\n        lstAppoinmentPrescriptionCompliants: [],\r\n        lstAppoinmentPrescriptionOnExamination: [],\r\n        lstAppoinmentPrescriptionFigure: [],\r\n        lstAppoinmentPrescriptionInvestigation: [],\r\n        lstAppoinmentPrescriptionDiagnosis: [],\r\n        lstAppoinmentPrescriptionFamilyHistory: [],\r\n        lstAppoinmentPrescriptionPastHistory: [],\r\n        lstAppoinmentPrescriptionTreatment: [],\r\n        lstAppoinmentPrescriptionAdvice: [],\r\n      },\r\n      //medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n      // canvas\r\n      canvas: null,\r\n      context: null,\r\n      isDrawing: false,\r\n      startX: 0,\r\n      startY: 0,\r\n      points: [],\r\n      //\r\n      submitted: false,\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n    this.figureSetupService = new FigureSetupService();\r\n    this.doctorAppointmentService = new DoctorAppointmentService();\r\n    this.commonService = new CommonService();\r\n    //this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n    this.prescriptionReportService = new PrescriptionReportService();\r\n\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n\r\n    this.commonService\r\n      .GetAllAppoinmentStatus()\r\n      .then((data) => (this.appoinmentStatusList = data.data));\r\n\r\n    this.commonService\r\n      .GetAllPatientsRelatives()\r\n      .then((data) => (this.patientsRelativeList = data.data));\r\n\r\n    this.appointmentPrescriptionService\r\n      .getPrescriptionDataByDoctorId(this.userInfo.doctor_id)\r\n      .then((data) => (this.prescriptionDataList = data.data));\r\n\r\n    //\r\n    // this.medicineSetupService\r\n    //   .getActiveCombo()\r\n    //   .then((data) => (this.medicineList = data.data));\r\n\r\n    this.treatmentRulesSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n    this.treatmentDurationSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n    this.treatmentDoseSetupService\r\n      .getActiveCombo()\r\n      .then((data) => (this.treatmentDoseList = data.data));\r\n\r\n    this.show();\r\n    this.newPrescription();\r\n\r\n    let that = this;\r\n    document.onkeyup = function (e) {\r\n      if (e.ctrlKey && e.altKey && e.which == 67) {\r\n        that.getPatientComplaints();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 69) {\r\n        that.getOnExaminationsPopup();\r\n        that.getOnExaminations();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 70) {\r\n        that.getFigure();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 73) {\r\n        that.getInvestigation();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 68) {\r\n        that.getDiagnosis();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 72) {\r\n        that.getFamilyHistory();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 80) {\r\n        that.getPastHistory();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 84) {\r\n        that.getTreatment();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 65) {\r\n        that.getAdvice();\r\n      }\r\n      // else if (e.ctrlKey && e.altKey && e.shiftKey) {\r\n\r\n      // }\r\n    };\r\n\r\n    var prescriptionData = JSON.parse(localStorage.getItem('prescriptionData'));\r\n    if (prescriptionData) {\r\n      this.prescription(prescriptionData);\r\n      localStorage.removeItem('prescriptionData');\r\n    }\r\n  },\r\n  methods: {\r\n    reset() {\r\n      this.doctorAppointment = {\r\n        cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdtodate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        // cdtodate: moment(\r\n        //   String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        // ).format(\"MM/DD/YYYY\"),\r\n        appoinment_status: \"Active\",\r\n      };\r\n\r\n      // this.dataList = true;\r\n      // this.submitted = false;\r\n      this.show();\r\n    },\r\n    show() {\r\n      this.submitted = true;\r\n      if (!this.doctorAppointment.cdfromdate) {\r\n        return;\r\n      } else if (!this.doctorAppointment.cdtodate) {\r\n        return;\r\n      } else if (!this.doctorAppointment.appoinment_status) {\r\n        return;\r\n      } else {\r\n        this.doctorAppointment.fromdate = moment(\r\n          String(this.doctorAppointment.cdfromdate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.doctorAppointment.todate = moment(\r\n          String(this.doctorAppointment.cdtodate)\r\n        ).format(\"YYYY-MM-DD\");\r\n        this.doctorAppointmentService\r\n          .getDynamicDoctorWise(\r\n            this.doctorAppointment.fromdate,\r\n            this.doctorAppointment.todate,\r\n            this.doctorAppointment.appoinment_status,\r\n            this.userInfo.doctor_id\r\n          )\r\n          .then((data) => (this.doctorAppointmentList = data.data));\r\n\r\n        //Test\r\n        // this.doctorAppointmentService\r\n        //   .getDynamicDoctorWise(\r\n        //     this.doctorAppointment.fromdate,\r\n        //     this.doctorAppointment.todate,\r\n        //     this.doctorAppointment.appoinment_status,\r\n        //     this.userInfo.doctor_id\r\n        //   )\r\n        //   .then((data) => this.prescription(data.data));\r\n      }\r\n      this.dataList = true;\r\n      this.submitted = false;\r\n    },\r\n    prescription(data) {\r\n      this.appointmentInfo.appoinment_id = data.appoinment_id;\r\n      this.appointmentInfo.patientReg = data.aPatient.registration_no;\r\n      this.appointmentInfo.patientName =\r\n        data.aPatient.first_name + \" \" + data.aPatient.last_name;\r\n      this.appointmentInfo.patientGender = data.aPatient.gender;\r\n      this.appointmentInfo.patientAgeYear = data.aPatient.age_year;\r\n      this.appointmentInfo.patientAgeMonth = data.aPatient.age_month;\r\n      this.appointmentInfo.patientAgeDay = data.aPatient.age_day;\r\n\r\n      // var patientDOB = moment(String(data.aPatient.dob)).format(\r\n      //   \"MM/DD/YYYY\"\r\n      // );\r\n\r\n      //this.appointmentInfo.age = Math.floor(moment(new Date()).diff(moment(patientDOB, \"MM/DD/YYYY\"), 'years', true));\r\n      //this.appointmentInfo.age = moment(patientDOB, \"MM/DD/YYYY\").fromNow().split(\" \")[0];\r\n\r\n      this.dataList = false;\r\n    },\r\n    previousPrescription(patient_id) {\r\n      this.appointmentPrescriptionService\r\n        .getPatientWisePrescriptionList(patient_id)\r\n        .then((data) => (this.prevPrescriptionList = data.data));\r\n\r\n      this.prevPrescriptionDialog = true;\r\n    },\r\n    downloadPrescription(appoinment_id) {\r\n      this.prescriptionReportService.GetPescription(appoinment_id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n    checkDate(date){\r\n      var today = moment(String(new Date())).format(\"MM/DD/YYYY\");\r\n      var apptDate = moment(String(date)).format(\"MM/DD/YYYY\");\r\n      if(today == apptDate){\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    },\r\n\r\n    //\r\n    getPatientComplaints() {\r\n      this.headerName = \"Patient Complaints\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstComplaint.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.compilants_name,\r\n          id: element.compilants_id,\r\n        });\r\n      });\r\n    },\r\n    getOnExaminationsPopup() {\r\n      this.popupOnExaminationsData = [];\r\n      this.prescriptionDataList.lstOnExamination.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          name: element.on_examination_name,\r\n          id: element.on_examination_id,\r\n          on_examination_result: 1,\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n    getOnExaminations() {\r\n      //this.getOnExaminationsPopup();\r\n      this.headerName = \"On Examinations\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstOnExamination.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.on_examination_name,\r\n          id: element.on_examination_id,\r\n        });\r\n      });\r\n    },\r\n    getFigure() {\r\n      this.headerName = \"Figure\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstFigureSetup.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.figure_name,\r\n          id: element.figure_id,\r\n        });\r\n      });\r\n    },\r\n    getInvestigation() {\r\n      this.headerName = \"Investigation\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstInvestigation.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.investingation_name,\r\n          id: element.investigation_id,\r\n        });\r\n      });\r\n    },\r\n    getDiagnosis() {\r\n      this.headerName = \"Diagnosis\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getFamilyHistory() {\r\n      this.headerName = \"Family History\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getPastHistory() {\r\n      this.headerName = \"Past History\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstDiagnosis.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.diagnosis_name,\r\n          id: element.diagnosis_id,\r\n        });\r\n      });\r\n    },\r\n    getTreatment() {\r\n      this.headerName = \"Medicine\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstTreatment.forEach((element) => {\r\n        this.tempData.push({\r\n          _medicine_type_name: element._medicine_type_name,\r\n          _medicine_name: element._medicine_name,\r\n          name: element._medicine_type_name + \" \" + element._medicine_name + \" \" + element._treatment_dose_name + \" \" + element._treatment_rule_name + \" \" + element._treatment_duration_name,\r\n          id: element.medicine_id,\r\n          _treatment_dose_name: element._treatment_dose_name,\r\n          treatment_dose_id: element.treatment_dose_id,\r\n          _treatment_rule_name: element._treatment_rule_name,\r\n          treatment_rules_id: element.treatment_rules_id,\r\n          _treatment_duration_name: element._treatment_duration_name,\r\n          treatment_duration_id: element.treatment_duration_id,\r\n          description: element.description,\r\n        });\r\n      });\r\n    },\r\n    getAdvice() {\r\n      this.headerName = \"Advice\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = true;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstAdvices.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.advice_name,\r\n          id: element.advice_id,\r\n        });\r\n      });\r\n    },\r\n    addOnExaminationFromPopup() {\r\n      //this.submitted = true;\r\n      //this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (element.on_examination_result) {\r\n          //this.requred = \"required\";\r\n          var aOnExaminations =\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.filter(\r\n              function (el) {\r\n                return el.on_examination_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aOnExaminations.length) {\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.push({\r\n              name: element.name,\r\n              on_examination_id: element.id,\r\n              on_examination_result:\r\n                element.on_examination_result.toString(),\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      // if (this.requred) {\r\n      //   this.$toast.add({\r\n      //     severity: \"error\",\r\n      //     summary: \"Required\",\r\n      //     detail: \"Please fill in the required fields\",\r\n      //     life: 10000,\r\n      //   });\r\n      //   return;\r\n      // }\r\n\r\n      this.onExaminationPopupDialog = false;\r\n    },\r\n    // add all advice checkbox\r\n    addAllAdvice() {\r\n      if (!this.appointmentPrescription.allAdvice) {\r\n        this.tempData.forEach((element) => {\r\n          var aAdvice =\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.filter(\r\n              function (el) {\r\n                return el.advice_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aAdvice.length) {\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.push({\r\n              name: element.name,\r\n              advice_id: element.id,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // add value \r\n    getValue(data) {\r\n      if (this.headerName == \"Patient Complaints\") {\r\n        var aCompliants =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionCompliants.filter(\r\n            function (el) {\r\n              return el.compilants_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aCompliants.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionCompliants.push(\r\n            {\r\n              name: data.name,\r\n              compilants_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"On Examinations\") {\r\n        var aOnExaminations =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.filter(\r\n            function (el) {\r\n              return el.on_examination_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aOnExaminations.length) {\r\n          this.onExamination.label = data.name;\r\n          this.onExamination.on_examination_id = data.id;\r\n          this.onExamination.on_examination_result = 1;\r\n          this.onExaminationDialog = true;\r\n        }\r\n      } else if (this.headerName == \"Figure\") {\r\n        var aFigure =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFigure.filter(\r\n            function (el) {\r\n              return el.figure_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aFigure.length) {\r\n          this.figureDialog = true;\r\n          this.figure.name = data.name;\r\n          this.figure.figure_id = data.id;\r\n          this.figureSetupService\r\n            .getById(data.id)\r\n            .then((data) => this.getFigureFormatted(data.data));\r\n        }\r\n      } else if (this.headerName == \"Investigation\") {\r\n        var aInvestigation =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionInvestigation.filter(\r\n            function (el) {\r\n              return el.investigation_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aInvestigation.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionInvestigation.push(\r\n            {\r\n              name: data.name,\r\n              investigation_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Diagnosis\") {\r\n        var aDiagnosis =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionDiagnosis.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aDiagnosis.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionDiagnosis.push({\r\n            name: data.name,\r\n            diagnosis_id: data.id,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Family History\") {\r\n        var aFamilyHistory =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aFamilyHistory.length) {\r\n          this.familyHistory.diagnosis_id = data.id;\r\n          this.familyHistory.name = data.name;\r\n          this.familyHistoryDialog = true;\r\n        }\r\n      } else if (this.headerName == \"Past History\") {\r\n        var aPastHistory =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory.filter(\r\n            function (el) {\r\n              return el.diagnosis_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aPastHistory.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory.push(\r\n            {\r\n              name: data.name,\r\n              diagnosis_id: data.id,\r\n            }\r\n          );\r\n          this.showInPrescription(\r\n            this.appointmentPrescription.lstAppoinmentPrescriptionPastHistory,\r\n            !this.appointmentPrescription.pastHistory_show_in_prescription\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Medicine\") {\r\n        var aMedicine =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionTreatment.push({\r\n            _medicine_type_name: data._medicine_type_name,\r\n            name: data._medicine_name,\r\n            medicine_id: data.id,\r\n            _treatment_dose_name: data._treatment_dose_name,\r\n            treatment_dose_id: data.treatment_dose_id,\r\n            _treatment_rule_name: data._treatment_rule_name,\r\n            treatment_rules_id: data.treatment_rules_id,\r\n            _treatment_duration_name: data._treatment_duration_name,\r\n            treatment_duration_id: data.treatment_duration_id,\r\n            description: data.description,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Advice\") {\r\n        var aAdvice =\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.filter(\r\n            function (el) {\r\n              return el.advice_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aAdvice.length) {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionAdvice.push({\r\n            name: data.name,\r\n            advice_id: data.id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    hideDialog() {\r\n      this.onExaminationDialog = false;\r\n      this.onExaminationPopupDialog = false;\r\n      //this.editOnExaminationDialog = false;\r\n      this.figureDialog = false;\r\n      this.familyHistoryDialog = false;\r\n      this.treatmentDialog = false;\r\n      this.prevPrescriptionDialog = false;\r\n      this.submitted = false;\r\n    },\r\n    addOnExamination() {\r\n      if (!this.isEdit) {\r\n        this.submitted = true;\r\n        if (!this.onExamination.on_examination_result) {\r\n          return;\r\n        } else {\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination.push(\r\n            {\r\n              name: this.onExamination.label,\r\n              on_examination_id: this.onExamination.on_examination_id,\r\n              on_examination_result:\r\n                this.onExamination.on_examination_result.toString(),\r\n            }\r\n          );\r\n          this.submitted = false;\r\n          this.onExaminationDialog = false;\r\n        }\r\n      } else if (this.isEdit) {\r\n        this.onExaminationEditSave();\r\n        this.isEdit = false;\r\n      }\r\n\r\n    },\r\n    getFigureFormatted(data) {\r\n      this.figure.figure_image = \"data:image/jpg;base64,\" + data.figure_image;\r\n      // canvas\r\n      var vm = this;\r\n      vm.canvas = vm.$refs.canvas;\r\n      vm.context = vm.canvas.getContext(\"2d\");\r\n      vm.canvas.addEventListener(\"mousedown\", vm.mousedown);\r\n      vm.canvas.addEventListener(\"mousemove\", vm.mousemove);\r\n      document.addEventListener(\"mouseup\", vm.mouseup);\r\n\r\n      vm.img = new Image();\r\n      vm.img.onload = function () {\r\n        vm.context.drawImage(vm.img, 0, 0, 300, 200); // Or at whatever offset you like and set height, width\r\n      };\r\n\r\n      vm.img.src = this.figure.figure_image;\r\n    },\r\n    // canvas\r\n    mousedown(e) {\r\n      var vm = this;\r\n      var rect = vm.canvas.getBoundingClientRect();\r\n      var x = e.clientX - rect.left;\r\n      var y = e.clientY - rect.top;\r\n\r\n      vm.isDrawing = true;\r\n      vm.startX = x;\r\n      vm.startY = y;\r\n      vm.points.push({\r\n        x: x,\r\n        y: y,\r\n      });\r\n    },\r\n    mousemove(e) {\r\n      var vm = this;\r\n      var rect = vm.canvas.getBoundingClientRect();\r\n      var x = e.clientX - rect.left;\r\n      var y = e.clientY - rect.top;\r\n\r\n      if (vm.isDrawing) {\r\n        vm.context.beginPath();\r\n        vm.context.moveTo(vm.startX, vm.startY);\r\n        vm.context.lineTo(x, y);\r\n        vm.context.lineWidth = 1;\r\n        vm.context.lineCap = \"round\";\r\n        vm.context.strokeStyle = \"rgba(0,0,0,1)\";\r\n        vm.context.stroke();\r\n\r\n        vm.startX = x;\r\n        vm.startY = y;\r\n\r\n        vm.points.push({\r\n          x: x,\r\n          y: y,\r\n        });\r\n      }\r\n    },\r\n    mouseup() {\r\n      var vm = this;\r\n      vm.isDrawing = false;\r\n      if (vm.points.length > 0) {\r\n        localStorage[\"points\"] = JSON.stringify(vm.points);\r\n      }\r\n    },\r\n    resetCanvas() {\r\n      // var vm = this;\r\n      // vm.canvas.width = vm.canvas.width;\r\n      // vm.points.length = 0; // reset points array\r\n\r\n      var vm = this;\r\n      vm.canvas = vm.$refs.canvas;\r\n      vm.context = vm.canvas.getContext(\"2d\");\r\n      vm.canvas.addEventListener(\"mousedown\", vm.mousedown);\r\n      vm.canvas.addEventListener(\"mousemove\", vm.mousemove);\r\n      document.addEventListener(\"mouseup\", vm.mouseup);\r\n\r\n      vm.img = new Image();\r\n      vm.img.onload = function () {\r\n        vm.context.drawImage(vm.img, 0, 0, 300, 200); // Or at whatever offset you like and set height, width\r\n      };\r\n\r\n      vm.img.src = this.figure.figure_image;\r\n\r\n      vm.canvas.width = this.canvas.width;\r\n      vm.points.length = 0; // reset points array\r\n    },\r\n    // saveImage() {\r\n    //   var vm = this;\r\n    //   var dataURL = vm.canvas.toDataURL();\r\n    //   var img = vm.$refs.img;\r\n    //   img.src = dataURL;\r\n    // },\r\n    //\r\n    addFigure() {\r\n      var dataURL = this.canvas.toDataURL();\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionFigure.push({\r\n        name: this.figure.name,\r\n        figure_id: this.figure.figure_id,\r\n        figure_image: dataURL.split(\",\")[1],\r\n      });\r\n      this.figureDialog = false;\r\n      this.showInPrescription(\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionFigure,\r\n        !this.appointmentPrescription.figure_show_in_prescription\r\n      );\r\n    },\r\n    addFamilyHistory() {\r\n      this.submitted = true;\r\n      if (!this.familyHistory.relative_ralation) {\r\n        return;\r\n      } else {\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory.push(\r\n          {\r\n            diagnosis_id: this.familyHistory.diagnosis_id,\r\n            name: this.familyHistory.name,\r\n            relative_ralation: this.familyHistory.relative_ralation,\r\n          }\r\n        );\r\n        this.submitted = false;\r\n        this.familyHistoryDialog = false;\r\n        this.showInPrescription(\r\n          this.appointmentPrescription.lstAppoinmentPrescriptionFamilyHistory,\r\n          !this.appointmentPrescription.familyHistory_show_in_prescription\r\n        );\r\n      }\r\n    },\r\n    editTreatment(data, index) {\r\n      this.treatmentSetup.medicineName = data.name;\r\n      // this.treatmentSetup.ddlmedicine = {\r\n      //   text: data.name,\r\n      //   value: data.medicine_id,\r\n      //   refid: null,\r\n      // };\r\n      this.treatmentSetup.ddltreatment_rules = {\r\n        text: data._treatment_rule_name,\r\n        value: data.treatment_rules_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_duration = {\r\n        text: data._treatment_duration_name,\r\n        value: data.treatment_duration_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_dose = {\r\n        text: data._treatment_dose_name,\r\n        value: data.treatment_dose_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentDialog = true;\r\n      this.treatmentIndex = index\r\n    },\r\n    treatmentEditSave() {\r\n      //this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].name = this.treatmentSetup.ddlmedicine.text;\r\n      //this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].medicine_id = this.treatmentSetup.ddlmedicine.value;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_rule_name = this.treatmentSetup.ddltreatment_rules.text;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_rules_id = this.treatmentSetup.ddltreatment_rules.value;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_duration_name = this.treatmentSetup.ddltreatment_duration.text;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_duration_id = this.treatmentSetup.ddltreatment_duration.value;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex]._treatment_dose_name = this.treatmentSetup.ddltreatment_dose.text;\r\n      this.appointmentPrescription.lstAppoinmentPrescriptionTreatment[this.treatmentIndex].treatment_dose_id = this.treatmentSetup.ddltreatment_dose.value;\r\n\r\n      this.treatmentDialog = false;\r\n    },\r\n    editOnExamination(data, index) {\r\n      this.onExamination.label = data.name;\r\n      this.onExamination.on_examination_result = data.on_examination_result;\r\n      //this.editOnExaminationDialog = true;\r\n      this.onExaminationDialog = true;\r\n      this.onExaminationIndex = index;\r\n      this.isEdit = true;\r\n    },\r\n    onExaminationEditSave() {\r\n      this.submitted = true;\r\n      if (!this.onExamination.on_examination_result) {\r\n        return;\r\n      } else {\r\n        this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination[this.onExaminationIndex].on_examination_result = this.onExamination.on_examination_result.toString();\r\n        //this.editOnExaminationDialog = false;\r\n        this.onExaminationDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n    deleteItem(lst, data) {\r\n      lst.splice(\r\n        lst.findIndex((i) => i === data),\r\n        1\r\n      );\r\n    },\r\n    showInPrescription(lst, val) {\r\n      lst.forEach((element) => {\r\n        element.show_in_prescription = !val;\r\n      });\r\n    },\r\n    async add() {\r\n      try {\r\n        if (\r\n          !this.appointmentPrescription.lstAppoinmentPrescriptionCompliants\r\n            .length\r\n        ) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Please add Patient Complaints\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (\r\n          !this.appointmentPrescription.lstAppoinmentPrescriptionOnExamination\r\n            .length\r\n        ) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Please add On Examination\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else {\r\n          this.appointmentPrescription.appoinment_id =\r\n            this.appointmentInfo.appoinment_id;\r\n\r\n          this.appointmentPrescription.prescription_date = moment(\r\n            String(this.appointmentPrescription.cdprescription_date)\r\n          ).format(\"YYYY-MM-DD\");\r\n\r\n          if (this.appointmentPrescription.cdfolowup_date) {\r\n            this.appointmentPrescription.folowup_date = moment(\r\n              String(this.appointmentPrescription.cdfolowup_date)\r\n            ).format(\"YYYY-MM-DD\");\r\n          }\r\n\r\n          let result = await this.appointmentPrescriptionService.add(\r\n            this.appointmentPrescription, this\r\n          );\r\n          if (result.status === 200) {\r\n            this.downloadPrescription(this.appointmentPrescription.appoinment_id)\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Sucess\",\r\n              detail: \"Prescribed Sucessfully\",\r\n              life: 10000,\r\n            });\r\n            this.newPrescription();\r\n            this.reset();\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Faild\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Faild\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    newPrescription() {\r\n      this.headerName = \"Sections\";\r\n      this.filters['global'].value = \"\";\r\n      this.tempData = [];\r\n      this.onExamination = {};\r\n      this.figure = {};\r\n      this.familyHistory = {};\r\n      this.appointmentPrescription = {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        figure_show_in_prescription: true,\r\n        familyHistory_show_in_prescription: true,\r\n        pastHistory_show_in_prescription: true,\r\n\r\n        lstAppoinmentPrescriptionCompliants: [],\r\n        lstAppoinmentPrescriptionOnExamination: [],\r\n        lstAppoinmentPrescriptionFigure: [],\r\n        lstAppoinmentPrescriptionInvestigation: [],\r\n        lstAppoinmentPrescriptionDiagnosis: [],\r\n        lstAppoinmentPrescriptionFamilyHistory: [],\r\n        lstAppoinmentPrescriptionPastHistory: [],\r\n        lstAppoinmentPrescriptionTreatment: [],\r\n        lstAppoinmentPrescriptionAdvice: [],\r\n      };\r\n\r\n      this.submitted = false;\r\n    },\r\n  },\r\n};"]}]}