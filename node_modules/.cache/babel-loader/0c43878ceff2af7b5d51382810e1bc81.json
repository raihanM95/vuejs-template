{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\thread-loader\\dist\\cjs.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\nurse-panel\\AdmittedPatientRequest.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\nurse-panel\\AdmittedPatientRequest.js","mtime":1676439304093},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\babel.config.js","mtime":1624271518206},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOi9TVk4gUFJPSkVDVFMvRVJQX0hvc3BpdGFsX0NsaWVudC90cnVuay9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRjovU1ZOIFBST0pFQ1RTL0VSUF9Ib3NwaXRhbF9DbGllbnQvdHJ1bmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgQWRtaXNzaW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2Zyb250LWRlc2svQWRtaXNzaW9uU2VydmljZSI7CmltcG9ydCBBZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcHJlc2NyaXB0aW9uL0FkbWlzc2lvblByZXNjcmlwdGlvblNlcnZpY2UiOwppbXBvcnQgQ29tbW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL0NvbW1vblNlcnZpY2UiOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCBWYWxpZGF0aW9uIGZyb20gIi4uLy4uL3NjcmlwdHMvdmFsaWRhdGlvbiI7CmltcG9ydCB7IEZpbHRlclNlcnZpY2UsIEZpbHRlck1hdGNoTW9kZSwgRmlsdGVyT3BlcmF0b3IgfSBmcm9tICJwcmltZXZ1ZS9hcGkiOyAvLyBJbnZlc3RpZ2F0aW9uIFJlcXVlc3QKCmltcG9ydCBQYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3RTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvZnJvbnQtZGVzay9QYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3RTZXJ2aWNlIjsgLy9pbXBvcnQgUGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9mcm9udC1kZXNrL1BhdGllbnRSZWdpc3RyYXRpb25TZXJ2aWNlIjsKCmltcG9ydCBQYXRpZW50UmVwb3J0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3JlcG9ydC9QYXRpZW50UmVwb3J0U2VydmljZSI7IC8vaW1wb3J0IERlc2lnbmF0aW9uU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvRGVzaWduYXRpb25TZXR1cFNlcnZpY2UiOwoKaW1wb3J0IENvbnN1bHRhbmN5RGVwYXJ0bWVudFNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0NvbnN1bHRhbmN5RGVwYXJ0bWVudFNldHVwU2VydmljZSI7CmltcG9ydCBEb2N0b3JTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Eb2N0b3JTZXR1cFNlcnZpY2UiOyAvL2ltcG9ydCBFbXBsb3llZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0VtcGxveWVlU2V0dXBTZXJ2aWNlIjsKCmltcG9ydCBCdWlsZGluZ1NldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0J1aWxkaW5nU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFJvb21TZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Sb29tU2V0dXBTZXJ2aWNlIjsgLy9pbXBvcnQgUmVmZXJyZWRCeVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1JlZmVycmVkQnlTZXR1cFNlcnZpY2UiOwoKaW1wb3J0IEludmVzdGlnYXRpb25TZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9JbnZlc3RpZ2F0aW9uU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFByb2R1Y3RTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Qcm9kdWN0U2V0dXBTZXJ2aWNlIjsKaW1wb3J0IElQRFJlcXVlc3RTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvaXBkL0lQRFJlcXVlc3RTZXJ2aWNlIjsgLy8gU2VydmljZSAmIFBhY2thZ2UKCmltcG9ydCBTZXJ2aWNlU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvU2VydmljZVNldHVwU2VydmljZSI7CmltcG9ydCBTZXJ2aWNlUGFja2FnZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1NlcnZpY2VQYWNrYWdlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IElQRFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9pcGQvSVBEU2VydmljZSI7IC8vIFBoYXJtYWN5CgppbXBvcnQgTWVkaWNpbmVSZXF1ZXN0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3BoYXJtYWN5L01lZGljaW5lUmVxdWVzdFNlcnZpY2UiOwppbXBvcnQgSVBEUmVwb3J0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3JlcG9ydC9JUERSZXBvcnRTZXJ2aWNlIjsKaW1wb3J0IE1lZGljaW5lU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvTWVkaWNpbmVTZXR1cFNlcnZpY2UiOyAvLyBCbG9vZCBCYW5rCgppbXBvcnQgQmxvb2RSZXF1ZXN0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2Jsb29kLWJhbmsvQmxvb2RSZXF1ZXN0U2VydmljZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZmlsdGVyZWRJdGVtczogbnVsbCwKICAgICAgZGF0YUxpc3Q6IHRydWUsCiAgICAgIGlzTnVyc2U6IGZhbHNlLAogICAgICBpc1JlcXVlc3Q6IGZhbHNlLAogICAgICBwaGFybWFjeTogZmFsc2UsCiAgICAgIGFjdGl2ZTogMCwKICAgICAgZXhwYW5kZWRSb3dzOiBbXSwKICAgICAgYWRtaXR0ZWRQYXRpZW50TGlzdDogW10sCiAgICAgIGFkbWl0dGVkUGF0aWVudDogewogICAgICAgIC8vIGNkZnJvbWRhdGU6IG1vbWVudCgKICAgICAgICAvLyAgICAgU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSAtIDg2MCkpKQogICAgICAgIC8vICkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgY2Rmcm9tZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgY2R0b2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpIC8vIGNkdG9kYXRlOiBtb21lbnQoCiAgICAgICAgLy8gICAgIFN0cmluZyhuZXcgRGF0ZShuZXcgRGF0ZSgpLnNldERhdGUobmV3IERhdGUoKS5nZXREYXRlKCkgKyA3KSkpCiAgICAgICAgLy8gKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKCiAgICAgIH0sCiAgICAgIC8vCiAgICAgIHN1Ym1pdHRlZDogZmFsc2UsCiAgICAgIGZpbHRlcnM6IHsKICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICB9LAogICAgICAgIG5hbWU6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuU1RBUlRTX1dJVEgKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGluaXRGaWx0ZXJzOiBmdW5jdGlvbiBpbml0RmlsdGVycygpIHsKICAgICAgICB0aGlzLmZpbHRlcnMgPSB7CiAgICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLkNPTlRBSU5TCiAgICAgICAgICB9LAogICAgICAgICAgbmFtZTogewogICAgICAgICAgICBvcGVyYXRvcjogRmlsdGVyT3BlcmF0b3IuQU5ELAogICAgICAgICAgICBjb25zdHJhaW50czogW3sKICAgICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgICAgICB9XQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0sCiAgICAgIC8vIEludmVzdGlnYXRpb24gUmVxdWVzdAogICAgICBhZG1pc3Npb25faWQ6IG51bGwsCiAgICAgIHBhdGllbnRfaWQ6IG51bGwsCiAgICAgIGRvY3Rvcl9pZDogbnVsbCwKICAgICAgZG9jdG9yX25vOiBudWxsLAogICAgICByZWZmZXJlZF9ieV9pZDogbnVsbCwKICAgICAgaW52ZXN0aWdhdGlvblJlcXVlc3REaWFsb2c6IGZhbHNlLAogICAgICBsc3RQcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOiBbXSwKICAgICAgLy9pc0ludmVzdGlnYXRpb246IHRydWUsCiAgICAgIC8vaXNQcmVzY3JpcHRpb246IGZhbHNlLAogICAgICAvL2lzQ29udGFjdEV4aXN0OiAiIiwKICAgICAgLy9pc1ZhbGlkOiAiIiwKICAgICAgLy9pc0VtYWlsVmFsaWQ6ICIiLAogICAgICAvL2lzUGF0aWVudEV4aXN0OiAiIiwKICAgICAgaXNFeGlzdDogIiIsCiAgICAgIC8vY29sbGVjdGlvbkxpc3Q6IFtdLAogICAgICAvL2Jsb29kR3JvdXBMaXN0OiBbXSwKICAgICAgLy9nZW5kZXJMaXN0OiBbXSwKICAgICAgLy9kZXNpZ25hdGlvbnRMaXN0OiBbXSwKICAgICAgLy9kZXBhcnRtZW50TGlzdDogW10sCiAgICAgIC8vZG9jdG9yTGlzdDogW10sCiAgICAgIGJ1aWxkaW5nTGlzdDogW10sCiAgICAgIHJvb21MaXN0OiBbXSwKICAgICAgLy9yZWZlcnJlZEJ5TGlzdDogW10sCiAgICAgIC8vZW1wbG95ZWVMaXN0OiBbXSwKICAgICAgLy9kaXNjb3VudEJ5TGlzdDogW10sCiAgICAgIGludmVzdGlnYXRpb25MaXN0OiBbXSwKICAgICAgcmVwb3J0RGVsaXZlcnlUeXBlTGlzdDogW10sCiAgICAgIHByb2R1Y3RMaXN0OiBbXSwKICAgICAgcGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0OiB7CiAgICAgICAgcGF0aWVudF9pZDogIiIsCiAgICAgICAgYVBhdGllbnQ6IHsKICAgICAgICAgIGFnZV95ZWFyOiAiMCIsCiAgICAgICAgICBhZ2VfbW9udGg6ICIwIiwKICAgICAgICAgIGFnZV9kYXk6ICIwIgogICAgICAgIH0sCiAgICAgICAgY2RpbnZlc3RpZ2F0aW9uX3JlcXVlc3RfZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgcmVwb3J0X2RlbGl2ZXJ5X3R5cGU6ICJSZWd1bGFyIiwKICAgICAgICBsc3RJbnZlc3RpZ2F0aW9uUmVxdWVzdERldGFpbHM6IFtdLAogICAgICAgIGxzdEludmVzdGlnYXRpb25QYXJ0aWN1bGFyOiBbXSwKICAgICAgICBkaXNjb3VudF9ieV9pZDogIkNvbXBhbnkiLAogICAgICAgIGRpc2NvdW50X3BlcmNlbnQ6IDAsCiAgICAgICAgZGlzY291bnRfYW1vdW50OiAwLAogICAgICAgIGNvc3RfcHJpY2U6IDAsCiAgICAgICAgcGFydGljdWxhcl9jb3N0X3ByaWNlOiAwLAogICAgICAgIHRvdGFsX2Ftb3VudDogMAogICAgICB9LAogICAgICBkaXNjb3VudEJ5TGlzdDogW3sKICAgICAgICB0ZXh0OiAiQm90aCIsCiAgICAgICAgdmFsdWU6ICJCb3RoIgogICAgICB9LCB7CiAgICAgICAgdGV4dDogIkhvc3BpdGFsIiwKICAgICAgICB2YWx1ZTogIkNvbXBhbnkiCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAiUmVmZXJlbmNlIiwKICAgICAgICB2YWx1ZTogIlJlZmVyZW5jZSIKICAgICAgfV0sCiAgICAgIC8vIEludmVzdGlnYXRpb24gUmVxdWVzdAogICAgICBpUERJbnZlc3RpZ2F0aW9uUmVxdWVzdExpc3Q6IFtdLAogICAgICBpUERJbnZlc3RpZ2F0aW9uUmVxdWVzdDogewogICAgICAgIGludmVzdGlnYXRpb25fcmVxdWVzdF9pZDogbnVsbCwKICAgICAgICBhZG1pc3Npb25faWQ6IG51bGwKICAgICAgfSwKICAgICAgLy8gUGhhcm1hY3kKICAgICAgaW52b2ljZV9pZDogbnVsbCwKICAgICAgYWRtaXNzaW9uX25vOiBudWxsLAogICAgICByZWdpc3RyYXRpb25fbm86IG51bGwsCiAgICAgIHBhdGllbnRfbmFtZTogbnVsbCwKICAgICAgaVBETWVkaWNpbmVSZXF1ZXN0TGlzdDogW10sCiAgICAgIGlQRFByZXNjcmlwdGlvbkxpc3Q6IFtdLAogICAgICBpUERQcmVzY3JpcHRpb25NZWRpY2luZUxpc3Q6IFtdLAogICAgICBpUERNZWRpY2luZVJlcXVlc3Q6IHsKICAgICAgICBsc3RNZWRpY2luZVJlcXVlc3REZXRhaWxzOiBbXQogICAgICB9LAogICAgICBpUERNZWRpY2luZVJlcXVlc3REaWFsb2c6IGZhbHNlLAogICAgICBhZGRNZWRpY2luZURpYWxvZzogZmFsc2UsCiAgICAgIGFkZE1lZGljaW5lOiB7fSwKICAgICAgbWVkaWNpbmVMaXN0OiBbXSwKICAgICAgLy8gU2VydmljZQogICAgICBzZXJ2aWNlRGlhbG9nOiBmYWxzZSwKICAgICAgaVBEU2VydmljZU9iajogewogICAgICAgIGxzdFNlcnZpY2U6IFtdCiAgICAgIH0sCiAgICAgIC8vIFBhY2thZ2UKICAgICAgc2VydmljZVBhY2thZ2VEaWFsb2c6IGZhbHNlLAogICAgICBpUERTZXJ2aWNlUGFja2FnZU9iajogewogICAgICAgIGxzdFNlcnZpY2VQYWNrYWdlOiBbXQogICAgICB9LAogICAgICAvLyBUYWtlbiBTZXJ2aWNlICYgUGFja2FnZQogICAgICB0YWtlblNlcnZpY2VQYWNrYWdlRGlhbG9nOiBmYWxzZSwKICAgICAgdGFrZW5TZXJ2aWNlUGFja2FnZU9iajogewogICAgICAgIGxzdFRha2VuU2VydmljZTogW10sCiAgICAgICAgbGFzdFRha2VuU2VydmljZVBhY2thZ2U6IFtdCiAgICAgIH0sCiAgICAgIC8vIFJvdW5kIERvY3RvcgogICAgICBkZXBhcnRtZW50TGlzdDogW10sCiAgICAgIGRvY3Rvckxpc3Q6IFtdLAogICAgICBhc3NpZ25Sb3VuZERvY3Rvcjoge30sCiAgICAgIHJvdW5kRG9jdG9yTGlzdDogW10sCiAgICAgIGxpc3RSb3VuZERvY3RvckRpYWxvZzogZmFsc2UsCiAgICAgIHJvdW5kRG9jdG9yRGlhbG9nOiBmYWxzZSwKICAgICAgLy8gQmxvb2QgQmFuawogICAgICBpUERCbG9vZFJlcXVlc3RMaXN0OiBbXSwKICAgICAgYmxvb2RSZXF1ZXN0RGlhbG9nOiBmYWxzZSwKICAgICAgYmxvb2RSZXF1ZXN0T2JqOiB7fSwKICAgICAgYmxvb2RHcm91cExpc3Q6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy5hZG1pc3Npb25TZXJ2aWNlID0gbmV3IEFkbWlzc2lvblNlcnZpY2UoKTsKICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlKCk7CiAgICB0aGlzLmNvbW1vblNlcnZpY2UgPSBuZXcgQ29tbW9uU2VydmljZSgpOwogICAgdGhpcy52YWxpZGF0aW9uID0gbmV3IFZhbGlkYXRpb24oKTsKICAgIHRoaXMudXNlckluZm8gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VySW5mbyIpKTsKICAgIHRoaXMuc2hvdygpOwoKICAgIGlmICh0aGlzLnVzZXJJbmZvLm51cnNlX2lkKSB7CiAgICAgIHRoaXMuaXNOdXJzZSA9IHRydWU7CiAgICB9IGVsc2UgaWYgKCF0aGlzLnVzZXJJbmZvLm51cnNlX2lkKSB7CiAgICAgIHRoaXMuaXNOdXJzZSA9IGZhbHNlOwogICAgfSAvLyBJbnZlc3RpZ2F0aW9uIFJlcXVlc3QKCgogICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3RTZXJ2aWNlID0gbmV3IFBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdFNlcnZpY2UoKTsgLy90aGlzLnBhdGllbnRSZWdpc3RyYXRpb25TZXJ2aWNlID0gbmV3IFBhdGllbnRSZWdpc3RyYXRpb25TZXJ2aWNlKCk7CiAgICAvL3RoaXMuZW1wbG95ZWVTZXR1cFNlcnZpY2UgPSBuZXcgRW1wbG95ZWVTZXR1cFNlcnZpY2UoKTsKCiAgICB0aGlzLmRvY3RvclNldHVwU2VydmljZSA9IG5ldyBEb2N0b3JTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuY29uc3VsdGFuY3lEZXBhcnRtZW50U2V0dXBTZXJ2aWNlID0gbmV3IENvbnN1bHRhbmN5RGVwYXJ0bWVudFNldHVwU2VydmljZSgpOyAvL3RoaXMuZGVzaWduYXRpb25TZXR1cFNlcnZpY2UgPSBuZXcgRGVzaWduYXRpb25TZXR1cFNlcnZpY2UoKTsKCiAgICB0aGlzLmJ1aWxkaW5nU2V0dXBTZXJ2aWNlID0gbmV3IEJ1aWxkaW5nU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnJvb21TZXR1cFNlcnZpY2UgPSBuZXcgUm9vbVNldHVwU2VydmljZSgpOyAvL3RoaXMucmVmZXJyZWRCeVNldHVwU2VydmljZSA9IG5ldyBSZWZlcnJlZEJ5U2V0dXBTZXJ2aWNlKCk7CgogICAgdGhpcy5pbnZlc3RpZ2F0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IEludmVzdGlnYXRpb25TZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMucHJvZHVjdFNldHVwU2VydmljZSA9IG5ldyBQcm9kdWN0U2V0dXBTZXJ2aWNlKCk7IC8vdGhpcy5jb2xsZWN0aW9uQ2VudGVyU2V0dXBTZXJ2aWNlID0gbmV3IENvbGxlY3Rpb25DZW50ZXJTZXR1cFNlcnZpY2UoKTsKCiAgICB0aGlzLnBhdGllbnRSZXBvcnRTZXJ2aWNlID0gbmV3IFBhdGllbnRSZXBvcnRTZXJ2aWNlKCk7IC8vdGhpcy5hcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UgPSBuZXcgQXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlKCk7CgogICAgdGhpcy5pUERSZXF1ZXN0U2VydmljZSA9IG5ldyBJUERSZXF1ZXN0U2VydmljZSgpOyAvLyBTZXJ2aWNlICYgUGFja2FnZQoKICAgIHRoaXMuc2VydmljZVNldHVwU2VydmljZSA9IG5ldyBTZXJ2aWNlU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLnNlcnZpY2VQYWNrYWdlU2V0dXBTZXJ2aWNlID0gbmV3IFNlcnZpY2VQYWNrYWdlU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmlQRFNlcnZpY2UgPSBuZXcgSVBEU2VydmljZSgpOyAvLyBQaGFybWFjeQoKICAgIHRoaXMubWVkaWNpbmVSZXF1ZXN0U2VydmljZSA9IG5ldyBNZWRpY2luZVJlcXVlc3RTZXJ2aWNlKCk7CiAgICB0aGlzLmlQRFJlcG9ydFNlcnZpY2UgPSBuZXcgSVBEUmVwb3J0U2VydmljZSgpOwogICAgdGhpcy5tZWRpY2luZVNldHVwU2VydmljZSA9IG5ldyBNZWRpY2luZVNldHVwU2VydmljZSgpOyAvLyBCbG9vZCBCYW5rCgogICAgdGhpcy5ibG9vZFJlcXVlc3RTZXJ2aWNlID0gbmV3IEJsb29kUmVxdWVzdFNlcnZpY2UoKTsgLy8gdGhpcy5jb21tb25TZXJ2aWNlCiAgICAvLyAgICAgLkdldEFsbEdlbmRlcigpCiAgICAvLyAgICAgLnRoZW4oKGRhdGEpID0+ICh0aGlzLmdlbmRlckxpc3QgPSBkYXRhLmRhdGEpKTsKICAgIC8vIHRoaXMuY29tbW9uU2VydmljZQogICAgLy8gICAgIC5HZXRBbGxCbG9vZEdyb3VwKCkKICAgIC8vICAgICAudGhlbigoZGF0YSkgPT4gKHRoaXMuYmxvb2RHcm91cExpc3QgPSBkYXRhLmRhdGEpKTsKICAgIC8vIHRoaXMuZGVzaWduYXRpb25TZXR1cFNlcnZpY2UKICAgIC8vICAgICAuZ2V0QWxsKCkKICAgIC8vICAgICAudGhlbigoZGF0YSkgPT4gKHRoaXMuZGVzaWduYXRpb250TGlzdCA9IGRhdGEuZGF0YSkpOwogICAgLy8gdGhpcy5jb25zdWx0YW5jeURlcGFydG1lbnRTZXR1cFNlcnZpY2UKICAgIC8vICAgICAuZ2V0QWN0aXZlQ29tYm8oKQogICAgLy8gICAgIC50aGVuKChkYXRhKSA9PiAodGhpcy5kZXBhcnRtZW50TGlzdCA9IGRhdGEuZGF0YSkpOwogICAgLy8gdGhpcy5idWlsZGluZ1NldHVwU2VydmljZQogICAgLy8gICAgIC5nZXRBbGwoKQogICAgLy8gICAgIC50aGVuKChkYXRhKSA9PiAodGhpcy5idWlsZGluZ0xpc3QgPSBkYXRhLmRhdGEpKTsKICAgIC8vIHRoaXMucm9vbVNldHVwU2VydmljZS5nZXRBbGwoKS50aGVuKChkYXRhKSA9PiAodGhpcy5yb29tTGlzdCA9IGRhdGEuZGF0YSkpOwogICAgLy8gdGhpcy5yZWZlcnJlZEJ5U2V0dXBTZXJ2aWNlCiAgICAvLyAgIC5nZXRBY3RpdmVDb21ibygpCiAgICAvLyAgIC50aGVuKChkYXRhKSA9PiAodGhpcy5yZWZlcnJlZEJ5TGlzdCA9IGRhdGEuZGF0YSkpOwogICAgLy8gdGhpcy5yZWZlcnJlZEJ5U2V0dXBTZXJ2aWNlCiAgICAvLyAgIC5nZXRBY3RpdmVDb21ibygpCiAgICAvLyAgIC50aGVuKChkYXRhKSA9PiB0aGlzLm1lcmdlUmVmZXJyZWRCeUluZm8oZGF0YS5kYXRhKSk7CiAgICAvLyB0aGlzLnJlZmVycmVkQnlTZXR1cFNlcnZpY2UKICAgIC8vICAgLmdldEFsbCgpCiAgICAvLyAgIC50aGVuKChkYXRhKSA9PiB0aGlzLm1lcmdlUmVmZXJyZWRCeUluZm8oZGF0YS5kYXRhKSk7CiAgICAvLyB0aGlzLmRvY3RvclNldHVwU2VydmljZQogICAgLy8gICAuZ2V0QWxsKCkKICAgIC8vICAgLnRoZW4oKGRhdGEpID0+IHRoaXMubWVyZ2VEb2N0b3JJbmZvKGRhdGEuZGF0YSkpOwogICAgLy8gdGhpcy5lbXBsb3llZVNldHVwU2VydmljZQogICAgLy8gICAuZ2V0QWxsKCkKICAgIC8vICAgLnRoZW4oKGRhdGEpID0+IHRoaXMubWVyZ2VFbXBsb3llZUluZm8oZGF0YS5kYXRhKSk7CgogICAgdGhpcy5pbnZlc3RpZ2F0aW9uU2V0dXBTZXJ2aWNlLmdldEFsbCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLmludmVzdGlnYXRpb25MaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7IC8vIHRoaXMuaW52ZXN0aWdhdGlvblNldHVwU2VydmljZQogICAgLy8gICAgIC5nZXRBbGwoKQogICAgLy8gICAgIC50aGVuKChkYXRhKSA9PiB0aGlzLmZvcm1hdEludmVzdGlnYXRpb25MaXN0KGRhdGEuZGF0YSkpOwoKICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxSZXBvcnREZWxpdmVyeVR5cGUoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy5yZXBvcnREZWxpdmVyeVR5cGVMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLnByb2R1Y3RTZXR1cFNlcnZpY2UuZ2V0QWxsKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMucHJvZHVjdExpc3QgPSBkYXRhLmRhdGE7CiAgICB9KTsgLy8gU2VydmljZSAmIFBhY2thZ2UKCiAgICB0aGlzLmdldFNlcnZpY2UoKTsKICAgIHRoaXMuZ2V0U2VydmljZVBhY2thZ2UoKTsgLy8KCiAgICB0aGlzLmNvbnN1bHRhbmN5RGVwYXJ0bWVudFNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgcmV0dXJuIF90aGlzLmRlcGFydG1lbnRMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB0aGlzLmRvY3RvclNldHVwU2VydmljZS5nZXRBbGwoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy5tZXJnZURvY3RvckluZm8oZGF0YS5kYXRhKTsKICAgIH0pOwogICAgdGhpcy5jb21tb25TZXJ2aWNlLkdldEFsbEJsb29kR3JvdXAoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy5ibG9vZEdyb3VwTGlzdCA9IGRhdGEuZGF0YTsKICAgIH0pOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0U2VydmljZTogZnVuY3Rpb24gZ2V0U2VydmljZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLnNlcnZpY2VTZXR1cFNlcnZpY2UuZ2V0QWxsKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczIuc2VydmljZUZvcm1hdHRlZChkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRTZXJ2aWNlUGFja2FnZTogZnVuY3Rpb24gZ2V0U2VydmljZVBhY2thZ2UoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5zZXJ2aWNlUGFja2FnZVNldHVwU2VydmljZS5nZXRBbGwoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5zZXJ2aWNlUGFja2FnZUZvcm1hdHRlZChkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy5hZG1pdHRlZFBhdGllbnQuY2Rmcm9tZGF0ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy5hZG1pdHRlZFBhdGllbnQuY2R0b2RhdGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnQuZnJvbWRhdGUgPSBtb21lbnQoU3RyaW5nKHRoaXMuYWRtaXR0ZWRQYXRpZW50LmNkZnJvbWRhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudC50b2RhdGUgPSBtb21lbnQoU3RyaW5nKHRoaXMuYWRtaXR0ZWRQYXRpZW50LmNkdG9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAgICAgdGhpcy51c2VySW5mbyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJbmZvIikpOwogICAgICAgIHRoaXMuYWRtaXNzaW9uU2VydmljZS5hZG1pdHRlZFBhdGllbnRMaXN0Rm9ySGlzdG9yeUJ5TnVyc2VJZCh0aGlzLmFkbWl0dGVkUGF0aWVudC5mcm9tZGF0ZSwgdGhpcy5hZG1pdHRlZFBhdGllbnQudG9kYXRlLCB0aGlzLnVzZXJJbmZvLm51cnNlX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXM0LmFkbWl0dGVkUGF0aWVudExpc3QgPSBkYXRhLmRhdGE7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZGF0YUxpc3QgPSB0cnVlOwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7CiAgICB9LAogICAgaGlkZURpYWxvZzogZnVuY3Rpb24gaGlkZURpYWxvZygpIHsKICAgICAgLy92YXIgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7CiAgICAgIHRoaXMucm91bmREb2N0b3JEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5saXN0Um91bmREb2N0b3JEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5zZXJ2aWNlUGFja2FnZURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnRha2VuU2VydmljZVBhY2thZ2VEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5zZXJ2aWNlRGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuaW52ZXN0aWdhdGlvblJlcXVlc3REaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5pUERNZWRpY2luZVJlcXVlc3REaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5hZGRNZWRpY2luZURpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmFkZE1lZGljaW5lID0ge307CiAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgIHRoaXMuYmxvb2RSZXF1ZXN0RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuYmxvb2RSZXF1ZXN0T2JqID0ge307CiAgICB9LAogICAgaGlkZUNvbGxlY3Rpb25SZXF1ZXN0OiBmdW5jdGlvbiBoaWRlQ29sbGVjdGlvblJlcXVlc3QoKSB7CiAgICAgIHRoaXMuaXNSZXF1ZXN0ID0gZmFsc2U7CiAgICAgIHRoaXMuZGF0YUxpc3QgPSB0cnVlOyAvL2xvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwYXRpZW50SWRGb3JUcmVhdG1lbnQnKTsKICAgIH0sCiAgICBjb2xsZWN0aW9uUmVxdWVzdDogZnVuY3Rpb24gY29sbGVjdGlvblJlcXVlc3QoZGF0YSkgewogICAgICB0aGlzLmdldElQREludmVzdGlnYXRpb25SZXF1ZXN0QnlBZG1pc3Npb25JZChkYXRhLmFkbWlzc2lvbl9pZCk7CiAgICAgIHRoaXMuZ2V0TWVkaWNpbmVSZXF1ZXN0TGlzdEJ5QWRtaXNzaW9uTm8oZGF0YS5hZG1pc3Npb25fbm8pOwogICAgICB0aGlzLmdldEJsb29kUmVxdWVzdExpc3RCeUFkbWlzc2lvbklkKGRhdGEuYWRtaXNzaW9uX2lkKTsKICAgICAgdGhpcy5ibG9vZFJlcXVlc3RPYmouYWRtaXNzaW9uX2lkID0gZGF0YS5hZG1pc3Npb25faWQ7CiAgICAgIHRoaXMuYmxvb2RSZXF1ZXN0T2JqLmJsb29kX2dyb3VwID0gZGF0YS5ibG9vZF9ncm91cDsKICAgICAgdGhpcy5pbnZvaWNlX2lkID0gZGF0YS5pbnZvaWNlX2lkOwogICAgICB0aGlzLmFkbWlzc2lvbl9pZCA9IGRhdGEuYWRtaXNzaW9uX2lkOwogICAgICB0aGlzLmFkbWlzc2lvbl9ubyA9IGRhdGEuYWRtaXNzaW9uX25vOwogICAgICB0aGlzLnBhdGllbnRfaWQgPSBkYXRhLnBhdGllbnRfaWQ7CiAgICAgIHRoaXMucmVnaXN0cmF0aW9uX25vID0gZGF0YS5yZWdpc3RyYXRpb25fbm87CiAgICAgIHRoaXMucGF0aWVudF9uYW1lID0gZGF0YS5wYXRpZW50X25hbWU7CiAgICAgIHRoaXMuZG9jdG9yX2lkID0gZGF0YS5kb2N0b3JfaWQ7CiAgICAgIHRoaXMuZG9jdG9yX25vID0gZGF0YS5kb2Nfbm87CiAgICAgIHRoaXMucmVmZmVyZWRfYnlfaWQgPSBkYXRhLnJlZmZlcmVkX2J5X2lkOwogICAgICB0aGlzLmlzUmVxdWVzdCA9IHRydWU7CiAgICAgIHRoaXMuZGF0YUxpc3QgPSBmYWxzZTsKICAgIH0sCiAgICBmb3JtYXREYXRlOiBmdW5jdGlvbiBmb3JtYXREYXRlKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CiAgICB9LAogICAgZm9ybWF0RGF0ZVRpbWU6IGZ1bmN0aW9uIGZvcm1hdERhdGVUaW1lKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIGg6bW06c3MgYSIpOwogICAgfSwKICAgIC8vIEludmVzdGlnYXRpb24gUmVxdWVzdAogICAgZ2V0SVBESW52ZXN0aWdhdGlvblJlcXVlc3RCeUFkbWlzc2lvbklkOiBmdW5jdGlvbiBnZXRJUERJbnZlc3RpZ2F0aW9uUmVxdWVzdEJ5QWRtaXNzaW9uSWQoYWRtaXNzaW9uX2lkKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy5pUERSZXF1ZXN0U2VydmljZS5nZXRJUERJbnZlc3RpZ2F0aW9uUmVxdWVzdEJ5QWRtaXNzaW9uSWQoYWRtaXNzaW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNS5pUERJbnZlc3RpZ2F0aW9uUmVxdWVzdExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIHByaW50SW52ZXN0aWdhdGlvblRva2VuOiBmdW5jdGlvbiBwcmludEludmVzdGlnYXRpb25Ub2tlbihpZCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHRoaXMucGF0aWVudFJlcG9ydFNlcnZpY2UuR2V0SW52ZXN0aWdhdGlvblRva2VuKGlkLCB0aGlzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNi5jb21tb25TZXJ2aWNlLkRvd25sb2FkZmlsZShkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBuZXdJbnZlc3RpZ2F0aW9uUmVxdWVzdDogZnVuY3Rpb24gbmV3SW52ZXN0aWdhdGlvblJlcXVlc3QoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlLmdldFByZXNjcmlwdGlvbkludmVzdGlnYXRpb25CeUFkbWlzc2lvbklkKHRoaXMuYWRtaXNzaW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNy5wcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgfSwKICAgIHByZXNjcmlwdGlvbkludmVzdGlnYXRpb246IGZ1bmN0aW9uIHByZXNjcmlwdGlvbkludmVzdGlnYXRpb24oZGF0YSkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHRoaXMubHN0UHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbiA9IFtdOwogICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczgubHN0UHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbi5wdXNoKHsKICAgICAgICAgIGFkbWlzc2lvbl9pZDogZWxlbWVudC5hZG1pc3Npb25faWQsCiAgICAgICAgICBpbnZlc3RpZ2F0aW9uX2lkOiBlbGVtZW50LmludmVzdGlnYXRpb25faWQsCiAgICAgICAgICBpbnZlc3RpbmdhdGlvbl9uYW1lOiBlbGVtZW50LmludmVzdGluZ2F0aW9uX25hbWUsCiAgICAgICAgICBpc0NoZWNrOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5pbnZlc3RpZ2F0aW9uUmVxdWVzdERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgaW52ZXN0aWdhdGlvblJlcXVlc3Q6IGZ1bmN0aW9uIGludmVzdGlnYXRpb25SZXF1ZXN0KCkgewogICAgICB0aGlzLmxzdFByZXNjcmlwdGlvbkludmVzdGlnYXRpb24gPSB0aGlzLmxzdFByZXNjcmlwdGlvbkludmVzdGlnYXRpb24uZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBlbC5pc0NoZWNrID09IHRydWU7CiAgICAgIH0sIHRoaXMpOwogICAgICB0aGlzLmdldEZvcm1hdHRlZFByZXNjcmlwdGlvbldpc2VJbnZlc3RpZ2F0aW9ucyh0aGlzLmxzdFByZXNjcmlwdGlvbkludmVzdGlnYXRpb24pOwogICAgfSwKICAgIGlQREludmVzdGlnYXRpb25SZXF1ZXN0U2F2ZTogZnVuY3Rpb24gaVBESW52ZXN0aWdhdGlvblJlcXVlc3RTYXZlKCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXM5LmlQREludmVzdGlnYXRpb25SZXF1ZXN0LmludmVzdGlnYXRpb25fcmVxdWVzdF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmIChfdGhpczkuaVBESW52ZXN0aWdhdGlvblJlcXVlc3QuYWRtaXNzaW9uX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOS5pUERSZXF1ZXN0U2VydmljZS5pUERJbnZlc3RpZ2F0aW9uUmVxdWVzdFNhdmUoX3RoaXM5LmlQREludmVzdGlnYXRpb25SZXF1ZXN0KTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczkuZ2V0SVBESW52ZXN0aWdhdGlvblJlcXVlc3RCeUFkbWlzc2lvbklkKF90aGlzOS5hZG1pc3Npb25faWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM5LnJlc2V0KCk7CgogICAgICAgICAgICAgICAgICBfdGhpczkuaGlkZURpYWxvZygpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM5LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE1OwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgwKTsKCiAgICAgICAgICAgICAgICBfdGhpczkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfY29udGV4dC50MCwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1swLCAxNV1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gUGhhcm1hY3kKICAgIGdldE1lZGljaW5lUmVxdWVzdExpc3RCeUFkbWlzc2lvbk5vOiBmdW5jdGlvbiBnZXRNZWRpY2luZVJlcXVlc3RMaXN0QnlBZG1pc3Npb25ObyhhZG1pc3Npb25fbm8pIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdGhpcy5tZWRpY2luZVJlcXVlc3RTZXJ2aWNlLmdldE1lZGljaW5lUmVxdWVzdExpc3RCeUFkbWlzc2lvbk5vKGFkbWlzc2lvbl9ubykudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczEwLmlQRE1lZGljaW5lUmVxdWVzdExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIHByaW50TWVkaWNpbmVSZXF1ZXN0OiBmdW5jdGlvbiBwcmludE1lZGljaW5lUmVxdWVzdChpZCkgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgICB0aGlzLmlQRFJlcG9ydFNlcnZpY2UuR2V0TWVkaWNpbmVSZXF1ZXN0VG9rZW4oaWQsIHRoaXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMS5jb21tb25TZXJ2aWNlLkRvd25sb2FkZmlsZShkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBuZXdNZWRpY2luZVJlcXVlc3Q6IGZ1bmN0aW9uIG5ld01lZGljaW5lUmVxdWVzdCgpIHsKICAgICAgdGhpcy5pUERNZWRpY2luZVJlcXVlc3QubHN0TWVkaWNpbmVSZXF1ZXN0RGV0YWlscyA9IFtdOwogICAgICB0aGlzLnBoYXJtYWN5ID0gdHJ1ZTsKICAgICAgdGhpcy5pc1JlcXVlc3QgPSBmYWxzZTsKICAgICAgdGhpcy5kYXRhTGlzdCA9IGZhbHNlOwogICAgfSwKICAgIHByZXNjcmliZU1lZGljaW5lOiBmdW5jdGlvbiBwcmVzY3JpYmVNZWRpY2luZSgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdGhpcy5pUERNZWRpY2luZVJlcXVlc3QuYWRtaXNzaW9uX3ByZXNjcmlwdGlvbl9pZCA9IG51bGw7CiAgICAgIHRoaXMuaVBEUHJlc2NyaXB0aW9uTWVkaWNpbmVMaXN0ID0gW107CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmVzY3JpcHRpb25Ob0J5QWRtaXNzaW9uSWQodGhpcy5hZG1pc3Npb25faWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5wcmVzY3JpcHRpb25ObyhkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBwcmVzY3JpcHRpb25ObzogZnVuY3Rpb24gcHJlc2NyaXB0aW9uTm8oZGF0YSkgewogICAgICB0aGlzLmlQRFByZXNjcmlwdGlvbkxpc3QgPSBkYXRhOwogICAgICB0aGlzLmlQRE1lZGljaW5lUmVxdWVzdERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgaGlkZU1lZGljaW5lUmVxdWVzdDogZnVuY3Rpb24gaGlkZU1lZGljaW5lUmVxdWVzdCgpIHsKICAgICAgdGhpcy5waGFybWFjeSA9IGZhbHNlOwogICAgICB0aGlzLmlzUmVxdWVzdCA9IHRydWU7CiAgICAgIHRoaXMuZGF0YUxpc3QgPSBmYWxzZTsKICAgIH0sCiAgICBnZXRQcmVzY3JpcHRpb25EYXRhOiBmdW5jdGlvbiBnZXRQcmVzY3JpcHRpb25EYXRhKCkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5pUERNZWRpY2luZVJlcXVlc3QuYWRtaXNzaW9uX3ByZXNjcmlwdGlvbl9pZCkgewogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmVzY3JpcHRpb25EYXRhQnlQcmVzY3JpcHRpb25JZCh0aGlzLmlQRE1lZGljaW5lUmVxdWVzdC5hZG1pc3Npb25fcHJlc2NyaXB0aW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMxMy5wcmVzY3JpcHRpb25EYXRhKGRhdGEuZGF0YSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBwcmVzY3JpcHRpb25EYXRhOiBmdW5jdGlvbiBwcmVzY3JpcHRpb25EYXRhKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgdGhpcy5pUERQcmVzY3JpcHRpb25NZWRpY2luZUxpc3QgPSBbXTsKICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxNC5pUERQcmVzY3JpcHRpb25NZWRpY2luZUxpc3QucHVzaCh7CiAgICAgICAgICBtZWRpY2luZV9pZDogZWxlbWVudC5tZWRpY2luZV9pZCwKICAgICAgICAgIG1lZGljaW5lX25hbWU6IGVsZW1lbnQubWVkaWNpbmVfbmFtZSwKICAgICAgICAgIGJhcmNvZGU6IGVsZW1lbnQuYmFyY29kZSwKICAgICAgICAgIHRyZWF0bWVudF9ydWxlX25hbWU6IGVsZW1lbnQudHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9uYW1lOiBlbGVtZW50LnRyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAgICAgdHJlYXRtZW50X2Rvc2VfbmFtZTogZWxlbWVudC50cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAgICAgbWVkaWNpbmVfZ2VuZXJpY19uYW1lOiBlbGVtZW50Lm1lZGljaW5lX2dlbmVyaWNfbmFtZSwKICAgICAgICAgIHN0cmdlbnRoOiBlbGVtZW50LnN0cmdlbnRoLAogICAgICAgICAgbWVkaWNpbmVfdHlwZV9uYW1lOiBlbGVtZW50Lm1lZGljaW5lX3R5cGVfbmFtZSwKICAgICAgICAgIHVvbV9uYW1lOiBlbGVtZW50LnVvbV9uYW1lLAogICAgICAgICAgbWFudWZhY3R1cmVyX25hbWU6IGVsZW1lbnQubWFudWZhY3R1cmVyX25hbWUsCiAgICAgICAgICByZXF1ZXN0X3F0eTogMSwKICAgICAgICAgIGlzQ2hlY2s6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIEFkZCBNZWRpY2luZQogICAgYWRkTmV3TWVkaWNpbmU6IGZ1bmN0aW9uIGFkZE5ld01lZGljaW5lKCkgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CgogICAgICB0aGlzLm1lZGljaW5lU2V0dXBTZXJ2aWNlLmdldEFsbCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxNS5nZXRNZWRpY2luZUxpc3QoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0TWVkaWNpbmVMaXN0OiBmdW5jdGlvbiBnZXRNZWRpY2luZUxpc3QoZGF0YSkgewogICAgICB0aGlzLm1lZGljaW5lTGlzdCA9IGRhdGE7CiAgICAgIHRoaXMuYWRkTWVkaWNpbmVEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIHNlYXJjaE1lZGljaW5lOiBmdW5jdGlvbiBzZWFyY2hNZWRpY2luZShldmVudCkgewogICAgICB2YXIgX3RoaXMxNiA9IHRoaXM7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWV2ZW50LnF1ZXJ5LnRyaW0oKS5sZW5ndGgpIHsKICAgICAgICAgIF90aGlzMTYuZmlsdGVyZWRJdGVtcyA9IF90b0NvbnN1bWFibGVBcnJheShfdGhpczE2Lm1lZGljaW5lTGlzdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIHN0YXJ0IHdpdGgKICAgICAgICAgIC8vIHRoaXMuZmlsdGVyZWRJdGVtcyA9IHRoaXMubWVkaWNpbmVMaXN0LmZpbHRlcigoaXRlbSkgPT4gewogICAgICAgICAgLy8gICAgIHJldHVybiBpdGVtLnRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgLy8gfSk7CiAgICAgICAgICAvLyBjb250YWlucwogICAgICAgICAgX3RoaXMxNi5maWx0ZXJlZEl0ZW1zID0gRmlsdGVyU2VydmljZS5maWx0ZXIoX3RoaXMxNi5tZWRpY2luZUxpc3QsIFsnbWVkaWNpbmVfbmFtZSddLCBldmVudC5xdWVyeS50b0xvd2VyQ2FzZSgpLCBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMpLnNsaWNlKDAsIDEwKTsKICAgICAgICB9CiAgICAgIH0sIDI1MCk7CiAgICB9LAogICAgYWRkUmVxdWVzdE1lZGljaW5lOiBmdW5jdGlvbiBhZGRSZXF1ZXN0TWVkaWNpbmUoKSB7CiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy5hZGRNZWRpY2luZS5kZGxtZWRpY2luZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy5hZGRNZWRpY2luZS5yZXF1ZXN0X3F0eSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlQRFByZXNjcmlwdGlvbk1lZGljaW5lTGlzdC5wdXNoKHsKICAgICAgICAgIG1lZGljaW5lX2lkOiB0aGlzLmFkZE1lZGljaW5lLmRkbG1lZGljaW5lLm1lZGljaW5lX2lkLAogICAgICAgICAgbWVkaWNpbmVfbmFtZTogdGhpcy5hZGRNZWRpY2luZS5kZGxtZWRpY2luZS5tZWRpY2luZV9uYW1lLAogICAgICAgICAgYmFyY29kZTogdGhpcy5hZGRNZWRpY2luZS5kZGxtZWRpY2luZS5iYXJjb2RlLAogICAgICAgICAgbWVkaWNpbmVfZ2VuZXJpY19uYW1lOiB0aGlzLmFkZE1lZGljaW5lLmRkbG1lZGljaW5lLl9tZWRpY2luZV9nZW5lcmljX25hbWUsCiAgICAgICAgICBzdHJnZW50aDogdGhpcy5hZGRNZWRpY2luZS5kZGxtZWRpY2luZS5zdHJnZW50aCwKICAgICAgICAgIG1lZGljaW5lX3R5cGVfbmFtZTogdGhpcy5hZGRNZWRpY2luZS5kZGxtZWRpY2luZS5fbWVkaWNpbmVfdHlwZV9uYW1lLAogICAgICAgICAgdW9tX25hbWU6IHRoaXMuYWRkTWVkaWNpbmUuZGRsbWVkaWNpbmUuX3VvbV9uYW1lLAogICAgICAgICAgbWVkaWNpbmVfbWFudWZhY3R1cmVyX25hbWU6IHRoaXMuYWRkTWVkaWNpbmUuZGRsbWVkaWNpbmUuX21hbnVmYWN0dXJlcl9uYW1lLAogICAgICAgICAgaXNDaGVjazogdHJ1ZSwKICAgICAgICAgIHJlcXVlc3RfcXR5OiB0aGlzLmFkZE1lZGljaW5lLnJlcXVlc3RfcXR5CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5zZXRSZXF1ZXN0TWVkaWNpbmUoKTsKICAgIH0sCiAgICBzZXRSZXF1ZXN0TWVkaWNpbmU6IGZ1bmN0aW9uIHNldFJlcXVlc3RNZWRpY2luZSgpIHsKICAgICAgdmFyIF90aGlzMTcgPSB0aGlzOwoKICAgICAgdmFyIGZpbHRlckRhdGEgPSB0aGlzLmlQRFByZXNjcmlwdGlvbk1lZGljaW5lTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIGVsLmlzQ2hlY2sgPT0gdHJ1ZTsKICAgICAgfSwgdGhpcyk7CiAgICAgIGZpbHRlckRhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIHZhciBhTWVkaWNpbmUgPSBfdGhpczE3LmlQRE1lZGljaW5lUmVxdWVzdC5sc3RNZWRpY2luZVJlcXVlc3REZXRhaWxzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5tZWRpY2luZV9pZCA9PT0gZWxlbWVudC5tZWRpY2luZV9pZDsKICAgICAgICB9LCBfdGhpczE3KTsKCiAgICAgICAgaWYgKCFhTWVkaWNpbmUubGVuZ3RoKSB7CiAgICAgICAgICBfdGhpczE3LmlQRE1lZGljaW5lUmVxdWVzdC5sc3RNZWRpY2luZVJlcXVlc3REZXRhaWxzLnB1c2goewogICAgICAgICAgICBtZWRpY2luZV9pZDogZWxlbWVudC5tZWRpY2luZV9pZCwKICAgICAgICAgICAgbWVkaWNpbmVfbmFtZTogZWxlbWVudC5tZWRpY2luZV9uYW1lLAogICAgICAgICAgICBiYXJjb2RlOiBlbGVtZW50LmJhcmNvZGUsCiAgICAgICAgICAgIHRyZWF0bWVudF9ydWxlX25hbWU6IGVsZW1lbnQudHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgICAgICAgdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IGVsZW1lbnQudHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9kb3NlX25hbWU6IGVsZW1lbnQudHJlYXRtZW50X2Rvc2VfbmFtZSwKICAgICAgICAgICAgbWVkaWNpbmVfZ2VuZXJpY19uYW1lOiBlbGVtZW50Lm1lZGljaW5lX2dlbmVyaWNfbmFtZSwKICAgICAgICAgICAgbWVkaWNpbmVfc3RyZ2VudGg6IGVsZW1lbnQuc3RyZ2VudGgsCiAgICAgICAgICAgIG1lZGljaW5lX3R5cGVfbmFtZTogZWxlbWVudC5tZWRpY2luZV90eXBlX25hbWUsCiAgICAgICAgICAgIG1lZGljaW5lX3VvbV9uYW1lOiBlbGVtZW50LnVvbV9uYW1lLAogICAgICAgICAgICBtZWRpY2luZV9tYW51ZmFjdHVyZXJfbmFtZTogZWxlbWVudC5tYW51ZmFjdHVyZXJfbmFtZSwKICAgICAgICAgICAgaXNDaGVjazogZWxlbWVudC5pc0NoZWNrLAogICAgICAgICAgICByZXF1ZXN0X3F0eTogZWxlbWVudC5yZXF1ZXN0X3F0eSA9PSAiIiB8fCBlbGVtZW50LnJlcXVlc3RfcXR5ID09IDAgPyAxIDogZWxlbWVudC5yZXF1ZXN0X3F0eQogICAgICAgICAgfSk7CgogICAgICAgICAgX3RoaXMxNy5oaWRlRGlhbG9nKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzMTcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgIHNldmVyaXR5OiAid2FybiIsCiAgICAgICAgICAgIHN1bW1hcnk6ICJXYXJuIE1lc3NhZ2UiLAogICAgICAgICAgICBkZXRhaWw6IGFNZWRpY2luZVswXS5tZWRpY2luZV9uYW1lICsgIiBhbHJlYWR5IGFkZGVkIiwKICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZGVsZXRlUmVxdWVzdE1lZGljaW5lOiBmdW5jdGlvbiBkZWxldGVSZXF1ZXN0TWVkaWNpbmUoZGF0YSkgewogICAgICB0aGlzLmlQRE1lZGljaW5lUmVxdWVzdC5sc3RNZWRpY2luZVJlcXVlc3REZXRhaWxzID0gdGhpcy5pUERNZWRpY2luZVJlcXVlc3QubHN0TWVkaWNpbmVSZXF1ZXN0RGV0YWlscy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIGVsLm1lZGljaW5lX2lkICE9IGRhdGEubWVkaWNpbmVfaWQ7CiAgICAgIH0sIHRoaXMpOwogICAgfSwKICAgIC8vIE1lZGljaW5lIFJlcXVlc3QKICAgIG1lZGljaW5lUmVxdWVzdDogZnVuY3Rpb24gbWVkaWNpbmVSZXF1ZXN0KCkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgYU1lZGljaW5lLCByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMDsKICAgICAgICAgICAgICAgIF90aGlzMTguaVBETWVkaWNpbmVSZXF1ZXN0Lmludm9pY2VfaWQgPSBfdGhpczE4Lmludm9pY2VfaWQ7CiAgICAgICAgICAgICAgICBfdGhpczE4LmlQRE1lZGljaW5lUmVxdWVzdC5hZG1pc3Npb25fbm8gPSBfdGhpczE4LmFkbWlzc2lvbl9ubzsKICAgICAgICAgICAgICAgIF90aGlzMTguaVBETWVkaWNpbmVSZXF1ZXN0LnBhdGllbnRfcmVnaXN0cmF0aW9uX25vID0gX3RoaXMxOC5yZWdpc3RyYXRpb25fbm87CiAgICAgICAgICAgICAgICBfdGhpczE4LmlQRE1lZGljaW5lUmVxdWVzdC5wYXRpZW50X25hbWUgPSBfdGhpczE4LnBhdGllbnRfbmFtZTsKICAgICAgICAgICAgICAgIGFNZWRpY2luZSA9IF90aGlzMTguaVBETWVkaWNpbmVSZXF1ZXN0LmxzdE1lZGljaW5lUmVxdWVzdERldGFpbHMuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZWwucmVxdWVzdF9xdHkgPT0gIiI7CiAgICAgICAgICAgICAgICB9LCBfdGhpczE4KTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxOC5pUERNZWRpY2luZVJlcXVlc3QuaW52b2ljZV9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxOC5pUERNZWRpY2luZVJlcXVlc3QuYWRtaXNzaW9uX25vKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczE4LmlQRE1lZGljaW5lUmVxdWVzdC5wYXRpZW50X3JlZ2lzdHJhdGlvbl9ubykgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxOC5pUERNZWRpY2luZVJlcXVlc3QucGF0aWVudF9uYW1lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgIGlmICghYU1lZGljaW5lLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogIlBsZWFzZSBlbnRlciBtZWRpY2luZSBxdHkiLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTguaVBETWVkaWNpbmVSZXF1ZXN0LmxzdE1lZGljaW5lUmVxdWVzdERldGFpbHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMTguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiUGxlYXNlIGFkZCBtZWRpY2luZSBmb3IgcmVxdWVzdCIsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTgubWVkaWNpbmVSZXF1ZXN0U2VydmljZS5hZGQoX3RoaXMxOC5pUERNZWRpY2luZVJlcXVlc3QsIF90aGlzMTgpOwoKICAgICAgICAgICAgICBjYXNlIDM0OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlJlcXVlc3QgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTguaGlkZU1lZGljaW5lUmVxdWVzdCgpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxOC5nZXRNZWRpY2luZVJlcXVlc3RMaXN0QnlBZG1pc3Npb25ObyhfdGhpczE4LmFkbWlzc2lvbl9ubyk7CgogICAgICAgICAgICAgICAgICBfdGhpczE4LnByaW50TWVkaWNpbmVSZXF1ZXN0KHJlc3VsdC5kYXRhKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTguJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0MTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDM4OgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAzODsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSgwKTsKCiAgICAgICAgICAgICAgICBfdGhpczE4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogX2NvbnRleHQyLnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbMCwgMzhdXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIGZvcm1hdEludmVzdGlnYXRpb25MaXN0KGRhdGEpIHsKICAgIC8vICAgICBsZXQgZmlsdGVyRGF0YSA9IGRhdGEuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgLy8gICAgICAgICByZXR1cm4gZWwuYWN0aXZlID09IHRydWU7CiAgICAvLyAgICAgfSwgdGhpcyk7CiAgICAvLyAgICAgZmlsdGVyRGF0YS5mb3JFYWNoKChlbGVtZW50KSA9PiB7CiAgICAvLyAgICAgICAgIHZhciBvYmogPSBlbGVtZW50OwogICAgLy8gICAgICAgICBvYmouaW52ZXN0aW5nYXRpb25fbmFtZSA9IGVsZW1lbnQubWFudWFsX2NvZGUgKyAiLSIgKyBlbGVtZW50LmludmVzdGluZ2F0aW9uX25hbWU7CiAgICAvLyAgICAgICAgIHRoaXMuaW52ZXN0aWdhdGlvbkxpc3QucHVzaChvYmopOwogICAgLy8gICAgIH0pOwogICAgLy8gfSwKICAgIC8vIG1lcmdlUmVmZXJyZWRCeUluZm8oZGF0YSkgewogICAgLy8gICAgIGxldCBmaWx0ZXJEYXRhID0gZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAvLyAgICAgICAgIHJldHVybiBlbC5hY3RpdmUgPT0gdHJ1ZTsKICAgIC8vICAgICB9LCB0aGlzKTsKICAgIC8vICAgICBmaWx0ZXJEYXRhLmZvckVhY2goKGVsZW1lbnQpID0+IHsKICAgIC8vICAgICAgICAgdGhpcy5yZWZlcnJlZEJ5TGlzdC5wdXNoKHsKICAgIC8vICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnJlZ2lzdHJhdGlvbl9ubywKICAgIC8vICAgICAgICAgICAgIHRleHQ6IGVsZW1lbnQubWFudWFsX2NvZGUgKyAiLSIgKyBlbGVtZW50LnJlZ2lzdHJhdGlvbl9ubyArICItIiArIGVsZW1lbnQucmVmZmVyZWRfYnlfbmFtZSArICIoUmVmZXJyZWQgQnkpIiwKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgLy8gbWVyZ2VEb2N0b3JJbmZvKGRhdGEpIHsKICAgIC8vICAgICAvL3RoaXMuZG9jdG9yTGlzdCA9IGRhdGE7CiAgICAvLyAgICAgZGF0YS5mb3JFYWNoKChlbGVtZW50KSA9PiB7CiAgICAvLyAgICAgICAgIHRoaXMucmVmZXJyZWRCeUxpc3QucHVzaCh7CiAgICAvLyAgICAgICAgICAgICB2YWx1ZTogZWxlbWVudC5kb2Nfbm8sCiAgICAvLyAgICAgICAgICAgICB0ZXh0OiBlbGVtZW50LmRvY19ubyArICItIiArIGVsZW1lbnQuZG9jdG9yX25hbWUgKyAiKERvY3RvcikiLAogICAgLy8gICAgICAgICB9KTsKICAgIC8vICAgICB9KTsKICAgIC8vICAgICBkYXRhLmZvckVhY2goKGVsZW1lbnQpID0+IHsKICAgIC8vICAgICAgICAgdGhpcy5kb2N0b3JMaXN0LnB1c2goewogICAgLy8gICAgICAgICAgICAgZGVwYXJ0bWVudF9pZDogZWxlbWVudC5kZXBhcnRtZW50X2lkLAogICAgLy8gICAgICAgICAgICAgZG9jdG9yX2lkOiBlbGVtZW50LmRvY3Rvcl9pZCwKICAgIC8vICAgICAgICAgICAgIGRvY3Rvcl9uYW1lOiBlbGVtZW50LmRvY19ubyArICItIiArIGVsZW1lbnQuZG9jdG9yX25hbWUsCiAgICAvLyAgICAgICAgIH0pOwogICAgLy8gICAgIH0pOwogICAgLy8gfSwKICAgIC8vIG1lcmdlRW1wbG95ZWVJbmZvKGRhdGEpIHsKICAgIC8vICAgICBsZXQgZmlsdGVyRGF0YSA9IGRhdGEuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgLy8gICAgICAgICByZXR1cm4gZWwuYWN0aXZlID09IHRydWU7CiAgICAvLyAgICAgfSwgdGhpcyk7CiAgICAvLyAgICAgZmlsdGVyRGF0YS5mb3JFYWNoKChlbGVtZW50KSA9PiB7CiAgICAvLyAgICAgICAgIHRoaXMucmVmZXJyZWRCeUxpc3QucHVzaCh7CiAgICAvLyAgICAgICAgICAgICB2YWx1ZTogZWxlbWVudC5lbXBfbm8sCiAgICAvLyAgICAgICAgICAgICB0ZXh0OiBlbGVtZW50LmVtcF9ubyArICItIiArIGVsZW1lbnQuZmlyc3RfbmFtZSArICIoRW1wbG95ZWUpIiwKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgLy8gbWVyZ2VEb2N0b3JJbmZvKGRhdGEpIHsKICAgIC8vICAgdGhpcy5kb2N0b3JMaXN0ID0gZGF0YTsKICAgIC8vICAgZGF0YS5mb3JFYWNoKChlbGVtZW50KSA9PiB7CiAgICAvLyAgICAgdGhpcy5kaXNjb3VudEJ5TGlzdC5wdXNoKHsKICAgIC8vICAgICAgIHZhbHVlOiBlbGVtZW50LmRvY19ubywKICAgIC8vICAgICAgIHRleHQ6IGVsZW1lbnQuZG9jX25vICsgIi0iICsgZWxlbWVudC5kb2N0b3JfbmFtZSArICIoRG9jdG9yKSIsCiAgICAvLyAgICAgfSk7CiAgICAvLyAgIH0pOwogICAgLy8gfSwKICAgIC8vIG1lcmdlRW1wbG95ZWVJbmZvKGRhdGEpIHsKICAgIC8vICAgZGF0YS5mb3JFYWNoKChlbGVtZW50KSA9PiB7CiAgICAvLyAgICAgdGhpcy5kaXNjb3VudEJ5TGlzdC5wdXNoKHsKICAgIC8vICAgICAgIHZhbHVlOiBlbGVtZW50LmVtcF9ubywKICAgIC8vICAgICAgIHRleHQ6IGVsZW1lbnQuZW1wX25vICsgIi0iICsgZWxlbWVudC5maXJzdF9uYW1lICsgIihFbXBsb3llZSkiLAogICAgLy8gICAgIH0pOwogICAgLy8gICB9KTsKICAgIC8vIH0sCiAgICAvLyBpbnZSZXNldCgpIHsKICAgIC8vICAgICB0aGlzLmlzSW52ZXN0aWdhdGlvbiA9IHRydWU7CiAgICAvLyAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGRsaW52ZXN0aWdhdGlvbiA9ICIiOwogICAgLy8gICAgIHRoaXMuaXNFeGlzdCA9ICIiOwogICAgLy8gfSwKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgLy90aGlzLmlzSW52ZXN0aWdhdGlvbiA9IHRydWU7CiAgICAgIC8vdGhpcy5pc1ByZXNjcmlwdGlvbiA9IGZhbHNlOwogICAgICAvL3RoaXMuYnV0dG9uID0gZmFsc2U7CiAgICAgIC8vdGhpcy5pc1ZhbGlkID0gIiI7CiAgICAgIC8vdGhpcy5pc0VtYWlsVmFsaWQgPSAiIjsKICAgICAgdGhpcy5pc0V4aXN0ID0gIiI7IC8vdGhpcy5pc0NvbnRhY3RFeGlzdCA9ICIiOwoKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QgPSB7CiAgICAgICAgcGF0aWVudF9pZDogIiIsCiAgICAgICAgYVBhdGllbnQ6IHsKICAgICAgICAgIGFnZV95ZWFyOiAiMCIsCiAgICAgICAgICBhZ2VfbW9udGg6ICIwIiwKICAgICAgICAgIGFnZV9kYXk6ICIwIgogICAgICAgIH0sCiAgICAgICAgY2RpbnZlc3RpZ2F0aW9uX3JlcXVlc3RfZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgcmVwb3J0X2RlbGl2ZXJ5X3R5cGU6ICJSZWd1bGFyIiwKICAgICAgICBsc3RJbnZlc3RpZ2F0aW9uUmVxdWVzdERldGFpbHM6IFtdLAogICAgICAgIGxzdEludmVzdGlnYXRpb25QYXJ0aWN1bGFyOiBbXSwKICAgICAgICBkaXNjb3VudF9ieV9pZDogIkNvbXBhbnkiLAogICAgICAgIGRpc2NvdW50X3BlcmNlbnQ6IDAsCiAgICAgICAgZGlzY291bnRfYW1vdW50OiAwLAogICAgICAgIGNvc3RfcHJpY2U6IDAsCiAgICAgICAgcGFydGljdWxhcl9jb3N0X3ByaWNlOiAwLAogICAgICAgIHRvdGFsX2Ftb3VudDogMAogICAgICB9OwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgICB0aGlzLmlQREludmVzdGlnYXRpb25SZXF1ZXN0ID0gewogICAgICAgIGludmVzdGlnYXRpb25fcmVxdWVzdF9pZDogbnVsbCwKICAgICAgICBhZG1pc3Npb25faWQ6IG51bGwKICAgICAgfTsKICAgIH0sCiAgICAvLyBkb2N0b3JSZXNldCgpIHsKICAgIC8vICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZXBhcnRtZW50X2lkID0gIiI7CiAgICAvLyAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QucmVmZmVyZWRfZG9jdG9yX2lkID0gIiI7CiAgICAvLyAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGVzaWduYXRpb25faWQgPSAiIjsKICAgIC8vICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5vdXRzaWRlX2RvY3Rvcl9uYW1lID0gIiI7CiAgICAvLyAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3Qub3V0c2lkZV9kb2N0b3JfaG9zcGl0YWxfbmFtZSA9ICIiOwogICAgLy8gfSwKICAgIC8vIGZpbHRlckRvY3RvcnNEZXBhcnRtZW50V2lzZSgpIHsKICAgIC8vICAgICByZXR1cm4gdGhpcy5kb2N0b3JMaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgIC8vICAgICAgICAgcmV0dXJuICgKICAgIC8vICAgICAgICAgICAgIGVsLmRlcGFydG1lbnRfaWQgPT09IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRlcGFydG1lbnRfaWQKICAgIC8vICAgICAgICAgKTsKICAgIC8vICAgICB9LCB0aGlzKTsKICAgIC8vIH0sCiAgICAvLyBnZXRDb25zdWx0YW5jeUZlZUJ5RG9jdG9ySWQoKSB7CiAgICAvLyAgICAgdmFyIGFEb2N0b3IgPSB0aGlzLmRvY3Rvckxpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgLy8gICAgICAgICByZXR1cm4gZWwuZG9jdG9yX2lkID09PSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kb2N0b3JfaWQ7CiAgICAvLyAgICAgfSwgdGhpcyk7CiAgICAvLyAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuY29uc3VsdGFuY3lfZmVlID0KICAgIC8vICAgICAgICAgYURvY3RvclswXS5jb25zdWx0YW5jeV9mZWU7CiAgICAvLyAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYnVpbGRpbmdfaWQgPSBhRG9jdG9yWzBdLl9idWlsZGluZ19pZDsKICAgIC8vICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5yb29tX2lkID0gYURvY3RvclswXS5yb29tX2lkOwogICAgLy8gfSwKICAgIC8vIGZpbHRlclJvb21zQnVpbGRpbmdXaXNlKCkgewogICAgLy8gICAgIHJldHVybiB0aGlzLnJvb21MaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgIC8vICAgICAgICAgcmV0dXJuIGVsLmJ1aWxkaW5nX2lkID09PSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5idWlsZGluZ19pZDsKICAgIC8vICAgICB9LCB0aGlzKTsKICAgIC8vIH0sCiAgICAvLyBmaWx0ZXJJbnZlc3RpZ2F0aW9uKCkgewogICAgLy8gICAgIHJldHVybiB0aGlzLmludmVzdGlnYXRpb25MaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgIC8vICAgICAgICAgcmV0dXJuIGVsLmFjdGl2ZSA9PSB0cnVlOwogICAgLy8gICAgIH0sIHRoaXMpOwogICAgLy8gfSwKICAgIC8vIGZpbHRlclByb2R1Y3QoKSB7CiAgICAvLyAgICAgcmV0dXJuIHRoaXMucHJvZHVjdExpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgLy8gICAgICAgICByZXR1cm4gZWwucHJvZHVjdF9jYXRlZ29yeV9pZCA9PSAxICYmIGVsLmFjdGl2ZSA9PSB0cnVlOwogICAgLy8gICAgIH0sIHRoaXMpOwogICAgLy8gfSwKICAgIC8vIGdldEZvcm1hdHRlZChkYXRhKSB7CiAgICAvLyAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQgPSBkYXRhOwogICAgLy8gICAgIGlmICghdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQucGF0aWVudF9pZCkgewogICAgLy8gICAgICAgICB0aGlzLmlzUGF0aWVudEV4aXN0ID0gIlBhdGllbnQgbm90IEV4aXN0ISI7CiAgICAvLyAgICAgICAgIC8vIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0ID0gewogICAgLy8gICAgICAgICAvLyAgIHBhdGllbnRfaWQ6ICIiLAogICAgLy8gICAgICAgICAvLyAgIGFQYXRpZW50OiB7fSwKICAgIC8vICAgICAgICAgLy8gfTsKICAgIC8vICAgICAgICAgdGhpcy5yZXNldCgpOwogICAgLy8gICAgIH0gZWxzZSB7CiAgICAvLyAgICAgICAgIHRoaXMuaXNQYXRpZW50RXhpc3QgPSAiIjsKICAgIC8vICAgICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QucGF0aWVudF9pZCA9CiAgICAvLyAgICAgICAgICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5wYXRpZW50X2lkOwogICAgLy8gICAgICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5jZGRvYiA9IG1vbWVudCgKICAgIC8vICAgICAgICAgICAgIFN0cmluZyh0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5kb2IpCiAgICAvLyAgICAgICAgICkuZm9ybWF0KCJZWVlZLU1NLUREIik7CiAgICAvLyAgICAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV95ZWFyID0gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuYWdlX3llYXIudG9TdHJpbmcoKTsKICAgIC8vICAgICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuYWdlX21vbnRoID0gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuYWdlX21vbnRoLnRvU3RyaW5nKCk7CiAgICAvLyAgICAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV9kYXkgPSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5hZ2VfZGF5LnRvU3RyaW5nKCk7CiAgICAvLyAgICAgfQogICAgLy8gfSwKICAgIGdldEZvcm1hdHRlZFByZXNjcmlwdGlvbldpc2VJbnZlc3RpZ2F0aW9uczogZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkUHJlc2NyaXB0aW9uV2lzZUludmVzdGlnYXRpb25zKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMTkgPSB0aGlzOwoKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYWRtaXNzaW9uX2lkID0gZGF0YVswXS5hZG1pc3Npb25faWQ7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmZpcnN0X25hbWUgPSAiSVBEIjsKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuY29udGFjdF9ubyA9ICIwMTciOwogICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5wYXRpZW50X2lkID0gdGhpcy5wYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5yZWZmZXJlZF9kb2N0b3JfaWQgPSB0aGlzLmRvY3Rvcl9pZDsKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QucmVmZmVyZWRfYnlfaWQgPSB0aGlzLnJlZmZlcmVkX2J5X2lkOyAvLyB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5hZ2VfeWVhciA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV95ZWFyLnRvU3RyaW5nKCk7CiAgICAgIC8vIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV9tb250aCA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV9tb250aC50b1N0cmluZygpOwogICAgICAvLyB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5hZ2VfZGF5ID0gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuYWdlX2RheS50b1N0cmluZygpOwogICAgICAvLyB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZXBhcnRtZW50X2lkID0gZGF0YVswXS5kZXBhcnRtZW50X2lkOwogICAgICAvLyB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5yZWZmZXJlZF9kb2N0b3JfaWQgPSBkYXRhWzBdLmRvY3Rvcl9pZDsKICAgICAgLy8gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QucmVmZmVyZWRfYnlfaWQgPSBkYXRhWzBdLmRvY19ubzsKICAgICAgLy90aGlzLmlzUHJlc2NyaXB0aW9uID0gdHJ1ZTsKCiAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIHZhciBhSW52ZXN0aWdhdGlvbiA9IF90aGlzMTkuaW52ZXN0aWdhdGlvbkxpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmludmVzdGlnYXRpb25faWQgPT09IGVsZW1lbnQuaW52ZXN0aWdhdGlvbl9pZDsKICAgICAgICB9LCBfdGhpczE5KVswXTsKCiAgICAgICAgX3RoaXMxOS5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGRsaW52ZXN0aWdhdGlvbiA9IGFJbnZlc3RpZ2F0aW9uOwoKICAgICAgICBfdGhpczE5LmFkZEludmVzdGlnYXRpb24oKTsKICAgICAgfSk7CiAgICAgIHRoaXMuYWRkKCk7CiAgICB9LAogICAgLy8gZmluZFBhdGllbnQoKSB7CiAgICAvLyAgICAgbGV0IHN0ciA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvbnRhY3RPclJlZ05vOwogICAgLy8gICAgIGlmIChzdHIuc3RhcnRzV2l0aCgiUFJFUyIpKSB7CiAgICAvLyAgICAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlCiAgICAvLyAgICAgICAgICAgICAucHJlc2NyaXB0aW9uV2lzZUludmVzdGlnYXRpb25zKHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvbnRhY3RPclJlZ05vLCB0aGlzKQogICAgLy8gICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHRoaXMuZ2V0Rm9ybWF0dGVkUHJlc2NyaXB0aW9uV2lzZUludmVzdGlnYXRpb25zKGRhdGEuZGF0YSkpOwogICAgLy8gICAgIH0gZWxzZSB7CiAgICAvLyAgICAgICAgIHRoaXMuaXNQcmVzY3JpcHRpb24gPSBmYWxzZTsKICAgIC8vICAgICAgICAgdGhpcy5wYXRpZW50UmVnaXN0cmF0aW9uU2VydmljZQogICAgLy8gICAgICAgICAgICAgLmdldEJ5Q29udGFjdE9yUmVnTm8odGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuY29udGFjdE9yUmVnTm8sIHRoaXMpCiAgICAvLyAgICAgICAgICAgICAudGhlbigoZGF0YSkgPT4gdGhpcy5nZXRGb3JtYXR0ZWQoZGF0YS5kYXRhKSk7CiAgICAvLyAgICAgfQogICAgLy8gfSwKICAgIC8vIGlzRXhpc3RDb250YWN0KCkgewogICAgLy8gICAgIGlmICgKICAgIC8vICAgICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuY29udGFjdF9uby5tYXRjaCgKICAgIC8vICAgICAgICAgICAgIC9eKDAxKShbMC05XXs5fSkkLwogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgKSB7CiAgICAvLyAgICAgICAgIHRoaXMucGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UKICAgIC8vICAgICAgICAgICAgIC5nZXRCeUNvbnRhY3RPclJlZ05vKAogICAgLy8gICAgICAgICAgICAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmNvbnRhY3Rfbm8sIHRoaXMKICAgIC8vICAgICAgICAgICAgICkKICAgIC8vICAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB0aGlzLmdldENvbnRhY3QoZGF0YS5kYXRhKSk7CiAgICAvLyAgICAgfSBlbHNlIHsKICAgIC8vICAgICAgICAgdGhpcy5pc0NvbnRhY3RFeGlzdCA9CiAgICAvLyAgICAgICAgICAgICAiQ29udGFjdCBudW1iZXIgbXVzdCBzdGFydCB3aXRoIDAxIGFuZCB0aGUgcmVxdWlyZWQgbGVuZ3RoIGlzIDExIjsKICAgIC8vICAgICB9CiAgICAvLyB9LAogICAgLy8gZ2V0Q29udGFjdChkYXRhKSB7CiAgICAvLyAgICAgaWYgKGRhdGEuY29udGFjdF9ubykgewogICAgLy8gICAgICAgICB0aGlzLmlzQ29udGFjdEV4aXN0ID0gIkR1cGxpY2F0ZSBwaG9uZSBudW1iZXIhIjsKICAgIC8vICAgICB9IGVsc2UgewogICAgLy8gICAgICAgICB0aGlzLmlzQ29udGFjdEV4aXN0ID0gIiI7CiAgICAvLyAgICAgfQogICAgLy8gfSwKICAgIGludmVzdGlnYXRpb25Jc0V4aXN0OiBmdW5jdGlvbiBpbnZlc3RpZ2F0aW9uSXNFeGlzdCgpIHsKICAgICAgdmFyIGFJbnZlc3RpZ2F0aW9uID0gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QubHN0SW52ZXN0aWdhdGlvblJlcXVlc3REZXRhaWxzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwuaW52ZXN0aWdhdGlvbl9pZCA9PT0gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGRsaW52ZXN0aWdhdGlvbi5pbnZlc3RpZ2F0aW9uX2lkOwogICAgICB9LCB0aGlzKTsKCiAgICAgIGlmIChhSW52ZXN0aWdhdGlvbi5sZW5ndGgpIHsKICAgICAgICB0aGlzLmlzRXhpc3QgPSAiVGhpcyBJbnZlc3RpZ2F0aW9uIGFscmVhZHkgYWRkZWQiOwogICAgICAgIHRoaXMuaXNJbnZlc3RpZ2F0aW9uID0gdHJ1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gdmFyIGFJbnYgPSB0aGlzLmludmVzdGlnYXRpb25MaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAvLyAgIHJldHVybiAoCiAgICAgICAgLy8gICAgIGVsLmludmVzdGlnYXRpb25faWQgPT09CiAgICAgICAgLy8gICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRkbGludmVzdGlnYXRpb24uaW52ZXN0aWdhdGlvbl9pZAogICAgICAgIC8vICAgKTsKICAgICAgICAvLyB9LCB0aGlzKTsKICAgICAgICAvLyB0aGlzLmNvbGxlY3Rpb25DZW50ZXJTZXR1cFNlcnZpY2UKICAgICAgICAvLyAgIC5nZXRCeUlkKGFJbnZbMF0uY29sbGVjdGlvbl9jZW50ZXJfaWQpCiAgICAgICAgLy8gICAudGhlbigoZGF0YSkgPT4gKHRoaXMuY29sbGVjdGlvbkxpc3QgPSBkYXRhLmRhdGEpKTsKICAgICAgICB0aGlzLmlzRXhpc3QgPSAiIjsKICAgICAgICB0aGlzLmlzSW52ZXN0aWdhdGlvbiA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgYWRkSW52ZXN0aWdhdGlvbjogZnVuY3Rpb24gYWRkSW52ZXN0aWdhdGlvbigpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICB2YXIgYUludmVzdGlnYXRpb24gPSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5sc3RJbnZlc3RpZ2F0aW9uUmVxdWVzdERldGFpbHMuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBlbC5pbnZlc3RpZ2F0aW9uX2lkID09PSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZGxpbnZlc3RpZ2F0aW9uLmludmVzdGlnYXRpb25faWQ7CiAgICAgIH0sIHRoaXMpOwoKICAgICAgaWYgKGFJbnZlc3RpZ2F0aW9uLmxlbmd0aCkgewogICAgICAgIHRoaXMuaXNFeGlzdCA9ICJUaGlzIEludmVzdGlnYXRpb24gYWxyZWFkeSBhZGRlZCI7IC8vdGhpcy5pc0ludmVzdGlnYXRpb24gPSB0cnVlOwoKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKCF0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZGxpbnZlc3RpZ2F0aW9uKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QucmVwb3J0X2RlbGl2ZXJ5X3R5cGUpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5jZGludmVzdGlnYXRpb25fcmVxdWVzdF9kYXRlKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuaXNFeGlzdCA9ICIiOwogICAgICAgICAgdmFyIGNvc3QgPSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5yZXBvcnRfZGVsaXZlcnlfdHlwZSA9PSAiUmVndWxhciIgPyB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZGxpbnZlc3RpZ2F0aW9uLmNoYXJnZSA6IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRkbGludmVzdGlnYXRpb24udXJnZW50X2NhcmdlOwogICAgICAgICAgdmFyIGRlbGl2ZXJ5VGltZSA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LnJlcG9ydF9kZWxpdmVyeV90eXBlID09ICJSZWd1bGFyIiA/IHRoaXMuZXhwZWN0ZWRIb3VyKHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRkbGludmVzdGlnYXRpb24ucmVwb3J0X2RlbGl2ZXJ5X2R1cmF0aW9uKSA6IHRoaXMuZXhwZWN0ZWRIb3VyKHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRkbGludmVzdGlnYXRpb24uZW1tZXJnZW5jeV9yZXBvcnRfZGVsaXZlcnlfZHVyYXRpb24pOwogICAgICAgICAgdmFyIGRpc2NvdW50QW1vdW50ID0gMSAqIGNvc3QgKiB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZGxpbnZlc3RpZ2F0aW9uLmRpc2NvdW50X3BlcmNlbnQgLyAxMDA7CiAgICAgICAgICB2YXIgdG90YWxBbW91bnQgPSAxICogY29zdCAtIGRpc2NvdW50QW1vdW50OwogICAgICAgICAgdmFyIG9iaiA9IHsKICAgICAgICAgICAgaW52ZXN0aWdhdGlvbl9pZDogdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGRsaW52ZXN0aWdhdGlvbi5pbnZlc3RpZ2F0aW9uX2lkLAogICAgICAgICAgICBfaW52ZXN0aW5nYXRpb25fbmFtZTogdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGRsaW52ZXN0aWdhdGlvbi5pbnZlc3RpbmdhdGlvbl9uYW1lLAogICAgICAgICAgICBfaW52ZXN0aWdhdGlvbl9jYXRlZ29yeV9oZWFkX25hbWU6IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRkbGludmVzdGlnYXRpb24uX2ludmVzdGlnYXRpb25fY2F0ZWdvcnlfaGVhZF9uYW1lLAogICAgICAgICAgICAvLyBidWlsZGluZ19pZDogdGhpcy5jb2xsZWN0aW9uTGlzdC5fYnVpbGRpbmdfaWQsCiAgICAgICAgICAgIC8vIF9idWlsZGluZ19uYW1lOiB0aGlzLmNvbGxlY3Rpb25MaXN0Ll9idWlsZGluZ19uYW1lLAogICAgICAgICAgICAvLyByb29tX2lkOiB0aGlzLmNvbGxlY3Rpb25MaXN0LnJvb21faWQsCiAgICAgICAgICAgIC8vIF9yb29tX25hbWU6IHRoaXMuY29sbGVjdGlvbkxpc3QuX3Jvb21fbmFtZSwKICAgICAgICAgICAgYnVpbGRpbmdfaWQ6IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRkbGludmVzdGlnYXRpb24uX2J1aWxkaW5nX2lkLAogICAgICAgICAgICByb29tX2lkOiB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZGxpbnZlc3RpZ2F0aW9uLl9yb29tX2lkLAogICAgICAgICAgICBleHBlY3RlZF9kZWxpdmVyeTogZGVsaXZlcnlUaW1lLAogICAgICAgICAgICByZXBvcnRfZGVsaXZlcnlfdHlwZTogdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QucmVwb3J0X2RlbGl2ZXJ5X3R5cGUsCiAgICAgICAgICAgIHF1YW50aXR5OiAxLAogICAgICAgICAgICBjb3N0X3ByaWNlOiBjb3N0LAogICAgICAgICAgICBkaXNjb3VudF9wZXJjZW50OiB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kZGxpbnZlc3RpZ2F0aW9uLmRpc2NvdW50X3BlcmNlbnQsCiAgICAgICAgICAgIGRpc2NvdW50X2Ftb3VudDogZGlzY291bnRBbW91bnQsCiAgICAgICAgICAgIHRvdGFsX2Ftb3VudDogdG90YWxBbW91bnQKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5sc3RJbnZlc3RpZ2F0aW9uUmVxdWVzdERldGFpbHMucHVzaChvYmopOwogICAgICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuY29zdF9wcmljZSA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvc3RfcHJpY2UgKyB0b3RhbEFtb3VudDsgLy8KCiAgICAgICAgICB0aGlzLmNhbGN1bGF0ZVRvdGFsQW1vdW50KCk7IC8vIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LnRvdGFsX2Ftb3VudCA9CiAgICAgICAgICAvLyAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvc3RfcHJpY2UgLQogICAgICAgICAgLy8gICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kaXNjb3VudF9hbW91bnQ7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFkZFBhcnRpY3VsYXIodGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGRsaW52ZXN0aWdhdGlvbi5pbnZlc3RpZ2F0aW9uX2lkKTsKICAgIH0sCiAgICBjYWxjdWxhdGVQZXJJbnZlc3RpZ2F0aW9uRGlzY291bnRQZXJjZW50OiBmdW5jdGlvbiBjYWxjdWxhdGVQZXJJbnZlc3RpZ2F0aW9uRGlzY291bnRQZXJjZW50KGRhdGEpIHsKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QubHN0SW52ZXN0aWdhdGlvblJlcXVlc3REZXRhaWxzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBpZiAoZWxlbWVudC5pbnZlc3RpZ2F0aW9uX2lkID09IGRhdGEuaW52ZXN0aWdhdGlvbl9pZCkgewogICAgICAgICAgZWxlbWVudC5kaXNjb3VudF9wZXJjZW50ID0gZWxlbWVudC5kaXNjb3VudF9hbW91bnQgLyBlbGVtZW50LmNvc3RfcHJpY2UgKiAxMDA7IC8vdmFyIGRpc2NvdW50X2Ftb3VudCA9IChlbGVtZW50LmNvc3RfcHJpY2UgKiBlbGVtZW50LmRpc2NvdW50X3BlcmNlbnQpIC8gMTAwOwoKICAgICAgICAgIGVsZW1lbnQudG90YWxfYW1vdW50ID0gZWxlbWVudC5jb3N0X3ByaWNlIC0gZWxlbWVudC5kaXNjb3VudF9hbW91bnQ7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5jYWxjdWxhdGVDb3N0UHJpY2UoKTsKICAgIH0sCiAgICBjYWxjdWxhdGVQZXJJbnZlc3RpZ2F0aW9uRGlzY291bnRBbW91bnQ6IGZ1bmN0aW9uIGNhbGN1bGF0ZVBlckludmVzdGlnYXRpb25EaXNjb3VudEFtb3VudChkYXRhKSB7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25SZXF1ZXN0RGV0YWlscy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgaWYgKGVsZW1lbnQuaW52ZXN0aWdhdGlvbl9pZCA9PSBkYXRhLmludmVzdGlnYXRpb25faWQpIHsKICAgICAgICAgIGVsZW1lbnQuZGlzY291bnRfYW1vdW50ID0gZWxlbWVudC5jb3N0X3ByaWNlICogZWxlbWVudC5kaXNjb3VudF9wZXJjZW50IC8gMTAwOwogICAgICAgICAgZWxlbWVudC50b3RhbF9hbW91bnQgPSBlbGVtZW50LmNvc3RfcHJpY2UgLSBlbGVtZW50LmRpc2NvdW50X2Ftb3VudDsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmNhbGN1bGF0ZUNvc3RQcmljZSgpOwogICAgfSwKICAgIGNhbGN1bGF0ZUNvc3RQcmljZTogZnVuY3Rpb24gY2FsY3VsYXRlQ29zdFByaWNlKCkgewogICAgICB2YXIgY29zdFByaWNlID0gMDsKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QubHN0SW52ZXN0aWdhdGlvblJlcXVlc3REZXRhaWxzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBjb3N0UHJpY2UgPSBjb3N0UHJpY2UgKyBlbGVtZW50LnRvdGFsX2Ftb3VudDsKICAgICAgfSk7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvc3RfcHJpY2UgPSBjb3N0UHJpY2U7CiAgICAgIHRoaXMuY2FsY3VsYXRlVG90YWxBbW91bnQoKTsKICAgIH0sCiAgICBjYWxjdWxhdGVUb3RhbEFtb3VudDogZnVuY3Rpb24gY2FsY3VsYXRlVG90YWxBbW91bnQoKSB7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LnRvdGFsX2Ftb3VudCA9IE1hdGguY2VpbCh0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5jb3N0X3ByaWNlIC0gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGlzY291bnRfYW1vdW50ICsgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QucGFydGljdWxhcl9jb3N0X3ByaWNlKTsKICAgIH0sCiAgICBhZGRQYXJ0aWN1bGFyOiBmdW5jdGlvbiBhZGRQYXJ0aWN1bGFyKGlkKSB7CiAgICAgIHZhciBfdGhpczIwID0gdGhpczsKCiAgICAgIHRoaXMuaW52ZXN0aWdhdGlvblNldHVwU2VydmljZS5nZXRCeUlkKGlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjAuZ2V0UGFydGljdWxhckZvcm1hdHRlZChkYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgYWRkQVBhcnRpY3VsYXI6IGZ1bmN0aW9uIGFkZEFQYXJ0aWN1bGFyKGRhdGEsIHF0eSwgcG5hbWUpIHsKICAgICAgaWYgKHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25SZXF1ZXN0RGV0YWlscy5sZW5ndGggPD0gMCkgewogICAgICAgIHRoaXMuaXNFeGlzdCA9ICJBZGQgSW52ZXN0aWdhdGlvbiI7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNFeGlzdCA9ICIiOwogICAgICAgIHZhciBvYmogPSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5sc3RJbnZlc3RpZ2F0aW9uUGFydGljdWxhci5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwucHJvZHVjdF9pZCA9PT0gZGF0YS5wcm9kdWN0X2lkOwogICAgICAgIH0sIHRoaXMpWzBdOwoKICAgICAgICBpZiAob2JqKSB7CiAgICAgICAgICBxdHkgPSBwYXJzZUludChvYmoucXR5KSArIHF0eTsKICAgICAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25QYXJ0aWN1bGFyID0gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QubHN0SW52ZXN0aWdhdGlvblBhcnRpY3VsYXIuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICByZXR1cm4gZWwucHJvZHVjdF9pZCAhPSBkYXRhLnByb2R1Y3RfaWQ7CiAgICAgICAgICB9LCB0aGlzKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25QYXJ0aWN1bGFyLnB1c2goewogICAgICAgICAgcHJvZHVjdF9pZDogZGF0YS5wcm9kdWN0X2lkLAogICAgICAgICAgX3Byb2R1Y3RfbmFtZTogcG5hbWUsCiAgICAgICAgICB1b21faWQ6IGRhdGEudW9tX2lkLAogICAgICAgICAgX3VvbV9uYW1lOiBkYXRhLl91b21fbmFtZSwKICAgICAgICAgIGNvc3RfcHJpY2U6IGRhdGEuY29zdF9wcmljZSwKICAgICAgICAgIHF0eTogcXR5CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5jaGVja1F0eSgpOwogICAgICB9CiAgICB9LAogICAgZ2V0UGFydGljdWxhckZvcm1hdHRlZDogZnVuY3Rpb24gZ2V0UGFydGljdWxhckZvcm1hdHRlZChkYXRhKSB7CiAgICAgIHZhciBfdGhpczIxID0gdGhpczsKCiAgICAgIGRhdGEuZGF0YS5fbHN0SW52ZXN0aWdhdGlvblBhcnRpY3VsYXIuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIC8vIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25QYXJ0aWN1bGFyLnB1c2goewogICAgICAgIC8vICAgaW52ZXN0aWdhdGlvbl9pZDogZWxlbWVudC5pbnZlc3RpZ2F0aW9uX2lkLAogICAgICAgIC8vICAgcHJvZHVjdF9pZDogZWxlbWVudC5wcm9kdWN0X2lkLAogICAgICAgIC8vICAgX3Byb2R1Y3RfbmFtZTogZWxlbWVudC5fcHJvZHVjdF9uYW1lLAogICAgICAgIC8vICAgdW9tX2lkOiBlbGVtZW50LnVvbV9pZCwKICAgICAgICAvLyAgIF91b21fbmFtZTogZWxlbWVudC5fdW9tX25hbWUsCiAgICAgICAgLy8gICBjb3N0X3ByaWNlOiBlbGVtZW50LmNvc3RfcHJpY2UsCiAgICAgICAgLy8gICBxdHk6IGVsZW1lbnQucXR5LAogICAgICAgIC8vIH0pOwogICAgICAgIF90aGlzMjEuYWRkQVBhcnRpY3VsYXIoZWxlbWVudCwgMSwgZWxlbWVudC5fcHJvZHVjdF9uYW1lKTsKICAgICAgfSk7CiAgICB9LAogICAgY2hlY2tRdHk6IGZ1bmN0aW9uIGNoZWNrUXR5KCkgewogICAgICB2YXIgX3RoaXMyMiA9IHRoaXM7CgogICAgICB2YXIgdG90YWxQcmljZSA9IDA7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25QYXJ0aWN1bGFyLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBpZiAoZWxlbWVudC5xdHkgPiBfdGhpczIyLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5sc3RJbnZlc3RpZ2F0aW9uUmVxdWVzdERldGFpbHMubGVuZ3RoKSB7CiAgICAgICAgICBlbGVtZW50LnF0eSA9IF90aGlzMjIucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25SZXF1ZXN0RGV0YWlscy5sZW5ndGg7CiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50LnF0eSA8PSAwKSB7CiAgICAgICAgICBlbGVtZW50LnF0eSA9IDE7CiAgICAgICAgfQoKICAgICAgICBlbGVtZW50LnRvdGFsUHJpY2UgPSBlbGVtZW50LnF0eSAqIGVsZW1lbnQuY29zdF9wcmljZTsKICAgICAgICB0b3RhbFByaWNlICs9IGVsZW1lbnQudG90YWxQcmljZTsKICAgICAgfSk7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LnBhcnRpY3VsYXJfY29zdF9wcmljZSA9IHRvdGFsUHJpY2U7CiAgICAgIHRoaXMuY2FsY3VsYXRlVG90YWxBbW91bnQoKTsKICAgIH0sCiAgICBnZXREaXNjb3VudFBlcmNlbnQ6IGZ1bmN0aW9uIGdldERpc2NvdW50UGVyY2VudCgpIHsKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGlzY291bnRfcGVyY2VudCA9IE1hdGguY2VpbCh0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kaXNjb3VudF9hbW91bnQgLyB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5jb3N0X3ByaWNlICogMTAwKTsgLy8gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QudG90YWxfYW1vdW50ID0gTWF0aC5jZWlsKAogICAgICAvLyAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvc3RfcHJpY2UgLQogICAgICAvLyAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRpc2NvdW50X2Ftb3VudCk7CgogICAgICB0aGlzLmNhbGN1bGF0ZVRvdGFsQW1vdW50KCk7CiAgICB9LAogICAgZ2V0RGlzY291bnRBbW91bnQ6IGZ1bmN0aW9uIGdldERpc2NvdW50QW1vdW50KCkgewogICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5kaXNjb3VudF9hbW91bnQgPSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5jb3N0X3ByaWNlICogdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuZGlzY291bnRfcGVyY2VudCAvIDEwMDsgLy8gdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QudG90YWxfYW1vdW50ID0gTWF0aC5jZWlsKAogICAgICAvLyAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvc3RfcHJpY2UgLQogICAgICAvLyAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmRpc2NvdW50X2Ftb3VudCk7CgogICAgICB0aGlzLmNhbGN1bGF0ZVRvdGFsQW1vdW50KCk7CiAgICB9LAogICAgZXhwZWN0ZWRIb3VyOiBmdW5jdGlvbiBleHBlY3RlZEhvdXIoaCkgewogICAgICAvLyB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgICAvLyB0b2RheS5zZXRIb3Vycyh0b2RheS5nZXRIb3VycygpICsgaCk7CiAgICAgIHZhciB0cmF2ZWxUaW1lID0gbW9tZW50KCkuYWRkKGgsICdob3VycycpLmZvcm1hdCgnWVlZWS1NTS1ERCBoaDptbSBBJyk7CiAgICAgIHJldHVybiB0cmF2ZWxUaW1lOwogICAgfSwKICAgIGRlbGV0ZUZyb21MaXN0OiBmdW5jdGlvbiBkZWxldGVGcm9tTGlzdChkYXRhKSB7CiAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25SZXF1ZXN0RGV0YWlscyA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25SZXF1ZXN0RGV0YWlscy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIGVsLmludmVzdGlnYXRpb25faWQgIT0gZGF0YS5pbnZlc3RpZ2F0aW9uX2lkOwogICAgICB9LCB0aGlzKTsKICAgICAgdGhpcy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuY29zdF9wcmljZSA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNvc3RfcHJpY2UgLSBkYXRhLnRvdGFsX2Ftb3VudDsKICAgICAgdGhpcy5jYWxjdWxhdGVUb3RhbEFtb3VudCgpOwogICAgICB0aGlzLmNoZWNrUXR5KCk7CgogICAgICBpZiAoIXRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25SZXF1ZXN0RGV0YWlscy5sZW5ndGgpIHsKICAgICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5sc3RJbnZlc3RpZ2F0aW9uUGFydGljdWxhciA9IFtdOwogICAgICAgIHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LnBhcnRpY3VsYXJfY29zdF9wcmljZSA9IDA7CiAgICAgICAgdGhpcy5jYWxjdWxhdGVUb3RhbEFtb3VudCgpOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlRnJvbVBhcnRpY3VsYXJMaXN0OiBmdW5jdGlvbiBkZWxldGVGcm9tUGFydGljdWxhckxpc3QoZGF0YSkgewogICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5sc3RJbnZlc3RpZ2F0aW9uUGFydGljdWxhciA9IHRoaXMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmxzdEludmVzdGlnYXRpb25QYXJ0aWN1bGFyLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwucHJvZHVjdF9pZCAhPSBkYXRhLnByb2R1Y3RfaWQ7CiAgICAgIH0sIHRoaXMpOwogICAgICB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5wYXJ0aWN1bGFyX2Nvc3RfcHJpY2UgPSB0aGlzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5wYXJ0aWN1bGFyX2Nvc3RfcHJpY2UgLSBkYXRhLnRvdGFsUHJpY2U7CiAgICAgIHRoaXMuY2FsY3VsYXRlVG90YWxBbW91bnQoKTsKICAgIH0sCiAgICBhZGQ6IGZ1bmN0aW9uIGFkZCgpIHsKICAgICAgdmFyIF90aGlzMjMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIGN1cnJlbnREYXRlLCBkb2IsIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAwOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5jZGludmVzdGlnYXRpb25fcmVxdWVzdF9kYXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QubHN0SW52ZXN0aWdhdGlvblJlcXVlc3REZXRhaWxzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczIzLmlzRXhpc3QgPSAiUGxlYXNlIGFkZCBhIEludmVzdGlnYXRpb24iOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX3RoaXMyMy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuaW52ZXN0aWdhdGlvbl9yZXF1ZXN0X2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzMjMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmNkaW52ZXN0aWdhdGlvbl9yZXF1ZXN0X2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgICAgIGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgICAgIGRvYiA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCkgLSBfdGhpczIzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5hZ2VfeWVhciwgY3VycmVudERhdGUuZ2V0TW9udGgoKSAtIF90aGlzMjMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV9tb250aCwgY3VycmVudERhdGUuZ2V0RGF0ZSgpIC0gX3RoaXMyMy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuYWdlX2RheSk7CiAgICAgICAgICAgICAgICBfdGhpczIzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdC5hUGF0aWVudC5kb2IgPSBtb21lbnQoU3RyaW5nKGRvYikpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOyAvLwoKICAgICAgICAgICAgICAgIF90aGlzMjMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV95ZWFyID0gX3RoaXMyMy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuYWdlX3llYXIudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIF90aGlzMjMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV9tb250aCA9IF90aGlzMjMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV9tb250aC50b1N0cmluZygpOwogICAgICAgICAgICAgICAgX3RoaXMyMy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3QuYVBhdGllbnQuYWdlX2RheSA9IF90aGlzMjMucGF0aWVudEludmVzdGlnYXRpb25SZXF1ZXN0LmFQYXRpZW50LmFnZV9kYXkudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMy5wYXRpZW50SW52ZXN0aWdhdGlvblJlcXVlc3RTZXJ2aWNlLmFkZChfdGhpczIzLnBhdGllbnRJbnZlc3RpZ2F0aW9uUmVxdWVzdCwgX3RoaXMyMyk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiUmVxdWVzdCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyMy5wcmludEludmVzdGlnYXRpb25Ub2tlbihyZXN1bHQuZGF0YSk7IC8vdGhpcy5pUERJbnZlc3RpZ2F0aW9uUmVxdWVzdC5pbnZlc3RpZ2F0aW9uX3JlcXVlc3RfaWQgPSByZXN1bHQuZGF0YS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgICAvL3RoaXMuaVBESW52ZXN0aWdhdGlvblJlcXVlc3QuYWRtaXNzaW9uX2lkID0gdGhpcy5hZG1pc3Npb25faWQ7CiAgICAgICAgICAgICAgICAgIC8vdGhpcy5pUERJbnZlc3RpZ2F0aW9uUmVxdWVzdFNhdmUoKTsKICAgICAgICAgICAgICAgICAgLy90aGlzLmNvbmZpcm1QYXkocmVzdWx0LmRhdGEpOwoKCiAgICAgICAgICAgICAgICAgIF90aGlzMjMuZ2V0SVBESW52ZXN0aWdhdGlvblJlcXVlc3RCeUFkbWlzc2lvbklkKF90aGlzMjMuYWRtaXNzaW9uX2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjMucmVzZXQoKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjMuaGlkZURpYWxvZygpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczIzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjY7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMjM7CiAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgX3RoaXMyMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0My50MCwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCBudWxsLCBbWzAsIDIzXV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBTZXJ2aWNlCiAgICB0YWtlU2VydmljZTogZnVuY3Rpb24gdGFrZVNlcnZpY2UoZGF0YSkgewogICAgICB0aGlzLmlQRFNlcnZpY2VPYmouYWRtaXNzaW9uX2lkID0gZGF0YS5hZG1pc3Npb25faWQ7CiAgICAgIHRoaXMuc2VydmljZURpYWxvZyA9IHRydWU7CiAgICB9LAogICAgLy8gUGFja2FnZQogICAgdGFrZVBhY2thZ2U6IGZ1bmN0aW9uIHRha2VQYWNrYWdlKGRhdGEpIHsKICAgICAgdGhpcy5pUERTZXJ2aWNlUGFja2FnZU9iai5hZG1pc3Npb25faWQgPSBkYXRhLmFkbWlzc2lvbl9pZDsKICAgICAgdGhpcy5zZXJ2aWNlUGFja2FnZURpYWxvZyA9IHRydWU7CiAgICB9LAogICAgLy8gVGFrZW4gU2VydmljZSAmIFBhY2thZ2UKICAgIHRha2VuTGlzdDogZnVuY3Rpb24gdGFrZW5MaXN0KGRhdGEpIHsKICAgICAgdmFyIF90aGlzMjQgPSB0aGlzOwoKICAgICAgdGhpcy5pUERTZXJ2aWNlLmdldFRha2VuU2VydmljZUFuZFNlcnZpY2VQYWNrYWdlKGRhdGEuYWRtaXNzaW9uX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjQuZm9ybWF0dGVkVGFrZW5MaXN0KGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIFZpZXcgUm91bmQgRG9jdG9yCiAgICB2aWV3Um91bmREb2N0b3I6IGZ1bmN0aW9uIHZpZXdSb3VuZERvY3RvcihkYXRhKSB7CiAgICAgIHZhciBfdGhpczI1ID0gdGhpczsKCiAgICAgIHRoaXMuYXNzaWduUm91bmREb2N0b3IgPSB7Ly9yb3VuZF90aW1lOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkgaDptbSBBIiksCiAgICAgIH07CiAgICAgIHRoaXMuYXNzaWduUm91bmREb2N0b3IuYWRtaXNzaW9uX2lkID0gZGF0YS5hZG1pc3Npb25faWQ7CiAgICAgIHRoaXMuaVBEU2VydmljZS5nZXRBc3NpZ25JUERSb3VuZERvY3RvcihkYXRhLmFkbWlzc2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI1LmZvcm1hdHRlZFJvdW5kRG9jdG9yTGlzdChkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBzZXRNYWluQ29uc3VsdGFudDogZnVuY3Rpb24gc2V0TWFpbkNvbnN1bHRhbnQoKSB7CiAgICAgIGlmICghdGhpcy5hc3NpZ25Sb3VuZERvY3Rvci5pc01haW5Db25zdWx0YW50KSB7CiAgICAgICAgdmFyIGFBZG1pdHRlZFBhdGllbnQgPSB0aGlzLmFkbWl0dGVkUGF0aWVudExpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmFkbWlzc2lvbl9pZCA9PT0gdGhpcy5hc3NpZ25Sb3VuZERvY3Rvci5hZG1pc3Npb25faWQ7CiAgICAgICAgfSwgdGhpcyk7CiAgICAgICAgdGhpcy5hc3NpZ25Sb3VuZERvY3Rvci5kZXBhcnRtZW50X2lkID0gYUFkbWl0dGVkUGF0aWVudFswXS5jb25zdWx0YW5jeV9kZXBhcnRtZW50X2lkOwogICAgICAgIHRoaXMuYXNzaWduUm91bmREb2N0b3Iucm91bmRfZG9jdG9yX2lkID0gYUFkbWl0dGVkUGF0aWVudFswXS5kb2N0b3JfaWQ7CiAgICAgICAgdGhpcy5hc3NpZ25Sb3VuZERvY3Rvci5jaGFyZ2UgPSBhQWRtaXR0ZWRQYXRpZW50WzBdLmlwZF9jb25zdWx0YW5jeV9mZWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hc3NpZ25Sb3VuZERvY3Rvci5kZXBhcnRtZW50X2lkID0gIiI7CiAgICAgICAgdGhpcy5hc3NpZ25Sb3VuZERvY3Rvci5yb3VuZF9kb2N0b3JfaWQgPSAiIjsKICAgICAgICB0aGlzLmFzc2lnblJvdW5kRG9jdG9yLmNoYXJnZSA9ICIiOwogICAgICB9CiAgICB9LAogICAgbWVyZ2VEb2N0b3JJbmZvOiBmdW5jdGlvbiBtZXJnZURvY3RvckluZm8oZGF0YSkgewogICAgICB2YXIgX3RoaXMyNiA9IHRoaXM7CgogICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICB2YXIgb2JqID0gZWxlbWVudDsKICAgICAgICBvYmouZG9jdG9yX2RlZ3JlZSA9ICIiOwogICAgICAgIG9iai5sc3RDb25zdWx0YW50RGVncmVlLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICBvYmouZG9jdG9yX2RlZ3JlZSArPSBlbC5jb25zdWx0YW50X2RlZ3JlZV9uYW1lICsgIi4gIjsKICAgICAgICB9KTsKICAgICAgICBvYmouZG9jdG9yX25hbWUgPSBlbGVtZW50LmRvY19ubyArICIgLSAoIiArIG9iai5kb2N0b3JfZGVncmVlICsgIikgLSAiICsgZWxlbWVudC5kb2N0b3JfbmFtZTsKCiAgICAgICAgX3RoaXMyNi5kb2N0b3JMaXN0LnB1c2gob2JqKTsKICAgICAgfSk7CiAgICB9LAogICAgZmlsdGVyRG9jdG9yc0RlcGFydG1lbnRXaXNlOiBmdW5jdGlvbiBmaWx0ZXJEb2N0b3JzRGVwYXJ0bWVudFdpc2UoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvY3Rvckxpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBlbC5kZXBhcnRtZW50X2lkID09PSB0aGlzLmFzc2lnblJvdW5kRG9jdG9yLmRlcGFydG1lbnRfaWQ7CiAgICAgIH0sIHRoaXMpOwogICAgfSwKICAgIGdldENoYXJnZTogZnVuY3Rpb24gZ2V0Q2hhcmdlKCkgewogICAgICB2YXIgYURvY3RvciA9IHRoaXMuZG9jdG9yTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIGVsLmRvY3Rvcl9pZCA9PT0gdGhpcy5hc3NpZ25Sb3VuZERvY3Rvci5yb3VuZF9kb2N0b3JfaWQ7CiAgICAgIH0sIHRoaXMpOwogICAgICB0aGlzLmFzc2lnblJvdW5kRG9jdG9yLmNoYXJnZSA9IGFEb2N0b3JbMF0uaXBkX2NvbnN1bHRhbmN5X2ZlZTsKICAgIH0sCiAgICAvLyBSb3VuZCBEb2N0b3IKICAgIHJvdW5kRG9jdG9yOiBmdW5jdGlvbiByb3VuZERvY3RvcigpIHsKICAgICAgdGhpcy5saXN0Um91bmREb2N0b3JEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5yb3VuZERvY3RvckRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZm9ybWF0dGVkUm91bmREb2N0b3JMaXN0OiBmdW5jdGlvbiBmb3JtYXR0ZWRSb3VuZERvY3Rvckxpc3QoZGF0YSkgewogICAgICB0aGlzLnJvdW5kRG9jdG9yTGlzdCA9IFtdOwogICAgICB0aGlzLnJvdW5kRG9jdG9yTGlzdCA9IGRhdGE7CiAgICAgIHRoaXMubGlzdFJvdW5kRG9jdG9yRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBmb3JtYXR0ZWRUYWtlbkxpc3Q6IGZ1bmN0aW9uIGZvcm1hdHRlZFRha2VuTGlzdChkYXRhKSB7CiAgICAgIHRoaXMudGFrZW5TZXJ2aWNlUGFja2FnZU9iai5sc3RUYWtlblNlcnZpY2UgPSBkYXRhLmxzdFRha2VuU2VydmljZTsKICAgICAgdGhpcy50YWtlblNlcnZpY2VQYWNrYWdlT2JqLmxhc3RUYWtlblNlcnZpY2VQYWNrYWdlID0gZGF0YS5sYXN0VGFrZW5TZXJ2aWNlUGFja2FnZTsKICAgICAgdGhpcy50YWtlblNlcnZpY2VQYWNrYWdlRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBzZXJ2aWNlRm9ybWF0dGVkOiBmdW5jdGlvbiBzZXJ2aWNlRm9ybWF0dGVkKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMjcgPSB0aGlzOwoKICAgICAgdmFyIGZpbHRlckRhdGEgPSBkYXRhLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwuc2VydmljZV9oZWFkX2lkID09ICcxJyB8fCBlbC5zZXJ2aWNlX2hlYWRfaWQgPT0gJzMnOwogICAgICB9LCB0aGlzKTsKICAgICAgdmFyIGZpbHRlckRhdGEyID0gZmlsdGVyRGF0YS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIGVsLmFjdGl2ZSA9PSB0cnVlICYmIGVsLnNlcnZpY2VfdHlwZV9pZCAhPSAnMic7CiAgICAgIH0sIHRoaXMpOwogICAgICB0aGlzLmlQRFNlcnZpY2VPYmoubHN0U2VydmljZSA9IFtdOwogICAgICBmaWx0ZXJEYXRhMi5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMyNy5pUERTZXJ2aWNlT2JqLmxzdFNlcnZpY2UucHVzaCh7CiAgICAgICAgICBzZXJ2aWNlX2lkOiBlbGVtZW50LnNlcnZpY2VfaWQsCiAgICAgICAgICBzZXJ2aWNlX25hbWU6IGVsZW1lbnQuc2VydmljZV9uYW1lLAogICAgICAgICAgc2VydmljZV9oZWFkX2lkOiBlbGVtZW50LnNlcnZpY2VfaGVhZF9pZCwKICAgICAgICAgIF9zZXJ2aWNlX2hlYWRfbmFtZTogZWxlbWVudC5fc2VydmljZV9oZWFkX25hbWUsCiAgICAgICAgICBzZXJ2aWNlX3R5cGVfaWQ6IGVsZW1lbnQuc2VydmljZV90eXBlX2lkLAogICAgICAgICAgX3NlcnZpY2VfdHlwZV9uYW1lOiBlbGVtZW50Ll9zZXJ2aWNlX3R5cGVfbmFtZSwKICAgICAgICAgIHNlcnZpY2VfY2hhcmdlOiBlbGVtZW50LnNlcnZpY2VfY2hhcmdlLAogICAgICAgICAgZXJfc2VydmljZV9jaGFyZ2U6IGVsZW1lbnQuZXJfc2VydmljZV9jaGFyZ2UsCiAgICAgICAgICBkaXNjb3VudDogZWxlbWVudC5kaXNjb3VudCwKICAgICAgICAgIGlzQ2hlY2s6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHNlcnZpY2VQYWNrYWdlRm9ybWF0dGVkOiBmdW5jdGlvbiBzZXJ2aWNlUGFja2FnZUZvcm1hdHRlZChkYXRhKSB7CiAgICAgIHZhciBfdGhpczI4ID0gdGhpczsKCiAgICAgIHRoaXMuaVBEU2VydmljZVBhY2thZ2VPYmoubHN0U2VydmljZVBhY2thZ2UgPSBbXTsKICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMyOC5pUERTZXJ2aWNlUGFja2FnZU9iai5sc3RTZXJ2aWNlUGFja2FnZS5wdXNoKHsKICAgICAgICAgIHNlcnZpY2VfcGFja2FnZV9pZDogZWxlbWVudC5zZXJ2aWNlX3BhY2thZ2VfaWQsCiAgICAgICAgICBzZXJ2aWNlX3BhY2thZ2VfbmFtZTogZWxlbWVudC5zZXJ2aWNlX3BhY2thZ2VfbmFtZSwKICAgICAgICAgIGNoYXJnZTogZWxlbWVudC5jaGFyZ2UsCiAgICAgICAgICBpc0NoZWNrOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBBc3NpZ24gUm91bmQgRG9jdG9yCiAgICBhZGREb2N0b3JBc3NpZ246IGZ1bmN0aW9uIGFkZERvY3RvckFzc2lnbigpIHsKICAgICAgdmFyIF90aGlzMjkgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjkuYXNzaWduUm91bmREb2N0b3IuZGVwYXJ0bWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjkuYXNzaWduUm91bmREb2N0b3Iucm91bmRfZG9jdG9yX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyOS5hc3NpZ25Sb3VuZERvY3Rvci5jaGFyZ2UpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjkuYXNzaWduUm91bmREb2N0b3Iucm91bmRfdGltZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjkuaVBEU2VydmljZS5hc3NpZ25JUERSb3VuZERvY3RvcihfdGhpczI5LmFzc2lnblJvdW5kRG9jdG9yLCBfdGhpczI5KTsKCiAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyOS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyOS5oaWRlRGlhbG9nKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgICAgICBfdGhpczI5LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgYWRkU2VydmljZTogZnVuY3Rpb24gYWRkU2VydmljZSgpIHsKICAgICAgdmFyIF90aGlzMzAgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMzMC5pUERTZXJ2aWNlT2JqLmxzdFNlcnZpY2UgPSBfdGhpczMwLmlQRFNlcnZpY2VPYmoubHN0U2VydmljZS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC5pc0NoZWNrID09IHRydWU7CiAgICAgICAgICAgICAgICB9LCBfdGhpczMwKTsKCiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczMwLmlQRFNlcnZpY2VPYmoubHN0U2VydmljZS5sZW5ndGggPiAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMwLmlQRFNlcnZpY2Uuc2F2ZUlQRFNlcnZpY2UoX3RoaXMzMC5pUERTZXJ2aWNlT2JqLCBfdGhpczMwKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ1LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBfdGhpczMwLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczMwLmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzAuZ2V0U2VydmljZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczMwLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF90aGlzMzAuZ2V0U2VydmljZSgpOwoKICAgICAgICAgICAgICAgIF90aGlzMzAuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2VsZWN0IFNlcnZpY2UiLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBhZGRTZXJ2aWNlUGFja2FnZTogZnVuY3Rpb24gYWRkU2VydmljZVBhY2thZ2UoKSB7CiAgICAgIHZhciBfdGhpczMxID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMzEuaVBEU2VydmljZVBhY2thZ2VPYmoubHN0U2VydmljZVBhY2thZ2UgPSBfdGhpczMxLmlQRFNlcnZpY2VQYWNrYWdlT2JqLmxzdFNlcnZpY2VQYWNrYWdlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlzQ2hlY2sgPT0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0sIF90aGlzMzEpOwoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMzEuaVBEU2VydmljZVBhY2thZ2VPYmoubHN0U2VydmljZVBhY2thZ2UubGVuZ3RoID4gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzMS5pUERTZXJ2aWNlLnNhdmVJUERTZXJ2aWNlUGFja2FnZShfdGhpczMxLmlQRFNlcnZpY2VQYWNrYWdlT2JqLCBfdGhpczMxKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ2LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBfdGhpczMxLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczMxLmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzEuZ2V0U2VydmljZVBhY2thZ2UoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzEuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBfdGhpczMxLmdldFNlcnZpY2VQYWNrYWdlKCk7CgogICAgICAgICAgICAgICAgX3RoaXMzMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTZWxlY3QgUGFja2FnZSIsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEJsb29kIEJhbmsKICAgIGdldEJsb29kUmVxdWVzdExpc3RCeUFkbWlzc2lvbklkOiBmdW5jdGlvbiBnZXRCbG9vZFJlcXVlc3RMaXN0QnlBZG1pc3Npb25JZChhZG1pc3Npb25faWQpIHsKICAgICAgdmFyIF90aGlzMzIgPSB0aGlzOwoKICAgICAgdGhpcy5ibG9vZFJlcXVlc3RTZXJ2aWNlLmdldEJsb29kUmVxdWVzdExpc3RCeUFkbWlzc2lvbklkKGFkbWlzc2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMyLmlQREJsb29kUmVxdWVzdExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIG5ld0Jsb29kUmVxdWVzdDogZnVuY3Rpb24gbmV3Qmxvb2RSZXF1ZXN0KCkgewogICAgICB0aGlzLmJsb29kUmVxdWVzdERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYmxvb2RSZXF1ZXN0OiBmdW5jdGlvbiBibG9vZFJlcXVlc3QoKSB7CiAgICAgIHZhciBfdGhpczMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMzMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzMy5ibG9vZFJlcXVlc3RPYmoudG90YWxfYmFnKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzMy5ibG9vZFJlcXVlc3RPYmouYmxvb2RfZ3JvdXApIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIGlmIChfdGhpczMzLmJsb29kUmVxdWVzdE9iai5hZG1pc3Npb25faWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMzLmJsb29kUmVxdWVzdFNlcnZpY2UuYWRkKF90aGlzMzMuYmxvb2RSZXF1ZXN0T2JqLCBfdGhpczMzKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ny5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMy5nZXRCbG9vZFJlcXVlc3RMaXN0QnlBZG1pc3Npb25JZChfdGhpczMzLmJsb29kUmVxdWVzdE9iai5hZG1pc3Npb25faWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMy5oaWRlRGlhbG9nKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDQwOSkgewogICAgICAgICAgICAgICAgICBfdGhpczMzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/nurse-panel/AdmittedPatientRequest.js"],"names":["AdmissionService","AdmissionPrescriptionService","CommonService","moment","Validation","FilterService","FilterMatchMode","FilterOperator","PatientInvestigationRequestService","PatientReportService","ConsultancyDepartmentSetupService","DoctorSetupService","BuildingSetupService","RoomSetupService","InvestigationSetupService","ProductSetupService","IPDRequestService","ServiceSetupService","ServicePackageSetupService","IPDService","MedicineRequestService","IPDReportService","MedicineSetupService","BloodRequestService","data","filteredItems","dataList","isNurse","isRequest","pharmacy","active","expandedRows","admittedPatientList","admittedPatient","cdfromdate","String","Date","format","cdtodate","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","admission_id","patient_id","doctor_id","doctor_no","reffered_by_id","investigationRequestDialog","lstPrescriptionInvestigation","isExist","buildingList","roomList","investigationList","reportDeliveryTypeList","productList","patientInvestigationRequest","aPatient","age_year","age_month","age_day","cdinvestigation_request_date","report_delivery_type","lstInvestigationRequestDetails","lstInvestigationParticular","discount_by_id","discount_percent","discount_amount","cost_price","particular_cost_price","total_amount","discountByList","text","iPDInvestigationRequestList","iPDInvestigationRequest","investigation_request_id","invoice_id","admission_no","registration_no","patient_name","iPDMedicineRequestList","iPDPrescriptionList","iPDPrescriptionMedicineList","iPDMedicineRequest","lstMedicineRequestDetails","iPDMedicineRequestDialog","addMedicineDialog","addMedicine","medicineList","serviceDialog","iPDServiceObj","lstService","servicePackageDialog","iPDServicePackageObj","lstServicePackage","takenServicePackageDialog","takenServicePackageObj","lstTakenService","lastTakenServicePackage","departmentList","doctorList","assignRoundDoctor","roundDoctorList","listRoundDoctorDialog","roundDoctorDialog","iPDBloodRequestList","bloodRequestDialog","bloodRequestObj","bloodGroupList","created","admissionService","admissionPrescriptionService","commonService","validation","userInfo","JSON","parse","localStorage","getItem","show","nurse_id","patientInvestigationRequestService","doctorSetupService","consultancyDepartmentSetupService","buildingSetupService","roomSetupService","investigationSetupService","productSetupService","patientReportService","iPDRequestService","serviceSetupService","servicePackageSetupService","iPDService","medicineRequestService","iPDReportService","medicineSetupService","bloodRequestService","getAll","then","GetAllReportDeliveryType","getService","getServicePackage","getActiveCombo","mergeDoctorInfo","GetAllBloodGroup","methods","serviceFormatted","servicePackageFormatted","fromdate","todate","admittedPatientListForHistoryByNurseId","hideDialog","hideCollectionRequest","collectionRequest","getIPDInvestigationRequestByAdmissionId","getMedicineRequestListByAdmissionNo","getBloodRequestListByAdmissionId","blood_group","doc_no","formatDate","formatDateTime","printInvestigationToken","id","GetInvestigationToken","Downloadfile","newInvestigationRequest","getPrescriptionInvestigationByAdmissionId","prescriptionInvestigation","forEach","element","push","investigation_id","investingation_name","isCheck","investigationRequest","filter","el","getFormattedPrescriptionWiseInvestigations","iPDInvestigationRequestSave","result","status","reset","$toast","add","severity","summary","detail","res","life","printMedicineRequest","GetMedicineRequestToken","newMedicineRequest","prescribeMedicine","admission_prescription_id","getPrescriptionNoByAdmissionId","prescriptionNo","hideMedicineRequest","getPrescriptionData","getPrescriptionDataByPrescriptionId","prescriptionData","medicine_id","medicine_name","barcode","treatment_rule_name","treatment_duration_name","treatment_dose_name","medicine_generic_name","strgenth","medicine_type_name","uom_name","manufacturer_name","request_qty","addNewMedicine","getMedicineList","searchMedicine","event","setTimeout","query","trim","length","toLowerCase","slice","addRequestMedicine","ddlmedicine","_medicine_generic_name","_medicine_type_name","_uom_name","medicine_manufacturer_name","_manufacturer_name","setRequestMedicine","filterData","aMedicine","medicine_strgenth","medicine_uom_name","deleteRequestMedicine","medicineRequest","patient_registration_no","first_name","contact_no","reffered_doctor_id","aInvestigation","ddlinvestigation","addInvestigation","investigationIsExist","isInvestigation","cost","charge","urgent_carge","deliveryTime","expectedHour","report_delivery_duration","emmergency_report_delivery_duration","discountAmount","totalAmount","obj","_investingation_name","_investigation_category_head_name","building_id","_building_id","room_id","_room_id","expected_delivery","quantity","calculateTotalAmount","addParticular","calculatePerInvestigationDiscountPercent","calculateCostPrice","calculatePerInvestigationDiscountAmount","costPrice","Math","ceil","getById","getParticularFormatted","addAParticular","qty","pname","product_id","parseInt","_product_name","uom_id","checkQty","_lstInvestigationParticular","totalPrice","getDiscountPercent","getDiscountAmount","h","travelTime","deleteFromList","deleteFromParticularList","investigation_request_date","currentDate","dob","getFullYear","getMonth","getDate","toString","takeService","takePackage","takenList","getTakenServiceAndServicePackage","formattedTakenList","viewRoundDoctor","getAssignIPDRoundDoctor","formattedRoundDoctorList","setMainConsultant","isMainConsultant","aAdmittedPatient","department_id","consultancy_department_id","round_doctor_id","ipd_consultancy_fee","doctor_degree","lstConsultantDegree","consultant_degree_name","doctor_name","filterDoctorsDepartmentWise","getCharge","aDoctor","roundDoctor","service_head_id","filterData2","service_type_id","service_id","service_name","_service_head_name","_service_type_name","service_charge","er_service_charge","discount","service_package_id","service_package_name","addDoctorAssign","round_time","assignIPDRoundDoctor","addService","saveIPDService","addServicePackage","saveIPDServicePackage","newBloodRequest","bloodRequest","total_bag"],"mappings":"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","sourcesContent":["import AdmissionService from \"../../service/front-desk/AdmissionService\";\r\nimport AdmissionPrescriptionService from \"../../service/prescription/AdmissionPrescriptionService\";\r\n\r\nimport CommonService from \"../../service/CommonService\";\r\n\r\nimport moment from \"moment\";\r\nimport Validation from \"../../scripts/validation\";\r\nimport { FilterService, FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n\r\n// Investigation Request\r\nimport PatientInvestigationRequestService from \"../../service/front-desk/PatientInvestigationRequestService\";\r\n//import PatientRegistrationService from \"../../service/front-desk/PatientRegistrationService\";\r\nimport PatientReportService from \"../../service/report/PatientReportService\";\r\n//import DesignationSetupService from \"../../service/setup/DesignationSetupService\";\r\nimport ConsultancyDepartmentSetupService from \"../../service/setup/ConsultancyDepartmentSetupService\";\r\nimport DoctorSetupService from \"../../service/setup/DoctorSetupService\";\r\n//import EmployeeSetupService from \"../../service/setup/EmployeeSetupService\";\r\nimport BuildingSetupService from \"../../service/setup/BuildingSetupService\";\r\nimport RoomSetupService from \"../../service/setup/RoomSetupService\";\r\n//import ReferredBySetupService from \"../../service/setup/ReferredBySetupService\";\r\nimport InvestigationSetupService from \"../../service/setup/InvestigationSetupService\";\r\nimport ProductSetupService from \"../../service/setup/ProductSetupService\";\r\nimport IPDRequestService from \"../../service/ipd/IPDRequestService\";\r\n// Service & Package\r\nimport ServiceSetupService from \"../../service/setup/ServiceSetupService\";\r\nimport ServicePackageSetupService from \"../../service/setup/ServicePackageSetupService\";\r\nimport IPDService from \"../../service/ipd/IPDService\";\r\n// Pharmacy\r\nimport MedicineRequestService from \"../../service/pharmacy/MedicineRequestService\";\r\nimport IPDReportService from \"../../service/report/IPDReportService\";\r\nimport MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\n// Blood Bank\r\nimport BloodRequestService from \"../../service/blood-bank/BloodRequestService\";\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            filteredItems: null,\r\n            dataList: true,\r\n            isNurse: false,\r\n            isRequest: false,\r\n            pharmacy: false,\r\n            active: 0,\r\n            expandedRows: [],\r\n            admittedPatientList: [],\r\n            admittedPatient: {\r\n                // cdfromdate: moment(\r\n                //     String(new Date(new Date().setDate(new Date().getDate() - 860)))\r\n                // ).format(\"MM/DD/YYYY\"),\r\n                cdfromdate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n                cdtodate: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n                // cdtodate: moment(\r\n                //     String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n                // ).format(\"MM/DD/YYYY\"),\r\n            },\r\n            //\r\n\r\n            submitted: false,\r\n            filters: {\r\n                global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n                name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            },\r\n            initFilters() {\r\n                this.filters = {\r\n                    global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n                    name: {\r\n                        operator: FilterOperator.AND,\r\n                        constraints: [\r\n                            { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n                        ],\r\n                    },\r\n                };\r\n            },\r\n\r\n            // Investigation Request\r\n            admission_id: null,\r\n            patient_id: null,\r\n            doctor_id: null,\r\n            doctor_no: null,\r\n            reffered_by_id: null,\r\n            investigationRequestDialog: false,\r\n            lstPrescriptionInvestigation: [],\r\n\r\n            //isInvestigation: true,\r\n            //isPrescription: false,\r\n            //isContactExist: \"\",\r\n            //isValid: \"\",\r\n            //isEmailValid: \"\",\r\n            //isPatientExist: \"\",\r\n            isExist: \"\",\r\n            //collectionList: [],\r\n            //bloodGroupList: [],\r\n            //genderList: [],\r\n            //designationtList: [],\r\n            //departmentList: [],\r\n            //doctorList: [],\r\n            buildingList: [],\r\n            roomList: [],\r\n            //referredByList: [],\r\n            //employeeList: [],\r\n            //discountByList: [],\r\n            investigationList: [],\r\n            reportDeliveryTypeList: [],\r\n            productList: [],\r\n            patientInvestigationRequest: {\r\n                patient_id: \"\",\r\n                aPatient: {\r\n                    age_year: \"0\",\r\n                    age_month: \"0\",\r\n                    age_day: \"0\",\r\n                },\r\n                cdinvestigation_request_date: moment(String(new Date())).format(\r\n                    \"MM/DD/YYYY\"\r\n                ),\r\n                report_delivery_type: \"Regular\",\r\n                lstInvestigationRequestDetails: [],\r\n                lstInvestigationParticular: [],\r\n                discount_by_id: \"Company\",\r\n                discount_percent: 0,\r\n                discount_amount: 0,\r\n                cost_price: 0,\r\n                particular_cost_price: 0,\r\n                total_amount: 0,\r\n            },\r\n            discountByList: [\r\n                { text: \"Both\", value: \"Both\" },\r\n                { text: \"Hospital\", value: \"Company\" },\r\n                { text: \"Reference\", value: \"Reference\" },\r\n            ],\r\n\r\n            // Investigation Request\r\n            iPDInvestigationRequestList: [],\r\n            iPDInvestigationRequest: {\r\n                investigation_request_id: null,\r\n                admission_id: null,\r\n            },\r\n            // Pharmacy\r\n            invoice_id: null,\r\n            admission_no: null,\r\n            registration_no: null,\r\n            patient_name: null,\r\n            iPDMedicineRequestList: [],\r\n            iPDPrescriptionList: [],\r\n            iPDPrescriptionMedicineList: [],\r\n            iPDMedicineRequest: {\r\n                lstMedicineRequestDetails: [],\r\n            },\r\n            iPDMedicineRequestDialog: false,\r\n            addMedicineDialog: false,\r\n            addMedicine: {},\r\n            medicineList: [],\r\n\r\n            // Service\r\n            serviceDialog: false,\r\n            iPDServiceObj: {\r\n                lstService: [],\r\n            },\r\n            // Package\r\n            servicePackageDialog: false,\r\n            iPDServicePackageObj: {\r\n                lstServicePackage: [],\r\n            },\r\n            // Taken Service & Package\r\n            takenServicePackageDialog: false,\r\n            takenServicePackageObj: {\r\n                lstTakenService: [],\r\n                lastTakenServicePackage: [],\r\n            },\r\n            // Round Doctor\r\n            departmentList: [],\r\n            doctorList: [],\r\n            assignRoundDoctor: {},\r\n            roundDoctorList: [],\r\n            listRoundDoctorDialog: false,\r\n            roundDoctorDialog: false,\r\n\r\n            // Blood Bank\r\n            iPDBloodRequestList: [],\r\n            bloodRequestDialog: false,\r\n            bloodRequestObj: {},\r\n            bloodGroupList: [],\r\n        };\r\n    },\r\n    created() {\r\n        this.admissionService = new AdmissionService();\r\n        this.admissionPrescriptionService = new AdmissionPrescriptionService();\r\n\r\n        this.commonService = new CommonService();\r\n        this.validation = new Validation();\r\n\r\n        this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n        this.show();\r\n\r\n        if (this.userInfo.nurse_id) {\r\n            this.isNurse = true;\r\n        } else if (!this.userInfo.nurse_id) {\r\n            this.isNurse = false;\r\n        }\r\n\r\n        // Investigation Request\r\n        this.patientInvestigationRequestService =\r\n            new PatientInvestigationRequestService();\r\n        //this.patientRegistrationService = new PatientRegistrationService();\r\n        //this.employeeSetupService = new EmployeeSetupService();\r\n        this.doctorSetupService = new DoctorSetupService();\r\n        this.consultancyDepartmentSetupService =\r\n            new ConsultancyDepartmentSetupService();\r\n        //this.designationSetupService = new DesignationSetupService();\r\n        this.buildingSetupService = new BuildingSetupService();\r\n        this.roomSetupService = new RoomSetupService();\r\n        //this.referredBySetupService = new ReferredBySetupService();\r\n        this.investigationSetupService = new InvestigationSetupService();\r\n        this.productSetupService = new ProductSetupService();\r\n        //this.collectionCenterSetupService = new CollectionCenterSetupService();\r\n        this.patientReportService = new PatientReportService();\r\n        //this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n        this.iPDRequestService = new IPDRequestService();\r\n        // Service & Package\r\n        this.serviceSetupService = new ServiceSetupService();\r\n        this.servicePackageSetupService = new ServicePackageSetupService();\r\n        this.iPDService = new IPDService();\r\n        // Pharmacy\r\n        this.medicineRequestService = new MedicineRequestService();\r\n        this.iPDReportService = new IPDReportService();\r\n        this.medicineSetupService = new MedicineSetupService();\r\n        // Blood Bank\r\n        this.bloodRequestService = new BloodRequestService();\r\n\r\n\r\n        // this.commonService\r\n        //     .GetAllGender()\r\n        //     .then((data) => (this.genderList = data.data));\r\n\r\n        // this.commonService\r\n        //     .GetAllBloodGroup()\r\n        //     .then((data) => (this.bloodGroupList = data.data));\r\n\r\n        // this.designationSetupService\r\n        //     .getAll()\r\n        //     .then((data) => (this.designationtList = data.data));\r\n\r\n        // this.consultancyDepartmentSetupService\r\n        //     .getActiveCombo()\r\n        //     .then((data) => (this.departmentList = data.data));\r\n\r\n        // this.buildingSetupService\r\n        //     .getAll()\r\n        //     .then((data) => (this.buildingList = data.data));\r\n\r\n        // this.roomSetupService.getAll().then((data) => (this.roomList = data.data));\r\n\r\n        // this.referredBySetupService\r\n        //   .getActiveCombo()\r\n        //   .then((data) => (this.referredByList = data.data));\r\n\r\n        // this.referredBySetupService\r\n        //   .getActiveCombo()\r\n        //   .then((data) => this.mergeReferredByInfo(data.data));\r\n\r\n        // this.referredBySetupService\r\n        //   .getAll()\r\n        //   .then((data) => this.mergeReferredByInfo(data.data));\r\n\r\n        // this.doctorSetupService\r\n        //   .getAll()\r\n        //   .then((data) => this.mergeDoctorInfo(data.data));\r\n\r\n        // this.employeeSetupService\r\n        //   .getAll()\r\n        //   .then((data) => this.mergeEmployeeInfo(data.data));\r\n\r\n        this.investigationSetupService\r\n            .getAll()\r\n            .then((data) => (this.investigationList = data.data));\r\n\r\n        // this.investigationSetupService\r\n        //     .getAll()\r\n        //     .then((data) => this.formatInvestigationList(data.data));\r\n\r\n        this.commonService\r\n            .GetAllReportDeliveryType()\r\n            .then((data) => (this.reportDeliveryTypeList = data.data));\r\n\r\n        this.productSetupService\r\n            .getAll()\r\n            .then((data) => (this.productList = data.data));\r\n\r\n        // Service & Package\r\n        this.getService();\r\n        this.getServicePackage();\r\n\r\n        //\r\n        this.consultancyDepartmentSetupService\r\n            .getActiveCombo()\r\n            .then((data) => (this.departmentList = data.data));\r\n\r\n        this.doctorSetupService\r\n            .getAll()\r\n            .then((data) => this.mergeDoctorInfo(data.data));\r\n\r\n        this.commonService\r\n            .GetAllBloodGroup()\r\n            .then((data) => (this.bloodGroupList = data.data));\r\n    },\r\n    methods: {\r\n        getService() {\r\n            this.serviceSetupService\r\n                .getAll()\r\n                .then((data) => this.serviceFormatted(data.data));\r\n        },\r\n        getServicePackage() {\r\n            this.servicePackageSetupService\r\n                .getAll()\r\n                .then((data) => this.servicePackageFormatted(data.data));\r\n        },\r\n\r\n        show() {\r\n            this.submitted = true;\r\n            if (!this.admittedPatient.cdfromdate) {\r\n                return;\r\n            } else if (!this.admittedPatient.cdtodate) {\r\n                return;\r\n            } else {\r\n                this.admittedPatient.fromdate = moment(\r\n                    String(this.admittedPatient.cdfromdate)\r\n                ).format(\"YYYY-MM-DD\");\r\n                this.admittedPatient.todate = moment(\r\n                    String(this.admittedPatient.cdtodate)\r\n                ).format(\"YYYY-MM-DD\");\r\n                this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n                this.admissionService\r\n                    .admittedPatientListForHistoryByNurseId(this.admittedPatient.fromdate, this.admittedPatient.todate, this.userInfo.nurse_id)\r\n                    .then((data) => (this.admittedPatientList = data.data));\r\n            }\r\n            this.dataList = true;\r\n            this.submitted = true;\r\n        },\r\n        hideDialog() {\r\n            //var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n            this.roundDoctorDialog = false;\r\n            this.listRoundDoctorDialog = false;\r\n            this.servicePackageDialog = false;\r\n            this.takenServicePackageDialog = false;\r\n            this.serviceDialog = false;\r\n            this.investigationRequestDialog = false;\r\n            this.iPDMedicineRequestDialog = false;\r\n            this.addMedicineDialog = false;\r\n            this.addMedicine = {};\r\n            this.submitted = false;\r\n            this.bloodRequestDialog = false;\r\n            this.bloodRequestObj = {};\r\n        },\r\n        hideCollectionRequest() {\r\n            this.isRequest = false;\r\n            this.dataList = true;\r\n            //localStorage.removeItem('patientIdForTreatment');\r\n        },\r\n        collectionRequest(data) {\r\n            this.getIPDInvestigationRequestByAdmissionId(data.admission_id);\r\n            this.getMedicineRequestListByAdmissionNo(data.admission_no);\r\n            this.getBloodRequestListByAdmissionId(data.admission_id);\r\n            this.bloodRequestObj.admission_id = data.admission_id;\r\n            this.bloodRequestObj.blood_group = data.blood_group;\r\n            this.invoice_id = data.invoice_id;\r\n            this.admission_id = data.admission_id;\r\n            this.admission_no = data.admission_no;\r\n            this.patient_id = data.patient_id;\r\n            this.registration_no = data.registration_no;\r\n            this.patient_name = data.patient_name;\r\n            this.doctor_id = data.doctor_id;\r\n            this.doctor_no = data.doc_no;\r\n            this.reffered_by_id = data.reffered_by_id;\r\n            this.isRequest = true;\r\n            this.dataList = false;\r\n        },\r\n\r\n        formatDate(value) {\r\n            return moment(String(value)).format(\"MM/DD/YYYY\");\r\n        },\r\n        formatDateTime(value) {\r\n            return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n        },\r\n        // Investigation Request\r\n        getIPDInvestigationRequestByAdmissionId(admission_id) {\r\n            this.iPDRequestService.getIPDInvestigationRequestByAdmissionId(admission_id)\r\n                .then((data) => (this.iPDInvestigationRequestList = data.data));\r\n        },\r\n        printInvestigationToken(id) {\r\n            this.patientReportService.GetInvestigationToken(id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n        },\r\n        newInvestigationRequest() {\r\n            this.admissionPrescriptionService\r\n                .getPrescriptionInvestigationByAdmissionId(this.admission_id)\r\n                .then((data) => this.prescriptionInvestigation(data.data));\r\n        },\r\n        prescriptionInvestigation(data) {\r\n            this.lstPrescriptionInvestigation = [];\r\n            data.forEach((element) => {\r\n                this.lstPrescriptionInvestigation.push({\r\n                    admission_id: element.admission_id,\r\n                    investigation_id: element.investigation_id,\r\n                    investingation_name: element.investingation_name,\r\n                    isCheck: false\r\n                });\r\n            });\r\n\r\n            this.investigationRequestDialog = true;\r\n        },\r\n        investigationRequest() {\r\n            this.lstPrescriptionInvestigation = this.lstPrescriptionInvestigation.filter(function (el) {\r\n                return el.isCheck == true;\r\n            }, this);\r\n\r\n            this.getFormattedPrescriptionWiseInvestigations(this.lstPrescriptionInvestigation);\r\n        },\r\n        async iPDInvestigationRequestSave() {\r\n            try {\r\n                if (!this.iPDInvestigationRequest.investigation_request_id) {\r\n                    return;\r\n                } else if (!this.iPDInvestigationRequest.admission_id) {\r\n                    return;\r\n                } else {\r\n                    let result = await this.iPDRequestService.iPDInvestigationRequestSave(this.iPDInvestigationRequest);\r\n                    if (result.status === 201) {\r\n                        this.getIPDInvestigationRequestByAdmissionId(this.admission_id);\r\n                        this.reset();\r\n                        this.hideDialog();\r\n                    } else {\r\n                        this.$toast.add({\r\n                            severity: \"error\",\r\n                            summary: \"Failed\",\r\n                            detail: result.res,\r\n                            life: 10000,\r\n                        });\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                this.$toast.add({\r\n                    severity: \"error\",\r\n                    summary: \"Failed\",\r\n                    detail: error,\r\n                    life: 10000,\r\n                });\r\n            }\r\n        },\r\n\r\n        // Pharmacy\r\n        getMedicineRequestListByAdmissionNo(admission_no) {\r\n            this.medicineRequestService.getMedicineRequestListByAdmissionNo(admission_no)\r\n                .then((data) => (this.iPDMedicineRequestList = data.data));\r\n        },\r\n        printMedicineRequest(id) {\r\n            this.iPDReportService.GetMedicineRequestToken(id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n        },\r\n        newMedicineRequest() {\r\n            this.iPDMedicineRequest.lstMedicineRequestDetails = [];\r\n            this.pharmacy = true;\r\n            this.isRequest = false;\r\n            this.dataList = false;\r\n        },\r\n        prescribeMedicine() {\r\n            this.iPDMedicineRequest.admission_prescription_id = null;\r\n            this.iPDPrescriptionMedicineList = [];\r\n\r\n            this.admissionPrescriptionService\r\n                .getPrescriptionNoByAdmissionId(this.admission_id)\r\n                .then((data) => this.prescriptionNo(data.data));\r\n        },\r\n        prescriptionNo(data) {\r\n            this.iPDPrescriptionList = data;\r\n            this.iPDMedicineRequestDialog = true;\r\n        },\r\n        hideMedicineRequest() {\r\n            this.pharmacy = false;\r\n            this.isRequest = true;\r\n            this.dataList = false;\r\n        },\r\n        getPrescriptionData() {\r\n            if (this.iPDMedicineRequest.admission_prescription_id) {\r\n                this.admissionPrescriptionService\r\n                    .getPrescriptionDataByPrescriptionId(this.iPDMedicineRequest.admission_prescription_id)\r\n                    .then((data) => this.prescriptionData(data.data));\r\n            }\r\n        },\r\n        prescriptionData(data) {\r\n            this.iPDPrescriptionMedicineList = [];\r\n            data.forEach((element) => {\r\n                this.iPDPrescriptionMedicineList.push({\r\n                    medicine_id: element.medicine_id,\r\n                    medicine_name: element.medicine_name,\r\n                    barcode: element.barcode,\r\n                    treatment_rule_name: element.treatment_rule_name,\r\n                    treatment_duration_name: element.treatment_duration_name,\r\n                    treatment_dose_name: element.treatment_dose_name,\r\n                    medicine_generic_name: element.medicine_generic_name,\r\n                    strgenth: element.strgenth,\r\n                    medicine_type_name: element.medicine_type_name,\r\n                    uom_name: element.uom_name,\r\n                    manufacturer_name: element.manufacturer_name,\r\n                    request_qty: 1,\r\n                    isCheck: false\r\n                });\r\n            });\r\n        },\r\n        // Add Medicine\r\n        addNewMedicine() {\r\n            this.medicineSetupService\r\n                .getAll()\r\n                .then((data) => this.getMedicineList(data.data));\r\n        },\r\n        getMedicineList(data) {\r\n            this.medicineList = data;\r\n            this.addMedicineDialog = true;\r\n        },\r\n        searchMedicine(event) {\r\n            setTimeout(() => {\r\n                if (!event.query.trim().length) {\r\n                    this.filteredItems = [...this.medicineList];\r\n                }\r\n                else {\r\n                    // start with\r\n                    // this.filteredItems = this.medicineList.filter((item) => {\r\n                    //     return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n                    // });\r\n\r\n                    // contains\r\n                    this.filteredItems = FilterService.filter(this.medicineList, ['medicine_name'], event.query.toLowerCase(), FilterMatchMode.CONTAINS).slice(0, 10);\r\n                }\r\n            }, 250);\r\n        },\r\n        addRequestMedicine() {\r\n            this.submitted = true;\r\n            if (!this.addMedicine.ddlmedicine) {\r\n                return;\r\n            } else if (!this.addMedicine.request_qty) {\r\n                return;\r\n            } else {\r\n                this.iPDPrescriptionMedicineList.push({\r\n                    medicine_id: this.addMedicine.ddlmedicine.medicine_id,\r\n                    medicine_name: this.addMedicine.ddlmedicine.medicine_name,\r\n                    barcode: this.addMedicine.ddlmedicine.barcode,\r\n                    medicine_generic_name: this.addMedicine.ddlmedicine._medicine_generic_name,\r\n                    strgenth: this.addMedicine.ddlmedicine.strgenth,\r\n                    medicine_type_name: this.addMedicine.ddlmedicine._medicine_type_name,\r\n                    uom_name: this.addMedicine.ddlmedicine._uom_name,\r\n                    medicine_manufacturer_name: this.addMedicine.ddlmedicine._manufacturer_name,\r\n                    isCheck: true,\r\n                    request_qty: this.addMedicine.request_qty\r\n                });\r\n                this.submitted = false;\r\n            }\r\n            this.setRequestMedicine();\r\n        },\r\n        setRequestMedicine() {\r\n            var filterData = this.iPDPrescriptionMedicineList.filter(function (el) {\r\n                return el.isCheck == true;\r\n            }, this);\r\n\r\n            filterData.forEach((element) => {\r\n                var aMedicine =\r\n                    this.iPDMedicineRequest.lstMedicineRequestDetails.filter(\r\n                        function (el) {\r\n                            return el.medicine_id === element.medicine_id;\r\n                        },\r\n                        this\r\n                    );\r\n                if (!aMedicine.length) {\r\n                    this.iPDMedicineRequest.lstMedicineRequestDetails.push({\r\n                        medicine_id: element.medicine_id,\r\n                        medicine_name: element.medicine_name,\r\n                        barcode: element.barcode,\r\n                        treatment_rule_name: element.treatment_rule_name,\r\n                        treatment_duration_name: element.treatment_duration_name,\r\n                        treatment_dose_name: element.treatment_dose_name,\r\n                        medicine_generic_name: element.medicine_generic_name,\r\n                        medicine_strgenth: element.strgenth,\r\n                        medicine_type_name: element.medicine_type_name,\r\n                        medicine_uom_name: element.uom_name,\r\n                        medicine_manufacturer_name: element.manufacturer_name,\r\n                        isCheck: element.isCheck,\r\n                        request_qty: (element.request_qty == \"\" || element.request_qty == 0) ? 1 : element.request_qty\r\n                    });\r\n                    this.hideDialog();\r\n                }\r\n                else {\r\n                    this.$toast.add({\r\n                        severity: \"warn\",\r\n                        summary: \"Warn Message\",\r\n                        detail: aMedicine[0].medicine_name + \" already added\",\r\n                        life: 10000,\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        deleteRequestMedicine(data) {\r\n            this.iPDMedicineRequest.lstMedicineRequestDetails = this.iPDMedicineRequest.lstMedicineRequestDetails.filter(function (el) {\r\n                return el.medicine_id != data.medicine_id;\r\n            }, this);\r\n        },\r\n        // Medicine Request\r\n        async medicineRequest() {\r\n            try {\r\n                this.iPDMedicineRequest.invoice_id = this.invoice_id;\r\n                this.iPDMedicineRequest.admission_no = this.admission_no;\r\n                this.iPDMedicineRequest.patient_registration_no = this.registration_no;\r\n                this.iPDMedicineRequest.patient_name = this.patient_name;\r\n                var aMedicine = this.iPDMedicineRequest.lstMedicineRequestDetails.filter(function (el) {\r\n                    return el.request_qty == \"\";\r\n                }, this);\r\n\r\n                if (!this.iPDMedicineRequest.invoice_id) {\r\n                    return;\r\n                } else if (!this.iPDMedicineRequest.admission_no) {\r\n                    return;\r\n                } else if (!this.iPDMedicineRequest.patient_registration_no) {\r\n                    return;\r\n                } else if (!this.iPDMedicineRequest.patient_name) {\r\n                    return;\r\n                } else if (aMedicine.length) {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Failed\",\r\n                        detail: \"Please enter medicine qty\",\r\n                        life: 10000,\r\n                    });\r\n                    return;\r\n                } else if (\r\n                    !this.iPDMedicineRequest.lstMedicineRequestDetails.length\r\n                ) {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Failed\",\r\n                        detail: \"Please add medicine for request\",\r\n                        life: 10000,\r\n                    });\r\n                    return;\r\n                } else {\r\n                    let result = await this.medicineRequestService.add(\r\n                        this.iPDMedicineRequest, this\r\n                    );\r\n                    if (result.status === 200) {\r\n                        this.$toast.add({\r\n                            severity: \"success\",\r\n                            summary: \"Success\",\r\n                            detail: \"Request Successfully\",\r\n                            life: 10000,\r\n                        });\r\n                        this.hideMedicineRequest();\r\n                        this.getMedicineRequestListByAdmissionNo(this.admission_no);\r\n                        this.printMedicineRequest(result.data);\r\n\r\n                    } else {\r\n                        this.$toast.add({\r\n                            severity: \"error\",\r\n                            summary: \"Failed\",\r\n                            detail: result.res,\r\n                            life: 10000,\r\n                        });\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                this.$toast.add({\r\n                    severity: \"error\",\r\n                    summary: \"Failed\",\r\n                    detail: error,\r\n                    life: 10000,\r\n                });\r\n            }\r\n        },\r\n        // formatInvestigationList(data) {\r\n        //     let filterData = data.filter(function (el) {\r\n        //         return el.active == true;\r\n        //     }, this);\r\n        //     filterData.forEach((element) => {\r\n        //         var obj = element;\r\n        //         obj.investingation_name = element.manual_code + \"-\" + element.investingation_name;\r\n        //         this.investigationList.push(obj);\r\n        //     });\r\n        // },\r\n        // mergeReferredByInfo(data) {\r\n        //     let filterData = data.filter(function (el) {\r\n        //         return el.active == true;\r\n        //     }, this);\r\n        //     filterData.forEach((element) => {\r\n        //         this.referredByList.push({\r\n        //             value: element.registration_no,\r\n        //             text: element.manual_code + \"-\" + element.registration_no + \"-\" + element.reffered_by_name + \"(Referred By)\",\r\n        //         });\r\n        //     });\r\n        // },\r\n        // mergeDoctorInfo(data) {\r\n        //     //this.doctorList = data;\r\n        //     data.forEach((element) => {\r\n        //         this.referredByList.push({\r\n        //             value: element.doc_no,\r\n        //             text: element.doc_no + \"-\" + element.doctor_name + \"(Doctor)\",\r\n        //         });\r\n        //     });\r\n\r\n        //     data.forEach((element) => {\r\n        //         this.doctorList.push({\r\n        //             department_id: element.department_id,\r\n        //             doctor_id: element.doctor_id,\r\n        //             doctor_name: element.doc_no + \"-\" + element.doctor_name,\r\n        //         });\r\n        //     });\r\n        // },\r\n        // mergeEmployeeInfo(data) {\r\n        //     let filterData = data.filter(function (el) {\r\n        //         return el.active == true;\r\n        //     }, this);\r\n        //     filterData.forEach((element) => {\r\n        //         this.referredByList.push({\r\n        //             value: element.emp_no,\r\n        //             text: element.emp_no + \"-\" + element.first_name + \"(Employee)\",\r\n        //         });\r\n        //     });\r\n        // },\r\n        // mergeDoctorInfo(data) {\r\n        //   this.doctorList = data;\r\n        //   data.forEach((element) => {\r\n        //     this.discountByList.push({\r\n        //       value: element.doc_no,\r\n        //       text: element.doc_no + \"-\" + element.doctor_name + \"(Doctor)\",\r\n        //     });\r\n        //   });\r\n        // },\r\n        // mergeEmployeeInfo(data) {\r\n        //   data.forEach((element) => {\r\n        //     this.discountByList.push({\r\n        //       value: element.emp_no,\r\n        //       text: element.emp_no + \"-\" + element.first_name + \"(Employee)\",\r\n        //     });\r\n        //   });\r\n        // },\r\n        // invReset() {\r\n        //     this.isInvestigation = true;\r\n        //     this.patientInvestigationRequest.ddlinvestigation = \"\";\r\n        //     this.isExist = \"\";\r\n        // },\r\n        reset() {\r\n            //this.isInvestigation = true;\r\n            //this.isPrescription = false;\r\n            //this.button = false;\r\n            //this.isValid = \"\";\r\n            //this.isEmailValid = \"\";\r\n            this.isExist = \"\";\r\n            //this.isContactExist = \"\";\r\n            this.patientInvestigationRequest = {\r\n                patient_id: \"\",\r\n                aPatient: {\r\n                    age_year: \"0\",\r\n                    age_month: \"0\",\r\n                    age_day: \"0\",\r\n                },\r\n                cdinvestigation_request_date: moment(String(new Date())).format(\r\n                    \"MM/DD/YYYY\"\r\n                ),\r\n                report_delivery_type: \"Regular\",\r\n                lstInvestigationRequestDetails: [],\r\n                lstInvestigationParticular: [],\r\n                discount_by_id: \"Company\",\r\n                discount_percent: 0,\r\n                discount_amount: 0,\r\n                cost_price: 0,\r\n                particular_cost_price: 0,\r\n                total_amount: 0,\r\n            };\r\n            this.submitted = false;\r\n            this.iPDInvestigationRequest = {\r\n                investigation_request_id: null,\r\n                admission_id: null,\r\n            }\r\n        },\r\n        // doctorReset() {\r\n        //     this.patientInvestigationRequest.department_id = \"\";\r\n        //     this.patientInvestigationRequest.reffered_doctor_id = \"\";\r\n        //     this.patientInvestigationRequest.designation_id = \"\";\r\n        //     this.patientInvestigationRequest.outside_doctor_name = \"\";\r\n        //     this.patientInvestigationRequest.outside_doctor_hospital_name = \"\";\r\n        // },\r\n        // filterDoctorsDepartmentWise() {\r\n        //     return this.doctorList.filter(function (el) {\r\n        //         return (\r\n        //             el.department_id === this.patientInvestigationRequest.department_id\r\n        //         );\r\n        //     }, this);\r\n        // },\r\n        // getConsultancyFeeByDoctorId() {\r\n        //     var aDoctor = this.doctorList.filter(function (el) {\r\n        //         return el.doctor_id === this.patientInvestigationRequest.doctor_id;\r\n        //     }, this);\r\n\r\n        //     this.patientInvestigationRequest.consultancy_fee =\r\n        //         aDoctor[0].consultancy_fee;\r\n        //     this.patientInvestigationRequest.building_id = aDoctor[0]._building_id;\r\n        //     this.patientInvestigationRequest.room_id = aDoctor[0].room_id;\r\n        // },\r\n        // filterRoomsBuildingWise() {\r\n        //     return this.roomList.filter(function (el) {\r\n        //         return el.building_id === this.patientInvestigationRequest.building_id;\r\n        //     }, this);\r\n        // },\r\n        // filterInvestigation() {\r\n        //     return this.investigationList.filter(function (el) {\r\n        //         return el.active == true;\r\n        //     }, this);\r\n        // },\r\n        // filterProduct() {\r\n        //     return this.productList.filter(function (el) {\r\n        //         return el.product_category_id == 1 && el.active == true;\r\n        //     }, this);\r\n        // },\r\n        // getFormatted(data) {\r\n        //     this.patientInvestigationRequest.aPatient = data;\r\n        //     if (!this.patientInvestigationRequest.aPatient.patient_id) {\r\n        //         this.isPatientExist = \"Patient not Exist!\";\r\n        //         // this.patientInvestigationRequest = {\r\n        //         //   patient_id: \"\",\r\n        //         //   aPatient: {},\r\n        //         // };\r\n        //         this.reset();\r\n        //     } else {\r\n        //         this.isPatientExist = \"\";\r\n\r\n        //         this.patientInvestigationRequest.patient_id =\r\n        //             this.patientInvestigationRequest.aPatient.patient_id;\r\n        //         this.patientInvestigationRequest.aPatient.cddob = moment(\r\n        //             String(this.patientInvestigationRequest.aPatient.dob)\r\n        //         ).format(\"YYYY-MM-DD\");\r\n        //         this.patientInvestigationRequest.aPatient.age_year = this.patientInvestigationRequest.aPatient.age_year.toString();\r\n        //         this.patientInvestigationRequest.aPatient.age_month = this.patientInvestigationRequest.aPatient.age_month.toString();\r\n        //         this.patientInvestigationRequest.aPatient.age_day = this.patientInvestigationRequest.aPatient.age_day.toString();\r\n        //     }\r\n        // },\r\n        getFormattedPrescriptionWiseInvestigations(data) {\r\n            this.patientInvestigationRequest.admission_id = data[0].admission_id;\r\n            this.patientInvestigationRequest.aPatient.first_name = \"IPD\";\r\n            this.patientInvestigationRequest.aPatient.contact_no = \"017\";\r\n            this.patientInvestigationRequest.patient_id = this.patient_id;\r\n            this.patientInvestigationRequest.reffered_doctor_id = this.doctor_id;\r\n            this.patientInvestigationRequest.reffered_by_id = this.reffered_by_id;\r\n            // this.patientInvestigationRequest.aPatient.age_year = this.patientInvestigationRequest.aPatient.age_year.toString();\r\n            // this.patientInvestigationRequest.aPatient.age_month = this.patientInvestigationRequest.aPatient.age_month.toString();\r\n            // this.patientInvestigationRequest.aPatient.age_day = this.patientInvestigationRequest.aPatient.age_day.toString();\r\n            // this.patientInvestigationRequest.department_id = data[0].department_id;\r\n            // this.patientInvestigationRequest.reffered_doctor_id = data[0].doctor_id;\r\n            // this.patientInvestigationRequest.reffered_by_id = data[0].doc_no;\r\n            //this.isPrescription = true;\r\n            data.forEach((element) => {\r\n                var aInvestigation =\r\n                    this.investigationList.filter(\r\n                        function (el) {\r\n                            return (\r\n                                el.investigation_id ===\r\n                                element.investigation_id\r\n                            );\r\n                        },\r\n                        this\r\n                    )[0];\r\n\r\n                this.patientInvestigationRequest.ddlinvestigation = aInvestigation;\r\n                this.addInvestigation();\r\n            });\r\n            this.add();\r\n        },\r\n        // findPatient() {\r\n        //     let str = this.patientInvestigationRequest.contactOrRegNo;\r\n\r\n        //     if (str.startsWith(\"PRES\")) {\r\n        //         this.appointmentPrescriptionService\r\n        //             .prescriptionWiseInvestigations(this.patientInvestigationRequest.contactOrRegNo, this)\r\n        //             .then((data) => this.getFormattedPrescriptionWiseInvestigations(data.data));\r\n        //     } else {\r\n        //         this.isPrescription = false;\r\n        //         this.patientRegistrationService\r\n        //             .getByContactOrRegNo(this.patientInvestigationRequest.contactOrRegNo, this)\r\n        //             .then((data) => this.getFormatted(data.data));\r\n        //     }\r\n        // },\r\n        // isExistContact() {\r\n        //     if (\r\n        //         this.patientInvestigationRequest.aPatient.contact_no.match(\r\n        //             /^(01)([0-9]{9})$/\r\n        //         )\r\n        //     ) {\r\n        //         this.patientRegistrationService\r\n        //             .getByContactOrRegNo(\r\n        //                 this.patientInvestigationRequest.aPatient.contact_no, this\r\n        //             )\r\n        //             .then((data) => this.getContact(data.data));\r\n        //     } else {\r\n        //         this.isContactExist =\r\n        //             \"Contact number must start with 01 and the required length is 11\";\r\n        //     }\r\n        // },\r\n        // getContact(data) {\r\n        //     if (data.contact_no) {\r\n        //         this.isContactExist = \"Duplicate phone number!\";\r\n        //     } else {\r\n        //         this.isContactExist = \"\";\r\n        //     }\r\n        // },\r\n        investigationIsExist() {\r\n            var aInvestigation =\r\n                this.patientInvestigationRequest.lstInvestigationRequestDetails.filter(\r\n                    function (el) {\r\n                        return (\r\n                            el.investigation_id ===\r\n                            this.patientInvestigationRequest.ddlinvestigation.investigation_id\r\n                        );\r\n                    },\r\n                    this\r\n                );\r\n\r\n            if (aInvestigation.length) {\r\n                this.isExist = \"This Investigation already added\";\r\n                this.isInvestigation = true;\r\n                return;\r\n            } else {\r\n                // var aInv = this.investigationList.filter(function (el) {\r\n                //   return (\r\n                //     el.investigation_id ===\r\n                //     this.patientInvestigationRequest.ddlinvestigation.investigation_id\r\n                //   );\r\n                // }, this);\r\n                // this.collectionCenterSetupService\r\n                //   .getById(aInv[0].collection_center_id)\r\n                //   .then((data) => (this.collectionList = data.data));\r\n\r\n                this.isExist = \"\";\r\n                this.isInvestigation = false;\r\n            }\r\n        },\r\n        addInvestigation() {\r\n            this.submitted = true;\r\n            var aInvestigation =\r\n                this.patientInvestigationRequest.lstInvestigationRequestDetails.filter(\r\n                    function (el) {\r\n                        return (\r\n                            el.investigation_id ===\r\n                            this.patientInvestigationRequest.ddlinvestigation.investigation_id\r\n                        );\r\n                    },\r\n                    this\r\n                );\r\n\r\n            if (aInvestigation.length) {\r\n                this.isExist = \"This Investigation already added\";\r\n                //this.isInvestigation = true;\r\n                return;\r\n            } else {\r\n                if (!this.patientInvestigationRequest.ddlinvestigation) {\r\n                    return;\r\n                } else if (!this.patientInvestigationRequest.report_delivery_type) {\r\n                    return;\r\n                } else if (\r\n                    !this.patientInvestigationRequest.cdinvestigation_request_date\r\n                ) {\r\n                    return;\r\n                } else {\r\n                    this.isExist = \"\";\r\n                    var cost =\r\n                        this.patientInvestigationRequest.report_delivery_type == \"Regular\"\r\n                            ? this.patientInvestigationRequest.ddlinvestigation.charge\r\n                            : this.patientInvestigationRequest.ddlinvestigation.urgent_carge;\r\n\r\n                    var deliveryTime = this.patientInvestigationRequest.report_delivery_type == \"Regular\" ? this.expectedHour(this.patientInvestigationRequest.ddlinvestigation.report_delivery_duration) : this.expectedHour(this.patientInvestigationRequest.ddlinvestigation.emmergency_report_delivery_duration);\r\n\r\n                    var discountAmount =\r\n                        (1 *\r\n                            cost *\r\n                            this.patientInvestigationRequest.ddlinvestigation\r\n                                .discount_percent) /\r\n                        100;\r\n\r\n                    var totalAmount = 1 * cost - discountAmount;\r\n\r\n                    var obj = {\r\n                        investigation_id:\r\n                            this.patientInvestigationRequest.ddlinvestigation\r\n                                .investigation_id,\r\n                        _investingation_name:\r\n                            this.patientInvestigationRequest.ddlinvestigation\r\n                                .investingation_name,\r\n                        _investigation_category_head_name:\r\n                            this.patientInvestigationRequest.ddlinvestigation\r\n                                ._investigation_category_head_name,\r\n\r\n                        // building_id: this.collectionList._building_id,\r\n                        // _building_name: this.collectionList._building_name,\r\n                        // room_id: this.collectionList.room_id,\r\n                        // _room_name: this.collectionList._room_name,\r\n                        building_id: this.patientInvestigationRequest.ddlinvestigation._building_id,\r\n                        room_id: this.patientInvestigationRequest.ddlinvestigation._room_id,\r\n                        expected_delivery: deliveryTime,\r\n\r\n                        report_delivery_type:\r\n                            this.patientInvestigationRequest.report_delivery_type,\r\n\r\n                        quantity: 1,\r\n                        cost_price: cost,\r\n\r\n                        discount_percent:\r\n                            this.patientInvestigationRequest.ddlinvestigation\r\n                                .discount_percent,\r\n\r\n                        discount_amount: discountAmount,\r\n\r\n                        total_amount: totalAmount,\r\n                    };\r\n\r\n                    this.patientInvestigationRequest.lstInvestigationRequestDetails.push(\r\n                        obj\r\n                    );\r\n\r\n                    this.patientInvestigationRequest.cost_price =\r\n                        this.patientInvestigationRequest.cost_price + totalAmount;\r\n                    //\r\n                    this.calculateTotalAmount();\r\n                    // this.patientInvestigationRequest.total_amount =\r\n                    //   this.patientInvestigationRequest.cost_price -\r\n                    //   this.patientInvestigationRequest.discount_amount;\r\n                }\r\n            }\r\n\r\n            this.addParticular(\r\n                this.patientInvestigationRequest.ddlinvestigation.investigation_id\r\n            );\r\n        },\r\n        calculatePerInvestigationDiscountPercent(data) {\r\n            this.patientInvestigationRequest.lstInvestigationRequestDetails.forEach(\r\n                (element) => {\r\n                    if (element.investigation_id == data.investigation_id) {\r\n                        element.discount_percent = (element.discount_amount / element.cost_price) * 100;\r\n                        //var discount_amount = (element.cost_price * element.discount_percent) / 100;\r\n                        element.total_amount = element.cost_price - element.discount_amount;\r\n                    }\r\n                }\r\n            );\r\n            this.calculateCostPrice();\r\n        },\r\n        calculatePerInvestigationDiscountAmount(data) {\r\n            this.patientInvestigationRequest.lstInvestigationRequestDetails.forEach(\r\n                (element) => {\r\n                    if (element.investigation_id == data.investigation_id) {\r\n                        element.discount_amount = (element.cost_price * element.discount_percent) / 100;\r\n                        element.total_amount = element.cost_price - element.discount_amount;\r\n                    }\r\n                }\r\n            );\r\n            this.calculateCostPrice();\r\n        },\r\n        calculateCostPrice() {\r\n            var costPrice = 0;\r\n            this.patientInvestigationRequest.lstInvestigationRequestDetails.forEach(\r\n                (element) => {\r\n                    costPrice = costPrice + element.total_amount;\r\n                }\r\n            );\r\n            this.patientInvestigationRequest.cost_price = costPrice;\r\n\r\n            this.calculateTotalAmount();\r\n        },\r\n        calculateTotalAmount() {\r\n            this.patientInvestigationRequest.total_amount = Math.ceil(\r\n                this.patientInvestigationRequest.cost_price -\r\n                this.patientInvestigationRequest.discount_amount +\r\n                this.patientInvestigationRequest.particular_cost_price);\r\n        },\r\n        addParticular(id) {\r\n            this.investigationSetupService\r\n                .getById(id)\r\n                .then((data) => this.getParticularFormatted(data));\r\n        },\r\n        addAParticular(data, qty, pname) {\r\n            if (\r\n                this.patientInvestigationRequest.lstInvestigationRequestDetails\r\n                    .length <= 0\r\n            ) {\r\n                this.isExist = \"Add Investigation\";\r\n                return;\r\n            } else {\r\n                this.isExist = \"\";\r\n                var obj =\r\n                    this.patientInvestigationRequest.lstInvestigationParticular.filter(\r\n                        function (el) {\r\n                            return el.product_id === data.product_id;\r\n                        },\r\n                        this\r\n                    )[0];\r\n                if (obj) {\r\n                    qty = parseInt(obj.qty) + qty;\r\n\r\n                    this.patientInvestigationRequest.lstInvestigationParticular =\r\n                        this.patientInvestigationRequest.lstInvestigationParticular.filter(\r\n                            function (el) {\r\n                                return el.product_id != data.product_id;\r\n                            },\r\n                            this\r\n                        );\r\n                }\r\n\r\n                this.patientInvestigationRequest.lstInvestigationParticular.push({\r\n                    product_id: data.product_id,\r\n                    _product_name: pname,\r\n                    uom_id: data.uom_id,\r\n                    _uom_name: data._uom_name,\r\n                    cost_price: data.cost_price,\r\n                    qty: qty,\r\n                });\r\n\r\n                this.checkQty();\r\n            }\r\n        },\r\n        getParticularFormatted(data) {\r\n            data.data._lstInvestigationParticular.forEach((element) => {\r\n                // this.patientInvestigationRequest.lstInvestigationParticular.push({\r\n                //   investigation_id: element.investigation_id,\r\n                //   product_id: element.product_id,\r\n                //   _product_name: element._product_name,\r\n                //   uom_id: element.uom_id,\r\n                //   _uom_name: element._uom_name,\r\n                //   cost_price: element.cost_price,\r\n                //   qty: element.qty,\r\n                // });\r\n\r\n                this.addAParticular(element, 1, element._product_name);\r\n            });\r\n        },\r\n        checkQty() {\r\n            var totalPrice = 0;\r\n            this.patientInvestigationRequest.lstInvestigationParticular.forEach(\r\n                (element) => {\r\n                    if (\r\n                        element.qty >\r\n                        this.patientInvestigationRequest.lstInvestigationRequestDetails\r\n                            .length\r\n                    ) {\r\n                        element.qty =\r\n                            this.patientInvestigationRequest.lstInvestigationRequestDetails.length;\r\n                    } else if (element.qty <= 0) {\r\n                        element.qty = 1;\r\n                    }\r\n\r\n                    element.totalPrice = element.qty * element.cost_price;\r\n                    totalPrice += element.totalPrice;\r\n                }\r\n            );\r\n            this.patientInvestigationRequest.particular_cost_price = totalPrice;\r\n            this.calculateTotalAmount();\r\n        },\r\n        getDiscountPercent() {\r\n            this.patientInvestigationRequest.discount_percent = Math.ceil(\r\n                (this.patientInvestigationRequest.discount_amount /\r\n                    this.patientInvestigationRequest.cost_price) *\r\n                100);\r\n\r\n            // this.patientInvestigationRequest.total_amount = Math.ceil(\r\n            //   this.patientInvestigationRequest.cost_price -\r\n            //   this.patientInvestigationRequest.discount_amount);\r\n            this.calculateTotalAmount();\r\n        },\r\n        getDiscountAmount() {\r\n            this.patientInvestigationRequest.discount_amount =\r\n                (this.patientInvestigationRequest.cost_price *\r\n                    this.patientInvestigationRequest.discount_percent) /\r\n                100;\r\n\r\n            // this.patientInvestigationRequest.total_amount = Math.ceil(\r\n            //   this.patientInvestigationRequest.cost_price -\r\n            //   this.patientInvestigationRequest.discount_amount);\r\n            this.calculateTotalAmount();\r\n        },\r\n        expectedHour(h) {\r\n            // var today = new Date();\r\n            // today.setHours(today.getHours() + h);\r\n            var travelTime = moment().add(h, 'hours').format('YYYY-MM-DD hh:mm A');\r\n            return travelTime;\r\n        },\r\n        deleteFromList(data) {\r\n            this.patientInvestigationRequest.lstInvestigationRequestDetails =\r\n                this.patientInvestigationRequest.lstInvestigationRequestDetails.filter(\r\n                    function (el) {\r\n                        return el.investigation_id != data.investigation_id;\r\n                    },\r\n                    this\r\n                );\r\n            this.patientInvestigationRequest.cost_price =\r\n                this.patientInvestigationRequest.cost_price - data.total_amount;\r\n            this.calculateTotalAmount();\r\n            this.checkQty();\r\n\r\n            if (\r\n                !this.patientInvestigationRequest.lstInvestigationRequestDetails.length\r\n            ) {\r\n                this.patientInvestigationRequest.lstInvestigationParticular = [];\r\n                this.patientInvestigationRequest.particular_cost_price = 0;\r\n                this.calculateTotalAmount();\r\n            }\r\n        },\r\n        deleteFromParticularList(data) {\r\n            this.patientInvestigationRequest.lstInvestigationParticular =\r\n                this.patientInvestigationRequest.lstInvestigationParticular.filter(\r\n                    function (el) {\r\n                        return el.product_id != data.product_id;\r\n                    },\r\n                    this\r\n                );\r\n            this.patientInvestigationRequest.particular_cost_price =\r\n                this.patientInvestigationRequest.particular_cost_price -\r\n                data.totalPrice;\r\n            this.calculateTotalAmount();\r\n        },\r\n        async add() {\r\n            try {\r\n                if (\r\n                    !this.patientInvestigationRequest.cdinvestigation_request_date\r\n                ) {\r\n                    return;\r\n                } else if (\r\n                    !this.patientInvestigationRequest.lstInvestigationRequestDetails\r\n                        .length\r\n                ) {\r\n                    this.isExist = \"Please add a Investigation\";\r\n                    return;\r\n                } else {\r\n                    this.patientInvestigationRequest.investigation_request_date = moment(\r\n                        String(\r\n                            this.patientInvestigationRequest.cdinvestigation_request_date\r\n                        )\r\n                    ).format(\"YYYY-MM-DD\");\r\n\r\n                    var currentDate = new Date();\r\n                    var dob = new Date(currentDate.getFullYear() - this.patientInvestigationRequest.aPatient.age_year, currentDate.getMonth() - this.patientInvestigationRequest.aPatient.age_month, currentDate.getDate() - this.patientInvestigationRequest.aPatient.age_day);\r\n                    this.patientInvestigationRequest.aPatient.dob = moment(\r\n                        String(dob)\r\n                    ).format(\"YYYY-MM-DD\");\r\n                    //\r\n                    this.patientInvestigationRequest.aPatient.age_year = this.patientInvestigationRequest.aPatient.age_year.toString();\r\n                    this.patientInvestigationRequest.aPatient.age_month = this.patientInvestigationRequest.aPatient.age_month.toString();\r\n                    this.patientInvestigationRequest.aPatient.age_day = this.patientInvestigationRequest.aPatient.age_day.toString();\r\n\r\n                    let result = await this.patientInvestigationRequestService.add(\r\n                        this.patientInvestigationRequest, this\r\n                    );\r\n                    if (result.status === 200) {\r\n                        this.$toast.add({\r\n                            severity: \"success\",\r\n                            summary: \"Success\",\r\n                            detail: \"Request Successfully\",\r\n                            life: 10000,\r\n                        });\r\n                        this.printInvestigationToken(result.data);\r\n                        //this.iPDInvestigationRequest.investigation_request_id = result.data.toString();\r\n                        //this.iPDInvestigationRequest.admission_id = this.admission_id;\r\n                        //this.iPDInvestigationRequestSave();\r\n                        //this.confirmPay(result.data);\r\n                        this.getIPDInvestigationRequestByAdmissionId(this.admission_id);\r\n                        this.reset();\r\n                        this.hideDialog();\r\n                    } else if (result.status === 401) {\r\n                        this.$toast.add({\r\n                            severity: \"error\",\r\n                            summary: \"Error\",\r\n                            detail: result.data,\r\n                            life: 10000,\r\n                        });\r\n                    } else {\r\n                        this.$toast.add({\r\n                            severity: \"error\",\r\n                            summary: \"Failed\",\r\n                            detail: result.res,\r\n                            life: 10000,\r\n                        });\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                this.$toast.add({\r\n                    severity: \"error\",\r\n                    summary: \"Failed\",\r\n                    detail: error,\r\n                    life: 10000,\r\n                });\r\n            }\r\n        },\r\n\r\n\r\n        // Service\r\n        takeService(data) {\r\n            this.iPDServiceObj.admission_id = data.admission_id;\r\n            this.serviceDialog = true;\r\n        },\r\n        // Package\r\n        takePackage(data) {\r\n            this.iPDServicePackageObj.admission_id = data.admission_id;\r\n            this.servicePackageDialog = true;\r\n        },\r\n        // Taken Service & Package\r\n        takenList(data) {\r\n            this.iPDService\r\n                .getTakenServiceAndServicePackage(data.admission_id)\r\n                .then((data) => this.formattedTakenList(data.data));\r\n        },\r\n        // View Round Doctor\r\n        viewRoundDoctor(data) {\r\n            this.assignRoundDoctor = {\r\n                //round_time: moment(String(new Date())).format(\"MM/DD/YYYY h:mm A\"),\r\n            };\r\n            this.assignRoundDoctor.admission_id = data.admission_id;\r\n            this.iPDService\r\n                .getAssignIPDRoundDoctor(data.admission_id)\r\n                .then((data) => this.formattedRoundDoctorList(data.data));\r\n        },\r\n        setMainConsultant() {\r\n            if (!this.assignRoundDoctor.isMainConsultant) {\r\n                var aAdmittedPatient = this.admittedPatientList.filter(function (el) {\r\n                    return el.admission_id === this.assignRoundDoctor.admission_id;\r\n                }, this);\r\n                this.assignRoundDoctor.department_id = aAdmittedPatient[0].consultancy_department_id;\r\n                this.assignRoundDoctor.round_doctor_id = aAdmittedPatient[0].doctor_id;\r\n                this.assignRoundDoctor.charge = aAdmittedPatient[0].ipd_consultancy_fee;\r\n            } else {\r\n                this.assignRoundDoctor.department_id = \"\";\r\n                this.assignRoundDoctor.round_doctor_id = \"\";\r\n                this.assignRoundDoctor.charge = \"\";\r\n            }\r\n        },\r\n        mergeDoctorInfo(data) {\r\n            data.forEach((element) => {\r\n                var obj = element;\r\n                obj.doctor_degree = \"\";\r\n                obj.lstConsultantDegree.forEach((el) => {\r\n                    obj.doctor_degree += el.consultant_degree_name + \". \";\r\n                });\r\n\r\n                obj.doctor_name = element.doc_no + \" - (\" + obj.doctor_degree + \") - \" + element.doctor_name;\r\n                this.doctorList.push(obj);\r\n            });\r\n        },\r\n        filterDoctorsDepartmentWise() {\r\n            return this.doctorList.filter(function (el) {\r\n                return el.department_id === this.assignRoundDoctor.department_id;\r\n            }, this);\r\n        },\r\n        getCharge() {\r\n            var aDoctor = this.doctorList.filter(function (el) {\r\n                return el.doctor_id === this.assignRoundDoctor.round_doctor_id;\r\n            }, this);\r\n            this.assignRoundDoctor.charge = aDoctor[0].ipd_consultancy_fee;\r\n        },\r\n        // Round Doctor\r\n        roundDoctor() {\r\n            this.listRoundDoctorDialog = false;\r\n            this.roundDoctorDialog = true;\r\n        },\r\n        formattedRoundDoctorList(data) {\r\n            this.roundDoctorList = [];\r\n            this.roundDoctorList = data;\r\n            this.listRoundDoctorDialog = true;\r\n        },\r\n        formattedTakenList(data) {\r\n            this.takenServicePackageObj.lstTakenService = data.lstTakenService;\r\n            this.takenServicePackageObj.lastTakenServicePackage = data.lastTakenServicePackage;\r\n            this.takenServicePackageDialog = true;\r\n        },\r\n        serviceFormatted(data) {\r\n            let filterData = data.filter(function (el) {\r\n                return el.service_head_id == '1' || el.service_head_id == '3';\r\n            }, this);\r\n            let filterData2 = filterData.filter(function (el) {\r\n                return el.active == true && el.service_type_id != '2';\r\n            }, this);\r\n            this.iPDServiceObj.lstService = [];\r\n            filterData2.forEach((element) => {\r\n                this.iPDServiceObj.lstService.push({\r\n                    service_id: element.service_id,\r\n                    service_name: element.service_name,\r\n                    service_head_id: element.service_head_id,\r\n                    _service_head_name: element._service_head_name,\r\n                    service_type_id: element.service_type_id,\r\n                    _service_type_name: element._service_type_name,\r\n                    service_charge: element.service_charge,\r\n                    er_service_charge: element.er_service_charge,\r\n                    discount: element.discount,\r\n                    isCheck: false\r\n                });\r\n            });\r\n        },\r\n        servicePackageFormatted(data) {\r\n            this.iPDServicePackageObj.lstServicePackage = [];\r\n            data.forEach((element) => {\r\n                this.iPDServicePackageObj.lstServicePackage.push({\r\n                    service_package_id: element.service_package_id,\r\n                    service_package_name: element.service_package_name,\r\n                    charge: element.charge,\r\n                    isCheck: false\r\n                });\r\n            });\r\n        },\r\n        // Assign Round Doctor\r\n        async addDoctorAssign() {\r\n            if (!this.assignRoundDoctor.department_id) {\r\n                return;\r\n            } else if (!this.assignRoundDoctor.round_doctor_id) {\r\n                return;\r\n            } else if (!this.assignRoundDoctor.charge) {\r\n                return;\r\n            } else if (!this.assignRoundDoctor.round_time) {\r\n                return;\r\n            } else {\r\n                //this.assignRoundDoctor.round_time = moment(String(this.assignRoundDoctor.cdround_time)).format(\"YYYY-MM-DD HH:mm:ss\");\r\n                let result = await this.iPDService.assignIPDRoundDoctor(this.assignRoundDoctor, this);\r\n                if (result.status === 200) {\r\n                    this.$toast.add({\r\n                        severity: \"success\",\r\n                        summary: \"Success\",\r\n                        detail: \"Saved Successfully\",\r\n                        life: 10000,\r\n                    });\r\n                    this.hideDialog();\r\n                } else if (result.status === 409) {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Error\",\r\n                        detail: result.data,\r\n                        life: 10000,\r\n                    });\r\n                } else {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Failed\",\r\n                        detail: result.res,\r\n                        life: 10000,\r\n                    });\r\n                }\r\n            }\r\n        },\r\n        async addService() {\r\n            this.iPDServiceObj.lstService = this.iPDServiceObj.lstService.filter(function (el) {\r\n                return el.isCheck == true;\r\n            }, this);\r\n\r\n            if (this.iPDServiceObj.lstService.length > 0) {\r\n                let result = await this.iPDService.saveIPDService(this.iPDServiceObj, this);\r\n                if (result.status === 200) {\r\n                    this.$toast.add({\r\n                        severity: \"success\",\r\n                        summary: \"Success\",\r\n                        detail: \"Saved Successfully\",\r\n                        life: 10000,\r\n                    });\r\n                    this.hideDialog();\r\n                    this.getService();\r\n                } else if (result.status === 401) {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Error\",\r\n                        detail: result.data,\r\n                        life: 10000,\r\n                    });\r\n                } else {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Failed\",\r\n                        detail: result.res,\r\n                        life: 10000,\r\n                    });\r\n                }\r\n            } else {\r\n                this.getService();\r\n                this.$toast.add({\r\n                    severity: \"error\",\r\n                    summary: \"Failed\",\r\n                    detail: \"Select Service\",\r\n                    life: 10000,\r\n                });\r\n            }\r\n        },\r\n        async addServicePackage() {\r\n            this.iPDServicePackageObj.lstServicePackage = this.iPDServicePackageObj.lstServicePackage.filter(function (el) {\r\n                return el.isCheck == true;\r\n            }, this);\r\n\r\n            if (this.iPDServicePackageObj.lstServicePackage.length > 0) {\r\n                let result = await this.iPDService.saveIPDServicePackage(this.iPDServicePackageObj, this);\r\n                if (result.status === 200) {\r\n                    this.$toast.add({\r\n                        severity: \"success\",\r\n                        summary: \"Success\",\r\n                        detail: \"Saved Successfully\",\r\n                        life: 10000,\r\n                    });\r\n                    this.hideDialog();\r\n                    this.getServicePackage();\r\n                } else if (result.status === 401) {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Error\",\r\n                        detail: result.data,\r\n                        life: 10000,\r\n                    });\r\n                } else {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Failed\",\r\n                        detail: result.res,\r\n                        life: 10000,\r\n                    });\r\n                }\r\n            } else {\r\n                this.getServicePackage();\r\n                this.$toast.add({\r\n                    severity: \"error\",\r\n                    summary: \"Failed\",\r\n                    detail: \"Select Package\",\r\n                    life: 10000,\r\n                });\r\n            }\r\n        },\r\n\r\n        // Blood Bank\r\n        getBloodRequestListByAdmissionId(admission_id) {\r\n            this.bloodRequestService.getBloodRequestListByAdmissionId(admission_id)\r\n                .then((data) => (this.iPDBloodRequestList = data.data));\r\n        },\r\n        newBloodRequest() {\r\n            this.bloodRequestDialog = true;\r\n        },\r\n        async bloodRequest() {\r\n            this.submitted = true;\r\n            if (!this.bloodRequestObj.total_bag) {\r\n                return;\r\n            } else if (!this.bloodRequestObj.blood_group) {\r\n                return;\r\n            } else if (!this.bloodRequestObj.admission_id) {\r\n                return;\r\n            } else {\r\n                let result = await this.bloodRequestService.add(this.bloodRequestObj, this);\r\n                if (result.status === 200) {\r\n                    this.$toast.add({\r\n                        severity: \"success\",\r\n                        summary: \"Success\",\r\n                        detail: \"Saved Successfully\",\r\n                        life: 10000,\r\n                    });\r\n                    this.getBloodRequestListByAdmissionId(this.bloodRequestObj.admission_id)\r\n                    this.hideDialog();\r\n                } else if (result.status === 409) {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Error\",\r\n                        detail: result.data,\r\n                        life: 10000,\r\n                    });\r\n                } else {\r\n                    this.$toast.add({\r\n                        severity: \"error\",\r\n                        summary: \"Failed\",\r\n                        detail: result.res,\r\n                        life: 10000,\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n};"]}]}