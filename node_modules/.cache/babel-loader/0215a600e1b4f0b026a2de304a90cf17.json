{"remainingRequest":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\src\\service\\axiosHelper.js","dependencies":[{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\src\\service\\axiosHelper.js","mtime":1633924746119},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\DiagnosticCenterManagement_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJGOi9TVk4gUFJPSkVDVFMvRGlhZ25vc3RpY0NlbnRlck1hbmFnZW1lbnRfQ2xpZW50L3RydW5rL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRjovU1ZOIFBST0pFQ1RTL0RpYWdub3N0aWNDZW50ZXJNYW5hZ2VtZW50X0NsaWVudC90cnVuay9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgQVBJX1VSTCB9IGZyb20gJy4uLy4uL3B1YmxpYy9hc3NldHMvLmVudic7CmltcG9ydCB7IEFQSV9VUkxfUkVQT1JUIH0gZnJvbSAnLi4vLi4vcHVibGljL2Fzc2V0cy8uZW52JzsKCnZhciBheGlvc0hlbHBlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gYXhpb3NIZWxwZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgYXhpb3NIZWxwZXIpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKGF4aW9zSGVscGVyLCBbewogICAga2V5OiAiYXhpb3NBZGFwdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBheGlvc0FkYXB0ZXIoKSB7CiAgICAgIHZhciBsb2dpblRva2VuID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9naW5Ub2tlbicpKTsKICAgICAgdmFyIGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKTsKICAgICAgdmFyIG1pbnV0ZSA9IDEwOwogICAgICB2YXIgbGFzdFRva2VuUmVmcmVzaGVkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbGFzdFRva2VuUmVmcmVzaGVkJykpOwoKICAgICAgaWYgKGxhc3RUb2tlblJlZnJlc2hlZCkgewogICAgICAgIGxhc3RUb2tlblJlZnJlc2hlZCA9IG5ldyBEYXRlKGxhc3RUb2tlblJlZnJlc2hlZCk7CiAgICAgICAgbWludXRlID0gTWF0aC5yb3VuZCgoY3VycmVudFRpbWUgLSBsYXN0VG9rZW5SZWZyZXNoZWQpICUgODY0MDAwMDAgJSAzNjAwMDAwIC8gNjAwMDApOwogICAgICB9CgogICAgICBpZiAobWludXRlID49IDEwKSB7CiAgICAgICAgYXhpb3MucG9zdChBUElfVVJMICsgJy9hcGkvVXNlcnMvVG9rZW5SZWZyZXNoP19iZWFyZXJfdG9rZW49JyArIGxvZ2luVG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAxKSB7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKCIvbG9naW4iKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdsb2dpblRva2VuJywgSlNPTi5zdHJpbmdpZnkocmVzLmRhdGEudG9rZW4pKTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xhc3RUb2tlblJlZnJlc2hlZCcsIEpTT04uc3RyaW5naWZ5KG5ldyBEYXRlKCkpKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGF4aW9zLmNyZWF0ZSh7CiAgICAgICAgYmFzZVVSTDogQVBJX1VSTCwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAnQmVhcmVyICcgKyBsb2dpblRva2VuCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJheGlvc0FkYXB0ZXJSZXBvcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGF4aW9zQWRhcHRlclJlcG9ydCgpIHsKICAgICAgdmFyIGxvZ2luVG9rZW4gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsb2dpblRva2VuJykpOwogICAgICByZXR1cm4gYXhpb3MuY3JlYXRlKHsKICAgICAgICBiYXNlVVJMOiBBUElfVVJMX1JFUE9SVCwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAnQmVhcmVyICcgKyBsb2dpblRva2VuCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwb3N0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwb3N0KHVybCwgZGF0YSkgewogICAgICByZXR1cm4gdGhpcy5heGlvc0FkYXB0ZXIoKS5wb3N0KHVybCwgZGF0YSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIHJlczsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIGVycm9yLnJlc3BvbnNlOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwdXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHB1dCh1cmwsIGRhdGEpIHsKICAgICAgcmV0dXJuIHRoaXMuYXhpb3NBZGFwdGVyKCkucG9zdCh1cmwsIGRhdGEpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiByZXM7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJldHVybiBlcnJvci5yZXNwb25zZTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbGwodXJsKSB7CiAgICAgIHJldHVybiB0aGlzLmF4aW9zQWRhcHRlcigpLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiByZXM7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJldHVybiBlcnJvci5yZXNwb25zZTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QnlJZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QnlJZCh1cmwsIElkKSB7CiAgICAgIHJldHVybiB0aGlzLmF4aW9zQWRhcHRlcigpLmdldCh1cmwgKyBJZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIHJlczsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIGVycm9yLnJlc3BvbnNlOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSZXBvcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJlcG9ydCh1cmwpIHsKICAgICAgcmV0dXJuIHRoaXMuYXhpb3NBZGFwdGVyUmVwb3J0KCkuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIHJlczsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIGVycm9yLnJlc3BvbnNlOwogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBheGlvc0hlbHBlcjsKfSgpOwoKZXhwb3J0IHsgYXhpb3NIZWxwZXIgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["F:/SVN PROJECTS/DiagnosticCenterManagement_Client/trunk/src/service/axiosHelper.js"],"names":["axios","API_URL","API_URL_REPORT","axiosHelper","loginToken","JSON","parse","localStorage","getItem","currentTime","Date","minute","lastTokenRefreshed","Math","round","post","then","res","status","window","location","replace","setItem","stringify","data","token","create","baseURL","headers","Authorization","url","axiosAdapter","catch","error","response","get","Id","axiosAdapterReport"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport { API_URL } from '../../public/assets/.env';\r\nimport { API_URL_REPORT } from '../../public/assets/.env';\r\n\r\nexport default class axiosHelper {\r\n    axiosAdapter() {\r\n        var loginToken = JSON.parse(localStorage.getItem('loginToken'));\r\n        var currentTime = new Date();\r\n        var minute = 10;\r\n        var lastTokenRefreshed = JSON.parse(localStorage.getItem('lastTokenRefreshed'));\r\n        if (lastTokenRefreshed) {\r\n            lastTokenRefreshed = new Date(lastTokenRefreshed);\r\n            minute = Math.round((((currentTime - lastTokenRefreshed) % 86400000) % 3600000) / 60000);\r\n        }\r\n        if (minute >= 10) {\r\n            axios.post(API_URL + '/api/Users/TokenRefresh?_bearer_token=' + loginToken).\r\n                then(res => {\r\n                    if (res.status == 201) {\r\n                        window.location.replace(\"/login\");\r\n                    }\r\n                    else {\r\n                        localStorage.setItem('loginToken', JSON.stringify(res.data.token));\r\n                        localStorage.setItem('lastTokenRefreshed', JSON.stringify(new Date()));\r\n                    }\r\n                });\r\n        }\r\n        return axios.create({\r\n            baseURL: API_URL,\r\n            headers: {\r\n                Authorization: 'Bearer ' + loginToken\r\n            }\r\n        });\r\n    }\r\n    axiosAdapterReport() {\r\n        var loginToken = JSON.parse(localStorage.getItem('loginToken'));\r\n        return axios.create({\r\n            baseURL: API_URL_REPORT,\r\n            headers: {\r\n                Authorization: 'Bearer ' + loginToken\r\n            }\r\n        });\r\n    }\r\n\r\n    post(url, data) {\r\n        return this.axiosAdapter().post(url, data).then(res => { return res; }).catch(error => { return error.response; });\r\n    }\r\n    put(url, data) {\r\n        return this.axiosAdapter().post(url, data).then(res => { return res; }).catch(error => { return error.response; });\r\n    }\r\n    getAll(url) {\r\n        return this.axiosAdapter().get(url).then(res => { return res; }).catch(error => { return error.response; });\r\n    }\r\n    getById(url, Id) {\r\n        return this.axiosAdapter().get(url + Id).then(res => { return res; }).catch(error => { return error.response; });\r\n    }\r\n    getReport(url) {\r\n        return this.axiosAdapterReport().get(url).then(res => { return res; }).catch(error => { return error.response; });\r\n    }\r\n}"]}]}