{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\components\\Prescription.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\components\\Prescription.js","mtime":1667299535186},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOi9TVk4gUFJPSkVDVFMvRVJQX0hvc3BpdGFsX0NsaWVudC90cnVuay9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRjovU1ZOIFBST0pFQ1RTL0VSUF9Ib3NwaXRhbF9DbGllbnQvdHJ1bmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3RhcnRzLXdpdGguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IFZhbGlkYXRpb24gZnJvbSAiLi4vLi4vc2NyaXB0cy92YWxpZGF0aW9uIjsKaW1wb3J0IHsgRmlsdGVyU2VydmljZSwgRmlsdGVyTWF0Y2hNb2RlLCBGaWx0ZXJPcGVyYXRvciB9IGZyb20gInByaW1ldnVlL2FwaSI7IC8vIFByZXNjcmlwdGlvbgoKaW1wb3J0IEFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2RvY3Rvci1wYW5lbC9BcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UiOwppbXBvcnQgQWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3ByZXNjcmlwdGlvbi9BZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlIjsgLy8gUHJlc2NyaXB0aW9uIFRyZWF0bWVudAoKaW1wb3J0IE1lZGljaW5lU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvTWVkaWNpbmVTZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSI7CmltcG9ydCBUcmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9UcmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlIjsgLy8gSGlzdG9yeQoKaW1wb3J0IFBhdGllbnRQcm9maWxlU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3Byb2ZpbGVzL1BhdGllbnRQcm9maWxlU2VydmljZSI7CmltcG9ydCBDb21wbGFpbnRTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Db21wbGFpbnRTZXR1cFNlcnZpY2UiOwppbXBvcnQgRm9vZFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Gb29kU2VydmljZSI7CmltcG9ydCBPbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvT25FeGFtaW5hdGlvblNldHVwU2VydmljZSI7CmltcG9ydCBEaWV0Q2hhcnRUZW1wbGF0ZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IERpZXRDaGFydFNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpZXRDaGFydFNldHVwU2VydmljZSI7CmltcG9ydCBEaWFnbm9zaXNTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9EaWFnbm9zaXNTZXR1cFNlcnZpY2UiOwppbXBvcnQgQ29tbW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL0NvbW1vblNlcnZpY2UiOyAvLyBBZHZpY2UKCmltcG9ydCBBZHZpY2VTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9BZHZpY2VTZXR1cFNlcnZpY2UiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpbHRlcmVkSXRlbXM6IG51bGwsCiAgICAgIHN1Ym1pdHRlZDogZmFsc2UsCiAgICAgIGZpbHRlcnM6IHsKICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICB9LAogICAgICAgIG5hbWU6IHsKICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuU1RBUlRTX1dJVEgKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGluaXRGaWx0ZXJzOiBmdW5jdGlvbiBpbml0RmlsdGVycygpIHsKICAgICAgICB0aGlzLmZpbHRlcnMgPSB7CiAgICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLkNPTlRBSU5TCiAgICAgICAgICB9LAogICAgICAgICAgbmFtZTogewogICAgICAgICAgICBvcGVyYXRvcjogRmlsdGVyT3BlcmF0b3IuQU5ELAogICAgICAgICAgICBjb25zdHJhaW50czogW3sKICAgICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgICAgICB9XQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0sCiAgICAgIC8vIFByZXNjcmlwdGlvbgogICAgICBhZG1pdHRlZFBhdGllbnRJbmZvOiB7fSwKICAgICAgcHJlc2NyaXB0aW9uRGF0YUxpc3Q6IFtdLAogICAgICB0ZW1wRGF0YTogW10sCiAgICAgIGhlYWRlck5hbWU6ICJTZWN0aW9ucyIsCiAgICAgIGFkbWlzc2lvblByZXNjcmlwdGlvbkluZm86IHsKICAgICAgICBhbGxBZHZpY2U6IGZhbHNlLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb246IFtdLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudDogW10sCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlOiBbXQogICAgICB9LAogICAgICAvLyBQcmVzY3JpcHRpb24gVHJlYXRtZW50CiAgICAgIHRyZWF0bWVudEFkZERpYWxvZzogZmFsc2UsCiAgICAgIHRyZWF0bWVudERpYWxvZzogZmFsc2UsCiAgICAgIHRyZWF0bWVudFNldHVwOiB7fSwKICAgICAgbWVkaWNpbmVMaXN0OiBbXSwKICAgICAgdHJlYXRtZW50UnVsZXNMaXN0OiBbXSwKICAgICAgdHJlYXRtZW50RHVyYXRpb25MaXN0OiBbXSwKICAgICAgdHJlYXRtZW50RG9zZUxpc3Q6IFtdLAogICAgICAvLyBTZWN0aW9uCiAgICAgIFNlY3Rpb25EaWFsb2c6IGZhbHNlLAogICAgICAvLyBIaXN0b3J5CiAgICAgIGNvbXBsYWludFNldHVwOiB7fSwKICAgICAgY2hpZWZDb21wbGFpbkRpYWxvZzogZmFsc2UsCiAgICAgIGNvbXBsaWFudExpc3Q6IFtdLAogICAgICBjaGllZkNvbXBsYWluOiB7fSwKICAgICAgY2hpZWZDb21wbGFpbkxpc3Q6IFtdLAogICAgICBmb29kU2V0dXA6IHt9LAogICAgICBhbGxlcmd5RGV0YWlsc0RpYWxvZzogZmFsc2UsCiAgICAgIGFsbGVyZ3lEZXRhaWxzOiB7fSwKICAgICAgZm9vZExpc3Q6IFtdLAogICAgICBhbGxlcmd5VHlwZUxpc3Q6IFtdLAogICAgICBvbkV4YW1pbmF0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgb25FeGFtaW5hdGlvbjoge30sCiAgICAgIHBhdGllbnRPbkV4YW1pbmF0aW9uTGlzdDogW10sCiAgICAgIG9uRXhhbWluYXRpb25MaXN0OiBbXSwKICAgICAgaU9DaGFydERpYWxvZzogZmFsc2UsCiAgICAgIGlPQ2hhcnQ6IHt9LAogICAgICBpT0NoYXJ0TGlzdDogW10sCiAgICAgIGRpYWJldGVzQ2hhcnREaWFsb2c6IGZhbHNlLAogICAgICBkaWFiZXRlc0NoYXJ0OiB7CiAgICAgICAgYUFkbWlzc2lvblNlcnZpY2VEZXRhaWxzOiB7fQogICAgICB9LAogICAgICBkaWFiZXRlc0NoYXJ0TGlzdDogW10sCiAgICAgIGRpYWJldGVzTWVhbExpc3Q6IFtdLAogICAgICBkaWV0Q2hhcnREaWFsb2c6IGZhbHNlLAogICAgICBkaWV0Q2hhcnQ6IHt9LAogICAgICBkaWV0Q2hhcnRMaXN0OiBbXSwKICAgICAgZGlldENoYXJ0VGVtcGxhdGVMaXN0OiBbXSwKICAgICAgZGlldENoYXJ0VGVtcExpc3Q6IFtdLAogICAgICBjdXJyZW50TWVkaWNhdGlvbnNEaWFsb2c6IGZhbHNlLAogICAgICBjdXJyZW50TWVkaWNhdGlvbnM6IHt9LAogICAgICBjdXJyZW50TWVkaWNhdGlvbnNMaXN0OiBbXSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nOiBmYWxzZSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5OiB7fSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5TGlzdDogW10sCiAgICAgIGRpYWdub3Npc0xpc3Q6IFtdLAogICAgICBwYXRpZW50TGF0ZXN0SGlzdG9yeTogewogICAgICAgIGxzdFBhdGllbnRPbkV4YW1pbmF0aW9uOiBbXSwKICAgICAgICBsc3RQYXRpZW50QWxsZXJneURldGFpbHM6IFtdLAogICAgICAgIGxzdFBhdGllbnREaWFiZXRlc0NoYXJ0OiBbXSwKICAgICAgICBsc3RQYXRpZW50RGlldENoYXJ0OiBbXQogICAgICB9LAogICAgICBkZXBhcnRtZW50X2lkOiAiIiwKICAgICAgbmV3QWR2aWNlRGlhbG9nOiBmYWxzZSwKICAgICAgYWR2aWNlU2V0dXA6IHt9CiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIC8vIHBhc3QgZGF0ZS15ZWFyIGRpc2FibGVkCiAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgdmFyIG1vbnRoID0gdG9kYXkuZ2V0TW9udGgoKTsKICAgIHZhciB5ZWFyID0gdG9kYXkuZ2V0RnVsbFllYXIoKTsKICAgIHZhciBwcmV2TW9udGggPSBtb250aCA9PT0gMCA/IDExIDogbW9udGggLSAwOwogICAgdmFyIHByZXZZZWFyID0gcHJldk1vbnRoID09PSAxMSA/IHllYXIgLSAwIDogeWVhcjsKICAgIHRoaXMubWluRGF0ZSA9IG5ldyBEYXRlKCk7CiAgICB0aGlzLm1pbkRhdGUuc2V0TW9udGgocHJldk1vbnRoKTsKICAgIHRoaXMubWluRGF0ZS5zZXRGdWxsWWVhcihwcmV2WWVhcik7IC8vIFByZXNjcmlwdGlvbgoKICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlKCk7CiAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UoKTsgLy8gUHJlc2NyaXB0aW9uIFRyZWF0bWVudAoKICAgIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UgPSBuZXcgTWVkaWNpbmVTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMudHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UgPSBuZXcgVHJlYXRtZW50UnVsZXNTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMudHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UgPSBuZXcgVHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZSA9IG5ldyBUcmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlKCk7IC8vIEhpc3RvcnkKCiAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZSA9IG5ldyBQYXRpZW50UHJvZmlsZVNlcnZpY2UoKTsKICAgIHRoaXMuY29tcGxhaW50U2V0dXBTZXJ2aWNlID0gbmV3IENvbXBsYWludFNldHVwU2VydmljZSgpOwogICAgdGhpcy5mb29kU2VydmljZSA9IG5ldyBGb29kU2VydmljZSgpOwogICAgdGhpcy5vbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlID0gbmV3IE9uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UgPSBuZXcgRGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZGlldENoYXJ0U2V0dXBTZXJ2aWNlID0gbmV3IERpZXRDaGFydFNldHVwU2VydmljZSgpOwogICAgdGhpcy5kaWFnbm9zaXNTZXR1cFNlcnZpY2UgPSBuZXcgRGlhZ25vc2lzU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmNvbW1vblNlcnZpY2UgPSBuZXcgQ29tbW9uU2VydmljZSgpOwogICAgdGhpcy52YWxpZGF0aW9uID0gbmV3IFZhbGlkYXRpb24oKTsgLy8gQWR2aWNlCgogICAgdGhpcy5hZHZpY2VTZXR1cFNlcnZpY2UgPSBuZXcgQWR2aWNlU2V0dXBTZXJ2aWNlKCk7IC8vIHNob3J0Y3V0IGtleSBzdGFydAoKICAgIHZhciB0aGF0ID0gdGhpczsKCiAgICBkb2N1bWVudC5vbmtleXVwID0gZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLndoaWNoID09IDczKSB7CiAgICAgICAgdGhhdC5nZXRJbnZlc3RpZ2F0aW9uKCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gODQpIHsKICAgICAgICB0aGF0LmdldFRyZWF0bWVudCgpOwogICAgICB9IGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLndoaWNoID09IDY1KSB7CiAgICAgICAgdGhhdC5nZXRBZHZpY2UoKTsKICAgICAgfSAvLyBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS5zaGlmdEtleSkgewogICAgICAvLyB9CgogICAgfTsgLy8gc2hvcnRjdXQga2V5IGVuZAoKCiAgICB0aGlzLnVzZXJJbmZvID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlckluZm8iKSk7CgogICAgaWYgKHRoaXMudXNlckluZm8uZG9jdG9yX2lkKSB7CiAgICAgIHRoaXMuZ2V0UHJlc2NyaXB0aW9uRGF0YSgpOwogICAgICB0aGlzLmRvY3Rvcl9pZCA9IHRoaXMudXNlckluZm8uZG9jdG9yX2lkOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uZG9jdG9yX2lkID0gdGhpcy5kb2N0b3JfaWQ7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRQcmVzY3JpcHRpb25EYXRhOiBmdW5jdGlvbiBnZXRQcmVzY3JpcHRpb25EYXRhKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy90aGlzLnVzZXJJbmZvID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlckluZm8iKSk7CiAgICAgIHRoaXMuYXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlLmdldFByZXNjcmlwdGlvbkRhdGFCeURvY3RvcklkKHRoaXMudXNlckluZm8uZG9jdG9yX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBoaWRlRGlhbG9nOiBmdW5jdGlvbiBoaWRlRGlhbG9nKCkgewogICAgICB2YXIgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7IC8vIENoaWVmIENvbXBsYWluCgogICAgICB0aGlzLmNoaWVmQ29tcGxhaW5EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5jaGllZkNvbXBsYWluID0gewogICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICB9OyAvLyBPbiBFeGFtaW5hdGlvbgoKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gZmFsc2U7IC8vIHRoaXMub25FeGFtaW5hdGlvbiA9IHsKICAgICAgLy8gICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgLy8gfTsKCiAgICAgIHRoaXMuU2VjdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnRyZWF0bWVudEFkZERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLnRyZWF0bWVudFNldHVwID0ge307CiAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuZm9vZFNldHVwID0ge307CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHNEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlscyA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5pT0NoYXJ0RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuaU9DaGFydCA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5kaWFiZXRlc0NoYXJ0RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydCA9IHsKICAgICAgICBhQWRtaXNzaW9uU2VydmljZURldGFpbHM6IHt9LAogICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICB9OwogICAgICB0aGlzLmRpZXRDaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmRpZXRDaGFydCA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5uZXdBZHZpY2VEaWFsb2cgPSBmYWxzZSwgdGhpcy5hZHZpY2VTZXR1cCA9IHt9OwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfSwKICAgIC8vIEdldCBQcmV2aW91cyBDaGllZiBDb21wbGFpbgogICAgZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldENvbXBsYWluc0J5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldENvbXBsYWluc0J5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLmNoaWVmQ29tcGxhaW5MaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBHZXQsIEFkZCBDb21wbGFpbgogICAgZ2V0Q29tcGxhaW46IGZ1bmN0aW9uIGdldENvbXBsYWluKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuY29tcGxhaW50U2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMuY29tcGxpYW50TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgYWRkQ29tcGxhaW46IGZ1bmN0aW9uIGFkZENvbXBsYWluKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczQuc3VibWl0dGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczQuY29tcGxhaW50U2V0dXAuY29tcGlsYW50c19uYW1lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LmNvbXBsYWludFNldHVwU2VydmljZS5hZGQoX3RoaXM0LmNvbXBsYWludFNldHVwKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIShyZXN1bHQuc3RhdHVzID09PSAyMDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXM0LmdldENvbXBsYWluKCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzdWx0LmRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX3RoaXM0LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTc7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICAgIF90aGlzNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzEsIDE3XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBBZGQgQ2hpZWYgQ29tcGxhaW4KICAgIHNlYXJjaENvbXBsYWluOiBmdW5jdGlvbiBzZWFyY2hDb21wbGFpbihldmVudCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghZXZlbnQucXVlcnkudHJpbSgpLmxlbmd0aCkgewogICAgICAgICAgX3RoaXM1LmZpbHRlcmVkSXRlbXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoX3RoaXM1LmNvbXBsaWFudExpc3QpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL3N0YXJ0IHdpdGgKICAgICAgICAgIF90aGlzNS5maWx0ZXJlZEl0ZW1zID0gX3RoaXM1LmNvbXBsaWFudExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCAyNTApOwogICAgfSwKICAgIG5ld0NoaWVmQ29tcGxhaW46IGZ1bmN0aW9uIG5ld0NoaWVmQ29tcGxhaW4oKSB7CiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQ2hpZWZDb21wbGFpbjogZnVuY3Rpb24gYWRkQ2hpZWZDb21wbGFpbigpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgaXNDb21wbGFpbkV4aXN0LCBjb21wbGFpbklkLCBpc0R1cGxpY2F0ZSwgcmVzdWx0LCBfcmVzdWx0OwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXM2LnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczYuY2hpZWZDb21wbGFpbi5wYXRpZW50X2lkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpLnRvU3RyaW5nKCk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNi5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2LmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2LmNoaWVmQ29tcGxhaW4uY2Rmcm9tX2RhdGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX3RoaXM2LmNoaWVmQ29tcGxhaW4uZnJvbV9kYXRlID0gbW9tZW50KFN0cmluZyhfdGhpczYuY2hpZWZDb21wbGFpbi5jZGZyb21fZGF0ZSkpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOyAvLyBjb21wbGFpbiBpcyBleGlzdCBjaGVjayBzdGFydAoKICAgICAgICAgICAgICAgIGlmIChfdGhpczYuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbi52YWx1ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpc0NvbXBsYWluRXhpc3QgPSBfdGhpczYuY29tcGxpYW50TGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC50ZXh0ID09IHRoaXMuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbjsKICAgICAgICAgICAgICAgIH0sIF90aGlzNik7CgogICAgICAgICAgICAgICAgaWYgKCEoaXNDb21wbGFpbkV4aXN0Lmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczYuY29tcGxhaW50U2V0dXAuY29tcGlsYW50c19uYW1lID0gX3RoaXM2LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW47CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5hZGRDb21wbGFpbigpOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgY29tcGxhaW5JZCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX3RoaXM2LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW4gPSB7CiAgICAgICAgICAgICAgICAgIHRleHQ6ICIiLAogICAgICAgICAgICAgICAgICB2YWx1ZTogIiIKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfdGhpczYuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbi52YWx1ZSA9IGNvbXBsYWluSWQudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgICAgIF90aGlzNi5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluID0gewogICAgICAgICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXM2LmNoaWVmQ29tcGxhaW4uZGRsY29tcGxhaW4udmFsdWUgPSBpc0NvbXBsYWluRXhpc3RbMF0udmFsdWU7CgogICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgICAvLyBjb21wbGFpbiBpcyBleGlzdCBjaGVjayBlbmQKICAgICAgICAgICAgICAgIGlzRHVwbGljYXRlID0gX3RoaXM2LmNoaWVmQ29tcGxhaW5MaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmNvbXBpbGFudHNfaWQgPT0gdGhpcy5jaGllZkNvbXBsYWluLmRkbGNvbXBsYWluLnZhbHVlOwogICAgICAgICAgICAgICAgfSwgX3RoaXM2KTsKICAgICAgICAgICAgICAgIF90aGlzNi5jaGllZkNvbXBsYWluLmNvbXBpbGFudHNfaWQgPSBfdGhpczYuY2hpZWZDb21wbGFpbi5kZGxjb21wbGFpbi52YWx1ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShpc0R1cGxpY2F0ZS5sZW5ndGggPT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczYucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmNvbXBsYWluU2F2ZShfdGhpczYuY2hpZWZDb21wbGFpbik7CgogICAgICAgICAgICAgIGNhc2UgMzM6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXM2LmdldENvbXBsYWluc0J5UGF0aWVudElkKF90aGlzNi5jaGllZkNvbXBsYWluLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM2LmhpZGVEaWFsb2coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgICAgIF90aGlzNi5jaGllZkNvbXBsYWluLnBhdGllbnRfY29tcGxhaW5faWQgPSBpc0R1cGxpY2F0ZVswXS5wYXRpZW50X2NvbXBsYWluX2lkOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0MDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczYucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmNvbXBsYWluVXBkYXRlKF90aGlzNi5jaGllZkNvbXBsYWluKTsKCiAgICAgICAgICAgICAgY2FzZSA0MDoKICAgICAgICAgICAgICAgIF9yZXN1bHQgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoX3Jlc3VsdC5zdGF0dXMgPT09IDIwMikgewogICAgICAgICAgICAgICAgICBfdGhpczYuZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQoX3RoaXM2LmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczYuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlVwZGF0ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3Jlc3VsdC5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDQyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gR2V0IFByZXZpb3VzIGxzdFBhdGllbnRPbkV4YW1pbmF0aW9uLCBsc3RQYXRpZW50QWxsZXJneURldGFpbHMsIGxzdFBhdGllbnREaWFiZXRlc0NoYXJ0LCBsc3RQYXRpZW50RGlldENoYXJ0LAogICAgZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBnZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdmFyIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKS50b1N0cmluZygpOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24ocGF0aWVudElkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNy5wYXRpZW50TGF0ZXN0SGlzdG9yeSA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gQWRkIE9uIEV4YW1pbmF0aW9uCiAgICBuZXdPbkV4YW1pbmF0aW9uOiBmdW5jdGlvbiBuZXdPbkV4YW1pbmF0aW9uKCkgewogICAgICB0aGlzLmdldE9uRXhhbWluYXRpb25zUG9wdXAoKTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwOiBmdW5jdGlvbiBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHZhciBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSk7CiAgICAgIHRoaXMucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEgPSBbXTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXM4LnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhLnB1c2goewogICAgICAgICAgX29uX2V4YW1pbmF0aW9uX25hbWU6IGVsZW1lbnQudGV4dCwKICAgICAgICAgIG9uX2V4YW1pbmF0aW9uX2lkOiBlbGVtZW50LnZhbHVlLAogICAgICAgICAgb25fZXhhbWluYXRpb25fcmVzdWx0OiBTdHJpbmcoMSksCiAgICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQudG9TdHJpbmcoKQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5vbkV4YW1pbmF0aW9uUG9wdXBEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZE9uRXhhbWluYXRpb246IGZ1bmN0aW9uIGFkZE9uRXhhbWluYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXM5LnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczkucmVxdXJlZCA9ICIiOwoKICAgICAgICAgICAgICAgIF90aGlzOS5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgIGlmICghZWxlbWVudC5vbl9leGFtaW5hdGlvbl9yZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczkucmVxdXJlZCA9ICJyZXF1aXJlZCI7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmICghX3RoaXM5LnJlcXVyZWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiUmVxdWlyZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQbGVhc2UgZmlsbCBpbiB0aGUgcmVxdWlyZWQgZmllbGRzIiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczkucmVxdXJlZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzOS5wYXRpZW50UHJvZmlsZVNlcnZpY2Uub25FeGFtaW5hdGlvblNhdmUoX3RoaXM5LnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM5LmdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbigpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM5LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzOS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM5LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEdldCwgQWRkIEZvb2QKICAgIGdldEZvb2Q6IGZ1bmN0aW9uIGdldEZvb2QoKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIHRoaXMuZm9vZFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTAuZm9vZExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGFkZEZvb2Q6IGZ1bmN0aW9uIGFkZEZvb2QoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMDsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMS5mb29kU2V0dXAuZm9vZF9uYW1lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfdGhpczExLmZvb2RTZXR1cC5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTEuZm9vZFNlcnZpY2UuYWRkKF90aGlzMTEuZm9vZFNldHVwKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQ0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCEocmVzdWx0LnN0YXR1cyA9PT0gMjAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczExLmdldEZvb2QoKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgcmVzdWx0LmRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX3RoaXMxMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTc7CiAgICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgX3RoaXMxMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0NC50MCwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCBudWxsLCBbWzAsIDE3XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBBZGQgQWxsZXJneSBEZXRhaWxzCiAgICBzZWFyY2hGb29kOiBmdW5jdGlvbiBzZWFyY2hGb29kKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghZXZlbnQucXVlcnkudHJpbSgpLmxlbmd0aCkgewogICAgICAgICAgX3RoaXMxMi5maWx0ZXJlZEl0ZW1zID0gX3RvQ29uc3VtYWJsZUFycmF5KF90aGlzMTIuZm9vZExpc3QpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL3N0YXJ0IHdpdGgKICAgICAgICAgIF90aGlzMTIuZmlsdGVyZWRJdGVtcyA9IF90aGlzMTIuZm9vZExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGV2ZW50LnF1ZXJ5LnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCAyNTApOwogICAgfSwKICAgIG5ld0FsbGVyZ3lEZXRhaWxzOiBmdW5jdGlvbiBuZXdBbGxlcmd5RGV0YWlscygpIHsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlsc0RpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQWxsZXJneURldGFpbHM6IGZ1bmN0aW9uIGFkZEFsbGVyZ3lEZXRhaWxzKCkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICB2YXIgaXNGb29kRXhpc3QsIGZvb2RJZCwgaXNEdXBsaWNhdGUsIHJlc3VsdCwgX3Jlc3VsdDI7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczEzLnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfaWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5kZGxmb29kKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLnR5cGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTMuYWxsZXJneURldGFpbHMuY2Rmcm9tX2RhdGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5mcm9tX2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzMTMuYWxsZXJneURldGFpbHMuY2Rmcm9tX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsgLy8gZm9vZCBpcyBleGlzdCBjaGVjayBzdGFydAoKICAgICAgICAgICAgICAgIGlmIChfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLmRkbGZvb2QudmFsdWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaXNGb29kRXhpc3QgPSBfdGhpczEzLmZvb2RMaXN0LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLnRleHQgPT0gdGhpcy5hbGxlcmd5RGV0YWlscy5kZGxmb29kOwogICAgICAgICAgICAgICAgfSwgX3RoaXMxMyk7CgogICAgICAgICAgICAgICAgaWYgKCEoaXNGb29kRXhpc3QubGVuZ3RoID09IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMTMuZm9vZFNldHVwLmZvb2RfbmFtZSA9IF90aGlzMTMuYWxsZXJneURldGFpbHMuZGRsZm9vZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMy5hZGRGb29kKCk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICBmb29kSWQgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzMTMuYWxsZXJneURldGFpbHMuZGRsZm9vZCA9IHsKICAgICAgICAgICAgICAgICAgdGV4dDogIiIsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiAiIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIF90aGlzMTMuYWxsZXJneURldGFpbHMuZGRsZm9vZC52YWx1ZSA9IGZvb2RJZC50b1N0cmluZygpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgICAgX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5kZGxmb29kID0gewogICAgICAgICAgICAgICAgICB0ZXh0OiAiIiwKICAgICAgICAgICAgICAgICAgdmFsdWU6ICIiCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5kZGxmb29kLnZhbHVlID0gaXNGb29kRXhpc3RbMF0udmFsdWU7CgogICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgICAvLyBmb29kIGlzIGV4aXN0IGNoZWNrIGVuZAogICAgICAgICAgICAgICAgaXNEdXBsaWNhdGUgPSBfdGhpczEzLnBhdGllbnRMYXRlc3RIaXN0b3J5LmxzdFBhdGllbnRBbGxlcmd5RGV0YWlscy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlbC5mb29kX2lkID09IHRoaXMuYWxsZXJneURldGFpbHMuZGRsZm9vZC52YWx1ZTsKICAgICAgICAgICAgICAgIH0sIF90aGlzMTMpOwogICAgICAgICAgICAgICAgX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5mb29kX2lkID0gX3RoaXMxMy5hbGxlcmd5RGV0YWlscy5kZGxmb29kLnZhbHVlOwoKICAgICAgICAgICAgICAgIGlmICghKGlzRHVwbGljYXRlLmxlbmd0aCA9PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDQxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmFsbGVyZ3lEZXRhaWxzU2F2ZShfdGhpczEzLmFsbGVyZ3lEZXRhaWxzKTsKCiAgICAgICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NS5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMy5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTMuaGlkZURpYWxvZygpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczEzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDQ2OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNDE6CiAgICAgICAgICAgICAgICBfdGhpczEzLmFsbGVyZ3lEZXRhaWxzLnBhdGllbnRfYWxsZXJneV9kZXRhaWxzX2lkID0gaXNEdXBsaWNhdGVbMF0ucGF0aWVudF9hbGxlcmd5X2RldGFpbHNfaWQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDQ0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmFsbGVyZ3lEZXRhaWxzVXBkYXRlKF90aGlzMTMuYWxsZXJneURldGFpbHMpOwoKICAgICAgICAgICAgICBjYXNlIDQ0OgogICAgICAgICAgICAgICAgX3Jlc3VsdDIgPSBfY29udGV4dDUuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoX3Jlc3VsdDIuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMy5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTMuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJVcGRhdGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9yZXN1bHQyLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQyLmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczEzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogX3Jlc3VsdDIucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDQ2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gQWRkIElPIENoYXJ0CiAgICBuZXdJT0NoYXJ0OiBmdW5jdGlvbiBuZXdJT0NoYXJ0KCkgewogICAgICB0aGlzLmlPQ2hhcnREaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZElPQ2hhcnQ6IGZ1bmN0aW9uIGFkZElPQ2hhcnQoKSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHZhciByZXN1bHQsIHBhdGllbnRJZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMxNC5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczE0LmlPQ2hhcnQucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTQucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmlPQ2hhcnRTYXZlKF90aGlzMTQuaU9DaGFydCk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ni5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxNC5nZXRJT0NoYXJ0QnlQYXRpZW50SWQocGF0aWVudElkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTQuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxNC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIC8vIEFkZCBEaWFiZXRlcyBDaGFydAogICAgbmV3RGlhYmV0ZXNDaGFydDogZnVuY3Rpb24gbmV3RGlhYmV0ZXNDaGFydCgpIHsKICAgICAgdGhpcy5kaWFiZXRlc0NoYXJ0RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBhZGREaWFiZXRlc0NoYXJ0OiBmdW5jdGlvbiBhZGREaWFiZXRlc0NoYXJ0KCkgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgICB2YXIgcGF0aWVudElkLCByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMTUuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNS5kaWFiZXRlc0NoYXJ0Lm1lYWwpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmIChfdGhpczE1LmRpYWJldGVzQ2hhcnQuYmVmb3JlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNS5kaWFiZXRlc0NoYXJ0LmFmdGVyKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIC8vdmFyIGFkbWlzc2lvbl9pZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImFkbWlzc2lvbklkRm9yRGlhYmV0ZXNTZXJ2aWNlIikpOwogICAgICAgICAgICAgICAgLy90aGlzLmRpYWJldGVzQ2hhcnQuYUFkbWlzc2lvblNlcnZpY2VEZXRhaWxzLmFkbWlzc2lvbl9pZCA9IFN0cmluZyhhZG1pc3Npb25faWQpOwogICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwogICAgICAgICAgICAgICAgX3RoaXMxNS5kaWFiZXRlc0NoYXJ0LnBhdGllbnRfaWQgPSBTdHJpbmcocGF0aWVudElkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNS5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZGlhYmV0ZXNDaGFydFNhdmUoX3RoaXMxNS5kaWFiZXRlc0NoYXJ0KTsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ny5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxNS5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTUuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxNS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBBZGQgRGlldCBDaGFydAogICAgbmV3RGlldENoYXJ0OiBmdW5jdGlvbiBuZXdEaWV0Q2hhcnQoKSB7CiAgICAgIHRoaXMuZGlldENoYXJ0RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBnZXREaWV0Q2hhcnRCeVRlbXBsYXRlSWQ6IGZ1bmN0aW9uIGdldERpZXRDaGFydEJ5VGVtcGxhdGVJZCgpIHsKICAgICAgdmFyIF90aGlzMTYgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmRpZXRDaGFydC5kaWV0X2NoYXJ0X3RlbXBsYXRlX2lkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZGlldENoYXJ0U2V0dXBTZXJ2aWNlLmdldEJ5RGlldENoYXJ0VGVtcGxhdGVJZCh0aGlzLmRpZXRDaGFydC5kaWV0X2NoYXJ0X3RlbXBsYXRlX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMxNi5kaWV0Q2hhcnRUZW1wTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGFkZERpZXRDaGFydDogZnVuY3Rpb24gYWRkRGlldENoYXJ0KCkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICB2YXIgcGF0aWVudElkLCByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMTcuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczE3LmRpZXRDaGFydFRlbXBMaXN0Lmxlbmd0aCA8PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgICAgICAgICAgIF90aGlzMTcuZGlldENoYXJ0VGVtcExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICBlbGVtZW50LnBhdGllbnRfaWQgPSBwYXRpZW50SWQudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczE3LnBhdGllbnRQcm9maWxlU2VydmljZS5kaWV0Q2hhcnRTYXZlKF90aGlzMTcuZGlldENoYXJ0VGVtcExpc3QpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDguc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTcuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE3LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gVHJlYXRtZW50CiAgICBzZWFyY2hNZWRpY2luZTogZnVuY3Rpb24gc2VhcmNoTWVkaWNpbmUoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzMTggPSB0aGlzOwoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFldmVudC5xdWVyeS50cmltKCkubGVuZ3RoKSB7CiAgICAgICAgICBfdGhpczE4LmZpbHRlcmVkSXRlbXMgPSBfdG9Db25zdW1hYmxlQXJyYXkoX3RoaXMxOC5tZWRpY2luZUxpc3QpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBzdGFydCB3aXRoCiAgICAgICAgICAvLyB0aGlzLmZpbHRlcmVkSXRlbXMgPSB0aGlzLm1lZGljaW5lTGlzdC5maWx0ZXIoKGl0ZW0pID0+IHsKICAgICAgICAgIC8vICAgICByZXR1cm4gaXRlbS50ZXh0LnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChldmVudC5xdWVyeS50b0xvd2VyQ2FzZSgpKTsKICAgICAgICAgIC8vIH0pOwogICAgICAgICAgLy8gY29udGFpbnMKICAgICAgICAgIF90aGlzMTguZmlsdGVyZWRJdGVtcyA9IEZpbHRlclNlcnZpY2UuZmlsdGVyKF90aGlzMTgubWVkaWNpbmVMaXN0LCBbJ3RleHQnXSwgZXZlbnQucXVlcnkudG9Mb3dlckNhc2UoKSwgRmlsdGVyTWF0Y2hNb2RlLkNPTlRBSU5TKS5zbGljZSgwLCAxMCk7CiAgICAgICAgfQogICAgICB9LCAyNTApOwogICAgfSwKICAgIGdldFRyZWF0bWVudDogZnVuY3Rpb24gZ2V0VHJlYXRtZW50KCkgewogICAgICB0aGlzLnRyZWF0bWVudEFkZERpYWxvZyA9IHRydWU7IC8vIHRoaXMuaGVhZGVyTmFtZSA9ICJNZWRpY2luZSI7CiAgICAgIC8vIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgLy8gdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICAvLyB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIC8vIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0VHJlYXRtZW50LmZvckVhY2goKGVsZW1lbnQpID0+IHsKICAgICAgLy8gICB0aGlzLnRlbXBEYXRhLnB1c2goewogICAgICAvLyAgICAgX21lZGljaW5lX3R5cGVfbmFtZTogZWxlbWVudC5fbWVkaWNpbmVfdHlwZV9uYW1lLAogICAgICAvLyAgICAgX21lZGljaW5lX25hbWU6IGVsZW1lbnQuX21lZGljaW5lX25hbWUsCiAgICAgIC8vICAgICBuYW1lOiBlbGVtZW50Ll9tZWRpY2luZV90eXBlX25hbWUgKyAiICIgKyBlbGVtZW50Ll9tZWRpY2luZV9uYW1lICsgIiAiICsgZWxlbWVudC5fdHJlYXRtZW50X2Rvc2VfbmFtZSArICIgIiArIGVsZW1lbnQuX3RyZWF0bWVudF9ydWxlX25hbWUgKyAiICIgKyBlbGVtZW50Ll90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgLy8gICAgIGlkOiBlbGVtZW50Lm1lZGljaW5lX2lkLAogICAgICAvLyAgICAgX3RyZWF0bWVudF9kb3NlX25hbWU6IGVsZW1lbnQuX3RyZWF0bWVudF9kb3NlX25hbWUsCiAgICAgIC8vICAgICB0cmVhdG1lbnRfZG9zZV9pZDogZWxlbWVudC50cmVhdG1lbnRfZG9zZV9pZCwKICAgICAgLy8gICAgIF90cmVhdG1lbnRfcnVsZV9uYW1lOiBlbGVtZW50Ll90cmVhdG1lbnRfcnVsZV9uYW1lLAogICAgICAvLyAgICAgdHJlYXRtZW50X3J1bGVzX2lkOiBlbGVtZW50LnRyZWF0bWVudF9ydWxlc19pZCwKICAgICAgLy8gICAgIF90cmVhdG1lbnRfZHVyYXRpb25fbmFtZTogZWxlbWVudC5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgIC8vICAgICB0cmVhdG1lbnRfZHVyYXRpb25faWQ6IGVsZW1lbnQudHJlYXRtZW50X2R1cmF0aW9uX2lkLAogICAgICAvLyAgICAgZGVzY3JpcHRpb246IGVsZW1lbnQuZGVzY3JpcHRpb24sCiAgICAgIC8vICAgfSk7CiAgICAgIC8vIH0pOwogICAgfSwKICAgIHNhdmVUcmVhdG1lbnQ6IGZ1bmN0aW9uIHNhdmVUcmVhdG1lbnQoKSB7CiAgICAgIHRoaXMuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBhTWVkaWNpbmUgPSB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5tZWRpY2luZV9pZCA9PT0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS52YWx1ZTsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhTWVkaWNpbmUubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50LnB1c2goewogICAgICAgICAgICBuYW1lOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnRleHQsCiAgICAgICAgICAgIG1lZGljaW5lX2lkOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnZhbHVlLAogICAgICAgICAgICBfdHJlYXRtZW50X2Rvc2VfbmFtZTogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZS50ZXh0LAogICAgICAgICAgICB0cmVhdG1lbnRfZG9zZV9pZDogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZS52YWx1ZSwKICAgICAgICAgICAgX3RyZWF0bWVudF9ydWxlX25hbWU6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnRleHQsCiAgICAgICAgICAgIHRyZWF0bWVudF9ydWxlc19pZDogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudmFsdWUsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZHVyYXRpb25fbmFtZTogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udGV4dCwKICAgICAgICAgICAgdHJlYXRtZW50X2R1cmF0aW9uX2lkOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbi52YWx1ZSwKICAgICAgICAgICAgZGVzY3JpcHRpb246ICIiCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHRoaXMuaGlkZURpYWxvZygpOwogICAgICB9CiAgICB9LAogICAgLy8gRWRpdCBUcmVhdG1lbnQKICAgIGVkaXRUcmVhdG1lbnQ6IGZ1bmN0aW9uIGVkaXRUcmVhdG1lbnQoZGF0YSwgaW5kZXgpIHsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5tZWRpY2luZU5hbWUgPSBkYXRhLm5hbWU7CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X3J1bGVzX2lkLAogICAgICAgIHJlZmlkOiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAgIHZhbHVlOiBkYXRhLnRyZWF0bWVudF9kdXJhdGlvbl9pZCwKICAgICAgICByZWZpZDogbnVsbAogICAgICB9OwogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlID0gewogICAgICAgIHRleHQ6IGRhdGEuX3RyZWF0bWVudF9kb3NlX25hbWUsCiAgICAgICAgdmFsdWU6IGRhdGEudHJlYXRtZW50X2Rvc2VfaWQsCiAgICAgICAgcmVmaWQ6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy50cmVhdG1lbnREaWFsb2cgPSB0cnVlOwogICAgICB0aGlzLnRyZWF0bWVudEluZGV4ID0gaW5kZXg7CiAgICB9LAogICAgdHJlYXRtZW50RWRpdFNhdmU6IGZ1bmN0aW9uIHRyZWF0bWVudEVkaXRTYXZlKCkgewogICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbikgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICAvL3RoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0ubmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmUudGV4dDsKICAgICAgICAvL3RoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0ubWVkaWNpbmVfaWQgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnZhbHVlOwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0uX3RyZWF0bWVudF9ydWxlX25hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy50ZXh0OwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X3J1bGVzX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudmFsdWU7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbi50ZXh0OwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0udHJlYXRtZW50X2R1cmF0aW9uX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udmFsdWU7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS5fdHJlYXRtZW50X2Rvc2VfbmFtZSA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudGV4dDsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLnRyZWF0bWVudF9kb3NlX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZS52YWx1ZTsKICAgICAgICB0aGlzLnRyZWF0bWVudERpYWxvZyA9IGZhbHNlOwogICAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICAvLyBJbnZlc3RpZ2F0aW9uCiAgICBnZXRJbnZlc3RpZ2F0aW9uOiBmdW5jdGlvbiBnZXRJbnZlc3RpZ2F0aW9uKCkgewogICAgICB2YXIgX3RoaXMxOSA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiSW52ZXN0aWdhdGlvbiI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IGZhbHNlOwogICAgICB0aGlzLnRlbXBEYXRhID0gW107CiAgICAgIHRoaXMucHJlc2NyaXB0aW9uRGF0YUxpc3QubHN0SW52ZXN0aWdhdGlvbi5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMxOS50ZW1wRGF0YS5wdXNoKHsKICAgICAgICAgIG5hbWU6IGVsZW1lbnQuaW52ZXN0aW5nYXRpb25fbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmludmVzdGlnYXRpb25faWQKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuU2VjdGlvbkRpYWxvZyA9IHRydWU7CiAgICB9LAogICAgLy8gQWR2aWNlCiAgICBnZXRBZHZpY2U6IGZ1bmN0aW9uIGdldEFkdmljZSgpIHsKICAgICAgdmFyIF90aGlzMjAgPSB0aGlzOwoKICAgICAgdGhpcy5oZWFkZXJOYW1lID0gIkFkdmljZSI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy5pc0FkdmljZSA9IHRydWU7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RBZHZpY2VzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczIwLnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5hZHZpY2VfbmFtZSwKICAgICAgICAgIGlkOiBlbGVtZW50LmFkdmljZV9pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5TZWN0aW9uRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICAvLyBBZGQgTmV3IEFkdmljZQogICAgbmV3QWR2aWNlOiBmdW5jdGlvbiBuZXdBZHZpY2UoKSB7CiAgICAgIHRoaXMuU2VjdGlvbkRpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLm5ld0FkdmljZURpYWxvZyA9IHRydWU7CiAgICB9LAogICAgYWRkQWR2aWNlOiBmdW5jdGlvbiBhZGRBZHZpY2UoKSB7CiAgICAgIHZhciBfdGhpczIxID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgICAgIHZhciBpc0V4aXN0LCBhQWR2aWNlLCBhZHZpY2VfaWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlzRXhpc3QgPSBfdGhpczIxLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLm5hbWUgPT0gdGhpcy5hZHZpY2VTZXR1cC5hZHZpY2VfbmFtZTsKICAgICAgICAgICAgICAgIH0sIF90aGlzMjEpOwoKICAgICAgICAgICAgICAgIGlmIChpc0V4aXN0Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBhQWR2aWNlID0gX3RoaXMyMS5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RBZHZpY2VzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmFkdmljZV9uYW1lID09IHRoaXMuYWR2aWNlU2V0dXAuYWR2aWNlX25hbWU7CiAgICAgICAgICAgICAgICB9LCBfdGhpczIxKTsKCiAgICAgICAgICAgICAgICBpZiAoIWFBZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMyMS5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgbmFtZTogYUFkdmljZVswXS5hZHZpY2VfbmFtZSwKICAgICAgICAgICAgICAgICAgYWR2aWNlX2lkOiBhQWR2aWNlWzBdLmFkdmljZV9pZAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgX3RoaXMyMS5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAvL3RoaXMuYWR2aWNlU2V0dXAuYWR2aWNlX2dyb3VwX2lkID0gIiI7CiAgICAgICAgICAgICAgICBfdGhpczIxLmFkdmljZVNldHVwLmNvbnN1bHRhbmN5X2RlcGFydG1lbnRfaWQgPSBfdGhpczIxLmRlcGFydG1lbnRfaWQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMjEuYWRkTmV3QWR2aWNlKCk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBhZHZpY2VfaWQgPSBfY29udGV4dDkuc2VudDsKCiAgICAgICAgICAgICAgICBfdGhpczIxLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlLnB1c2goewogICAgICAgICAgICAgICAgICBuYW1lOiBfdGhpczIxLmFkdmljZVNldHVwLmFkdmljZV9uYW1lLAogICAgICAgICAgICAgICAgICBhZHZpY2VfaWQ6IGFkdmljZV9pZC50b1N0cmluZygpCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBfdGhpczIxLmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIF90aGlzMjEuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgYWRkTmV3QWR2aWNlOiBmdW5jdGlvbiBhZGROZXdBZHZpY2UoKSB7CiAgICAgIHZhciBfdGhpczIyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMyMi5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5wcmV2ID0gMTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMi5hZHZpY2VTZXR1cC5hZHZpY2VfbmFtZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyMi5hZHZpY2VTZXR1cC5jb25zdWx0YW5jeV9kZXBhcnRtZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyMi5hZHZpY2VTZXR1cFNlcnZpY2UuYWRkKF90aGlzMjIuYWR2aWNlU2V0dXApOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMC5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMjIuZ2V0UHJlc2NyaXB0aW9uRGF0YSgpOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdCgicmV0dXJuIiwgcmVzdWx0LmRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX3RoaXMyMi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDI0OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBfY29udGV4dDEwLnByZXYgPSAyMTsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAudDAgPSBfY29udGV4dDEwWyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICAgIF90aGlzMjIuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfY29udGV4dDEwLnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCwgbnVsbCwgW1sxLCAyMV1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgLy8gQWRkIGFsbCBhZHZpY2UgY2hlY2tib3gKICAgIGFkZEFsbEFkdmljZTogZnVuY3Rpb24gYWRkQWxsQWR2aWNlKCkgewogICAgICB2YXIgX3RoaXMyMyA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5hbGxBZHZpY2UpIHsKICAgICAgICB0aGlzLnRlbXBEYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgIHZhciBhQWR2aWNlID0gX3RoaXMyMy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgIHJldHVybiBlbC5hZHZpY2VfaWQgPT09IGVsZW1lbnQuaWQ7CiAgICAgICAgICB9LCBfdGhpczIzKTsKCiAgICAgICAgICBpZiAoIWFBZHZpY2UubGVuZ3RoKSB7CiAgICAgICAgICAgIF90aGlzMjMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogZWxlbWVudC5uYW1lLAogICAgICAgICAgICAgIGFkdmljZV9pZDogZWxlbWVudC5pZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIEFkZCB2YWx1ZSAKICAgIGdldFZhbHVlOiBmdW5jdGlvbiBnZXRWYWx1ZShkYXRhKSB7CiAgICAgIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIkludmVzdGlnYXRpb24iKSB7CiAgICAgICAgdmFyIGFJbnZlc3RpZ2F0aW9uID0gdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb24uZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmludmVzdGlnYXRpb25faWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUludmVzdGlnYXRpb24ubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbi5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICBpbnZlc3RpZ2F0aW9uX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJNZWRpY2luZSIpIHsKICAgICAgICB2YXIgYU1lZGljaW5lID0gdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwubWVkaWNpbmVfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYU1lZGljaW5lLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudC5wdXNoKHsKICAgICAgICAgICAgX21lZGljaW5lX3R5cGVfbmFtZTogZGF0YS5fbWVkaWNpbmVfdHlwZV9uYW1lLAogICAgICAgICAgICBuYW1lOiBkYXRhLl9tZWRpY2luZV9uYW1lLAogICAgICAgICAgICBtZWRpY2luZV9pZDogZGF0YS5pZCwKICAgICAgICAgICAgX3RyZWF0bWVudF9kb3NlX25hbWU6IGRhdGEuX3RyZWF0bWVudF9kb3NlX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9kb3NlX2lkOiBkYXRhLnRyZWF0bWVudF9kb3NlX2lkLAogICAgICAgICAgICBfdHJlYXRtZW50X3J1bGVfbmFtZTogZGF0YS5fdHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgICAgICAgdHJlYXRtZW50X3J1bGVzX2lkOiBkYXRhLnRyZWF0bWVudF9ydWxlc19pZCwKICAgICAgICAgICAgX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lOiBkYXRhLl90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgICAgICAgdHJlYXRtZW50X2R1cmF0aW9uX2lkOiBkYXRhLnRyZWF0bWVudF9kdXJhdGlvbl9pZCwKICAgICAgICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLmhlYWRlck5hbWUgPT0gIkFkdmljZSIpIHsKICAgICAgICB2YXIgYUFkdmljZSA9IHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmFkdmljZV9pZCA9PT0gZGF0YS5pZDsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhQWR2aWNlLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZS5wdXNoKHsKICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICBhZHZpY2VfaWQ6IGRhdGEuaWQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIERlbGV0ZSBmcm9tIHRlbXAgbGlzdAogICAgZGVsZXRlSXRlbTogZnVuY3Rpb24gZGVsZXRlSXRlbShsc3QsIGRhdGEpIHsKICAgICAgbHN0LnNwbGljZShsc3QuZmluZEluZGV4KGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuIGkgPT09IGRhdGE7CiAgICAgIH0pLCAxKTsKICAgIH0sCiAgICBwcmVzY3JpcHRpb246IGZ1bmN0aW9uIHByZXNjcmlwdGlvbihkYXRhKSB7CiAgICAgIHZhciBfdGhpczI0ID0gdGhpczsKCiAgICAgIHRoaXMuZGVwYXJ0bWVudF9pZCA9IGRhdGEuZGVwYXJ0bWVudF9pZDsgLy90aGlzLmFkbWl0dGVkUGF0aWVudEluZm8uYWRtaXNzaW9uX2lkID0gZGF0YS5hZG1pc3Npb25faWQ7CiAgICAgIC8vdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFkbWlzc2lvbl9ubyA9IGRhdGEuYWRtaXNzaW9uX25vOwogICAgICAvL2xvY2FsU3RvcmFnZS5zZXRJdGVtKCdhZG1pc3Npb25JZEZvckRpYWJldGVzU2VydmljZScsIGRhdGEuYWRtaXNzaW9uX2lkKTsKCiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5wYXRpZW50X2lkID0gZGF0YS5wYXRpZW50X2lkOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncGF0aWVudElkRm9yVHJlYXRtZW50JywgZGF0YS5wYXRpZW50X2lkKTsgLy8gdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLnJlZ2lzdHJhdGlvbl9ubyA9IGRhdGEucmVnaXN0cmF0aW9uX25vOwogICAgICAvLyB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8ucGF0aWVudF9uYW1lID0gZGF0YS5wYXRpZW50X25hbWU7CiAgICAgIC8vIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5nZW5kZXIgPSBkYXRhLmdlbmRlcjsKICAgICAgLy8gdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV95ZWFyID0gZGF0YS5hZ2VfeWVhcjsKICAgICAgLy8gdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV9tb250aCA9IGRhdGEuYWdlX21vbnRoOwogICAgICAvLyB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8uYWdlX2RheSA9IGRhdGEuYWdlX2RheTsKCiAgICAgIHRoaXMuZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKTsgLy8gVXNlIGZvciBEaWFsb2cgLy8KCiAgICAgIHRoaXMuZ2V0Q29tcGxhaW4oKTsKICAgICAgdGhpcy5nZXRGb29kKCk7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvblNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNC5vbkV4YW1pbmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7IC8vIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlCiAgICAgIC8vICAgLmdldEFsbCgpCiAgICAgIC8vICAgLnRoZW4oKGRhdGEpID0+ICh0aGlzLmRpYWdub3Npc0xpc3QgPSBkYXRhLmRhdGEpKTsKCiAgICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxBbGxlcmd5VHlwZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNC5hbGxlcmd5VHlwZUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmNvbW1vblNlcnZpY2UuR2V0QWxsRGlhYmV0ZXNNZWFsKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI0LmRpYWJldGVzTWVhbExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLmRpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI0LmRpZXRDaGFydFRlbXBsYXRlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7IC8vIFVzZSBmb3IgRGlhbG9nIC8vCgogICAgICBpZiAoZGF0YS5hZG1pc3Npb25faWQpIHsKICAgICAgICAvLyBQcmV2aW91cyBQcmVzY3JpcHRpb24gRGF0YQogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFBZG1pc3Npb25JZChkYXRhLmFkbWlzc2lvbl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgcmV0dXJuIF90aGlzMjQucHJldmlvdXNQcmVzY3JpcHRpb25EYXRhRm9ybWF0dGVkKGRhdGEuZGF0YSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoIWRhdGEuYWRtaXNzaW9uX2lkICYmIGRhdGEucGF0aWVudF9pZCkgewogICAgICAgIC8vIFByZXZpb3VzIFByZXNjcmlwdGlvbiBEYXRhCiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlLmdldFByZXZpb3VzUHJlc2NyaXB0aW9uRGF0YUJ5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgcmV0dXJuIF90aGlzMjQucHJldmlvdXNQcmVzY3JpcHRpb25EYXRhRm9ybWF0dGVkKGRhdGEuZGF0YSk7CiAgICAgICAgfSk7CiAgICAgIH0gLy8gUHJlc2NyaXB0aW9uIFRyZWF0bWVudAoKCiAgICAgIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjQubWVkaWNpbmVMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy50cmVhdG1lbnRSdWxlc1NldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNC50cmVhdG1lbnRSdWxlc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI0LnRyZWF0bWVudER1cmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNC50cmVhdG1lbnREb3NlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgcHJldmlvdXNQcmVzY3JpcHRpb25EYXRhRm9ybWF0dGVkOiBmdW5jdGlvbiBwcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFGb3JtYXR0ZWQoZGF0YSkgewogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uY2RwcmVzY3JpcHRpb25fZGF0ZSA9IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50ID0gZGF0YS5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQ7CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UgPSBkYXRhLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZTsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb24gPSBkYXRhLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb247CiAgICB9LAogICAgbmV3UHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBuZXdQcmVzY3JpcHRpb24oKSB7CiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJTZWN0aW9ucyI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8gPSB7CiAgICAgICAgY2RwcmVzY3JpcHRpb25fZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgYWxsQWR2aWNlOiBmYWxzZSwKICAgICAgICBsc3RBZG1pc3Npb25QcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOiBbXSwKICAgICAgICBsc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQ6IFtdLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZTogW10KICAgICAgfSwgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgIH0sCiAgICBmb3JtYXREYXRlOiBmdW5jdGlvbiBmb3JtYXREYXRlKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CiAgICB9LAogICAgZm9ybWF0RGF0ZVRpbWU6IGZ1bmN0aW9uIGZvcm1hdERhdGVUaW1lKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIGg6bW06c3MgYSIpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/components/Prescription.js"],"names":["moment","Validation","FilterService","FilterMatchMode","FilterOperator","AppointmentPrescriptionService","AdmissionPrescriptionService","MedicineSetupService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","PatientProfileService","ComplaintSetupService","FoodService","OnExaminationSetupService","DietChartTemplateSetupService","DietChartSetupService","DiagnosisSetupService","CommonService","AdviceSetupService","data","filteredItems","submitted","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","admittedPatientInfo","prescriptionDataList","tempData","headerName","admissionPrescriptionInfo","allAdvice","lstAdmissionPrescriptionInvestigation","lstAdmissionPrescriptionTreatment","lstAdmissionPrescriptionAdvice","treatmentAddDialog","treatmentDialog","treatmentSetup","medicineList","treatmentRulesList","treatmentDurationList","treatmentDoseList","SectionDialog","complaintSetup","chiefComplainDialog","compliantList","chiefComplain","chiefComplainList","foodSetup","allergyDetailsDialog","allergyDetails","foodList","allergyTypeList","onExaminationDialog","onExamination","patientOnExaminationList","onExaminationList","iOChartDialog","iOChart","iOChartList","diabetesChartDialog","diabetesChart","aAdmissionServiceDetails","diabetesChartList","diabetesMealList","dietChartDialog","dietChart","dietChartList","dietChartTemplateList","dietChartTempList","currentMedicationsDialog","currentMedications","currentMedicationsList","pastMedicalHistoryDialog","pastMedicalHistory","pastMedicalHistoryList","diagnosisList","patientLatestHistory","lstPatientOnExamination","lstPatientAllergyDetails","lstPatientDiabetesChart","lstPatientDietChart","department_id","newAdviceDialog","adviceSetup","created","today","Date","month","getMonth","year","getFullYear","prevMonth","prevYear","minDate","setMonth","setFullYear","admissionPrescriptionService","appointmentPrescriptionService","medicineSetupService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","patientProfileService","complaintSetupService","foodService","onExaminationSetupService","dietChartTemplateSetupService","dietChartSetupService","diagnosisSetupService","commonService","validation","adviceSetupService","that","document","onkeyup","e","ctrlKey","altKey","which","getInvestigation","getTreatment","getAdvice","userInfo","JSON","parse","localStorage","getItem","doctor_id","getPrescriptionData","methods","getPrescriptionDataByDoctorId","then","hideDialog","patientId","toString","patient_id","getComplainsByPatientId","getComplain","getActiveCombo","addComplain","compilants_name","add","result","status","$toast","severity","summary","detail","res","life","searchComplain","event","setTimeout","query","trim","length","filter","item","text","toLowerCase","startsWith","newChiefComplain","addChiefComplain","ddlcomplain","cdfrom_date","from_date","String","format","isComplainExist","el","complainId","isDuplicate","compilants_id","complainSave","patient_complain_id","complainUpdate","getLatestHistoryByPatientIdForPrescription","newOnExamination","getOnExaminationsPopup","popupOnExaminationsData","forEach","element","push","_on_examination_name","on_examination_id","on_examination_result","onExaminationPopupDialog","addOnExamination","requred","onExaminationSave","getFood","addFood","food_name","active","searchFood","newAllergyDetails","addAllergyDetails","ddlfood","type","isFoodExist","foodId","food_id","allergyDetailsSave","patient_allergy_details_id","allergyDetailsUpdate","newIOChart","addIOChart","iOChartSave","getIOChartByPatientId","newDiabetesChart","addDiabetesChart","meal","before","after","diabetesChartSave","newDietChart","getDietChartByTemplateId","diet_chart_template_id","getByDietChartTemplateId","addDietChart","dietChartSave","searchMedicine","slice","saveTreatment","ddlmedicine","ddltreatment_rules","ddltreatment_duration","ddltreatment_dose","aMedicine","medicine_id","_treatment_dose_name","treatment_dose_id","_treatment_rule_name","treatment_rules_id","_treatment_duration_name","treatment_duration_id","description","editTreatment","index","medicineName","refid","treatmentIndex","treatmentEditSave","isAdvice","lstInvestigation","investingation_name","id","investigation_id","lstAdvices","advice_name","advice_id","newAdvice","addAdvice","isExist","aAdvice","consultancy_department_id","addNewAdvice","addAllAdvice","getValue","aInvestigation","_medicine_type_name","_medicine_name","deleteItem","lst","splice","findIndex","i","prescription","setItem","GetAllAllergyType","GetAllDiabetesMeal","admission_id","getPreviousPrescriptionDataAdmissionId","previousPrescriptionDataFormatted","getPreviousPrescriptionDataByPatientId","cdprescription_date","newPrescription","formatDate","formatDateTime"],"mappings":"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","sourcesContent":["import moment from \"moment\";\r\nimport Validation from \"../../scripts/validation\";\r\nimport { FilterService, FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n\r\n// Prescription\r\nimport AppointmentPrescriptionService from \"../../service/doctor-panel/AppointmentPrescriptionService\";\r\nimport AdmissionPrescriptionService from \"../../service/prescription/AdmissionPrescriptionService\";\r\n// Prescription Treatment\r\nimport MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\n// History\r\nimport PatientProfileService from \"../../service/profiles/PatientProfileService\";\r\nimport ComplaintSetupService from \"../../service/setup/ComplaintSetupService\";\r\nimport FoodService from \"../../service/setup/FoodService\";\r\nimport OnExaminationSetupService from \"../../service/setup/OnExaminationSetupService\";\r\nimport DietChartTemplateSetupService from \"../../service/setup/DietChartTemplateSetupService\";\r\nimport DietChartSetupService from \"../../service/setup/DietChartSetupService\";\r\nimport DiagnosisSetupService from \"../../service/setup/DiagnosisSetupService\";\r\nimport CommonService from \"../../service/CommonService\";\r\n// Advice\r\nimport AdviceSetupService from \"../../service/setup/AdviceSetupService\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      filteredItems: null,\r\n      submitted: false,\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n\r\n      // Prescription\r\n      admittedPatientInfo: {},\r\n      prescriptionDataList: [],\r\n      tempData: [],\r\n      headerName: \"Sections\",\r\n      admissionPrescriptionInfo: {\r\n        allAdvice: false,\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n      // Prescription Treatment\r\n      treatmentAddDialog: false,\r\n      treatmentDialog: false,\r\n      treatmentSetup: {},\r\n      medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n\r\n      // Section\r\n      SectionDialog: false,\r\n\r\n      // History\r\n      complaintSetup: {},\r\n      chiefComplainDialog: false,\r\n      compliantList: [],\r\n      chiefComplain: {},\r\n      chiefComplainList: [],\r\n\r\n      foodSetup: {},\r\n      allergyDetailsDialog: false,\r\n      allergyDetails: {},\r\n      foodList: [],\r\n      allergyTypeList: [],\r\n\r\n      onExaminationDialog: false,\r\n      onExamination: {},\r\n      patientOnExaminationList: [],\r\n      onExaminationList: [],\r\n\r\n      iOChartDialog: false,\r\n      iOChart: {},\r\n      iOChartList: [],\r\n\r\n      diabetesChartDialog: false,\r\n      diabetesChart: {\r\n        aAdmissionServiceDetails: {}\r\n      },\r\n      diabetesChartList: [],\r\n      diabetesMealList: [],\r\n\r\n      dietChartDialog: false,\r\n      dietChart: {},\r\n      dietChartList: [],\r\n      dietChartTemplateList: [],\r\n      dietChartTempList: [],\r\n\r\n      currentMedicationsDialog: false,\r\n      currentMedications: {},\r\n      currentMedicationsList: [],\r\n\r\n      pastMedicalHistoryDialog: false,\r\n      pastMedicalHistory: {},\r\n      pastMedicalHistoryList: [],\r\n      diagnosisList: [],\r\n\r\n      patientLatestHistory: {\r\n        lstPatientOnExamination: [],\r\n        lstPatientAllergyDetails: [],\r\n        lstPatientDiabetesChart: [],\r\n        lstPatientDietChart: [],\r\n      },\r\n\r\n      department_id: \"\",\r\n      newAdviceDialog: false,\r\n      adviceSetup: {},\r\n    };\r\n  },\r\n  created() {\r\n    // past date-year disabled\r\n    let today = new Date();\r\n    let month = today.getMonth();\r\n    let year = today.getFullYear();\r\n    let prevMonth = (month === 0) ? 11 : month - 0;\r\n    let prevYear = (prevMonth === 11) ? year - 0 : year;\r\n    this.minDate = new Date();\r\n    this.minDate.setMonth(prevMonth);\r\n    this.minDate.setFullYear(prevYear);\r\n\r\n    // Prescription\r\n    this.admissionPrescriptionService = new AdmissionPrescriptionService();\r\n    this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n\r\n    // Prescription Treatment\r\n    this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n\r\n    // History\r\n    this.patientProfileService = new PatientProfileService();\r\n\r\n    this.complaintSetupService = new ComplaintSetupService();\r\n    this.foodService = new FoodService();\r\n    this.onExaminationSetupService = new OnExaminationSetupService();\r\n    this.dietChartTemplateSetupService = new DietChartTemplateSetupService();\r\n    this.dietChartSetupService = new DietChartSetupService();\r\n\r\n    this.diagnosisSetupService = new DiagnosisSetupService();\r\n    this.commonService = new CommonService();\r\n    this.validation = new Validation();\r\n\r\n    // Advice\r\n    this.adviceSetupService = new AdviceSetupService();\r\n\r\n    // shortcut key start\r\n    let that = this;\r\n    document.onkeyup = function (e) {\r\n      if (e.ctrlKey && e.altKey && e.which == 73) {\r\n        that.getInvestigation();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 84) {\r\n        that.getTreatment();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 65) {\r\n        that.getAdvice();\r\n      }\r\n      // else if (e.ctrlKey && e.altKey && e.shiftKey) {\r\n\r\n      // }\r\n    };\r\n    // shortcut key end\r\n\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n\r\n    if (this.userInfo.doctor_id) {\r\n      this.getPrescriptionData();\r\n\r\n      this.doctor_id = this.userInfo.doctor_id;\r\n      this.admissionPrescriptionInfo.doctor_id = this.doctor_id;\r\n    }\r\n  },\r\n  methods: {\r\n    getPrescriptionData() {\r\n      //this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n      this.appointmentPrescriptionService\r\n        .getPrescriptionDataByDoctorId(this.userInfo.doctor_id)\r\n        .then((data) => (this.prescriptionDataList = data.data));\r\n    },\r\n\r\n    hideDialog() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n\r\n      // Chief Complain\r\n      this.chiefComplainDialog = false;\r\n      this.chiefComplain = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      // On Examination\r\n      this.onExaminationDialog = false;\r\n      // this.onExamination = {\r\n      //   patient_id: patientId\r\n      // };\r\n\r\n      this.SectionDialog = false;\r\n      this.treatmentAddDialog = false;\r\n      this.treatmentSetup = {};\r\n      this.treatmentDialog = false;\r\n\r\n      this.foodSetup = {};\r\n      this.allergyDetailsDialog = false;\r\n      this.allergyDetails = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.iOChartDialog = false;\r\n      this.iOChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.diabetesChartDialog = false;\r\n      this.diabetesChart = {\r\n        aAdmissionServiceDetails: {},\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.dietChartDialog = false;\r\n      this.dietChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.newAdviceDialog = false,\r\n        this.adviceSetup = {};\r\n\r\n      this.submitted = false;\r\n    },\r\n    // Get Previous Chief Complain\r\n    getComplainsByPatientId(patient_id) {\r\n      this.chiefComplain.patient_id = patient_id;\r\n      this.patientProfileService.getComplainsByPatientId(patient_id).then((data) => (this.chiefComplainList = data.data));\r\n    },\r\n    // Get, Add Complain\r\n    getComplain() {\r\n      this.complaintSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.compliantList = data.data));\r\n    },\r\n    async addComplain() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.complaintSetup.compilants_name) {\r\n          return;\r\n        } else {\r\n          //this.complaintSetup.compliants_group_id = \"1\"\r\n          //this.complaintSetup.is_favourite = true;\r\n          let result = await this.complaintSetupService.add(this.complaintSetup);\r\n          if (result.status === 200) {\r\n            this.getComplain();\r\n            return result.data;\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    // Add Chief Complain\r\n    searchComplain(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.compliantList];\r\n        }\r\n        else {\r\n          //start with\r\n          this.filteredItems = this.compliantList.filter((item) => {\r\n            return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          });\r\n        }\r\n      }, 250);\r\n    },\r\n    newChiefComplain() {\r\n      this.chiefComplainDialog = true;\r\n    },\r\n    async addChiefComplain() {\r\n      this.submitted = true;\r\n      this.chiefComplain.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.chiefComplain.ddlcomplain) {\r\n        return;\r\n      } else if (!this.chiefComplain.patient_id) {\r\n        return;\r\n      } else if (!this.chiefComplain.cdfrom_date) {\r\n        return;\r\n      } else {\r\n        this.chiefComplain.from_date = moment(\r\n          String(this.chiefComplain.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        // complain is exist check start\r\n        if (!this.chiefComplain.ddlcomplain.value) {\r\n          var isComplainExist = this.compliantList.filter(function (el) {\r\n            return el.text == this.chiefComplain.ddlcomplain;\r\n          }, this);\r\n\r\n          if (isComplainExist.length == 0) {\r\n            this.complaintSetup.compilants_name = this.chiefComplain.ddlcomplain;\r\n            var complainId = await this.addComplain();\r\n            this.chiefComplain.ddlcomplain = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.chiefComplain.ddlcomplain.value = complainId.toString();\r\n          } else {\r\n            this.chiefComplain.ddlcomplain = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.chiefComplain.ddlcomplain.value = isComplainExist[0].value;\r\n          }\r\n        }\r\n        // complain is exist check end\r\n\r\n        var isDuplicate = this.chiefComplainList.filter(function (el) {\r\n          return el.compilants_id == this.chiefComplain.ddlcomplain.value;\r\n        }, this);\r\n        this.chiefComplain.compilants_id = this.chiefComplain.ddlcomplain.value;\r\n        if (isDuplicate.length == 0) {\r\n          let result = await this.patientProfileService.complainSave(this.chiefComplain);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          this.chiefComplain.patient_complain_id = isDuplicate[0].patient_complain_id;\r\n          let result = await this.patientProfileService.complainUpdate(this.chiefComplain);\r\n          if (result.status === 202) {\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n\r\n      // var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      // this.chiefComplain.patient_id = patientId;\r\n      // this.submitted = true;\r\n      // if (!this.chiefComplain.compilants_id) {\r\n      //   return;\r\n      // } else if (!this.chiefComplain.patient_id) {\r\n      //   return;\r\n      // } else if (!this.chiefComplain.cdfrom_date) {\r\n      //   return;\r\n      // } else if (this.validation.isIdExists(this.chiefComplainList, 'compilants_id', this.chiefComplain.compilants_id, 'patient_complain_id', this.chiefComplain.patient_complain_id, this)) {\r\n      //   return;\r\n      // } else {\r\n      //   this.chiefComplain.from_date = moment(\r\n      //     String(this.chiefComplain.cdfrom_date)\r\n      //   ).format(\"YYYY-MM-DD\");\r\n      //   if (!this.chiefComplain.patient_complain_id) {\r\n      //     let result = await this.patientProfileService.complainSave(this.chiefComplain);\r\n      //     if (result.status === 201) {\r\n      //       this.$toast.add({\r\n      //         severity: \"success\",\r\n      //         summary: \"Success\",\r\n      //         detail: \"Saved Successfully\",\r\n      //         life: 10000,\r\n      //       });\r\n      //       this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n      //       this.hideDialog();\r\n      //     } else if (result.status === 401) {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Error\",\r\n      //         detail: result.data,\r\n      //         life: 10000,\r\n      //       });\r\n      //     } else {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Failed\",\r\n      //         detail: result.res,\r\n      //         life: 10000,\r\n      //       });\r\n      //     }\r\n      //   } else {\r\n      //     let result = await this.patientProfileService.complainUpdate(this.chiefComplain);\r\n      //     if (result.status === 202) {\r\n      //       this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n      //       this.hideDialog();\r\n      //       this.$toast.add({\r\n      //         severity: \"success\",\r\n      //         summary: \"Success\",\r\n      //         detail: \"Updated Successfully\",\r\n      //         life: 10000,\r\n      //       });\r\n      //     } else if (result.status === 401) {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Error\",\r\n      //         detail: result.data,\r\n      //         life: 10000,\r\n      //       });\r\n      //     } else {\r\n      //       this.$toast.add({\r\n      //         severity: \"error\",\r\n      //         summary: \"Failed\",\r\n      //         detail: result.res,\r\n      //         life: 10000,\r\n      //       });\r\n      //     }\r\n      //   }\r\n      // }\r\n    },\r\n\r\n    // Get Previous lstPatientOnExamination, lstPatientAllergyDetails, lstPatientDiabetesChart, lstPatientDietChart,\r\n    getLatestHistoryByPatientIdForPrescription() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      this.patientProfileService.getLatestHistoryByPatientIdForPrescription(patientId).then((data) => (this.patientLatestHistory = data.data));\r\n    },\r\n\r\n    // Add On Examination\r\n    newOnExamination() {\r\n      this.getOnExaminationsPopup();\r\n      this.onExaminationDialog = true;\r\n    },\r\n    getOnExaminationsPopup() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n\r\n      this.popupOnExaminationsData = [];\r\n      this.onExaminationList.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          _on_examination_name: element.text,\r\n          on_examination_id: element.value,\r\n          on_examination_result: String(1),\r\n          patient_id: patientId.toString()\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n    async addOnExamination() {\r\n      this.submitted = true;\r\n      this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (!element.on_examination_result) {\r\n          this.requred = \"required\";\r\n        }\r\n      });\r\n\r\n      if (this.requred) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Required\",\r\n          detail: \"Please fill in the required fields\",\r\n          life: 10000,\r\n        });\r\n        return;\r\n      }\r\n      if (this.requred) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.onExaminationSave(this.popupOnExaminationsData);\r\n        if (result.status === 201) {\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Get, Add Food\r\n    getFood() {\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => (this.foodList = data.data));\r\n    },\r\n    async addFood() {\r\n      try {\r\n        if (!this.foodSetup.food_name) {\r\n          return;\r\n        } else {\r\n          this.foodSetup.active = true;\r\n          let result = await this.foodService.add(this.foodSetup);\r\n          if (result.status === 200) {\r\n            this.getFood();\r\n            return result.data;\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add Allergy Details\r\n    searchFood(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.foodList];\r\n        }\r\n        else {\r\n          //start with\r\n          this.filteredItems = this.foodList.filter((item) => {\r\n            return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          });\r\n        }\r\n      }, 250);\r\n    },\r\n    newAllergyDetails() {\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n    async addAllergyDetails() {\r\n      this.submitted = true;\r\n      this.allergyDetails.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      if (!this.allergyDetails.ddlfood) {\r\n        return;\r\n      } else if (!this.allergyDetails.patient_id) {\r\n        return;\r\n      } else if (!this.allergyDetails.type) {\r\n        return;\r\n      } else if (!this.allergyDetails.cdfrom_date) {\r\n        return;\r\n      } else {\r\n        this.allergyDetails.from_date = moment(\r\n          String(this.allergyDetails.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        // food is exist check start\r\n        if (!this.allergyDetails.ddlfood.value) {\r\n          var isFoodExist = this.foodList.filter(function (el) {\r\n            return el.text == this.allergyDetails.ddlfood;\r\n          }, this);\r\n\r\n          if (isFoodExist.length == 0) {\r\n            this.foodSetup.food_name = this.allergyDetails.ddlfood;\r\n            var foodId = await this.addFood();\r\n            this.allergyDetails.ddlfood = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.allergyDetails.ddlfood.value = foodId.toString();\r\n          } else {\r\n            this.allergyDetails.ddlfood = {\r\n              text: \"\",\r\n              value: \"\",\r\n            };\r\n            this.allergyDetails.ddlfood.value = isFoodExist[0].value;\r\n          }\r\n        }\r\n        // food is exist check end\r\n\r\n        var isDuplicate = this.patientLatestHistory.lstPatientAllergyDetails.filter(function (el) {\r\n          return el.food_id == this.allergyDetails.ddlfood.value;\r\n        }, this);\r\n        this.allergyDetails.food_id = this.allergyDetails.ddlfood.value;\r\n        if (isDuplicate.length == 0) {\r\n          let result = await this.patientProfileService.allergyDetailsSave(this.allergyDetails);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getLatestHistoryByPatientIdForPrescription();\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          this.allergyDetails.patient_allergy_details_id = isDuplicate[0].patient_allergy_details_id;\r\n          let result = await this.patientProfileService.allergyDetailsUpdate(this.allergyDetails);\r\n          if (result.status === 202) {\r\n            this.getLatestHistoryByPatientIdForPrescription();\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add IO Chart\r\n    newIOChart() {\r\n      this.iOChartDialog = true;\r\n    },\r\n    async addIOChart() {\r\n      this.submitted = true;\r\n      if (!this.iOChart.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.iOChartSave(this.iOChart);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getIOChartByPatientId(patientId);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add Diabetes Chart\r\n    newDiabetesChart() {\r\n      this.diabetesChartDialog = true;\r\n    },\r\n    async addDiabetesChart() {\r\n      this.submitted = true;\r\n      if (!this.diabetesChart.meal) {\r\n        return;\r\n      } else if (!this.diabetesChart.before) {\r\n        return;\r\n      } else if (!this.diabetesChart.after) {\r\n        return;\r\n      } else {\r\n        //var admission_id = JSON.parse(localStorage.getItem(\"admissionIdForDiabetesService\"));\r\n        //this.diabetesChart.aAdmissionServiceDetails.admission_id = String(admission_id);\r\n        var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n        this.diabetesChart.patient_id = String(patientId);\r\n        let result = await this.patientProfileService.diabetesChartSave(this.diabetesChart);\r\n        if (result.status === 201) {\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Add Diet Chart\r\n    newDietChart() {\r\n      this.dietChartDialog = true;\r\n    },\r\n    getDietChartByTemplateId() {\r\n      if (!this.dietChart.diet_chart_template_id) {\r\n        return\r\n      } else {\r\n        this.dietChartSetupService\r\n          .getByDietChartTemplateId(this.dietChart.diet_chart_template_id)\r\n          .then((data) => (this.dietChartTempList = data.data));\r\n      }\r\n    },\r\n    async addDietChart() {\r\n      this.submitted = true;\r\n      if (this.dietChartTempList.length <= 0) {\r\n        return;\r\n      } else {\r\n        var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n        this.dietChartTempList.forEach(element => {\r\n          element.patient_id = patientId.toString()\r\n        });\r\n\r\n        let result = await this.patientProfileService.dietChartSave(this.dietChartTempList);\r\n        if (result.status === 201) {\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Treatment\r\n    searchMedicine(event) {\r\n      setTimeout(() => {\r\n        if (!event.query.trim().length) {\r\n          this.filteredItems = [...this.medicineList];\r\n        }\r\n        else {\r\n          // start with\r\n          // this.filteredItems = this.medicineList.filter((item) => {\r\n          //     return item.text.toLowerCase().startsWith(event.query.toLowerCase());\r\n          // });\r\n\r\n          // contains\r\n          this.filteredItems = FilterService.filter(this.medicineList, ['text'], event.query.toLowerCase(), FilterMatchMode.CONTAINS).slice(0, 10);\r\n        }\r\n      }, 250);\r\n    },\r\n    getTreatment() {\r\n      this.treatmentAddDialog = true;\r\n      // this.headerName = \"Medicine\";\r\n      // this.filters['global'].value = \"\";\r\n      // this.isAdvice = false;\r\n      // this.tempData = [];\r\n      // this.prescriptionDataList.lstTreatment.forEach((element) => {\r\n      //   this.tempData.push({\r\n      //     _medicine_type_name: element._medicine_type_name,\r\n      //     _medicine_name: element._medicine_name,\r\n      //     name: element._medicine_type_name + \" \" + element._medicine_name + \" \" + element._treatment_dose_name + \" \" + element._treatment_rule_name + \" \" + element._treatment_duration_name,\r\n      //     id: element.medicine_id,\r\n      //     _treatment_dose_name: element._treatment_dose_name,\r\n      //     treatment_dose_id: element.treatment_dose_id,\r\n      //     _treatment_rule_name: element._treatment_rule_name,\r\n      //     treatment_rules_id: element.treatment_rules_id,\r\n      //     _treatment_duration_name: element._treatment_duration_name,\r\n      //     treatment_duration_id: element.treatment_duration_id,\r\n      //     description: element.description,\r\n      //   });\r\n      // });\r\n    },\r\n    saveTreatment() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddlmedicine) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === this.treatmentSetup.ddlmedicine.value;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            name: this.treatmentSetup.ddlmedicine.text,\r\n            medicine_id: this.treatmentSetup.ddlmedicine.value,\r\n            _treatment_dose_name: this.treatmentSetup.ddltreatment_dose.text,\r\n            treatment_dose_id: this.treatmentSetup.ddltreatment_dose.value,\r\n            _treatment_rule_name: this.treatmentSetup.ddltreatment_rules.text,\r\n            treatment_rules_id: this.treatmentSetup.ddltreatment_rules.value,\r\n            _treatment_duration_name: this.treatmentSetup.ddltreatment_duration.text,\r\n            treatment_duration_id: this.treatmentSetup.ddltreatment_duration.value,\r\n            description: \"\",\r\n          });\r\n        }\r\n        this.hideDialog();\r\n      }\r\n    },\r\n    // Edit Treatment\r\n    editTreatment(data, index) {\r\n      this.treatmentSetup.medicineName = data.name;\r\n      this.treatmentSetup.ddltreatment_rules = {\r\n        text: data._treatment_rule_name,\r\n        value: data.treatment_rules_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_duration = {\r\n        text: data._treatment_duration_name,\r\n        value: data.treatment_duration_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_dose = {\r\n        text: data._treatment_dose_name,\r\n        value: data.treatment_dose_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentDialog = true;\r\n      this.treatmentIndex = index\r\n    },\r\n    treatmentEditSave() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].name = this.treatmentSetup.ddlmedicine.text;\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].medicine_id = this.treatmentSetup.ddlmedicine.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_rule_name = this.treatmentSetup.ddltreatment_rules.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_rules_id = this.treatmentSetup.ddltreatment_rules.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_duration_name = this.treatmentSetup.ddltreatment_duration.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_duration_id = this.treatmentSetup.ddltreatment_duration.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_dose_name = this.treatmentSetup.ddltreatment_dose.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_dose_id = this.treatmentSetup.ddltreatment_dose.value;\r\n\r\n        this.treatmentDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n\r\n    // Investigation\r\n    getInvestigation() {\r\n      this.headerName = \"Investigation\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstInvestigation.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.investingation_name,\r\n          id: element.investigation_id,\r\n        });\r\n      });\r\n\r\n      this.SectionDialog = true;\r\n    },\r\n\r\n    // Advice\r\n    getAdvice() {\r\n      this.headerName = \"Advice\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = true;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstAdvices.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.advice_name,\r\n          id: element.advice_id,\r\n        });\r\n      });\r\n      this.SectionDialog = true;\r\n    },\r\n\r\n    // Add New Advice\r\n    newAdvice() {\r\n      this.SectionDialog = false;\r\n      this.newAdviceDialog = true;\r\n    },\r\n    async addAdvice() {\r\n      var isExist =\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n          function (el) {\r\n            return el.name == this.adviceSetup.advice_name;\r\n          },\r\n          this\r\n        );\r\n\r\n      if (!isExist.length) {\r\n        var aAdvice =\r\n          this.prescriptionDataList.lstAdvices.filter(\r\n            function (el) {\r\n              return el.advice_name == this.adviceSetup.advice_name;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (aAdvice.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: aAdvice[0].advice_name,\r\n            advice_id: aAdvice[0].advice_id,\r\n          });\r\n\r\n          this.hideDialog();\r\n        }\r\n        else {\r\n          //this.adviceSetup.advice_group_id = \"\";\r\n          this.adviceSetup.consultancy_department_id = this.department_id;\r\n          var advice_id = await this.addNewAdvice();\r\n          \r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: this.adviceSetup.advice_name,\r\n            advice_id: advice_id.toString(),\r\n          });\r\n          this.hideDialog();\r\n        }\r\n      }\r\n      else {\r\n        this.hideDialog();\r\n      }\r\n    },\r\n\r\n    async addNewAdvice() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.adviceSetup.advice_name) {\r\n          return;\r\n        } else if (!this.adviceSetup.consultancy_department_id) {\r\n          return;\r\n        } else {\r\n          let result = await this.adviceSetupService.add(this.adviceSetup);\r\n          if (result.status === 200) {\r\n            this.getPrescriptionData();\r\n            return result.data;\r\n          }\r\n          else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add all advice checkbox\r\n    addAllAdvice() {\r\n      if (!this.admissionPrescriptionInfo.allAdvice) {\r\n        this.tempData.forEach((element) => {\r\n          var aAdvice =\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n              function (el) {\r\n                return el.advice_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aAdvice.length) {\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n              name: element.name,\r\n              advice_id: element.id,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    // Add value \r\n    getValue(data) {\r\n      if (this.headerName == \"Investigation\") {\r\n        var aInvestigation =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.filter(\r\n            function (el) {\r\n              return el.investigation_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aInvestigation.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.push(\r\n            {\r\n              name: data.name,\r\n              investigation_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Medicine\") {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            _medicine_type_name: data._medicine_type_name,\r\n            name: data._medicine_name,\r\n            medicine_id: data.id,\r\n            _treatment_dose_name: data._treatment_dose_name,\r\n            treatment_dose_id: data.treatment_dose_id,\r\n            _treatment_rule_name: data._treatment_rule_name,\r\n            treatment_rules_id: data.treatment_rules_id,\r\n            _treatment_duration_name: data._treatment_duration_name,\r\n            treatment_duration_id: data.treatment_duration_id,\r\n            description: data.description,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Advice\") {\r\n        var aAdvice =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n            function (el) {\r\n              return el.advice_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aAdvice.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: data.name,\r\n            advice_id: data.id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    // Delete from temp list\r\n    deleteItem(lst, data) {\r\n      lst.splice(\r\n        lst.findIndex((i) => i === data),\r\n        1\r\n      );\r\n    },\r\n\r\n    prescription(data) {\r\n      this.department_id = data.department_id;\r\n      //this.admittedPatientInfo.admission_id = data.admission_id;\r\n      //this.admittedPatientInfo.admission_no = data.admission_no;\r\n      //localStorage.setItem('admissionIdForDiabetesService', data.admission_id);\r\n      this.admittedPatientInfo.patient_id = data.patient_id;\r\n      localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      // this.admittedPatientInfo.registration_no = data.registration_no;\r\n      // this.admittedPatientInfo.patient_name = data.patient_name;\r\n      // this.admittedPatientInfo.gender = data.gender;\r\n      // this.admittedPatientInfo.age_year = data.age_year;\r\n      // this.admittedPatientInfo.age_month = data.age_month;\r\n      // this.admittedPatientInfo.age_day = data.age_day;\r\n\r\n      this.getComplainsByPatientId(data.patient_id);\r\n      this.getLatestHistoryByPatientIdForPrescription();\r\n\r\n      // Use for Dialog //\r\n      this.getComplain();\r\n\r\n      this.getFood();\r\n\r\n      this.onExaminationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.onExaminationList = data.data));\r\n\r\n      // this.diagnosisSetupService\r\n      //   .getAll()\r\n      //   .then((data) => (this.diagnosisList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllAllergyType()\r\n        .then((data) => (this.allergyTypeList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllDiabetesMeal()\r\n        .then((data) => (this.diabetesMealList = data.data));\r\n\r\n      this.dietChartTemplateSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.dietChartTemplateList = data.data));\r\n      // Use for Dialog //\r\n\r\n      if (data.admission_id) {\r\n        // Previous Prescription Data\r\n        this.admissionPrescriptionService\r\n          .getPreviousPrescriptionDataAdmissionId(data.admission_id)\r\n          .then((data) => this.previousPrescriptionDataFormatted(data.data));\r\n      } else if (!data.admission_id && data.patient_id) {\r\n        // Previous Prescription Data\r\n        this.admissionPrescriptionService\r\n          .getPreviousPrescriptionDataByPatientId(data.patient_id)\r\n          .then((data) => this.previousPrescriptionDataFormatted(data.data));\r\n      }\r\n\r\n      // Prescription Treatment\r\n      this.medicineSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.medicineList = data.data));\r\n\r\n      this.treatmentRulesSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n      this.treatmentDurationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n      this.treatmentDoseSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDoseList = data.data));\r\n    },\r\n    previousPrescriptionDataFormatted(data) {\r\n      this.admissionPrescriptionInfo.cdprescription_date = moment(String(new Date())).format(\"MM/DD/YYYY\");\r\n\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment = data.lstAdmissionPrescriptionTreatment;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice = data.lstAdmissionPrescriptionAdvice;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation = data.lstAdmissionPrescriptionInvestigation;\r\n    },\r\n\r\n    newPrescription() {\r\n      this.headerName = \"Sections\";\r\n      this.filters['global'].value = \"\";\r\n      this.tempData = [];\r\n\r\n      this.admissionPrescriptionInfo = {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        allAdvice: false,\r\n\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n        this.submitted = false;\r\n    },\r\n\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY\");\r\n    },\r\n    formatDateTime(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n  },\r\n};"]}]}