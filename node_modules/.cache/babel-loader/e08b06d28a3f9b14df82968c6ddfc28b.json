{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\emergency\\PatientRegTreatment.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\emergency\\PatientRegTreatment.js","mtime":1656333832339},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L1NWTiBQUk9KRUNUUy9FUlBfSG9zcGl0YWxfQ2xpZW50L3RydW5rL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuZGVzY3JpcHRpb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLWluZGV4LmpzIjsKaW1wb3J0IFBhdGllbnRSZWdpc3RyYXRpb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvZnJvbnQtZGVzay9QYXRpZW50UmVnaXN0cmF0aW9uU2VydmljZSI7CmltcG9ydCBQYXRpZW50UmVwb3J0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3JlcG9ydC9QYXRpZW50UmVwb3J0U2VydmljZSI7CmltcG9ydCBDb21tb25TZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvQ29tbW9uU2VydmljZSI7CmltcG9ydCBWYWxpZGF0aW9uIGZyb20gIi4uLy4uL3NjcmlwdHMvdmFsaWRhdGlvbiI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IHsgRmlsdGVyTWF0Y2hNb2RlLCBGaWx0ZXJPcGVyYXRvciB9IGZyb20gInByaW1ldnVlL2FwaSI7IC8vIFNlcnZpY2UKCmltcG9ydCBTZXJ2aWNlU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvU2VydmljZVNldHVwU2VydmljZSI7CmltcG9ydCBFbWVyZ2VuY3lTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvZW1lcmdlbmN5L0VtZXJnZW5jeVNlcnZpY2UiOyAvLyBQcmVzY3JpcHRpb24KCmltcG9ydCBBcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9kb2N0b3ItcGFuZWwvQXBwb2ludG1lbnRQcmVzY3JpcHRpb25TZXJ2aWNlIjsKaW1wb3J0IEFkbWlzc2lvblByZXNjcmlwdGlvblNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9wcmVzY3JpcHRpb24vQWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZSI7IC8vIFByZXNjcmlwdGlvbiBUcmVhdG1lbnQKCmltcG9ydCBNZWRpY2luZVR5cGVTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9NZWRpY2luZVR5cGVTZXR1cFNlcnZpY2UiOwppbXBvcnQgTWVkaWNpbmVTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9NZWRpY2luZVNldHVwU2VydmljZSI7CmltcG9ydCBUcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudFJ1bGVzU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IFRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvVHJlYXRtZW50RHVyYXRpb25TZXR1cFNlcnZpY2UiOwppbXBvcnQgVHJlYXRtZW50RG9zZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL1RyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UiOyAvLyBIaXN0b3J5CgppbXBvcnQgUGF0aWVudFByb2ZpbGVTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcHJvZmlsZXMvUGF0aWVudFByb2ZpbGVTZXJ2aWNlIjsgLy9pbXBvcnQgV29yZENhYmluU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvV29yZENhYmluU2V0dXBTZXJ2aWNlIjsKCmltcG9ydCBDb21wbGFpbnRTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Db21wbGFpbnRTZXR1cFNlcnZpY2UiOwppbXBvcnQgRm9vZFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9Gb29kU2VydmljZSI7CmltcG9ydCBPbkV4YW1pbmF0aW9uU2V0dXBTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2Uvc2V0dXAvT25FeGFtaW5hdGlvblNldHVwU2VydmljZSI7CmltcG9ydCBEaWV0Q2hhcnRUZW1wbGF0ZVNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpZXRDaGFydFRlbXBsYXRlU2V0dXBTZXJ2aWNlIjsKaW1wb3J0IERpZXRDaGFydFNldHVwU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3NldHVwL0RpZXRDaGFydFNldHVwU2VydmljZSI7CmltcG9ydCBEaWFnbm9zaXNTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9EaWFnbm9zaXNTZXR1cFNlcnZpY2UiOwppbXBvcnQgUHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL3JlcG9ydC9QcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwYWdlOiAxMDAsCiAgICAgIGlzQ29udGFjdEV4aXN0OiAiIiwKICAgICAgaXNWYWxpZDogIiIsCiAgICAgIGlzRW1haWxWYWxpZDogIiIsCiAgICAgIG5ld0luZm86IGZhbHNlLAogICAgICBkYXRhTGlzdDogdHJ1ZSwKICAgICAgcmVsYXRpb25MaXN0OiBbXSwKICAgICAgYmxvb2RHcm91cExpc3Q6IFtdLAogICAgICBnZW5kZXJMaXN0OiBbXSwKICAgICAgcGF0aWVudFJlZ2lzdHJhdGlvbkxpc3Q6IFtdLAogICAgICBwYXRpZW50UmVnaXN0cmF0aW9uOiB7CiAgICAgICAgYWdlX3llYXI6ICIwIiwKICAgICAgICBhZ2VfbW9udGg6ICIwIiwKICAgICAgICBhZ2VfZGF5OiAiMCIKICAgICAgfSwKICAgICAgZmlsdGVyczogewogICAgICAgIGdsb2JhbDogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5DT05UQUlOUwogICAgICAgIH0sCiAgICAgICAgbmFtZTogewogICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5TVEFSVFNfV0lUSAogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5pdEZpbHRlcnM6IGZ1bmN0aW9uIGluaXRGaWx0ZXJzKCkgewogICAgICAgIHRoaXMuZmlsdGVycyA9IHsKICAgICAgICAgIGdsb2JhbDogewogICAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuQ09OVEFJTlMKICAgICAgICAgIH0sCiAgICAgICAgICBuYW1lOiB7CiAgICAgICAgICAgIG9wZXJhdG9yOiBGaWx0ZXJPcGVyYXRvci5BTkQsCiAgICAgICAgICAgIGNvbnN0cmFpbnRzOiBbewogICAgICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLlNUQVJUU19XSVRICiAgICAgICAgICAgIH1dCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSwKICAgICAgc3VibWl0dGVkOiBmYWxzZSwKICAgICAgLy8gU2VydmljZQogICAgICBzZXJ2aWNlRGlhbG9nOiBmYWxzZSwKICAgICAgZW1lcmdlbmN5U2VydmljZU9iajogewogICAgICAgIGxzdFNlcnZpY2U6IFtdCiAgICAgIH0sCiAgICAgIC8vIFByZXNjcmlwdGlvbgogICAgICBpc0RvY3RvcjogZmFsc2UsCiAgICAgIGFkbWl0dGVkUGF0aWVudEluZm86IHt9LAogICAgICBwcmVzY3JpcHRpb25EYXRhTGlzdDogW10sCiAgICAgIHRlbXBEYXRhOiBbXSwKICAgICAgaGVhZGVyTmFtZTogIlNlY3Rpb25zIiwKICAgICAgYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mbzogewogICAgICAgIGNkcHJlc2NyaXB0aW9uX2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGNkZm9sb3d1cF9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSArIDcpKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIGFsbEFkdmljZTogZmFsc2UsCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uSW52ZXN0aWdhdGlvbjogW10sCiAgICAgICAgbHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50OiBbXSwKICAgICAgICBsc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2U6IFtdCiAgICAgIH0sCiAgICAgIC8vIFByZXNjcmlwdGlvbiBUcmVhdG1lbnQKICAgICAgdHJlYXRtZW50QWRkRGlhbG9nOiBmYWxzZSwKICAgICAgdHJlYXRtZW50RGlhbG9nOiBmYWxzZSwKICAgICAgdHJlYXRtZW50U2V0dXA6IHt9LAogICAgICBtZWRpY2luZVR5cGVMaXN0OiBbXSwKICAgICAgbWVkaWNpbmVMaXN0OiBbXSwKICAgICAgdHJlYXRtZW50UnVsZXNMaXN0OiBbXSwKICAgICAgdHJlYXRtZW50RHVyYXRpb25MaXN0OiBbXSwKICAgICAgdHJlYXRtZW50RG9zZUxpc3Q6IFtdLAogICAgICAvLyBIaXN0b3J5CiAgICAgIGlzSGlzdG9yeTogZmFsc2UsCiAgICAgIGFjdGl2ZTogMCwKICAgICAgZXhwYW5kZWRSb3dzOiBbXSwKICAgICAgaXNGZW1hbGU6IGZhbHNlLAogICAgICBjaGllZkNvbXBsYWluRGlhbG9nOiBmYWxzZSwKICAgICAgY2hpZWZDb21wbGFpbjoge30sCiAgICAgIGNoaWVmQ29tcGxhaW5MaXN0OiBbXSwKICAgICAgY29tcGxpYW50TGlzdDogW10sCiAgICAgIGZvb2REaWFsb2c6IGZhbHNlLAogICAgICBmb29kU2V0dXA6IHt9LAogICAgICBhbGxlcmd5RGV0YWlsc0RpYWxvZzogZmFsc2UsCiAgICAgIGFsbGVyZ3lEZXRhaWxzOiB7fSwKICAgICAgYWxsZXJneURldGFpbHNMaXN0OiBbXSwKICAgICAgZm9vZExpc3Q6IFtdLAogICAgICBhbGxlcmd5VHlwZUxpc3Q6IFtdLAogICAgICBvbkV4YW1pbmF0aW9uRGlhbG9nOiBmYWxzZSwKICAgICAgb25FeGFtaW5hdGlvbjoge30sCiAgICAgIHBhdGllbnRPbkV4YW1pbmF0aW9uTGlzdDogW10sCiAgICAgIG9uRXhhbWluYXRpb25MaXN0OiBbXSwKICAgICAgaU9DaGFydERpYWxvZzogZmFsc2UsCiAgICAgIGlPQ2hhcnQ6IHt9LAogICAgICBpT0NoYXJ0TGlzdDogW10sCiAgICAgIGRpYWJldGVzQ2hhcnREaWFsb2c6IGZhbHNlLAogICAgICBkaWFiZXRlc0NoYXJ0OiB7CiAgICAgICAgYUFkbWlzc2lvblNlcnZpY2VEZXRhaWxzOiB7fQogICAgICB9LAogICAgICBkaWFiZXRlc0NoYXJ0TGlzdDogW10sCiAgICAgIGRpYWJldGVzTWVhbExpc3Q6IFtdLAogICAgICBkaWV0Q2hhcnREaWFsb2c6IGZhbHNlLAogICAgICBkaWV0Q2hhcnQ6IHt9LAogICAgICBkaWV0Q2hhcnRMaXN0OiBbXSwKICAgICAgZGlldENoYXJ0VGVtcGxhdGVMaXN0OiBbXSwKICAgICAgZGlldENoYXJ0VGVtcExpc3Q6IFtdLAogICAgICBjdXJyZW50TWVkaWNhdGlvbnNEaWFsb2c6IGZhbHNlLAogICAgICBjdXJyZW50TWVkaWNhdGlvbnM6IHt9LAogICAgICBjdXJyZW50TWVkaWNhdGlvbnNMaXN0OiBbXSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nOiBmYWxzZSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5OiB7fSwKICAgICAgcGFzdE1lZGljYWxIaXN0b3J5TGlzdDogW10sCiAgICAgIGRpYWdub3Npc0xpc3Q6IFtdLAogICAgICBwYXRpZW50TGF0ZXN0SGlzdG9yeTogewogICAgICAgIGxzdFBhdGllbnRPbkV4YW1pbmF0aW9uOiBbXSwKICAgICAgICBsc3RQYXRpZW50QWxsZXJneURldGFpbHM6IFtdLAogICAgICAgIGxzdFBhdGllbnREaWFiZXRlc0NoYXJ0OiBbXSwKICAgICAgICBsc3RQYXRpZW50RGlldENoYXJ0OiBbXQogICAgICB9LAogICAgICBwYXRpZW50SGlzdG9yeTogewogICAgICAgIGxzdFBlcnNvbmFsSGlzdG9yeTogW10sCiAgICAgICAgbHN0RmFtaWx5SGlzdG9yeTogW10sCiAgICAgICAgbHN0U3lzdGVtc1JldmlldzogW10sCiAgICAgICAgbHN0U3Vic3RhbmNlVXNlOiBbXSwKICAgICAgICBsc3RSZXByb2R1Y3RpdmVIaXN0b3J5OiBbXQogICAgICB9CiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgLy8gcGFzdCBkYXRlLXllYXIgZGlzYWJsZWQKICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7CiAgICB2YXIgbW9udGggPSB0b2RheS5nZXRNb250aCgpOwogICAgdmFyIHllYXIgPSB0b2RheS5nZXRGdWxsWWVhcigpOwogICAgdmFyIHByZXZNb250aCA9IG1vbnRoID09PSAwID8gMTEgOiBtb250aCAtIDA7CiAgICB2YXIgcHJldlllYXIgPSBwcmV2TW9udGggPT09IDExID8geWVhciAtIDAgOiB5ZWFyOwogICAgdGhpcy5taW5EYXRlID0gbmV3IERhdGUoKTsKICAgIHRoaXMubWluRGF0ZS5zZXRNb250aChwcmV2TW9udGgpOwogICAgdGhpcy5taW5EYXRlLnNldEZ1bGxZZWFyKHByZXZZZWFyKTsKICAgIHRoaXMucGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UgPSBuZXcgUGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UoKTsKICAgIHRoaXMucGF0aWVudFJlcG9ydFNlcnZpY2UgPSBuZXcgUGF0aWVudFJlcG9ydFNlcnZpY2UoKTsKICAgIHRoaXMuY29tbW9uU2VydmljZSA9IG5ldyBDb21tb25TZXJ2aWNlKCk7CiAgICB0aGlzLnZhbGlkYXRpb24gPSBuZXcgVmFsaWRhdGlvbigpOyAvLyBTZXJ2aWNlCgogICAgdGhpcy5zZXJ2aWNlU2V0dXBTZXJ2aWNlID0gbmV3IFNlcnZpY2VTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMuZW1lcmdlbmN5U2VydmljZSA9IG5ldyBFbWVyZ2VuY3lTZXJ2aWNlKCk7IC8vIFByZXNjcmlwdGlvbgoKICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBZG1pc3Npb25QcmVzY3JpcHRpb25TZXJ2aWNlKCk7CiAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZSA9IG5ldyBBcHBvaW50bWVudFByZXNjcmlwdGlvblNlcnZpY2UoKTsgLy8gUHJlc2NyaXB0aW9uIFRyZWF0bWVudAoKICAgIHRoaXMubWVkaWNpbmVUeXBlU2V0dXBTZXJ2aWNlID0gbmV3IE1lZGljaW5lVHlwZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5tZWRpY2luZVNldHVwU2VydmljZSA9IG5ldyBNZWRpY2luZVNldHVwU2VydmljZSgpOwogICAgdGhpcy50cmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSA9IG5ldyBUcmVhdG1lbnRSdWxlc1NldHVwU2VydmljZSgpOwogICAgdGhpcy50cmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSA9IG5ldyBUcmVhdG1lbnREdXJhdGlvblNldHVwU2VydmljZSgpOwogICAgdGhpcy50cmVhdG1lbnREb3NlU2V0dXBTZXJ2aWNlID0gbmV3IFRyZWF0bWVudERvc2VTZXR1cFNlcnZpY2UoKTsgLy8gSGlzdG9yeQoKICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlID0gbmV3IFBhdGllbnRQcm9maWxlU2VydmljZSgpOwogICAgdGhpcy5jb21wbGFpbnRTZXR1cFNlcnZpY2UgPSBuZXcgQ29tcGxhaW50U2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmZvb2RTZXJ2aWNlID0gbmV3IEZvb2RTZXJ2aWNlKCk7CiAgICB0aGlzLm9uRXhhbWluYXRpb25TZXR1cFNlcnZpY2UgPSBuZXcgT25FeGFtaW5hdGlvblNldHVwU2VydmljZSgpOwogICAgdGhpcy5kaWV0Q2hhcnRUZW1wbGF0ZVNldHVwU2VydmljZSA9IG5ldyBEaWV0Q2hhcnRUZW1wbGF0ZVNldHVwU2VydmljZSgpOwogICAgdGhpcy5kaWV0Q2hhcnRTZXR1cFNlcnZpY2UgPSBuZXcgRGlldENoYXJ0U2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmRpYWdub3Npc1NldHVwU2VydmljZSA9IG5ldyBEaWFnbm9zaXNTZXR1cFNlcnZpY2UoKTsKICAgIHRoaXMucHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZSA9IG5ldyBQcmVzY3JpcHRpb25SZXBvcnRTZXJ2aWNlKCk7CiAgICB0aGlzLmNvbW1vblNlcnZpY2UuR2V0QWxsR2VuZGVyKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMuZ2VuZGVyTGlzdCA9IGRhdGEuZGF0YTsKICAgIH0pOwogICAgdGhpcy5jb21tb25TZXJ2aWNlLkdldEFsbEJsb29kR3JvdXAoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy5ibG9vZEdyb3VwTGlzdCA9IGRhdGEuZGF0YTsKICAgIH0pOwogICAgdGhpcy5jb21tb25TZXJ2aWNlLkdldEFsbFBhdGllbnRzUmVsYXRpdmVzKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMucmVsYXRpb25MaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7IC8vIHNlcnZlciBzaWRlIHBhZ2luYXRpb24KCiAgICB2YXIgZmlsdGVyID0gdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA/IHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgOiAiIjsKICAgIHRoaXMucGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UuZ2V0UGF0aWVudFdpdGhQYWdpbmF0aW9uKCIwIiwgIjEwIiwgZmlsdGVyLCB0aGlzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBfdGhpcy5wYXRpZW50Rm9ybWF0dGVkKGRhdGEuZGF0YSk7CiAgICB9KTsgLy8gUHJlc2NyaXB0aW9uCgogICAgdmFyIHRoYXQgPSB0aGlzOwoKICAgIGRvY3VtZW50Lm9ua2V5dXAgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNzMpIHsKICAgICAgICB0aGF0LmdldEludmVzdGlnYXRpb24oKTsKICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5hbHRLZXkgJiYgZS53aGljaCA9PSA4NCkgewogICAgICAgIHRoYXQuZ2V0VHJlYXRtZW50KCk7CiAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUuYWx0S2V5ICYmIGUud2hpY2ggPT0gNjUpIHsKICAgICAgICB0aGF0LmdldEFkdmljZSgpOwogICAgICB9IC8vIGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSAmJiBlLnNoaWZ0S2V5KSB7CiAgICAgIC8vIH0KCiAgICB9OwoKICAgIHRoaXMubWVkaWNpbmVUeXBlU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMubWVkaWNpbmVUeXBlTGlzdCA9IGRhdGEuZGF0YTsKICAgIH0pOwogICAgdGhpcy51c2VySW5mbyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJJbmZvIikpOwoKICAgIGlmICh0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZCkgewogICAgICB0aGlzLmFwcG9pbnRtZW50UHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmVzY3JpcHRpb25EYXRhQnlEb2N0b3JJZCh0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZG9jdG9yX2lkID0gdGhpcy51c2VySW5mby5kb2N0b3JfaWQ7CiAgICAgIHRoaXMuaXNEb2N0b3IgPSB0cnVlOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uZG9jdG9yX2lkID0gdGhpcy5kb2N0b3JfaWQ7CiAgICB9IGVsc2UgaWYgKCF0aGlzLnVzZXJJbmZvLmRvY3Rvcl9pZCkgewogICAgICB0aGlzLmlzRG9jdG9yID0gZmFsc2U7CiAgICB9IC8vIFNlcnZpY2UKCgogICAgdGhpcy5nZXRTZXJ2aWNlKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRTZXJ2aWNlOiBmdW5jdGlvbiBnZXRTZXJ2aWNlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuc2VydmljZVNldHVwU2VydmljZS5nZXRBbGwoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5zZXJ2aWNlRm9ybWF0dGVkKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgfSwKICAgIHByaW50QWxsUGF0aWVudDogZnVuY3Rpb24gcHJpbnRBbGxQYXRpZW50KCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMucGF0aWVudFJlcG9ydFNlcnZpY2UuZ2V0QWxsKHRoaXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLmNvbW1vblNlcnZpY2UuRG93bmxvYWRmaWxlKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgfSwKICAgIHByaW50SUQ6IGZ1bmN0aW9uIHByaW50SUQocmVnTm8pIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLnBhdGllbnRSZXBvcnRTZXJ2aWNlLkdldFBhdGllbnRJZENhcmRCeVJlZ05vKHJlZ05vLCB0aGlzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNC5jb21tb25TZXJ2aWNlLkRvd25sb2FkZmlsZShkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBwYXRpZW50Rm9ybWF0dGVkOiBmdW5jdGlvbiBwYXRpZW50Rm9ybWF0dGVkKGRhdGEpIHsKICAgICAgdGhpcy5wYXRpZW50UmVnaXN0cmF0aW9uTGlzdCA9IGRhdGE7CiAgICAgIHRoaXMucGFnZSA9IGRhdGEubGVuZ3RoID8gZGF0YVswXS5fdG90YWxfcmVjb3JkcyA6IDEwMDsKICAgIH0sCiAgICAvLyBzZXJ2ZXIgc2lkZSBwYWdpbmF0aW9uCiAgICBvblBhZ2U6IGZ1bmN0aW9uIG9uUGFnZShldmVudCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBmaWx0ZXIgPSB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID8gdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA6ICIiOwogICAgICB2YXIgcGFnZSA9IGV2ZW50ID09IDAgPyAwIDogZXZlbnQucGFnZTsKICAgICAgdmFyIHJvd3MgPSBldmVudCA9PSAwID8gMTAgOiBldmVudC5yb3dzOwogICAgICB0aGlzLnBhdGllbnRSZWdpc3RyYXRpb25TZXJ2aWNlLmdldFBhdGllbnRXaXRoUGFnaW5hdGlvbihwYWdlLCByb3dzLCBmaWx0ZXIsIHRoaXMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXM1LnBhdGllbnRGb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgb3Blbk5ldzogZnVuY3Rpb24gb3Blbk5ldygpIHsKICAgICAgdGhpcy5pc0NvbnRhY3RFeGlzdCA9ICIiOwogICAgICB0aGlzLmlzVmFsaWQgPSAiIjsKICAgICAgdGhpcy5pc0VtYWlsVmFsaWQgPSAiIjsKICAgICAgdGhpcy5wYXRpZW50UmVnaXN0cmF0aW9uID0gewogICAgICAgIGFnZV95ZWFyOiAiMCIsCiAgICAgICAgYWdlX21vbnRoOiAiMCIsCiAgICAgICAgYWdlX2RheTogIjAiCiAgICAgIH07CiAgICAgIHRoaXMubmV3SW5mbyA9IHRydWU7CiAgICAgIHRoaXMuZGF0YUxpc3QgPSBmYWxzZTsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgIH0sCiAgICBoaWRlTmV3OiBmdW5jdGlvbiBoaWRlTmV3KCkgewogICAgICB0aGlzLmlzQ29udGFjdEV4aXN0ID0gIiI7CiAgICAgIHRoaXMuaXNWYWxpZCA9ICIiOwogICAgICB0aGlzLmlzRW1haWxWYWxpZCA9ICIiOwogICAgICB0aGlzLnBhdGllbnRSZWdpc3RyYXRpb24gPSB7CiAgICAgICAgYWdlX3llYXI6ICIwIiwKICAgICAgICBhZ2VfbW9udGg6ICIwIiwKICAgICAgICBhZ2VfZGF5OiAiMCIKICAgICAgfTsKICAgICAgdGhpcy5kYXRhTGlzdCA9IHRydWU7CiAgICAgIHRoaXMuaXNIaXN0b3J5ID0gZmFsc2U7CiAgICAgIHRoaXMubmV3SW5mbyA9IGZhbHNlOwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfSwKICAgIGlzRXhpc3RDb250YWN0OiBmdW5jdGlvbiBpc0V4aXN0Q29udGFjdCgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICBpZiAodGhpcy5wYXRpZW50UmVnaXN0cmF0aW9uLmNvbnRhY3Rfbm8ubWF0Y2goL14oMDEpKFswLTldezl9KSQvKSkgewogICAgICAgIHRoaXMucGF0aWVudFJlZ2lzdHJhdGlvblNlcnZpY2UuZ2V0QnlDb250YWN0T3JSZWdObyh0aGlzLnBhdGllbnRSZWdpc3RyYXRpb24uY29udGFjdF9ubywgdGhpcykudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgcmV0dXJuIF90aGlzNi5nZXRDb250YWN0KGRhdGEuZGF0YSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc0NvbnRhY3RFeGlzdCA9ICJDb250YWN0IG51bWJlciBtdXN0IHN0YXJ0IHdpdGggMDEgYW5kIHRoZSByZXF1aXJlZCBsZW5ndGggaXMgMTEiOwogICAgICB9CiAgICB9LAogICAgZ2V0Q29udGFjdDogZnVuY3Rpb24gZ2V0Q29udGFjdChkYXRhKSB7CiAgICAgIGlmIChkYXRhLmNvbnRhY3Rfbm8pIHsKICAgICAgICB0aGlzLmlzQ29udGFjdEV4aXN0ID0gIkR1cGxpY2F0ZSBwaG9uZSBudW1iZXIhIjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzQ29udGFjdEV4aXN0ID0gIiI7CiAgICAgIH0KICAgIH0sCiAgICBhZGQ6IGZ1bmN0aW9uIGFkZCgpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBjdXJyZW50RGF0ZSwgZG9iLCByZXN1bHQsIF9yZXN1bHQ7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzNy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNy5wYXRpZW50UmVnaXN0cmF0aW9uLmZpcnN0X25hbWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM3LnBhdGllbnRSZWdpc3RyYXRpb24uYWdlX3llYXIpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczcucGF0aWVudFJlZ2lzdHJhdGlvbi5hZ2VfbW9udGgpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczcucGF0aWVudFJlZ2lzdHJhdGlvbi5hZ2VfZGF5KSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM3LnBhdGllbnRSZWdpc3RyYXRpb24uY29udGFjdF9ubykgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczcuaXNDb250YWN0RXhpc3QpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgICAgIGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgICAgIGRvYiA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCkgLSBfdGhpczcucGF0aWVudFJlZ2lzdHJhdGlvbi5hZ2VfeWVhciwgY3VycmVudERhdGUuZ2V0TW9udGgoKSAtIF90aGlzNy5wYXRpZW50UmVnaXN0cmF0aW9uLmFnZV9tb250aCwgY3VycmVudERhdGUuZ2V0RGF0ZSgpIC0gX3RoaXM3LnBhdGllbnRSZWdpc3RyYXRpb24uYWdlX2RheSk7CiAgICAgICAgICAgICAgICBfdGhpczcucGF0aWVudFJlZ2lzdHJhdGlvbi5kb2IgPSBtb21lbnQoU3RyaW5nKGRvYikpLmZvcm1hdCgiWVlZWS1NTS1ERCIpOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczcucGF0aWVudFJlZ2lzdHJhdGlvbi5wYXRpZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNy5wYXRpZW50UmVnaXN0cmF0aW9uU2VydmljZS5hZGQoX3RoaXM3LnBhdGllbnRSZWdpc3RyYXRpb24sIF90aGlzNyk7CgogICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzNy5pc0RvY3RvcikgewogICAgICAgICAgICAgICAgICAgIF90aGlzNy5nZXRQYXRpZW50SWQocmVzdWx0LmRhdGEpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBfdGhpczcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNy5oaWRlTmV3KCk7CgogICAgICAgICAgICAgICAgICBfdGhpczcub25QYWdlKDApOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzY6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzg7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM3LnBhdGllbnRSZWdpc3RyYXRpb25TZXJ2aWNlLnB1dChfdGhpczcucGF0aWVudFJlZ2lzdHJhdGlvbiwgX3RoaXM3KTsKCiAgICAgICAgICAgICAgY2FzZSAzODoKICAgICAgICAgICAgICAgIF9yZXN1bHQgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChfcmVzdWx0LnN0YXR1cyA9PT0gMjAyKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJVcGRhdGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczcuaGlkZU5ldygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM3Lm9uUGFnZSgwKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3Jlc3VsdC5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDQwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ1OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNDI6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNDI7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICAgIF90aGlzNy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzEsIDQyXV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBnZXRQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldFBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdGhpcy5wYXRpZW50UmVnaXN0cmF0aW9uU2VydmljZS5nZXRCeUlkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXM4LnByZXNjcmlwdGlvbihkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICB0YWtlU2VydmljZTogZnVuY3Rpb24gdGFrZVNlcnZpY2UoZGF0YSkgewogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8ucGF0aWVudF9pZCA9IGRhdGEucGF0aWVudF9pZDsKICAgICAgdGhpcy5zZXJ2aWNlRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBzZXJ2aWNlRm9ybWF0dGVkOiBmdW5jdGlvbiBzZXJ2aWNlRm9ybWF0dGVkKGRhdGEpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICB2YXIgZmlsdGVyRGF0YSA9IGRhdGEuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBlbC5zZXJ2aWNlX2hlYWRfaWQgPT0gJzInIHx8IGVsLnNlcnZpY2VfaGVhZF9pZCA9PSAnMycgJiYgZWwuYWN0aXZlID09IHRydWU7CiAgICAgIH0sIHRoaXMpOwogICAgICB0aGlzLmVtZXJnZW5jeVNlcnZpY2VPYmoubHN0U2VydmljZSA9IFtdOwogICAgICBmaWx0ZXJEYXRhLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczkuZW1lcmdlbmN5U2VydmljZU9iai5sc3RTZXJ2aWNlLnB1c2goewogICAgICAgICAgc2VydmljZV9pZDogZWxlbWVudC5zZXJ2aWNlX2lkLAogICAgICAgICAgc2VydmljZV9uYW1lOiBlbGVtZW50LnNlcnZpY2VfbmFtZSwKICAgICAgICAgIHNlcnZpY2VfaGVhZF9pZDogZWxlbWVudC5zZXJ2aWNlX2hlYWRfaWQsCiAgICAgICAgICBfc2VydmljZV9oZWFkX25hbWU6IGVsZW1lbnQuX3NlcnZpY2VfaGVhZF9uYW1lLAogICAgICAgICAgc2VydmljZV90eXBlX2lkOiBlbGVtZW50LnNlcnZpY2VfdHlwZV9pZCwKICAgICAgICAgIF9zZXJ2aWNlX3R5cGVfbmFtZTogZWxlbWVudC5fc2VydmljZV90eXBlX25hbWUsCiAgICAgICAgICBzZXJ2aWNlX2NoYXJnZTogZWxlbWVudC5zZXJ2aWNlX2NoYXJnZSwKICAgICAgICAgIGVyX3NlcnZpY2VfY2hhcmdlOiBlbGVtZW50LmVyX3NlcnZpY2VfY2hhcmdlLAogICAgICAgICAgZGlzY291bnQ6IGVsZW1lbnQuZGlzY291bnQsCiAgICAgICAgICBpc0NoZWNrOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBhZGRTZXJ2aWNlOiBmdW5jdGlvbiBhZGRTZXJ2aWNlKCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczEwLmVtZXJnZW5jeVNlcnZpY2VPYmoubHN0U2VydmljZSA9IF90aGlzMTAuZW1lcmdlbmN5U2VydmljZU9iai5sc3RTZXJ2aWNlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlzQ2hlY2sgPT0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0sIF90aGlzMTApOwoKICAgICAgICAgICAgICAgIGlmICghKF90aGlzMTAuZW1lcmdlbmN5U2VydmljZU9iai5sc3RTZXJ2aWNlLmxlbmd0aCA+IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMxMC5lbWVyZ2VuY3lTZXJ2aWNlT2JqLnBhdGllbnRfaWQgPSBfdGhpczEwLmFkbWl0dGVkUGF0aWVudEluZm8ucGF0aWVudF9pZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczEwLmVtZXJnZW5jeVNlcnZpY2UuYWRkKF90aGlzMTAuZW1lcmdlbmN5U2VydmljZU9iaiwgX3RoaXMxMCk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMxMC5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczEwLmdldFNlcnZpY2UoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTAuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxMC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHRyYW5zZmVySVBEOiBmdW5jdGlvbiB0cmFuc2ZlcklQRChkYXRhKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0ucmVxdWlyZSh7CiAgICAgICAgbWVzc2FnZTogJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byB0cmFuc2ZlciBJUEQ/JywKICAgICAgICBoZWFkZXI6ICdDb25maXJtYXRpb24nLAogICAgICAgIGljb246ICdwaSBwaS1leGNsYW1hdGlvbi10cmlhbmdsZScsCiAgICAgICAgYWNjZXB0OiBmdW5jdGlvbiBhY2NlcHQoKSB7CiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndHJhbnNmZXJQYXRpZW50UmVnTm8nLCBkYXRhLnJlZ2lzdHJhdGlvbl9ubyk7CgogICAgICAgICAgX3RoaXMxMS4kcm91dGVyLnB1c2goIi9wYXRpZW50LWFkbWlzc2lvbi1mb3JtIik7CiAgICAgICAgfSwKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdCgpIHsKICAgICAgICAgIHJldHVybjsgLy90aGlzLm9uUGFnZSgwKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGVkaXQ6IGZ1bmN0aW9uIGVkaXQob2JqKSB7CiAgICAgIHRoaXMucGF0aWVudFJlZ2lzdHJhdGlvbiA9IE9iamVjdC5hc3NpZ24oe30sIG9iaik7IC8vIHRoaXMucGF0aWVudFJlZ2lzdHJhdGlvbi5jZGRvYiA9IG1vbWVudCgKICAgICAgLy8gICBTdHJpbmcodGhpcy5wYXRpZW50UmVnaXN0cmF0aW9uLmRvYikKICAgICAgLy8gKS5mb3JtYXQoIllZWVktTU0tREQiKTsKCiAgICAgIHRoaXMuZGF0YUxpc3QgPSBmYWxzZTsKICAgICAgdGhpcy5uZXdJbmZvID0gdHJ1ZTsKICAgIH0sCiAgICAvLyBwcmVzY3JpcHRpb24KICAgIHByZXNjcmlwdGlvbjogZnVuY3Rpb24gcHJlc2NyaXB0aW9uKGRhdGEpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLnBhdGllbnRfaWQgPSBkYXRhLnBhdGllbnRfaWQ7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwYXRpZW50SWRGb3JUcmVhdG1lbnQnLCBkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8ucmVnaXN0cmF0aW9uX25vID0gZGF0YS5yZWdpc3RyYXRpb25fbm87CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5wYXRpZW50X25hbWUgPSBkYXRhLmZpcnN0X25hbWU7CiAgICAgIHRoaXMuYWRtaXR0ZWRQYXRpZW50SW5mby5nZW5kZXIgPSBkYXRhLmdlbmRlcjsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV95ZWFyID0gZGF0YS5hZ2VfeWVhcjsKICAgICAgdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvLmFnZV9tb250aCA9IGRhdGEuYWdlX21vbnRoOwogICAgICB0aGlzLmFkbWl0dGVkUGF0aWVudEluZm8uYWdlX2RheSA9IGRhdGEuYWdlX2RheTsKICAgICAgdGhpcy5kYXRhTGlzdCA9IGZhbHNlOwogICAgICB0aGlzLmdldENvbXBsYWluc0J5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7IC8vIFVzZSBmb3IgRGlhbG9nIC8vCgogICAgICB0aGlzLmNvbXBsYWludFNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5jb21wbGlhbnRMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy5mb29kU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5mb29kTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMub25FeGFtaW5hdGlvblNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5vbkV4YW1pbmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGlhZ25vc2lzU2V0dXBTZXJ2aWNlLmdldEFsbCgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5kaWFnbm9zaXNMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy5jb21tb25TZXJ2aWNlLkdldEFsbEFsbGVyZ3lUeXBlKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczEyLmFsbGVyZ3lUeXBlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuY29tbW9uU2VydmljZS5HZXRBbGxEaWFiZXRlc01lYWwoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTIuZGlhYmV0ZXNNZWFsTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGlldENoYXJ0VGVtcGxhdGVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTIuZGlldENoYXJ0VGVtcGxhdGVMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsgLy8gVXNlIGZvciBEaWFsb2cgLy8KICAgICAgLy8gUHJldmlvdXMgUHJlc2NyaXB0aW9uIERhdGEKCiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZS5nZXRQcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi5wcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFGb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgfSk7IC8vIFByZXNjcmlwdGlvbiBUcmVhdG1lbnQKCiAgICAgIHRoaXMubWVkaWNpbmVTZXR1cFNlcnZpY2UuZ2V0QWN0aXZlQ29tYm8oKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTIubWVkaWNpbmVMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgdGhpcy50cmVhdG1lbnRSdWxlc1NldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi50cmVhdG1lbnRSdWxlc0xpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgICB0aGlzLnRyZWF0bWVudER1cmF0aW9uU2V0dXBTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczEyLnRyZWF0bWVudER1cmF0aW9uTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJlYXRtZW50RG9zZVNldHVwU2VydmljZS5nZXRBY3RpdmVDb21ibygpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi50cmVhdG1lbnREb3NlTGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgcHJldmlvdXNQcmVzY3JpcHRpb25EYXRhRm9ybWF0dGVkOiBmdW5jdGlvbiBwcmV2aW91c1ByZXNjcmlwdGlvbkRhdGFGb3JtYXR0ZWQoZGF0YSkgewogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uY2RwcmVzY3JpcHRpb25fZGF0ZSA9IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uY2Rmb2xvd3VwX2RhdGUgPSBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0RGF0ZShuZXcgRGF0ZSgpLmdldERhdGUoKSArIDcpKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50ID0gZGF0YS5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQ7CiAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UgPSBkYXRhLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZTsKICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb24gPSBkYXRhLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb247CiAgICB9LAogICAgZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBnZXRMYXRlc3RIaXN0b3J5QnlQYXRpZW50SWRGb3JQcmVzY3JpcHRpb24oKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIHZhciBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKHBhdGllbnRJZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczEzLnBhdGllbnRMYXRlc3RIaXN0b3J5ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBHZXQgUHJlc2NyaXB0aW9uIERhdGEKICAgIGdldEludmVzdGlnYXRpb246IGZ1bmN0aW9uIGdldEludmVzdGlnYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKCiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJJbnZlc3RpZ2F0aW9uIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcERhdGEgPSBbXTsKICAgICAgdGhpcy5wcmVzY3JpcHRpb25EYXRhTGlzdC5sc3RJbnZlc3RpZ2F0aW9uLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczE0LnRlbXBEYXRhLnB1c2goewogICAgICAgICAgbmFtZTogZWxlbWVudC5pbnZlc3RpbmdhdGlvbl9uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuaW52ZXN0aWdhdGlvbl9pZAogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRUcmVhdG1lbnQ6IGZ1bmN0aW9uIGdldFRyZWF0bWVudCgpIHsKICAgICAgdGhpcy50cmVhdG1lbnRBZGREaWFsb2cgPSB0cnVlOyAvLyB0aGlzLmhlYWRlck5hbWUgPSAiTWVkaWNpbmUiOwogICAgICAvLyB0aGlzLmZpbHRlcnNbJ2dsb2JhbCddLnZhbHVlID0gIiI7CiAgICAgIC8vIHRoaXMuaXNBZHZpY2UgPSBmYWxzZTsKICAgICAgLy8gdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICAvLyB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdFRyZWF0bWVudC5mb3JFYWNoKChlbGVtZW50KSA9PiB7CiAgICAgIC8vICAgdGhpcy50ZW1wRGF0YS5wdXNoKHsKICAgICAgLy8gICAgIF9tZWRpY2luZV90eXBlX25hbWU6IGVsZW1lbnQuX21lZGljaW5lX3R5cGVfbmFtZSwKICAgICAgLy8gICAgIF9tZWRpY2luZV9uYW1lOiBlbGVtZW50Ll9tZWRpY2luZV9uYW1lLAogICAgICAvLyAgICAgbmFtZTogZWxlbWVudC5fbWVkaWNpbmVfdHlwZV9uYW1lICsgIiAiICsgZWxlbWVudC5fbWVkaWNpbmVfbmFtZSArICIgIiArIGVsZW1lbnQuX3RyZWF0bWVudF9kb3NlX25hbWUgKyAiICIgKyBlbGVtZW50Ll90cmVhdG1lbnRfcnVsZV9uYW1lICsgIiAiICsgZWxlbWVudC5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgIC8vICAgICBpZDogZWxlbWVudC5tZWRpY2luZV9pZCwKICAgICAgLy8gICAgIF90cmVhdG1lbnRfZG9zZV9uYW1lOiBlbGVtZW50Ll90cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAvLyAgICAgdHJlYXRtZW50X2Rvc2VfaWQ6IGVsZW1lbnQudHJlYXRtZW50X2Rvc2VfaWQsCiAgICAgIC8vICAgICBfdHJlYXRtZW50X3J1bGVfbmFtZTogZWxlbWVudC5fdHJlYXRtZW50X3J1bGVfbmFtZSwKICAgICAgLy8gICAgIHRyZWF0bWVudF9ydWxlc19pZDogZWxlbWVudC50cmVhdG1lbnRfcnVsZXNfaWQsCiAgICAgIC8vICAgICBfdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IGVsZW1lbnQuX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lLAogICAgICAvLyAgICAgdHJlYXRtZW50X2R1cmF0aW9uX2lkOiBlbGVtZW50LnRyZWF0bWVudF9kdXJhdGlvbl9pZCwKICAgICAgLy8gICAgIGRlc2NyaXB0aW9uOiBlbGVtZW50LmRlc2NyaXB0aW9uLAogICAgICAvLyAgIH0pOwogICAgICAvLyB9KTsKICAgIH0sCiAgICBzYXZlVHJlYXRtZW50OiBmdW5jdGlvbiBzYXZlVHJlYXRtZW50KCkgewogICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsbWVkaWNpbmVfdHlwZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBhTWVkaWNpbmUgPSB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50LmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5tZWRpY2luZV9pZCA9PT0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS52YWx1ZTsKICAgICAgICB9LCB0aGlzKTsKCiAgICAgICAgaWYgKCFhTWVkaWNpbmUubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50LnB1c2goewogICAgICAgICAgICBfbWVkaWNpbmVfdHlwZV9uYW1lOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lX3R5cGUudGV4dCwKICAgICAgICAgICAgbmFtZTogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS50ZXh0LAogICAgICAgICAgICBtZWRpY2luZV9pZDogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS52YWx1ZSwKICAgICAgICAgICAgX3RyZWF0bWVudF9kb3NlX25hbWU6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudGV4dCwKICAgICAgICAgICAgdHJlYXRtZW50X2Rvc2VfaWQ6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudmFsdWUsCiAgICAgICAgICAgIF90cmVhdG1lbnRfcnVsZV9uYW1lOiB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcy50ZXh0LAogICAgICAgICAgICB0cmVhdG1lbnRfcnVsZXNfaWQ6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnZhbHVlLAogICAgICAgICAgICBfdHJlYXRtZW50X2R1cmF0aW9uX25hbWU6IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnRleHQsCiAgICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udmFsdWUsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAiIgogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmhpZGVEaWFsb2coKTsKICAgICAgfQogICAgfSwKICAgIGdldEFkdmljZTogZnVuY3Rpb24gZ2V0QWR2aWNlKCkgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CgogICAgICB0aGlzLmhlYWRlck5hbWUgPSAiQWR2aWNlIjsKICAgICAgdGhpcy5maWx0ZXJzWydnbG9iYWwnXS52YWx1ZSA9ICIiOwogICAgICB0aGlzLmlzQWR2aWNlID0gdHJ1ZTsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLnByZXNjcmlwdGlvbkRhdGFMaXN0LmxzdEFkdmljZXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzMTUudGVtcERhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBlbGVtZW50LmFkdmljZV9uYW1lLAogICAgICAgICAgaWQ6IGVsZW1lbnQuYWR2aWNlX2lkCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIEFkZCBhbGwgYWR2aWNlIGNoZWNrYm94CiAgICBhZGRBbGxBZHZpY2U6IGZ1bmN0aW9uIGFkZEFsbEFkdmljZSgpIHsKICAgICAgdmFyIF90aGlzMTYgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uYWxsQWR2aWNlKSB7CiAgICAgICAgdGhpcy50ZW1wRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICB2YXIgYUFkdmljZSA9IF90aGlzMTYuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgICByZXR1cm4gZWwuYWR2aWNlX2lkID09PSBlbGVtZW50LmlkOwogICAgICAgICAgfSwgX3RoaXMxNik7CgogICAgICAgICAgaWYgKCFhQWR2aWNlLmxlbmd0aCkgewogICAgICAgICAgICBfdGhpczE2LmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGVsZW1lbnQubmFtZSwKICAgICAgICAgICAgICBhZHZpY2VfaWQ6IGVsZW1lbnQuaWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBBZGQgdmFsdWUgCiAgICBnZXRWYWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWUoZGF0YSkgewogICAgICBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJJbnZlc3RpZ2F0aW9uIikgewogICAgICAgIHZhciBhSW52ZXN0aWdhdGlvbiA9IHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5pbnZlc3RpZ2F0aW9uX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFJbnZlc3RpZ2F0aW9uLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkludmVzdGlnYXRpb24ucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgaW52ZXN0aWdhdGlvbl9pZDogZGF0YS5pZAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaGVhZGVyTmFtZSA9PSAiTWVkaWNpbmUiKSB7CiAgICAgICAgdmFyIGFNZWRpY2luZSA9IHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLm1lZGljaW5lX2lkID09PSBkYXRhLmlkOwogICAgICAgIH0sIHRoaXMpOwoKICAgICAgICBpZiAoIWFNZWRpY2luZS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQucHVzaCh7CiAgICAgICAgICAgIF9tZWRpY2luZV90eXBlX25hbWU6IGRhdGEuX21lZGljaW5lX3R5cGVfbmFtZSwKICAgICAgICAgICAgbmFtZTogZGF0YS5fbWVkaWNpbmVfbmFtZSwKICAgICAgICAgICAgbWVkaWNpbmVfaWQ6IGRhdGEuaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZG9zZV9uYW1lOiBkYXRhLl90cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAgICAgICB0cmVhdG1lbnRfZG9zZV9pZDogZGF0YS50cmVhdG1lbnRfZG9zZV9pZCwKICAgICAgICAgICAgX3RyZWF0bWVudF9ydWxlX25hbWU6IGRhdGEuX3RyZWF0bWVudF9ydWxlX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9ydWxlc19pZDogZGF0YS50cmVhdG1lbnRfcnVsZXNfaWQsCiAgICAgICAgICAgIF90cmVhdG1lbnRfZHVyYXRpb25fbmFtZTogZGF0YS5fdHJlYXRtZW50X2R1cmF0aW9uX25hbWUsCiAgICAgICAgICAgIHRyZWF0bWVudF9kdXJhdGlvbl9pZDogZGF0YS50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJOYW1lID09ICJBZHZpY2UiKSB7CiAgICAgICAgdmFyIGFBZHZpY2UgPSB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uQWR2aWNlLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgIHJldHVybiBlbC5hZHZpY2VfaWQgPT09IGRhdGEuaWQ7CiAgICAgICAgfSwgdGhpcyk7CgogICAgICAgIGlmICghYUFkdmljZS5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25BZHZpY2UucHVzaCh7CiAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSwKICAgICAgICAgICAgYWR2aWNlX2lkOiBkYXRhLmlkCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBoaWRlRGlhbG9nOiBmdW5jdGlvbiBoaWRlRGlhbG9nKCkgewogICAgICB0aGlzLnNlcnZpY2VEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy50cmVhdG1lbnRBZGREaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy50cmVhdG1lbnREaWFsb2cgPSBmYWxzZTsKICAgICAgdmFyIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKS50b1N0cmluZygpOwogICAgICB0aGlzLmNoaWVmQ29tcGxhaW5EaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5jaGllZkNvbXBsYWluID0gewogICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICB9OwogICAgICB0aGlzLmZvb2REaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5mb29kU2V0dXAgPSB7fTsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlsc0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmFsbGVyZ3lEZXRhaWxzID0gewogICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICB9OwogICAgICB0aGlzLm9uRXhhbWluYXRpb25EaWFsb2cgPSBmYWxzZTsgLy8gdGhpcy5vbkV4YW1pbmF0aW9uID0gewogICAgICAvLyAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICAvLyB9OwoKICAgICAgdGhpcy5pT0NoYXJ0RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuaU9DaGFydCA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5kaWFiZXRlc0NoYXJ0RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMuZGlhYmV0ZXNDaGFydCA9IHsKICAgICAgICBhQWRtaXNzaW9uU2VydmljZURldGFpbHM6IHt9LAogICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICB9OwogICAgICB0aGlzLmRpZXRDaGFydERpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmRpZXRDaGFydCA9IHsKICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50SWQKICAgICAgfTsKICAgICAgdGhpcy5jdXJyZW50TWVkaWNhdGlvbnNEaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5jdXJyZW50TWVkaWNhdGlvbnMgPSB7CiAgICAgICAgcGF0aWVudF9pZDogcGF0aWVudElkCiAgICAgIH07CiAgICAgIHRoaXMucGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMucGFzdE1lZGljYWxIaXN0b3J5ID0gewogICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZAogICAgICB9OwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgfSwKICAgIGZpbHRlck1lZGljaW5lVHlwZVdpc2U6IGZ1bmN0aW9uIGZpbHRlck1lZGljaW5lVHlwZVdpc2UoKSB7CiAgICAgIGlmICh0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lX3R5cGUpIHsKICAgICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lX3R5cGUudGV4dDsKICAgICAgICByZXR1cm4gdGhpcy5tZWRpY2luZUxpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLnJlZmlkID09PSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lX3R5cGUudmFsdWU7CiAgICAgICAgfSwgdGhpcyk7CiAgICAgIH0KICAgIH0sCiAgICBlZGl0VHJlYXRtZW50OiBmdW5jdGlvbiBlZGl0VHJlYXRtZW50KGRhdGEsIGluZGV4KSB7CiAgICAgIHRoaXMudHJlYXRtZW50U2V0dXAubWVkaWNpbmVOYW1lID0gZGF0YS5uYW1lOwogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcyA9IHsKICAgICAgICB0ZXh0OiBkYXRhLl90cmVhdG1lbnRfcnVsZV9uYW1lLAogICAgICAgIHZhbHVlOiBkYXRhLnRyZWF0bWVudF9ydWxlc19pZCwKICAgICAgICByZWZpZDogbnVsbAogICAgICB9OwogICAgICB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kdXJhdGlvbiA9IHsKICAgICAgICB0ZXh0OiBkYXRhLl90cmVhdG1lbnRfZHVyYXRpb25fbmFtZSwKICAgICAgICB2YWx1ZTogZGF0YS50cmVhdG1lbnRfZHVyYXRpb25faWQsCiAgICAgICAgcmVmaWQ6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZG9zZSA9IHsKICAgICAgICB0ZXh0OiBkYXRhLl90cmVhdG1lbnRfZG9zZV9uYW1lLAogICAgICAgIHZhbHVlOiBkYXRhLnRyZWF0bWVudF9kb3NlX2lkLAogICAgICAgIHJlZmlkOiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMudHJlYXRtZW50RGlhbG9nID0gdHJ1ZTsKICAgICAgdGhpcy50cmVhdG1lbnRJbmRleCA9IGluZGV4OwogICAgfSwKICAgIHRyZWF0bWVudEVkaXRTYXZlOiBmdW5jdGlvbiB0cmVhdG1lbnRFZGl0U2F2ZSgpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgaWYgKCF0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9ydWxlcykgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICghdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy90aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLm5hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbG1lZGljaW5lLnRleHQ7CiAgICAgICAgLy90aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLm1lZGljaW5lX2lkID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGxtZWRpY2luZS52YWx1ZTsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLl90cmVhdG1lbnRfcnVsZV9uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfcnVsZXMudGV4dDsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLnRyZWF0bWVudF9ydWxlc19pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X3J1bGVzLnZhbHVlOwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0uX3RyZWF0bWVudF9kdXJhdGlvbl9uYW1lID0gdGhpcy50cmVhdG1lbnRTZXR1cC5kZGx0cmVhdG1lbnRfZHVyYXRpb24udGV4dDsKICAgICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ubHN0QWRtaXNzaW9uUHJlc2NyaXB0aW9uVHJlYXRtZW50W3RoaXMudHJlYXRtZW50SW5kZXhdLnRyZWF0bWVudF9kdXJhdGlvbl9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2R1cmF0aW9uLnZhbHVlOwogICAgICAgIHRoaXMuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5sc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnRbdGhpcy50cmVhdG1lbnRJbmRleF0uX3RyZWF0bWVudF9kb3NlX25hbWUgPSB0aGlzLnRyZWF0bWVudFNldHVwLmRkbHRyZWF0bWVudF9kb3NlLnRleHQ7CiAgICAgICAgdGhpcy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvblRyZWF0bWVudFt0aGlzLnRyZWF0bWVudEluZGV4XS50cmVhdG1lbnRfZG9zZV9pZCA9IHRoaXMudHJlYXRtZW50U2V0dXAuZGRsdHJlYXRtZW50X2Rvc2UudmFsdWU7CiAgICAgICAgdGhpcy50cmVhdG1lbnREaWFsb2cgPSBmYWxzZTsKICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlSXRlbTogZnVuY3Rpb24gZGVsZXRlSXRlbShsc3QsIGRhdGEpIHsKICAgICAgbHN0LnNwbGljZShsc3QuZmluZEluZGV4KGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuIGkgPT09IGRhdGE7CiAgICAgIH0pLCAxKTsKICAgIH0sCiAgICBhZGRSeDogZnVuY3Rpb24gYWRkUngoKSB7CiAgICAgIHZhciBfdGhpczE3ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMDsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMxNy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvLmxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczE3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiUGxlYXNlIGFkZCBQYXRpZW50IEFkdmljZSIsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIF90aGlzMTcuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5wYXRpZW50X2lkID0gX3RoaXMxNy5hZG1pdHRlZFBhdGllbnRJbmZvLnBhdGllbnRfaWQ7CiAgICAgICAgICAgICAgICBfdGhpczE3LmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8ucHJlc2NyaXB0aW9uX2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzMTcuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5jZHByZXNjcmlwdGlvbl9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMTcuYWRtaXNzaW9uUHJlc2NyaXB0aW9uSW5mby5jZGZvbG93dXBfZGF0ZSkgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uZm9sb3d1cF9kYXRlID0gbW9tZW50KFN0cmluZyhfdGhpczE3LmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8uY2Rmb2xvd3VwX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTcuYWRtaXNzaW9uUHJlc2NyaXB0aW9uU2VydmljZS5hZGQoX3RoaXMxNy5hZG1pc3Npb25QcmVzY3JpcHRpb25JbmZvKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMxNy5kb3dubG9hZFByZXNjcmlwdGlvbihyZXN1bHQuZGF0YSk7CgogICAgICAgICAgICAgICAgICBfdGhpczE3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlByZXNjcmliZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMTcubmV3UHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczE3LmhpZGVOZXcoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxODsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxNTsKICAgICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IF9jb250ZXh0M1siY2F0Y2giXSgwKTsKCiAgICAgICAgICAgICAgICBfdGhpczE3LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogX2NvbnRleHQzLnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIG51bGwsIFtbMCwgMTVdXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGRvd25sb2FkUHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBkb3dubG9hZFByZXNjcmlwdGlvbihhZG1pc3Npb25fcHJlc2NyaXB0aW9uX2lkKSB7CiAgICAgIHZhciBfdGhpczE4ID0gdGhpczsKCiAgICAgIHRoaXMucHJlc2NyaXB0aW9uUmVwb3J0U2VydmljZS5HZXRFbWVyZ2VuY3lQZXNjcmlwdGlvbihhZG1pc3Npb25fcHJlc2NyaXB0aW9uX2lkLCB0aGlzKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTguY29tbW9uU2VydmljZS5Eb3dubG9hZGZpbGUoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgbmV3UHJlc2NyaXB0aW9uOiBmdW5jdGlvbiBuZXdQcmVzY3JpcHRpb24oKSB7CiAgICAgIHRoaXMuaGVhZGVyTmFtZSA9ICJTZWN0aW9ucyI7CiAgICAgIHRoaXMuZmlsdGVyc1snZ2xvYmFsJ10udmFsdWUgPSAiIjsKICAgICAgdGhpcy50ZW1wRGF0YSA9IFtdOwogICAgICB0aGlzLmFkbWlzc2lvblByZXNjcmlwdGlvbkluZm8gPSB7CiAgICAgICAgY2RwcmVzY3JpcHRpb25fZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgY2Rmb2xvd3VwX2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUobmV3IERhdGUoKS5zZXREYXRlKG5ldyBEYXRlKCkuZ2V0RGF0ZSgpICsgNykpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgYWxsQWR2aWNlOiBmYWxzZSwKICAgICAgICBsc3RBZG1pc3Npb25QcmVzY3JpcHRpb25JbnZlc3RpZ2F0aW9uOiBbXSwKICAgICAgICBsc3RBZG1pc3Npb25QcmVzY3JpcHRpb25UcmVhdG1lbnQ6IFtdLAogICAgICAgIGxzdEFkbWlzc2lvblByZXNjcmlwdGlvbkFkdmljZTogW10KICAgICAgfSwgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTsKICAgIH0sCiAgICBmb3JtYXREYXRlOiBmdW5jdGlvbiBmb3JtYXREYXRlKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CiAgICB9LAogICAgZm9ybWF0RGF0ZVRpbWU6IGZ1bmN0aW9uIGZvcm1hdERhdGVUaW1lKHZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoU3RyaW5nKHZhbHVlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIGg6bW06c3MgYSIpOwogICAgfSwKICAgIC8vIEhpc3RvcnkKICAgIGhpc3Rvcnk6IGZ1bmN0aW9uIGhpc3RvcnkoKSB7CiAgICAgIHZhciBfdGhpczE5ID0gdGhpczsKCiAgICAgIHZhciBkYXRhID0gdGhpcy5hZG1pdHRlZFBhdGllbnRJbmZvOwoKICAgICAgaWYgKGRhdGEuZ2VuZGVyID09ICJGZW1hbGUiKSB7CiAgICAgICAgdGhpcy5pc0ZlbWFsZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc0ZlbWFsZSA9IGZhbHNlOwogICAgICB9CgogICAgICB2YXIgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgaWYgKHBhdGllbnRJZCkgewogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwYXRpZW50SWRGb3JUcmVhdG1lbnQnKTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncGF0aWVudElkRm9yVHJlYXRtZW50JywgZGF0YS5wYXRpZW50X2lkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncGF0aWVudElkRm9yVHJlYXRtZW50JywgZGF0YS5wYXRpZW50X2lkKTsKICAgICAgfSAvLyBDb2xsZWN0IGhpc3RvcnkgcGF0aWVudCB3aXNlIC8vCgoKICAgICAgdGhpcy5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldEFsbGVyZ3lEZXRhaWxzQnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXRPbkV4YW1pbmF0aW9uQnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXRJT0NoYXJ0QnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXREaWFiZXRlc0NoYXJ0QnlQYXRpZW50SWQoZGF0YS5wYXRpZW50X2lkKTsKICAgICAgdGhpcy5nZXREaWV0Q2hhcnRCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLmdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgIHRoaXMuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXRTeXN0ZW1TdWJzdGFuY2UoZGF0YS5wYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMTkuZm9ybWF0dGVkU3lzdGVtU3Vic3RhbmNlKGRhdGEuZGF0YSk7CiAgICAgIH0pOwogICAgICB0aGlzLmlzSGlzdG9yeSA9IHRydWU7CiAgICAgIHRoaXMuZGF0YUxpc3QgPSBmYWxzZTsgLy8gQ29sbGVjdCBoaXN0b3J5IHBhdGllbnQgd2lzZSAvLwogICAgfSwKICAgIGdldENvbXBsYWluc0J5UGF0aWVudElkOiBmdW5jdGlvbiBnZXRDb21wbGFpbnNCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczIwID0gdGhpczsKCiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbi5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0Q29tcGxhaW5zQnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczIwLmNoaWVmQ29tcGxhaW5MaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRBbGxlcmd5RGV0YWlsc0J5UGF0aWVudElkOiBmdW5jdGlvbiBnZXRBbGxlcmd5RGV0YWlsc0J5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMjEgPSB0aGlzOwoKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0QWxsZXJneURldGFpbHNCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjEuYWxsZXJneURldGFpbHNMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwOiBmdW5jdGlvbiBnZXRPbkV4YW1pbmF0aW9uc1BvcHVwKCkgewogICAgICB2YXIgX3RoaXMyMiA9IHRoaXM7CgogICAgICB2YXIgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwogICAgICB0aGlzLnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhID0gW107CiAgICAgIHRoaXMub25FeGFtaW5hdGlvbkxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIF90aGlzMjIucG9wdXBPbkV4YW1pbmF0aW9uc0RhdGEucHVzaCh7CiAgICAgICAgICBfb25fZXhhbWluYXRpb25fbmFtZTogZWxlbWVudC50ZXh0LAogICAgICAgICAgb25fZXhhbWluYXRpb25faWQ6IGVsZW1lbnQudmFsdWUsCiAgICAgICAgICBvbl9leGFtaW5hdGlvbl9yZXN1bHQ6IFN0cmluZygxKSwKICAgICAgICAgIHBhdGllbnRfaWQ6IHBhdGllbnRJZC50b1N0cmluZygpCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25Qb3B1cERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZ2V0T25FeGFtaW5hdGlvbkJ5UGF0aWVudElkOiBmdW5jdGlvbiBnZXRPbkV4YW1pbmF0aW9uQnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMyMyA9IHRoaXM7CgogICAgICB0aGlzLm9uRXhhbWluYXRpb24ucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldE9uRXhhbWluYXRpb25CeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjMucGF0aWVudE9uRXhhbWluYXRpb25MaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRJT0NoYXJ0QnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldElPQ2hhcnRCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczI0ID0gdGhpczsKCiAgICAgIHRoaXMuaU9DaGFydC5wYXRpZW50X2lkID0gcGF0aWVudF9pZDsKICAgICAgdGhpcy5wYXRpZW50UHJvZmlsZVNlcnZpY2UuZ2V0SU9DaGFydEJ5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNC5pT0NoYXJ0TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0RGlhYmV0ZXNDaGFydEJ5UGF0aWVudElkOiBmdW5jdGlvbiBnZXREaWFiZXRlc0NoYXJ0QnlQYXRpZW50SWQocGF0aWVudF9pZCkgewogICAgICB2YXIgX3RoaXMyNSA9IHRoaXM7CgogICAgICB0aGlzLmRpYWJldGVzQ2hhcnQucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldERpYWJldGVzQ2hhcnRCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjUuZGlhYmV0ZXNDaGFydExpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGdldERpZXRDaGFydEJ5UGF0aWVudElkOiBmdW5jdGlvbiBnZXREaWV0Q2hhcnRCeVBhdGllbnRJZChwYXRpZW50X2lkKSB7CiAgICAgIHZhciBfdGhpczI2ID0gdGhpczsKCiAgICAgIHRoaXMuZGlldENoYXJ0LnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRQcm9maWxlU2VydmljZS5nZXREaWV0Q2hhcnRCeVBhdGllbnRJZChwYXRpZW50X2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMjYuZGlldENoYXJ0TGlzdCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0Q3VycmVudE1lZGljYXRpb25zQnlQYXRpZW50SWQ6IGZ1bmN0aW9uIGdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMjcgPSB0aGlzOwoKICAgICAgdGhpcy5jdXJyZW50TWVkaWNhdGlvbnMucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKHBhdGllbnRfaWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyNy5jdXJyZW50TWVkaWNhdGlvbnNMaXN0ID0gZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkOiBmdW5jdGlvbiBnZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkKHBhdGllbnRfaWQpIHsKICAgICAgdmFyIF90aGlzMjggPSB0aGlzOwoKICAgICAgdGhpcy5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9pZCA9IHBhdGllbnRfaWQ7CiAgICAgIHRoaXMucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmdldFBhc3RIaXN0b3J5QnlQYXRpZW50SWQocGF0aWVudF9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczI4LnBhc3RNZWRpY2FsSGlzdG9yeUxpc3QgPSBkYXRhLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGZvcm1hdHRlZFN5c3RlbVN1YnN0YW5jZTogZnVuY3Rpb24gZm9ybWF0dGVkU3lzdGVtU3Vic3RhbmNlKGRhdGEpIHsKICAgICAgLy90aGlzLnBhdGllbnRIaXN0b3J5LnBhdGllbnRfaWQgPSBwYXRpZW50X2lkOwogICAgICB0aGlzLnBhdGllbnRIaXN0b3J5LmxzdFBlcnNvbmFsSGlzdG9yeSA9IGRhdGEubHN0UGVyc29uYWxIaXN0b3J5OwogICAgICB0aGlzLnBhdGllbnRIaXN0b3J5LmxzdEZhbWlseUhpc3RvcnkgPSBkYXRhLmxzdEZhbWlseUhpc3Rvcnk7CiAgICAgIHRoaXMucGF0aWVudEhpc3RvcnkubHN0U3lzdGVtc1JldmlldyA9IGRhdGEubHN0U3lzdGVtc1JldmlldzsKICAgICAgdGhpcy5wYXRpZW50SGlzdG9yeS5sc3RTdWJzdGFuY2VVc2UgPSBkYXRhLmxzdFN1YnN0YW5jZVVzZTsKICAgICAgdGhpcy5wYXRpZW50SGlzdG9yeS5sc3RSZXByb2R1Y3RpdmVIaXN0b3J5ID0gZGF0YS5sc3RSZXByb2R1Y3RpdmVIaXN0b3J5OwogICAgfSwKICAgIGhpZGVIaXN0b3J5OiBmdW5jdGlvbiBoaWRlSGlzdG9yeSgpIHsKICAgICAgdGhpcy5pc0hpc3RvcnkgPSBmYWxzZTsKICAgICAgdGhpcy5kYXRhTGlzdCA9IGZhbHNlOyAvL2xvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdwYXRpZW50SWRGb3JUcmVhdG1lbnQnKTsKICAgIH0sCiAgICBuZXdDaGllZkNvbXBsYWluOiBmdW5jdGlvbiBuZXdDaGllZkNvbXBsYWluKCkgewogICAgICB0aGlzLmNoaWVmQ29tcGxhaW5EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZENoaWVmQ29tcGxhaW46IGZ1bmN0aW9uIGFkZENoaWVmQ29tcGxhaW4oKSB7CiAgICAgIHZhciBfdGhpczI5ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciBwYXRpZW50SWQsIHJlc3VsdCwgX3Jlc3VsdDI7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIF90aGlzMjkuY2hpZWZDb21wbGFpbi5wYXRpZW50X2lkID0gcGF0aWVudElkOwogICAgICAgICAgICAgICAgX3RoaXMyOS5zdWJtaXR0ZWQgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmIChfdGhpczI5LmNoaWVmQ29tcGxhaW4uY29tcGlsYW50c19pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMjkuY2hpZWZDb21wbGFpbi5wYXRpZW50X2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIGlmIChfdGhpczI5LmNoaWVmQ29tcGxhaW4uY2Rmcm9tX2RhdGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczI5LnZhbGlkYXRpb24uaXNJZEV4aXN0cyhfdGhpczI5LmNoaWVmQ29tcGxhaW5MaXN0LCAnY29tcGlsYW50c19pZCcsIF90aGlzMjkuY2hpZWZDb21wbGFpbi5jb21waWxhbnRzX2lkLCAncGF0aWVudF9jb21wbGFpbl9pZCcsIF90aGlzMjkuY2hpZWZDb21wbGFpbi5wYXRpZW50X2NvbXBsYWluX2lkLCBfdGhpczI5KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBfdGhpczI5LmNoaWVmQ29tcGxhaW4uZnJvbV9kYXRlID0gbW9tZW50KFN0cmluZyhfdGhpczI5LmNoaWVmQ29tcGxhaW4uY2Rmcm9tX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyOS5jaGllZkNvbXBsYWluLnBhdGllbnRfY29tcGxhaW5faWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczI5LnBhdGllbnRQcm9maWxlU2VydmljZS5jb21wbGFpblNhdmUoX3RoaXMyOS5jaGllZkNvbXBsYWluKTsKCiAgICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0NC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyOS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyOS5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChfdGhpczI5LmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczI5LmhpZGVEaWFsb2coKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMjkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyOS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzMTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyOTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczI5LnBhdGllbnRQcm9maWxlU2VydmljZS5jb21wbGFpblVwZGF0ZShfdGhpczI5LmNoaWVmQ29tcGxhaW4pOwoKICAgICAgICAgICAgICBjYXNlIDI5OgogICAgICAgICAgICAgICAgX3Jlc3VsdDIgPSBfY29udGV4dDQuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoX3Jlc3VsdDIuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyOS5nZXRDb21wbGFpbnNCeVBhdGllbnRJZChfdGhpczI5LmNoaWVmQ29tcGxhaW4ucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczI5LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMjkuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiVXBkYXRlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfcmVzdWx0Mi5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczI5LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBfcmVzdWx0Mi5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMyOS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQyLnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGVkaXRDaGllZkNvbXBsYWluOiBmdW5jdGlvbiBlZGl0Q2hpZWZDb21wbGFpbihkYXRhKSB7CiAgICAgIHRoaXMuY2hpZWZDb21wbGFpbiA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpOwogICAgICB0aGlzLmNoaWVmQ29tcGxhaW4uY2Rmcm9tX2RhdGUgPSBtb21lbnQoU3RyaW5nKHRoaXMuY2hpZWZDb21wbGFpbi5mcm9tX2RhdGUpKS5mb3JtYXQoIk1NL0REL1lZWVkiKTsKICAgICAgdGhpcy5jaGllZkNvbXBsYWluRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBnZXRGb29kOiBmdW5jdGlvbiBnZXRGb29kKCkgewogICAgICB2YXIgX3RoaXMzMCA9IHRoaXM7CgogICAgICB0aGlzLmZvb2RTZXJ2aWNlLmdldEFjdGl2ZUNvbWJvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMwLmZvb2RGb3JtYXR0ZWQoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgZm9vZEZvcm1hdHRlZDogZnVuY3Rpb24gZm9vZEZvcm1hdHRlZChkYXRhKSB7CiAgICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7CiAgICAgIHRoaXMuZm9vZFNldHVwID0ge307CiAgICAgIHRoaXMuZm9vZExpc3QgPSBkYXRhOwogICAgICB0aGlzLmZvb2REaWFsb2cgPSBmYWxzZTsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlsc0RpYWxvZyA9IHRydWU7CiAgICB9LAogICAgbmV3Rm9vZDogZnVuY3Rpb24gbmV3Rm9vZCgpIHsKICAgICAgdGhpcy5hbGxlcmd5RGV0YWlsc0RpYWxvZyA9IGZhbHNlOwogICAgICB0aGlzLmZvb2REaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZEZvb2Q6IGZ1bmN0aW9uIGFkZEZvb2QoKSB7CiAgICAgIHZhciBfdGhpczMxID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMzEuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzMS5mb29kU2V0dXAuZm9vZF9uYW1lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMzEudmFsaWRhdGlvbi5pc05hbWVFeGlzdHMoX3RoaXMzMS5mb29kTGlzdCwgJ3RleHQnLCBfdGhpczMxLmZvb2RTZXR1cC5mb29kX25hbWUsICd2YWx1ZScsIF90aGlzMzEuZm9vZFNldHVwLmZvb2RfaWQsIF90aGlzMzEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfdGhpczMxLmZvb2RTZXR1cC5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMxLmZvb2RTZXJ2aWNlLmFkZChfdGhpczMxLmZvb2RTZXR1cCk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDUuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzEuZ2V0Rm9vZCgpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdBbGxlcmd5RGV0YWlsczogZnVuY3Rpb24gbmV3QWxsZXJneURldGFpbHMoKSB7CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHNEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZEFsbGVyZ3lEZXRhaWxzOiBmdW5jdGlvbiBhZGRBbGxlcmd5RGV0YWlscygpIHsKICAgICAgdmFyIF90aGlzMzIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIHJlc3VsdCwgX3Jlc3VsdDM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczMyLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzIuYWxsZXJneURldGFpbHMuZm9vZF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzIuYWxsZXJneURldGFpbHMucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzIuYWxsZXJneURldGFpbHMudHlwZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzMi5hbGxlcmd5RGV0YWlscy5jZGZyb21fZGF0ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMzIudmFsaWRhdGlvbi5pc0lkRXhpc3RzKF90aGlzMzIuYWxsZXJneURldGFpbHNMaXN0LCAnZm9vZF9pZCcsIF90aGlzMzIuYWxsZXJneURldGFpbHMuZm9vZF9pZCwgJ3BhdGllbnRfYWxsZXJneV9kZXRhaWxzX2lkJywgX3RoaXMzMi5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2FsbGVyZ3lfZGV0YWlsc19pZCwgX3RoaXMzMikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgX3RoaXMzMi5hbGxlcmd5RGV0YWlscy5mcm9tX2RhdGUgPSBtb21lbnQoU3RyaW5nKF90aGlzMzIuYWxsZXJneURldGFpbHMuY2Rmcm9tX2RhdGUpKS5mb3JtYXQoIllZWVktTU0tREQiKTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzMi5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2FsbGVyZ3lfZGV0YWlsc19pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMzIucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmFsbGVyZ3lEZXRhaWxzU2F2ZShfdGhpczMyLmFsbGVyZ3lEZXRhaWxzKTsKCiAgICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ni5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzMi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMi5nZXRBbGxlcmd5RGV0YWlsc0J5UGF0aWVudElkKF90aGlzMzIuYWxsZXJneURldGFpbHMucGF0aWVudF9pZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczMyLmdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbigpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMi5oaWRlRGlhbG9nKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczMyLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzIuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzM7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzE7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzMi5wYXRpZW50UHJvZmlsZVNlcnZpY2UuYWxsZXJneURldGFpbHNVcGRhdGUoX3RoaXMzMi5hbGxlcmd5RGV0YWlscyk7CgogICAgICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgICAgICBfcmVzdWx0MyA9IF9jb250ZXh0Ni5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChfcmVzdWx0My5zdGF0dXMgPT09IDIwMikgewogICAgICAgICAgICAgICAgICBfdGhpczMyLmdldEFsbGVyZ3lEZXRhaWxzQnlQYXRpZW50SWQoX3RoaXMzMi5hbGxlcmd5RGV0YWlscy5wYXRpZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzIuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJVcGRhdGVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9yZXN1bHQzLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzIuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IF9yZXN1bHQzLmRhdGEsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczMyLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogX3Jlc3VsdDMucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZWRpdEFsbGVyZ3lEZXRhaWxzOiBmdW5jdGlvbiBlZGl0QWxsZXJneURldGFpbHMoZGF0YSkgewogICAgICB0aGlzLmFsbGVyZ3lEZXRhaWxzID0gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHMuY2Rmcm9tX2RhdGUgPSBtb21lbnQoU3RyaW5nKHRoaXMuYWxsZXJneURldGFpbHMuZnJvbV9kYXRlKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIik7CiAgICAgIHRoaXMuYWxsZXJneURldGFpbHNEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIG5ld09uRXhhbWluYXRpb246IGZ1bmN0aW9uIG5ld09uRXhhbWluYXRpb24oKSB7CiAgICAgIHRoaXMuZ2V0T25FeGFtaW5hdGlvbnNQb3B1cCgpOwogICAgICB0aGlzLm9uRXhhbWluYXRpb25EaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZE9uRXhhbWluYXRpb246IGZ1bmN0aW9uIGFkZE9uRXhhbWluYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICAgIHZhciByZXN1bHQsIHBhdGllbnRJZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMzMy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgX3RoaXMzMy5yZXF1cmVkID0gIiI7CgogICAgICAgICAgICAgICAgX3RoaXMzMy5wb3B1cE9uRXhhbWluYXRpb25zRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgIGlmICghZWxlbWVudC5vbl9leGFtaW5hdGlvbl9yZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczMzLnJlcXVyZWQgPSAicmVxdWlyZWQiOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMzMucmVxdXJlZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMzMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiUmVxdWlyZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQbGVhc2UgZmlsbCBpbiB0aGUgcmVxdWlyZWQgZmllbGRzIiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgaWYgKCFfdGhpczMzLnJlcXVyZWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMzLnBhdGllbnRQcm9maWxlU2VydmljZS5vbkV4YW1pbmF0aW9uU2F2ZShfdGhpczMzLnBvcHVwT25FeGFtaW5hdGlvbnNEYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Ny5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgcGF0aWVudElkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicGF0aWVudElkRm9yVHJlYXRtZW50IikpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzMy5nZXRPbkV4YW1pbmF0aW9uQnlQYXRpZW50SWQocGF0aWVudElkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzMuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczMzLmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbmV3SU9DaGFydDogZnVuY3Rpb24gbmV3SU9DaGFydCgpIHsKICAgICAgdGhpcy5pT0NoYXJ0RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBhZGRJT0NoYXJ0OiBmdW5jdGlvbiBhZGRJT0NoYXJ0KCkgewogICAgICB2YXIgX3RoaXMzNCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICB2YXIgcmVzdWx0LCBwYXRpZW50SWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMzQuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzNC5pT0NoYXJ0LnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczM0LnBhdGllbnRQcm9maWxlU2VydmljZS5pT0NoYXJ0U2F2ZShfdGhpczM0LmlPQ2hhcnQpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDguc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzQuZ2V0SU9DaGFydEJ5UGF0aWVudElkKHBhdGllbnRJZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczM0LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzQuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzQuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdEaWFiZXRlc0NoYXJ0OiBmdW5jdGlvbiBuZXdEaWFiZXRlc0NoYXJ0KCkgewogICAgICB0aGlzLmRpYWJldGVzQ2hhcnREaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZERpYWJldGVzQ2hhcnQ6IGZ1bmN0aW9uIGFkZERpYWJldGVzQ2hhcnQoKSB7CiAgICAgIHZhciBfdGhpczM1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgICAgIHZhciBhZG1pc3Npb25faWQsIHJlc3VsdCwgcGF0aWVudElkOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczM1LnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzUuZGlhYmV0ZXNDaGFydC5tZWFsKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzNS5kaWFiZXRlc0NoYXJ0LmJlZm9yZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzUuZGlhYmV0ZXNDaGFydC5hZnRlcikgewogICAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICBhZG1pc3Npb25faWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhZG1pc3Npb25JZEZvckRpYWJldGVzU2VydmljZSIpKTsKICAgICAgICAgICAgICAgIF90aGlzMzUuZGlhYmV0ZXNDaGFydC5hQWRtaXNzaW9uU2VydmljZURldGFpbHMuYWRtaXNzaW9uX2lkID0gU3RyaW5nKGFkbWlzc2lvbl9pZCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMzUucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmRpYWJldGVzQ2hhcnRTYXZlKF90aGlzMzUuZGlhYmV0ZXNDaGFydCk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDkuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIHBhdGllbnRJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInBhdGllbnRJZEZvclRyZWF0bWVudCIpKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzUuZ2V0RGlhYmV0ZXNDaGFydEJ5UGF0aWVudElkKHBhdGllbnRJZCk7CgogICAgICAgICAgICAgICAgICBfdGhpczM1LmdldExhdGVzdEhpc3RvcnlCeVBhdGllbnRJZEZvclByZXNjcmlwdGlvbigpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzNS5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczM1LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczM1LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIG5ld0RpZXRDaGFydDogZnVuY3Rpb24gbmV3RGlldENoYXJ0KCkgewogICAgICB0aGlzLmRpZXRDaGFydERpYWxvZyA9IHRydWU7CiAgICB9LAogICAgZ2V0RGlldENoYXJ0QnlUZW1wbGF0ZUlkOiBmdW5jdGlvbiBnZXREaWV0Q2hhcnRCeVRlbXBsYXRlSWQoKSB7CiAgICAgIHZhciBfdGhpczM2ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5kaWV0Q2hhcnQuZGlldF9jaGFydF90ZW1wbGF0ZV9pZCkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRpZXRDaGFydFNldHVwU2VydmljZS5nZXRCeURpZXRDaGFydFRlbXBsYXRlSWQodGhpcy5kaWV0Q2hhcnQuZGlldF9jaGFydF90ZW1wbGF0ZV9pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgcmV0dXJuIF90aGlzMzYuZGlldENoYXJ0VGVtcExpc3QgPSBkYXRhLmRhdGE7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBhZGREaWV0Q2hhcnQ6IGZ1bmN0aW9uIGFkZERpZXRDaGFydCgpIHsKICAgICAgdmFyIF90aGlzMzcgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICAgIHZhciBwYXRpZW50SWQsIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMzcuc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczM3LmRpZXRDaGFydFRlbXBMaXN0Lmxlbmd0aCA8PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSk7CgogICAgICAgICAgICAgICAgX3RoaXMzNy5kaWV0Q2hhcnRUZW1wTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGF0aWVudF9pZCA9IHBhdGllbnRJZC50b1N0cmluZygpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczM3LnBhdGllbnRQcm9maWxlU2VydmljZS5kaWV0Q2hhcnRTYXZlKF90aGlzMzcuZGlldENoYXJ0VGVtcExpc3QpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDEwLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICAvL3ZhciBwYXRpZW50SWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSk7CiAgICAgICAgICAgICAgICAgIF90aGlzMzcuZ2V0RGlldENoYXJ0QnlQYXRpZW50SWQocGF0aWVudElkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzcuZ2V0TGF0ZXN0SGlzdG9yeUJ5UGF0aWVudElkRm9yUHJlc2NyaXB0aW9uKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczM3LmhpZGVEaWFsb2coKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzMzcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMzcuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkZhaWxlZCIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiByZXN1bHQucmVzLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdDdXJyZW50TWVkaWNhdGlvbnM6IGZ1bmN0aW9uIG5ld0N1cnJlbnRNZWRpY2F0aW9ucygpIHsKICAgICAgdGhpcy5jdXJyZW50TWVkaWNhdGlvbnNEaWFsb2cgPSB0cnVlOwogICAgfSwKICAgIGFkZEN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gYWRkQ3VycmVudE1lZGljYXRpb25zKCkgewogICAgICB2YXIgX3RoaXMzOCA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzMzguc3VibWl0dGVkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzOC5jdXJyZW50TWVkaWNhdGlvbnMubWVkaWNpbmVfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzguY3VycmVudE1lZGljYXRpb25zLnRyZWF0bWVudF9ydWxlc19pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzOC5jdXJyZW50TWVkaWNhdGlvbnMudHJlYXRtZW50X2R1cmF0aW9uX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzguY3VycmVudE1lZGljYXRpb25zLnRyZWF0bWVudF9kb3NlX2lkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgaWYgKF90aGlzMzguY3VycmVudE1lZGljYXRpb25zLnBhdGllbnRfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMzgudmFsaWRhdGlvbi5pc0lkRXhpc3RzKF90aGlzMzguY3VycmVudE1lZGljYXRpb25zTGlzdCwgJ21lZGljaW5lX2lkJywgX3RoaXMzOC5jdXJyZW50TWVkaWNhdGlvbnMubWVkaWNpbmVfaWQsICdwYXRpZW50X2N1cnJlbnRfbWVkaWNhdGlvbnNfaWQnLCBfdGhpczM4LmN1cnJlbnRNZWRpY2F0aW9ucy5wYXRpZW50X2N1cnJlbnRfbWVkaWNhdGlvbnNfaWQsIF90aGlzMzgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMjc7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzOC5wYXRpZW50UHJvZmlsZVNlcnZpY2UuY3VycmVudE1lZGljYXRpb25zU2F2ZShfdGhpczM4LmN1cnJlbnRNZWRpY2F0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDExLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczM4LmdldEN1cnJlbnRNZWRpY2F0aW9uc0J5UGF0aWVudElkKF90aGlzMzguY3VycmVudE1lZGljYXRpb25zLnBhdGllbnRfaWQpOwoKICAgICAgICAgICAgICAgICAgX3RoaXMzOC5oaWRlRGlhbG9nKCk7CgogICAgICAgICAgICAgICAgICBfdGhpczM4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAic3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIlN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogIlNhdmVkIFN1Y2Nlc3NmdWxseSIsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczM4LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY29uZmlybURlbGV0ZUN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gY29uZmlybURlbGV0ZUN1cnJlbnRNZWRpY2F0aW9ucyhkYXRhKSB7CiAgICAgIHZhciBfdGhpczM5ID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0ucmVxdWlyZSh7CiAgICAgICAgbWVzc2FnZTogJ0RvIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHJlY29yZD8nLAogICAgICAgIGhlYWRlcjogJ0RlbGV0ZSBDb25maXJtYXRpb24nLAogICAgICAgIGljb246ICdwaSBwaS1pbmZvLWNpcmNsZScsCiAgICAgICAgYWNjZXB0Q2xhc3M6ICdwLWJ1dHRvbi1kYW5nZXInLAogICAgICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICAgICAgX3RoaXMzOS5kZWxldGVDdXJyZW50TWVkaWNhdGlvbnMoZGF0YSk7CiAgICAgICAgfSwKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uIHJlamVjdCgpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGRlbGV0ZUN1cnJlbnRNZWRpY2F0aW9uczogZnVuY3Rpb24gZGVsZXRlQ3VycmVudE1lZGljYXRpb25zKGRhdGEpIHsKICAgICAgdmFyIF90aGlzNDAgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNDAucGF0aWVudFByb2ZpbGVTZXJ2aWNlLmN1cnJlbnRNZWRpY2F0aW9uc0RlbGV0ZShkYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxMi5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0MC5nZXRDdXJyZW50TWVkaWNhdGlvbnNCeVBhdGllbnRJZChkYXRhLnBhdGllbnRfaWQpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0MC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgbmV3UGFzdE1lZGljYWxIaXN0b3J5OiBmdW5jdGlvbiBuZXdQYXN0TWVkaWNhbEhpc3RvcnkoKSB7CiAgICAgIHRoaXMucGFzdE1lZGljYWxIaXN0b3J5RGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBhZGRQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGFkZFBhc3RNZWRpY2FsSGlzdG9yeSgpIHsKICAgICAgdmFyIF90aGlzNDEgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczQxLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNDEucGFzdE1lZGljYWxIaXN0b3J5LmRpYWdub3Npc19pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM0MS5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzNDEudmFsaWRhdGlvbi5pc0lkRXhpc3RzKF90aGlzNDEucGFzdE1lZGljYWxIaXN0b3J5TGlzdCwgJ2RpYWdub3Npc19pZCcsIF90aGlzNDEucGFzdE1lZGljYWxIaXN0b3J5LmRpYWdub3Npc19pZCwgJ3BhdGllbnRfcGFzdF9oaXN0b3J5X2lkJywgX3RoaXM0MS5wYXN0TWVkaWNhbEhpc3RvcnkucGF0aWVudF9wYXN0X2hpc3RvcnlfaWQsIF90aGlzNDEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0MS5wYXRpZW50UHJvZmlsZVNlcnZpY2UucGFzdEhpc3RvcnlTYXZlKF90aGlzNDEucGFzdE1lZGljYWxIaXN0b3J5KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0MTMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gMjAxKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzNDEuZ2V0UGFzdEhpc3RvcnlCeVBhdGllbnRJZChfdGhpczQxLnBhc3RNZWRpY2FsSGlzdG9yeS5wYXRpZW50X2lkKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNDEuaGlkZURpYWxvZygpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM0MS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0MS4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNvbmZpcm1EZWxldGVQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGNvbmZpcm1EZWxldGVQYXN0TWVkaWNhbEhpc3RvcnkoZGF0YSkgewogICAgICB2YXIgX3RoaXM0MiA9IHRoaXM7CgogICAgICB0aGlzLiRjb25maXJtLnJlcXVpcmUoewogICAgICAgIG1lc3NhZ2U6ICdEbyB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyByZWNvcmQ/JywKICAgICAgICBoZWFkZXI6ICdEZWxldGUgQ29uZmlybWF0aW9uJywKICAgICAgICBpY29uOiAncGkgcGktaW5mby1jaXJjbGUnLAogICAgICAgIGFjY2VwdENsYXNzOiAncC1idXR0b24tZGFuZ2VyJywKICAgICAgICBhY2NlcHQ6IGZ1bmN0aW9uIGFjY2VwdCgpIHsKICAgICAgICAgIF90aGlzNDIuZGVsZXRlUGFzdE1lZGljYWxIaXN0b3J5KGRhdGEpOwogICAgICAgIH0sCiAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3QoKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkZWxldGVQYXN0TWVkaWNhbEhpc3Rvcnk6IGZ1bmN0aW9uIGRlbGV0ZVBhc3RNZWRpY2FsSGlzdG9yeShkYXRhKSB7CiAgICAgIHZhciBfdGhpczQzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNCgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTQkKF9jb250ZXh0MTQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNC5wcmV2ID0gX2NvbnRleHQxNC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxNC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczQzLnBhdGllbnRQcm9maWxlU2VydmljZS5wYXN0SGlzdG9yeURlbGV0ZShkYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxNC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDIpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0My5nZXRQYXN0SGlzdG9yeUJ5UGF0aWVudElkKGRhdGEucGF0aWVudF9pZCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczQzLiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBwYXRpZW50SGlzdG9yeVNhdmU6IGZ1bmN0aW9uIHBhdGllbnRIaXN0b3J5U2F2ZSgpIHsKICAgICAgdmFyIF90aGlzNDQgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE1KCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNSQoX2NvbnRleHQxNSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE1LnByZXYgPSBfY29udGV4dDE1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpczQ0LnBhdGllbnRIaXN0b3J5LnBhdGllbnRfaWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYXRpZW50SWRGb3JUcmVhdG1lbnQiKSkudG9TdHJpbmcoKTsgLy90aGlzLnN1Ym1pdHRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNDQucGF0aWVudEhpc3RvcnkucGF0aWVudF9pZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE1Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfY29udGV4dDE1Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNDQucGF0aWVudFByb2ZpbGVTZXJ2aWNlLnBhdGllbnRIaXN0b3J5U2F2ZShfdGhpczQ0LnBhdGllbnRIaXN0b3J5LCBfdGhpczQ0KTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQxNS5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDEpIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0NC5oaWRlSGlzdG9yeSgpOwoKICAgICAgICAgICAgICAgICAgX3RoaXM0NC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJTdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6ICJTYXZlZCBTdWNjZXNzZnVsbHkiLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM0NC4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRmFpbGVkIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5yZXMsCiAgICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE1KTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/emergency/PatientRegTreatment.js"],"names":["PatientRegistrationService","PatientReportService","CommonService","Validation","moment","FilterMatchMode","FilterOperator","ServiceSetupService","EmergencyService","AppointmentPrescriptionService","AdmissionPrescriptionService","MedicineTypeSetupService","MedicineSetupService","TreatmentRulesSetupService","TreatmentDurationSetupService","TreatmentDoseSetupService","PatientProfileService","ComplaintSetupService","FoodService","OnExaminationSetupService","DietChartTemplateSetupService","DietChartSetupService","DiagnosisSetupService","PrescriptionReportService","data","page","isContactExist","isValid","isEmailValid","newInfo","dataList","relationList","bloodGroupList","genderList","patientRegistrationList","patientRegistration","age_year","age_month","age_day","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","submitted","serviceDialog","emergencyServiceObj","lstService","isDoctor","admittedPatientInfo","prescriptionDataList","tempData","headerName","admissionPrescriptionInfo","cdprescription_date","String","Date","format","cdfolowup_date","setDate","getDate","allAdvice","lstAdmissionPrescriptionInvestigation","lstAdmissionPrescriptionTreatment","lstAdmissionPrescriptionAdvice","treatmentAddDialog","treatmentDialog","treatmentSetup","medicineTypeList","medicineList","treatmentRulesList","treatmentDurationList","treatmentDoseList","isHistory","active","expandedRows","isFemale","chiefComplainDialog","chiefComplain","chiefComplainList","compliantList","foodDialog","foodSetup","allergyDetailsDialog","allergyDetails","allergyDetailsList","foodList","allergyTypeList","onExaminationDialog","onExamination","patientOnExaminationList","onExaminationList","iOChartDialog","iOChart","iOChartList","diabetesChartDialog","diabetesChart","aAdmissionServiceDetails","diabetesChartList","diabetesMealList","dietChartDialog","dietChart","dietChartList","dietChartTemplateList","dietChartTempList","currentMedicationsDialog","currentMedications","currentMedicationsList","pastMedicalHistoryDialog","pastMedicalHistory","pastMedicalHistoryList","diagnosisList","patientLatestHistory","lstPatientOnExamination","lstPatientAllergyDetails","lstPatientDiabetesChart","lstPatientDietChart","patientHistory","lstPersonalHistory","lstFamilyHistory","lstSystemsReview","lstSubstanceUse","lstReproductiveHistory","created","today","month","getMonth","year","getFullYear","prevMonth","prevYear","minDate","setMonth","setFullYear","patientRegistrationService","patientReportService","commonService","validation","serviceSetupService","emergencyService","admissionPrescriptionService","appointmentPrescriptionService","medicineTypeSetupService","medicineSetupService","treatmentRulesSetupService","treatmentDurationSetupService","treatmentDoseSetupService","patientProfileService","complaintSetupService","foodService","onExaminationSetupService","dietChartTemplateSetupService","dietChartSetupService","diagnosisSetupService","prescriptionReportService","GetAllGender","then","GetAllBloodGroup","GetAllPatientsRelatives","filter","getPatientWithPagination","patientFormatted","that","document","onkeyup","e","ctrlKey","altKey","which","getInvestigation","getTreatment","getAdvice","getActiveCombo","userInfo","JSON","parse","localStorage","getItem","doctor_id","getPrescriptionDataByDoctorId","getService","methods","getAll","serviceFormatted","printAllPatient","Downloadfile","printID","regNo","GetPatientIdCardByRegNo","length","_total_records","onPage","event","rows","openNew","hideNew","isExistContact","contact_no","match","getByContactOrRegNo","getContact","add","first_name","currentDate","dob","patient_id","result","status","getPatientId","$toast","severity","summary","detail","life","res","put","getById","prescription","takeService","filterData","el","service_head_id","forEach","element","push","service_id","service_name","_service_head_name","service_type_id","_service_type_name","service_charge","er_service_charge","discount","isCheck","addService","hideDialog","transferIPD","$confirm","require","message","header","icon","accept","setItem","registration_no","$router","reject","edit","obj","Object","assign","patient_name","gender","getComplainsByPatientId","getLatestHistoryByPatientIdForPrescription","GetAllAllergyType","GetAllDiabetesMeal","getPreviousPrescriptionDataByPatientId","previousPrescriptionDataFormatted","patientId","toString","isAdvice","lstInvestigation","investingation_name","id","investigation_id","saveTreatment","ddlmedicine_type","ddlmedicine","ddltreatment_rules","ddltreatment_duration","ddltreatment_dose","aMedicine","medicine_id","_medicine_type_name","text","_treatment_dose_name","treatment_dose_id","_treatment_rule_name","treatment_rules_id","_treatment_duration_name","treatment_duration_id","description","lstAdvices","advice_name","advice_id","addAllAdvice","aAdvice","getValue","aInvestigation","_medicine_name","filterMedicineTypeWise","refid","editTreatment","index","medicineName","treatmentIndex","treatmentEditSave","deleteItem","lst","splice","findIndex","i","addRx","prescription_date","folowup_date","downloadPrescription","newPrescription","admission_prescription_id","GetEmergencyPescription","formatDate","formatDateTime","history","removeItem","getAllergyDetailsByPatientId","getOnExaminationByPatientId","getIOChartByPatientId","getDiabetesChartByPatientId","getDietChartByPatientId","getCurrentMedicationsByPatientId","getPastHistoryByPatientId","getSystemSubstance","formattedSystemSubstance","getOnExaminationsPopup","popupOnExaminationsData","_on_examination_name","on_examination_id","on_examination_result","onExaminationPopupDialog","hideHistory","newChiefComplain","addChiefComplain","compilants_id","cdfrom_date","isIdExists","patient_complain_id","from_date","complainSave","complainUpdate","editChiefComplain","getFood","foodFormatted","newFood","addFood","food_name","isNameExists","food_id","newAllergyDetails","addAllergyDetails","type","patient_allergy_details_id","allergyDetailsSave","allergyDetailsUpdate","editAllergyDetails","newOnExamination","addOnExamination","requred","onExaminationSave","newIOChart","addIOChart","iOChartSave","newDiabetesChart","addDiabetesChart","meal","before","after","admission_id","diabetesChartSave","newDietChart","getDietChartByTemplateId","diet_chart_template_id","getByDietChartTemplateId","addDietChart","dietChartSave","newCurrentMedications","addCurrentMedications","patient_current_medications_id","currentMedicationsSave","confirmDeleteCurrentMedications","acceptClass","deleteCurrentMedications","currentMedicationsDelete","newPastMedicalHistory","addPastMedicalHistory","diagnosis_id","patient_past_history_id","pastHistorySave","confirmDeletePastMedicalHistory","deletePastMedicalHistory","pastHistoryDelete","patientHistorySave"],"mappings":"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","sourcesContent":["import PatientRegistrationService from \"../../service/front-desk/PatientRegistrationService\";\r\nimport PatientReportService from \"../../service/report/PatientReportService\";\r\nimport CommonService from \"../../service/CommonService\";\r\nimport Validation from \"../../scripts/validation\";\r\nimport moment from \"moment\";\r\nimport { FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n// Service\r\nimport ServiceSetupService from \"../../service/setup/ServiceSetupService\";\r\nimport EmergencyService from \"../../service/emergency/EmergencyService\";\r\n// Prescription\r\nimport AppointmentPrescriptionService from \"../../service/doctor-panel/AppointmentPrescriptionService\";\r\nimport AdmissionPrescriptionService from \"../../service/prescription/AdmissionPrescriptionService\";\r\n// Prescription Treatment\r\nimport MedicineTypeSetupService from \"../../service/setup/MedicineTypeSetupService\";\r\nimport MedicineSetupService from \"../../service/setup/MedicineSetupService\";\r\nimport TreatmentRulesSetupService from \"../../service/setup/TreatmentRulesSetupService\";\r\nimport TreatmentDurationSetupService from \"../../service/setup/TreatmentDurationSetupService\";\r\nimport TreatmentDoseSetupService from \"../../service/setup/TreatmentDoseSetupService\";\r\n// History\r\nimport PatientProfileService from \"../../service/profiles/PatientProfileService\";\r\n//import WordCabinSetupService from \"../../service/setup/WordCabinSetupService\";\r\nimport ComplaintSetupService from \"../../service/setup/ComplaintSetupService\";\r\nimport FoodService from \"../../service/setup/FoodService\";\r\nimport OnExaminationSetupService from \"../../service/setup/OnExaminationSetupService\";\r\nimport DietChartTemplateSetupService from \"../../service/setup/DietChartTemplateSetupService\";\r\nimport DietChartSetupService from \"../../service/setup/DietChartSetupService\";\r\nimport DiagnosisSetupService from \"../../service/setup/DiagnosisSetupService\";\r\nimport PrescriptionReportService from \"../../service/report/PrescriptionReportService\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      page: 100,\r\n      isContactExist: \"\",\r\n      isValid: \"\",\r\n      isEmailValid: \"\",\r\n      newInfo: false,\r\n      dataList: true,\r\n      relationList: [],\r\n      bloodGroupList: [],\r\n      genderList: [],\r\n      patientRegistrationList: [],\r\n      patientRegistration: {\r\n        age_year: \"0\",\r\n        age_month: \"0\",\r\n        age_day: \"0\",\r\n      },\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n      submitted: false,\r\n      // Service\r\n      serviceDialog: false,\r\n      emergencyServiceObj: {\r\n        lstService: [],\r\n      },\r\n      // Prescription\r\n      isDoctor: false,\r\n      admittedPatientInfo: {},\r\n      prescriptionDataList: [],\r\n      tempData: [],\r\n      headerName: \"Sections\",\r\n\r\n      admissionPrescriptionInfo: {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        allAdvice: false,\r\n\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n      // Prescription Treatment\r\n      treatmentAddDialog: false,\r\n      treatmentDialog: false,\r\n      treatmentSetup: {},\r\n      medicineTypeList: [],\r\n      medicineList: [],\r\n      treatmentRulesList: [],\r\n      treatmentDurationList: [],\r\n      treatmentDoseList: [],\r\n      // History\r\n      isHistory: false,\r\n      active: 0,\r\n      expandedRows: [],\r\n      isFemale: false,\r\n\r\n      chiefComplainDialog: false,\r\n      chiefComplain: {},\r\n      chiefComplainList: [],\r\n      compliantList: [],\r\n\r\n      foodDialog: false,\r\n      foodSetup: {},\r\n      allergyDetailsDialog: false,\r\n      allergyDetails: {},\r\n      allergyDetailsList: [],\r\n      foodList: [],\r\n      allergyTypeList: [],\r\n\r\n      onExaminationDialog: false,\r\n      onExamination: {},\r\n      patientOnExaminationList: [],\r\n      onExaminationList: [],\r\n\r\n      iOChartDialog: false,\r\n      iOChart: {},\r\n      iOChartList: [],\r\n\r\n      diabetesChartDialog: false,\r\n      diabetesChart: {\r\n        aAdmissionServiceDetails: {}\r\n      },\r\n      diabetesChartList: [],\r\n      diabetesMealList: [],\r\n\r\n      dietChartDialog: false,\r\n      dietChart: {},\r\n      dietChartList: [],\r\n      dietChartTemplateList: [],\r\n      dietChartTempList: [],\r\n\r\n      currentMedicationsDialog: false,\r\n      currentMedications: {},\r\n      currentMedicationsList: [],\r\n\r\n      pastMedicalHistoryDialog: false,\r\n      pastMedicalHistory: {},\r\n      pastMedicalHistoryList: [],\r\n      diagnosisList: [],\r\n\r\n      patientLatestHistory: {\r\n        lstPatientOnExamination: [],\r\n        lstPatientAllergyDetails: [],\r\n        lstPatientDiabetesChart: [],\r\n        lstPatientDietChart: [],\r\n      },\r\n      patientHistory: {\r\n        lstPersonalHistory: [],\r\n        lstFamilyHistory: [],\r\n        lstSystemsReview: [],\r\n        lstSubstanceUse: [],\r\n        lstReproductiveHistory: [],\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    // past date-year disabled\r\n    let today = new Date();\r\n    let month = today.getMonth();\r\n    let year = today.getFullYear();\r\n    let prevMonth = (month === 0) ? 11 : month - 0;\r\n    let prevYear = (prevMonth === 11) ? year - 0 : year;\r\n    this.minDate = new Date();\r\n    this.minDate.setMonth(prevMonth);\r\n    this.minDate.setFullYear(prevYear);\r\n\r\n    this.patientRegistrationService = new PatientRegistrationService();\r\n    this.patientReportService = new PatientReportService();\r\n    this.commonService = new CommonService();\r\n    this.validation = new Validation();\r\n    // Service\r\n    this.serviceSetupService = new ServiceSetupService();\r\n    this.emergencyService = new EmergencyService();\r\n    // Prescription\r\n    this.admissionPrescriptionService = new AdmissionPrescriptionService();\r\n    this.appointmentPrescriptionService = new AppointmentPrescriptionService();\r\n\r\n    // Prescription Treatment\r\n    this.medicineTypeSetupService = new MedicineTypeSetupService();\r\n    this.medicineSetupService = new MedicineSetupService();\r\n    this.treatmentRulesSetupService = new TreatmentRulesSetupService();\r\n    this.treatmentDurationSetupService = new TreatmentDurationSetupService();\r\n    this.treatmentDoseSetupService = new TreatmentDoseSetupService();\r\n    // History\r\n    this.patientProfileService = new PatientProfileService();\r\n\r\n    this.complaintSetupService = new ComplaintSetupService();\r\n    this.foodService = new FoodService();\r\n    this.onExaminationSetupService = new OnExaminationSetupService();\r\n    this.dietChartTemplateSetupService = new DietChartTemplateSetupService();\r\n    this.dietChartSetupService = new DietChartSetupService();\r\n\r\n    this.diagnosisSetupService = new DiagnosisSetupService();\r\n    this.prescriptionReportService = new PrescriptionReportService();\r\n\r\n    this.commonService.GetAllGender().then(\r\n      (data) =>\r\n        (this.genderList = data.data)\r\n    );\r\n\r\n    this.commonService\r\n      .GetAllBloodGroup()\r\n      .then((data) => (this.bloodGroupList = data.data));\r\n\r\n    this.commonService\r\n      .GetAllPatientsRelatives()\r\n      .then((data) => (this.relationList = data.data));\r\n\r\n    // server side pagination\r\n    var filter = this.filters['global'].value ? this.filters['global'].value : \"\";\r\n    this.patientRegistrationService\r\n      .getPatientWithPagination(\"0\", \"10\", filter, this)\r\n      .then((data) => this.patientFormatted(data.data));\r\n\r\n    // Prescription\r\n    let that = this;\r\n    document.onkeyup = function (e) {\r\n      if (e.ctrlKey && e.altKey && e.which == 73) {\r\n        that.getInvestigation();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 84) {\r\n        that.getTreatment();\r\n      } else if (e.ctrlKey && e.altKey && e.which == 65) {\r\n        that.getAdvice();\r\n      }\r\n      // else if (e.ctrlKey && e.altKey && e.shiftKey) {\r\n\r\n      // }\r\n    };\r\n\r\n    this.medicineTypeSetupService.getActiveCombo().then((data) => (this.medicineTypeList = data.data));\r\n\r\n    this.userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\n    if (this.userInfo.doctor_id) {\r\n      this.appointmentPrescriptionService\r\n        .getPrescriptionDataByDoctorId(this.userInfo.doctor_id)\r\n        .then((data) => (this.prescriptionDataList = data.data));\r\n\r\n      this.doctor_id = this.userInfo.doctor_id;\r\n\r\n      this.isDoctor = true;\r\n      this.admissionPrescriptionInfo.doctor_id = this.doctor_id;\r\n    } else if (!this.userInfo.doctor_id) {\r\n      this.isDoctor = false;\r\n    }\r\n\r\n    // Service\r\n    this.getService();\r\n  },\r\n  methods: {\r\n    getService(){\r\n      this.serviceSetupService\r\n      .getAll()\r\n      .then((data) => this.serviceFormatted(data.data));\r\n    },\r\n    printAllPatient() {\r\n      this.patientReportService.getAll(this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    printID(regNo) {\r\n      this.patientReportService.GetPatientIdCardByRegNo(regNo, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    patientFormatted(data) {\r\n      this.patientRegistrationList = data;\r\n      this.page = data.length ? data[0]._total_records : 100;\r\n    },\r\n    // server side pagination\r\n    onPage(event) {\r\n      var filter = this.filters['global'].value ? this.filters['global'].value : \"\";\r\n      var page = event == 0 ? 0 : event.page;\r\n      var rows = event == 0 ? 10 : event.rows;\r\n\r\n      this.patientRegistrationService\r\n        .getPatientWithPagination(page, rows, filter, this)\r\n        .then((data) => this.patientFormatted(data.data));\r\n    },\r\n    openNew() {\r\n      this.isContactExist = \"\";\r\n      this.isValid = \"\";\r\n      this.isEmailValid = \"\";\r\n      this.patientRegistration = {\r\n        age_year: \"0\",\r\n        age_month: \"0\",\r\n        age_day: \"0\",\r\n      };\r\n      this.newInfo = true;\r\n      this.dataList = false;\r\n      this.submitted = false;\r\n    },\r\n    hideNew() {\r\n      this.isContactExist = \"\";\r\n      this.isValid = \"\";\r\n      this.isEmailValid = \"\";\r\n      this.patientRegistration = {\r\n        age_year: \"0\",\r\n        age_month: \"0\",\r\n        age_day: \"0\",\r\n      };\r\n      this.dataList = true;\r\n      this.isHistory = false;\r\n      this.newInfo = false;\r\n      this.submitted = false;\r\n    },\r\n    isExistContact() {\r\n      if (this.patientRegistration.contact_no.match(/^(01)([0-9]{9})$/)) {\r\n        this.patientRegistrationService\r\n          .getByContactOrRegNo(this.patientRegistration.contact_no, this)\r\n          .then((data) => this.getContact(data.data));\r\n      } else {\r\n        this.isContactExist =\r\n          \"Contact number must start with 01 and the required length is 11\";\r\n      }\r\n    },\r\n    getContact(data) {\r\n      if (data.contact_no) {\r\n        this.isContactExist = \"Duplicate phone number!\";\r\n      } else {\r\n        this.isContactExist = \"\";\r\n      }\r\n    },\r\n    async add() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.patientRegistration.first_name) {\r\n          return;\r\n        } else if (!this.patientRegistration.age_year) {\r\n          return;\r\n        } else if (!this.patientRegistration.age_month) {\r\n          return;\r\n        } else if (!this.patientRegistration.age_day) {\r\n          return;\r\n        } else if (!this.patientRegistration.contact_no) {\r\n          return;\r\n        } else if (this.isContactExist) {\r\n          return;\r\n        } else {\r\n          var currentDate = new Date();\r\n          var dob = new Date(currentDate.getFullYear() - this.patientRegistration.age_year, currentDate.getMonth() - this.patientRegistration.age_month, currentDate.getDate() - this.patientRegistration.age_day);\r\n          this.patientRegistration.dob = moment(\r\n            String(dob)\r\n          ).format(\"YYYY-MM-DD\");\r\n\r\n          if (!this.patientRegistration.patient_id) {\r\n            let result = await this.patientRegistrationService.add(\r\n              this.patientRegistration, this\r\n            );\r\n            if (result.status === 200) {\r\n              if (this.isDoctor) {\r\n                this.getPatientId(result.data);\r\n              }\r\n\r\n              this.$toast.add({\r\n                severity: \"success\",\r\n                summary: \"Success\",\r\n                detail: \"Saved Successfully\",\r\n                life: 10000,\r\n              });\r\n              this.hideNew();\r\n              this.onPage(0);\r\n            } else if (result.status === 401) {\r\n              this.$toast.add({\r\n                severity: \"error\",\r\n                summary: \"Error\",\r\n                detail: result.data,\r\n                life: 10000,\r\n              });\r\n            } else {\r\n              this.$toast.add({\r\n                severity: \"error\",\r\n                summary: \"Failed\",\r\n                detail: result.res,\r\n                life: 10000,\r\n              });\r\n            }\r\n          } else {\r\n            let result = await this.patientRegistrationService.put(\r\n              this.patientRegistration,\r\n              this\r\n            );\r\n            if (result.status === 202) {\r\n              this.$toast.add({\r\n                severity: \"success\",\r\n                summary: \"Success\",\r\n                detail: \"Updated Successfully\",\r\n                life: 10000,\r\n              });\r\n              this.hideNew();\r\n              this.onPage(0);\r\n            } else if (result.status === 401) {\r\n              this.$toast.add({\r\n                severity: \"error\",\r\n                summary: \"Error\",\r\n                detail: result.data,\r\n                life: 10000,\r\n              });\r\n            } else {\r\n              this.$toast.add({\r\n                severity: \"error\",\r\n                summary: \"Failed\",\r\n                detail: result.res,\r\n                life: 10000,\r\n              });\r\n            }\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    getPatientId(patient_id) {\r\n      this.patientRegistrationService\r\n        .getById(patient_id)\r\n        .then((data) => this.prescription(data.data));\r\n    },\r\n    takeService(data) {\r\n      this.admittedPatientInfo.patient_id = data.patient_id;\r\n      this.serviceDialog = true;\r\n    },\r\n    serviceFormatted(data) {\r\n      let filterData = data.filter(function (el) {\r\n        return el.service_head_id == '2' || el.service_head_id == '3' && el.active == true;\r\n      }, this);\r\n      this.emergencyServiceObj.lstService = [];\r\n      filterData.forEach((element) => {\r\n        this.emergencyServiceObj.lstService.push({\r\n          service_id: element.service_id,\r\n          service_name: element.service_name,\r\n          service_head_id: element.service_head_id,\r\n          _service_head_name: element._service_head_name,\r\n          service_type_id: element.service_type_id,\r\n          _service_type_name: element._service_type_name,\r\n          service_charge: element.service_charge,\r\n          er_service_charge: element.er_service_charge,\r\n          discount: element.discount,\r\n          isCheck: false\r\n        });\r\n      });\r\n    },\r\n    async addService() {\r\n      this.emergencyServiceObj.lstService = this.emergencyServiceObj.lstService.filter(function (el) {\r\n        return el.isCheck == true;\r\n      }, this);\r\n\r\n      if (this.emergencyServiceObj.lstService.length > 0) {\r\n        this.emergencyServiceObj.patient_id = this.admittedPatientInfo.patient_id;\r\n        let result = await this.emergencyService.add(this.emergencyServiceObj, this);\r\n        if (result.status === 200) {\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n          this.hideDialog();\r\n          this.getService();\r\n        } else if (result.status === 401) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: result.data,\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    transferIPD(data){\r\n      this.$confirm.require({\r\n        message: 'Are you sure you want to transfer IPD?',\r\n        header: 'Confirmation',\r\n        icon: 'pi pi-exclamation-triangle',\r\n        accept: () => {\r\n          localStorage.setItem('transferPatientRegNo', data.registration_no);\r\n          this.$router.push(\"/patient-admission-form\");\r\n        },\r\n        reject: () => {\r\n          return;\r\n          //this.onPage(0);\r\n        },\r\n\r\n      });\r\n    },\r\n    edit(obj) {\r\n      this.patientRegistration = Object.assign({}, obj);\r\n      // this.patientRegistration.cddob = moment(\r\n      //   String(this.patientRegistration.dob)\r\n      // ).format(\"YYYY-MM-DD\");\r\n      this.dataList = false;\r\n      this.newInfo = true;\r\n    },\r\n    // prescription\r\n    prescription(data) {\r\n      this.admittedPatientInfo.patient_id = data.patient_id;\r\n      localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      this.admittedPatientInfo.registration_no = data.registration_no;\r\n      this.admittedPatientInfo.patient_name = data.first_name;\r\n      this.admittedPatientInfo.gender = data.gender;\r\n      this.admittedPatientInfo.age_year = data.age_year;\r\n      this.admittedPatientInfo.age_month = data.age_month;\r\n      this.admittedPatientInfo.age_day = data.age_day;\r\n\r\n      this.dataList = false;\r\n      this.getComplainsByPatientId(data.patient_id);\r\n      this.getLatestHistoryByPatientIdForPrescription();\r\n      // Use for Dialog //\r\n      this.complaintSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.compliantList = data.data));\r\n\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => (this.foodList = data.data));\r\n\r\n      this.onExaminationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.onExaminationList = data.data));\r\n\r\n      this.diagnosisSetupService\r\n        .getAll()\r\n        .then((data) => (this.diagnosisList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllAllergyType()\r\n        .then((data) => (this.allergyTypeList = data.data));\r\n\r\n      this.commonService\r\n        .GetAllDiabetesMeal()\r\n        .then((data) => (this.diabetesMealList = data.data));\r\n\r\n      this.dietChartTemplateSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.dietChartTemplateList = data.data));\r\n      // Use for Dialog //\r\n\r\n      // Previous Prescription Data\r\n      this.admissionPrescriptionService\r\n        .getPreviousPrescriptionDataByPatientId(data.patient_id)\r\n        .then((data) => this.previousPrescriptionDataFormatted(data.data));\r\n\r\n      // Prescription Treatment\r\n      this.medicineSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.medicineList = data.data));\r\n\r\n      this.treatmentRulesSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentRulesList = data.data));\r\n\r\n      this.treatmentDurationSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDurationList = data.data));\r\n\r\n      this.treatmentDoseSetupService\r\n        .getActiveCombo()\r\n        .then((data) => (this.treatmentDoseList = data.data));\r\n    },\r\n    previousPrescriptionDataFormatted(data) {\r\n      this.admissionPrescriptionInfo.cdprescription_date = moment(String(new Date())).format(\"MM/DD/YYYY\");\r\n      this.admissionPrescriptionInfo.cdfolowup_date = moment(\r\n        String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n      ).format(\"MM/DD/YYYY\");\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment = data.lstAdmissionPrescriptionTreatment;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice = data.lstAdmissionPrescriptionAdvice;\r\n      this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation = data.lstAdmissionPrescriptionInvestigation;\r\n    },\r\n    getLatestHistoryByPatientIdForPrescription() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      this.patientProfileService.getLatestHistoryByPatientIdForPrescription(patientId).then((data) => (this.patientLatestHistory = data.data));\r\n    },\r\n    // Get Prescription Data\r\n    getInvestigation() {\r\n      this.headerName = \"Investigation\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = false;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstInvestigation.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.investingation_name,\r\n          id: element.investigation_id,\r\n        });\r\n      });\r\n    },\r\n    getTreatment() {\r\n      this.treatmentAddDialog = true;\r\n      // this.headerName = \"Medicine\";\r\n      // this.filters['global'].value = \"\";\r\n      // this.isAdvice = false;\r\n      // this.tempData = [];\r\n      // this.prescriptionDataList.lstTreatment.forEach((element) => {\r\n      //   this.tempData.push({\r\n      //     _medicine_type_name: element._medicine_type_name,\r\n      //     _medicine_name: element._medicine_name,\r\n      //     name: element._medicine_type_name + \" \" + element._medicine_name + \" \" + element._treatment_dose_name + \" \" + element._treatment_rule_name + \" \" + element._treatment_duration_name,\r\n      //     id: element.medicine_id,\r\n      //     _treatment_dose_name: element._treatment_dose_name,\r\n      //     treatment_dose_id: element.treatment_dose_id,\r\n      //     _treatment_rule_name: element._treatment_rule_name,\r\n      //     treatment_rules_id: element.treatment_rules_id,\r\n      //     _treatment_duration_name: element._treatment_duration_name,\r\n      //     treatment_duration_id: element.treatment_duration_id,\r\n      //     description: element.description,\r\n      //   });\r\n      // });\r\n    },\r\n    saveTreatment() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddlmedicine_type) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddlmedicine) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === this.treatmentSetup.ddlmedicine.value;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            _medicine_type_name: this.treatmentSetup.ddlmedicine_type.text,\r\n            name: this.treatmentSetup.ddlmedicine.text,\r\n            medicine_id: this.treatmentSetup.ddlmedicine.value,\r\n            _treatment_dose_name: this.treatmentSetup.ddltreatment_dose.text,\r\n            treatment_dose_id: this.treatmentSetup.ddltreatment_dose.value,\r\n            _treatment_rule_name: this.treatmentSetup.ddltreatment_rules.text,\r\n            treatment_rules_id: this.treatmentSetup.ddltreatment_rules.value,\r\n            _treatment_duration_name: this.treatmentSetup.ddltreatment_duration.text,\r\n            treatment_duration_id: this.treatmentSetup.ddltreatment_duration.value,\r\n            description: \"\",\r\n          });\r\n        }\r\n        this.hideDialog();\r\n      }\r\n    },\r\n    getAdvice() {\r\n      this.headerName = \"Advice\";\r\n      this.filters['global'].value = \"\";\r\n      this.isAdvice = true;\r\n      this.tempData = [];\r\n      this.prescriptionDataList.lstAdvices.forEach((element) => {\r\n        this.tempData.push({\r\n          name: element.advice_name,\r\n          id: element.advice_id,\r\n        });\r\n      });\r\n    },\r\n    // Add all advice checkbox\r\n    addAllAdvice() {\r\n      if (!this.admissionPrescriptionInfo.allAdvice) {\r\n        this.tempData.forEach((element) => {\r\n          var aAdvice =\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n              function (el) {\r\n                return el.advice_id === element.id;\r\n              },\r\n              this\r\n            );\r\n\r\n          if (!aAdvice.length) {\r\n            this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n              name: element.name,\r\n              advice_id: element.id,\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    // Add value \r\n    getValue(data) {\r\n      if (this.headerName == \"Investigation\") {\r\n        var aInvestigation =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.filter(\r\n            function (el) {\r\n              return el.investigation_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aInvestigation.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionInvestigation.push(\r\n            {\r\n              name: data.name,\r\n              investigation_id: data.id,\r\n            }\r\n          );\r\n        }\r\n      } else if (this.headerName == \"Medicine\") {\r\n        var aMedicine =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.filter(\r\n            function (el) {\r\n              return el.medicine_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aMedicine.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment.push({\r\n            _medicine_type_name: data._medicine_type_name,\r\n            name: data._medicine_name,\r\n            medicine_id: data.id,\r\n            _treatment_dose_name: data._treatment_dose_name,\r\n            treatment_dose_id: data.treatment_dose_id,\r\n            _treatment_rule_name: data._treatment_rule_name,\r\n            treatment_rules_id: data.treatment_rules_id,\r\n            _treatment_duration_name: data._treatment_duration_name,\r\n            treatment_duration_id: data.treatment_duration_id,\r\n            description: data.description,\r\n          });\r\n        }\r\n      } else if (this.headerName == \"Advice\") {\r\n        var aAdvice =\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.filter(\r\n            function (el) {\r\n              return el.advice_id === data.id;\r\n            },\r\n            this\r\n          );\r\n\r\n        if (!aAdvice.length) {\r\n          this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice.push({\r\n            name: data.name,\r\n            advice_id: data.id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    hideDialog() {\r\n      this.serviceDialog = false;\r\n      this.treatmentAddDialog = false;\r\n      this.treatmentDialog = false;\r\n\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n\r\n      this.chiefComplainDialog = false;\r\n      this.chiefComplain = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.foodDialog = false;\r\n      this.foodSetup = {};\r\n      this.allergyDetailsDialog = false;\r\n      this.allergyDetails = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.onExaminationDialog = false;\r\n      // this.onExamination = {\r\n      //   patient_id: patientId\r\n      // };\r\n\r\n      this.iOChartDialog = false;\r\n      this.iOChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.diabetesChartDialog = false;\r\n      this.diabetesChart = {\r\n        aAdmissionServiceDetails: {},\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.dietChartDialog = false;\r\n      this.dietChart = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.currentMedicationsDialog = false;\r\n      this.currentMedications = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.pastMedicalHistoryDialog = false;\r\n      this.pastMedicalHistory = {\r\n        patient_id: patientId\r\n      };\r\n\r\n      this.submitted = false;\r\n    },\r\n    filterMedicineTypeWise() {\r\n      if (this.treatmentSetup.ddlmedicine_type) {\r\n        this.treatmentSetup.ddlmedicine_type.text;\r\n        return this.medicineList.filter(function (el) {\r\n          return el.refid === this.treatmentSetup.ddlmedicine_type.value;\r\n        }, this);\r\n      }\r\n    },\r\n    editTreatment(data, index) {\r\n      this.treatmentSetup.medicineName = data.name;\r\n      this.treatmentSetup.ddltreatment_rules = {\r\n        text: data._treatment_rule_name,\r\n        value: data.treatment_rules_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_duration = {\r\n        text: data._treatment_duration_name,\r\n        value: data.treatment_duration_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentSetup.ddltreatment_dose = {\r\n        text: data._treatment_dose_name,\r\n        value: data.treatment_dose_id,\r\n        refid: null,\r\n      };\r\n      this.treatmentDialog = true;\r\n      this.treatmentIndex = index\r\n    },\r\n    treatmentEditSave() {\r\n      this.submitted = true;\r\n      if (!this.treatmentSetup.ddltreatment_rules) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_duration) {\r\n        return;\r\n      } else if (!this.treatmentSetup.ddltreatment_dose) {\r\n        return;\r\n      } else {\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].name = this.treatmentSetup.ddlmedicine.text;\r\n        //this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].medicine_id = this.treatmentSetup.ddlmedicine.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_rule_name = this.treatmentSetup.ddltreatment_rules.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_rules_id = this.treatmentSetup.ddltreatment_rules.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_duration_name = this.treatmentSetup.ddltreatment_duration.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_duration_id = this.treatmentSetup.ddltreatment_duration.value;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex]._treatment_dose_name = this.treatmentSetup.ddltreatment_dose.text;\r\n        this.admissionPrescriptionInfo.lstAdmissionPrescriptionTreatment[this.treatmentIndex].treatment_dose_id = this.treatmentSetup.ddltreatment_dose.value;\r\n\r\n        this.treatmentDialog = false;\r\n        this.submitted = false;\r\n      }\r\n    },\r\n    deleteItem(lst, data) {\r\n      lst.splice(\r\n        lst.findIndex((i) => i === data),\r\n        1\r\n      );\r\n    },\r\n    async addRx() {\r\n      try {\r\n        if (\r\n          !this.admissionPrescriptionInfo.lstAdmissionPrescriptionAdvice\r\n            .length\r\n        ) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Please add Patient Advice\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else {\r\n          this.admissionPrescriptionInfo.patient_id =\r\n            this.admittedPatientInfo.patient_id;\r\n\r\n          this.admissionPrescriptionInfo.prescription_date = moment(\r\n            String(this.admissionPrescriptionInfo.cdprescription_date)\r\n          ).format(\"YYYY-MM-DD\");\r\n\r\n          if (this.admissionPrescriptionInfo.cdfolowup_date) {\r\n            this.admissionPrescriptionInfo.folowup_date = moment(\r\n              String(this.admissionPrescriptionInfo.cdfolowup_date)\r\n            ).format(\"YYYY-MM-DD\");\r\n          }\r\n\r\n          let result = await this.admissionPrescriptionService.add(\r\n            this.admissionPrescriptionInfo\r\n          );\r\n          if (result.status === 200) {\r\n            this.downloadPrescription(result.data);\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Prescribed Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.newPrescription();\r\n            this.hideNew();\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n    downloadPrescription(admission_prescription_id) {\r\n      this.prescriptionReportService.GetEmergencyPescription(admission_prescription_id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    newPrescription() {\r\n      this.headerName = \"Sections\";\r\n      this.filters['global'].value = \"\";\r\n      this.tempData = [];\r\n\r\n      this.admissionPrescriptionInfo = {\r\n        cdprescription_date: moment(String(new Date())).format(\"MM/DD/YYYY\"),\r\n        cdfolowup_date: moment(\r\n          String(new Date(new Date().setDate(new Date().getDate() + 7)))\r\n        ).format(\"MM/DD/YYYY\"),\r\n\r\n        allAdvice: false,\r\n\r\n        lstAdmissionPrescriptionInvestigation: [],\r\n        lstAdmissionPrescriptionTreatment: [],\r\n        lstAdmissionPrescriptionAdvice: [],\r\n      },\r\n\r\n        this.submitted = false;\r\n    },\r\n    formatDate(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY\");\r\n    },\r\n    formatDateTime(value) {\r\n      return moment(String(value)).format(\"MM/DD/YYYY h:mm:ss a\");\r\n    },\r\n    // History\r\n    history() {\r\n      var data = this.admittedPatientInfo;\r\n      if (data.gender == \"Female\") {\r\n        this.isFemale = true;\r\n      } else {\r\n        this.isFemale = false;\r\n      }\r\n\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n      if (patientId) {\r\n        localStorage.removeItem('patientIdForTreatment');\r\n        localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      } else {\r\n        localStorage.setItem('patientIdForTreatment', data.patient_id);\r\n      }\r\n\r\n      // Collect history patient wise //\r\n      this.getComplainsByPatientId(data.patient_id);\r\n\r\n      this.getAllergyDetailsByPatientId(data.patient_id);\r\n\r\n      this.getOnExaminationByPatientId(data.patient_id);\r\n\r\n      this.getIOChartByPatientId(data.patient_id);\r\n\r\n      this.getDiabetesChartByPatientId(data.patient_id);\r\n\r\n      this.getDietChartByPatientId(data.patient_id);\r\n\r\n      this.getCurrentMedicationsByPatientId(data.patient_id);\r\n\r\n      this.getPastHistoryByPatientId(data.patient_id);\r\n\r\n      this.patientProfileService.getSystemSubstance(data.patient_id).then((data) => this.formattedSystemSubstance(data.data));\r\n\r\n      this.isHistory = true;\r\n      this.dataList = false;\r\n      // Collect history patient wise //\r\n    },\r\n    getComplainsByPatientId(patient_id) {\r\n      this.chiefComplain.patient_id = patient_id;\r\n      this.patientProfileService.getComplainsByPatientId(patient_id).then((data) => (this.chiefComplainList = data.data));\r\n    },\r\n\r\n    getAllergyDetailsByPatientId(patient_id) {\r\n      this.allergyDetails.patient_id = patient_id;\r\n      this.patientProfileService.getAllergyDetailsByPatientId(patient_id).then((data) => (this.allergyDetailsList = data.data));\r\n    },\r\n\r\n    getOnExaminationsPopup() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n\r\n      this.popupOnExaminationsData = [];\r\n      this.onExaminationList.forEach((element) => {\r\n        this.popupOnExaminationsData.push({\r\n          _on_examination_name: element.text,\r\n          on_examination_id: element.value,\r\n          on_examination_result: String(1),\r\n          patient_id: patientId.toString()\r\n        });\r\n      });\r\n\r\n      this.onExaminationPopupDialog = true;\r\n    },\r\n\r\n    getOnExaminationByPatientId(patient_id) {\r\n      this.onExamination.patient_id = patient_id;\r\n      this.patientProfileService.getOnExaminationByPatientId(patient_id).then((data) => (this.patientOnExaminationList = data.data));\r\n    },\r\n\r\n    getIOChartByPatientId(patient_id) {\r\n      this.iOChart.patient_id = patient_id;\r\n      this.patientProfileService.getIOChartByPatientId(patient_id).then((data) => (this.iOChartList = data.data));\r\n    },\r\n\r\n    getDiabetesChartByPatientId(patient_id) {\r\n      this.diabetesChart.patient_id = patient_id;\r\n      this.patientProfileService.getDiabetesChartByPatientId(patient_id).then((data) => (this.diabetesChartList = data.data));\r\n    },\r\n\r\n    getDietChartByPatientId(patient_id) {\r\n      this.dietChart.patient_id = patient_id;\r\n      this.patientProfileService.getDietChartByPatientId(patient_id).then((data) => (this.dietChartList = data.data));\r\n    },\r\n\r\n    getCurrentMedicationsByPatientId(patient_id) {\r\n      this.currentMedications.patient_id = patient_id;\r\n      this.patientProfileService.getCurrentMedicationsByPatientId(patient_id).then((data) => (this.currentMedicationsList = data.data));\r\n    },\r\n\r\n    getPastHistoryByPatientId(patient_id) {\r\n      this.pastMedicalHistory.patient_id = patient_id;\r\n      this.patientProfileService.getPastHistoryByPatientId(patient_id).then((data) => (this.pastMedicalHistoryList = data.data));\r\n    },\r\n\r\n    formattedSystemSubstance(data) {\r\n      //this.patientHistory.patient_id = patient_id;\r\n      this.patientHistory.lstPersonalHistory = data.lstPersonalHistory;\r\n      this.patientHistory.lstFamilyHistory = data.lstFamilyHistory;\r\n      this.patientHistory.lstSystemsReview = data.lstSystemsReview;\r\n      this.patientHistory.lstSubstanceUse = data.lstSubstanceUse;\r\n      this.patientHistory.lstReproductiveHistory = data.lstReproductiveHistory;\r\n    },\r\n\r\n    hideHistory() {\r\n      this.isHistory = false;\r\n      this.dataList = false;\r\n      //localStorage.removeItem('patientIdForTreatment');\r\n    },\r\n\r\n    newChiefComplain() {\r\n      this.chiefComplainDialog = true;\r\n    },\r\n    async addChiefComplain() {\r\n      var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      this.chiefComplain.patient_id = patientId;\r\n      this.submitted = true;\r\n      if (!this.chiefComplain.compilants_id) {\r\n        return;\r\n      } else if (!this.chiefComplain.patient_id) {\r\n        return;\r\n      } else if (!this.chiefComplain.cdfrom_date) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.chiefComplainList, 'compilants_id', this.chiefComplain.compilants_id, 'patient_complain_id', this.chiefComplain.patient_complain_id, this)) {\r\n        return;\r\n      } else {\r\n        this.chiefComplain.from_date = moment(\r\n          String(this.chiefComplain.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        if (!this.chiefComplain.patient_complain_id) {\r\n          let result = await this.patientProfileService.complainSave(this.chiefComplain);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          let result = await this.patientProfileService.complainUpdate(this.chiefComplain);\r\n          if (result.status === 202) {\r\n            this.getComplainsByPatientId(this.chiefComplain.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    editChiefComplain(data) {\r\n      this.chiefComplain = Object.assign({}, data);\r\n      this.chiefComplain.cdfrom_date = moment(\r\n        String(this.chiefComplain.from_date)\r\n      ).format(\"MM/DD/YYYY\");\r\n      this.chiefComplainDialog = true;\r\n    },\r\n\r\n    getFood() {\r\n      this.foodService\r\n        .getActiveCombo()\r\n        .then((data) => this.foodFormatted(data.data));\r\n    },\r\n    foodFormatted(data) {\r\n      this.submitted = false;\r\n      this.foodSetup = {};\r\n      this.foodList = data;\r\n      this.foodDialog = false;\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n    newFood() {\r\n      this.allergyDetailsDialog = false;\r\n      this.foodDialog = true;\r\n    },\r\n    async addFood() {\r\n      this.submitted = true;\r\n      if (!this.foodSetup.food_name) {\r\n        return;\r\n      } else if (this.validation.isNameExists(this.foodList, 'text', this.foodSetup.food_name, 'value', this.foodSetup.food_id, this)) {\r\n        return;\r\n      } else {\r\n        this.foodSetup.active = true;\r\n        let result = await this.foodService.add(this.foodSetup);\r\n        if (result.status === 201) {\r\n          this.getFood();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newAllergyDetails() {\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n    async addAllergyDetails() {\r\n      this.submitted = true;\r\n      if (!this.allergyDetails.food_id) {\r\n        return;\r\n      } else if (!this.allergyDetails.patient_id) {\r\n        return;\r\n      } else if (!this.allergyDetails.type) {\r\n        return;\r\n      } else if (!this.allergyDetails.cdfrom_date) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.allergyDetailsList, 'food_id', this.allergyDetails.food_id, 'patient_allergy_details_id', this.allergyDetails.patient_allergy_details_id, this)) {\r\n        return;\r\n      } else {\r\n        this.allergyDetails.from_date = moment(\r\n          String(this.allergyDetails.cdfrom_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n        if (!this.allergyDetails.patient_allergy_details_id) {\r\n          let result = await this.patientProfileService.allergyDetailsSave(this.allergyDetails);\r\n          if (result.status === 201) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            this.getAllergyDetailsByPatientId(this.allergyDetails.patient_id);\r\n            this.getLatestHistoryByPatientIdForPrescription();\r\n            this.hideDialog();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        } else {\r\n          let result = await this.patientProfileService.allergyDetailsUpdate(this.allergyDetails);\r\n          if (result.status === 202) {\r\n            this.getAllergyDetailsByPatientId(this.allergyDetails.patient_id);\r\n            this.hideDialog();\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Updated Successfully\",\r\n              life: 10000,\r\n            });\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    editAllergyDetails(data) {\r\n      this.allergyDetails = Object.assign({}, data);\r\n      this.allergyDetails.cdfrom_date = moment(\r\n        String(this.allergyDetails.from_date)\r\n      ).format(\"MM/DD/YYYY\");\r\n      this.allergyDetailsDialog = true;\r\n    },\r\n\r\n    newOnExamination() {\r\n      this.getOnExaminationsPopup();\r\n      this.onExaminationDialog = true;\r\n    },\r\n    async addOnExamination() {\r\n      this.submitted = true;\r\n      this.requred = \"\";\r\n      this.popupOnExaminationsData.forEach((element) => {\r\n        if (!element.on_examination_result) {\r\n          this.requred = \"required\";\r\n        }\r\n      });\r\n\r\n      if (this.requred) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Required\",\r\n          detail: \"Please fill in the required fields\",\r\n          life: 10000,\r\n        });\r\n        return;\r\n      }\r\n      if (this.requred) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.onExaminationSave(this.popupOnExaminationsData);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getOnExaminationByPatientId(patientId);\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newIOChart() {\r\n      this.iOChartDialog = true;\r\n    },\r\n    async addIOChart() {\r\n      this.submitted = true;\r\n      if (!this.iOChart.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.iOChartSave(this.iOChart);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getIOChartByPatientId(patientId);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newDiabetesChart() {\r\n      this.diabetesChartDialog = true;\r\n    },\r\n    async addDiabetesChart() {\r\n      this.submitted = true;\r\n      if (!this.diabetesChart.meal) {\r\n        return;\r\n      } else if (!this.diabetesChart.before) {\r\n        return;\r\n      } else if (!this.diabetesChart.after) {\r\n        return;\r\n      } else {\r\n        var admission_id = JSON.parse(localStorage.getItem(\"admissionIdForDiabetesService\"));\r\n        this.diabetesChart.aAdmissionServiceDetails.admission_id = String(admission_id);\r\n        let result = await this.patientProfileService.diabetesChartSave(this.diabetesChart);\r\n        if (result.status === 201) {\r\n          var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getDiabetesChartByPatientId(patientId);\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newDietChart() {\r\n      this.dietChartDialog = true;\r\n    },\r\n    getDietChartByTemplateId() {\r\n      if (!this.dietChart.diet_chart_template_id) {\r\n        return\r\n      } else {\r\n        this.dietChartSetupService\r\n          .getByDietChartTemplateId(this.dietChart.diet_chart_template_id)\r\n          .then((data) => (this.dietChartTempList = data.data));\r\n      }\r\n    },\r\n    async addDietChart() {\r\n      this.submitted = true;\r\n      if (this.dietChartTempList.length <= 0) {\r\n        return;\r\n      } else {\r\n        var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n        this.dietChartTempList.forEach(element => {\r\n          element.patient_id = patientId.toString()\r\n        });\r\n\r\n        let result = await this.patientProfileService.dietChartSave(this.dietChartTempList);\r\n        if (result.status === 201) {\r\n          //var patientId = JSON.parse(localStorage.getItem(\"patientIdForTreatment\"));\r\n          this.getDietChartByPatientId(patientId);\r\n          this.getLatestHistoryByPatientIdForPrescription();\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n\r\n    newCurrentMedications() {\r\n      this.currentMedicationsDialog = true;\r\n    },\r\n    async addCurrentMedications() {\r\n      this.submitted = true;\r\n      if (!this.currentMedications.medicine_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_rules_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_duration_id) {\r\n        return;\r\n      } else if (!this.currentMedications.treatment_dose_id) {\r\n        return;\r\n      } else if (!this.currentMedications.patient_id) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.currentMedicationsList, 'medicine_id', this.currentMedications.medicine_id, 'patient_current_medications_id', this.currentMedications.patient_current_medications_id, this)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.currentMedicationsSave(this.currentMedications);\r\n        if (result.status === 201) {\r\n          this.getCurrentMedicationsByPatientId(this.currentMedications.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeleteCurrentMedications(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deleteCurrentMedications(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deleteCurrentMedications(data) {\r\n      let result = await this.patientProfileService.currentMedicationsDelete(data);\r\n      if (result.status === 202) {\r\n        this.getCurrentMedicationsByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    newPastMedicalHistory() {\r\n      this.pastMedicalHistoryDialog = true;\r\n    },\r\n    async addPastMedicalHistory() {\r\n      this.submitted = true;\r\n      if (!this.pastMedicalHistory.diagnosis_id) {\r\n        return;\r\n      } else if (!this.pastMedicalHistory.patient_id) {\r\n        return;\r\n      } else if (this.validation.isIdExists(this.pastMedicalHistoryList, 'diagnosis_id', this.pastMedicalHistory.diagnosis_id, 'patient_past_history_id', this.pastMedicalHistory.patient_past_history_id, this)) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.pastHistorySave(this.pastMedicalHistory);\r\n        if (result.status === 201) {\r\n          this.getPastHistoryByPatientId(this.pastMedicalHistory.patient_id);\r\n          this.hideDialog();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    confirmDeletePastMedicalHistory(data) {\r\n      this.$confirm.require({\r\n        message: 'Do you want to delete this record?',\r\n        header: 'Delete Confirmation',\r\n        icon: 'pi pi-info-circle',\r\n        acceptClass: 'p-button-danger',\r\n        accept: () => {\r\n          this.deletePastMedicalHistory(data);\r\n        },\r\n        reject: () => {\r\n          return;\r\n        }\r\n      });\r\n    },\r\n    async deletePastMedicalHistory(data) {\r\n      let result = await this.patientProfileService.pastHistoryDelete(data);\r\n      if (result.status === 202) {\r\n        this.getPastHistoryByPatientId(data.patient_id)\r\n      } else {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: result.res,\r\n          life: 10000,\r\n        });\r\n      }\r\n    },\r\n\r\n    async patientHistorySave() {\r\n      this.patientHistory.patient_id = JSON.parse(localStorage.getItem(\"patientIdForTreatment\")).toString();\r\n      //this.submitted = true;\r\n      if (!this.patientHistory.patient_id) {\r\n        return;\r\n      } else {\r\n        let result = await this.patientProfileService.patientHistorySave(this.patientHistory, this);\r\n        if (result.status === 201) {\r\n          this.hideHistory();\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Success\",\r\n            detail: \"Saved Successfully\",\r\n            life: 10000,\r\n          });\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Failed\",\r\n            detail: result.res,\r\n            life: 10000,\r\n          });\r\n        }\r\n      }\r\n    },\r\n  },\r\n};"]}]}