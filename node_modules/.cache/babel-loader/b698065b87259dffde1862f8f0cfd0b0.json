{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\vue2-timepicker\\src\\vue-timepicker.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\vue2-timepicker\\src\\vue-timepicker.vue","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90eXBlb2YgZnJvbSAiRjovU1ZOIFBST0pFQ1RTL0VSUF9Ib3NwaXRhbF9DbGllbnQvdHJ1bmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICJGOi9TVk4gUFJPSkVDVFMvRVJQX0hvc3BpdGFsX0NsaWVudC90cnVuay9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC1hbGwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwp2YXIgQ09ORklHID0gewogIEhPVVJfVE9LRU5TOiBbJ0hIJywgJ0gnLCAnaGgnLCAnaCcsICdraycsICdrJ10sCiAgTUlOVVRFX1RPS0VOUzogWydtbScsICdtJ10sCiAgU0VDT05EX1RPS0VOUzogWydzcycsICdzJ10sCiAgQVBNX1RPS0VOUzogWydBJywgJ2EnXSwKICBCQVNJQ19UWVBFUzogWydob3VyJywgJ21pbnV0ZScsICdzZWNvbmQnLCAnYXBtJ10KfTsKdmFyIERFRkFVTFRfT1BUSU9OUyA9IHsKICBmb3JtYXQ6ICdISDptbScsCiAgbWludXRlSW50ZXJ2YWw6IDEsCiAgc2Vjb25kSW50ZXJ2YWw6IDEsCiAgaG91clJhbmdlOiBudWxsLAogIG1pbnV0ZVJhbmdlOiBudWxsLAogIHNlY29uZFJhbmdlOiBudWxsLAogIGhpZGVEaXNhYmxlZEhvdXJzOiBmYWxzZSwKICBoaWRlRGlzYWJsZWRNaW51dGVzOiBmYWxzZSwKICBoaWRlRGlzYWJsZWRTZWNvbmRzOiBmYWxzZSwKICBoaWRlRGlzYWJsZWRJdGVtczogZmFsc2UsCiAgaGlkZURyb3Bkb3duOiBmYWxzZSwKICBibHVyRGVsYXk6IDMwMCwKICBtYW51YWxJbnB1dFRpbWVvdXQ6IDEwMDAsCiAgZHJvcE9mZnNldEhlaWdodDogMTYwCn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVnVlVGltZXBpY2tlcicsCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IFtPYmplY3QsIFN0cmluZ10KICAgIH0sCiAgICBmb3JtYXQ6IHsKICAgICAgdHlwZTogU3RyaW5nCiAgICB9LAogICAgbWludXRlSW50ZXJ2YWw6IHsKICAgICAgdHlwZTogW051bWJlciwgU3RyaW5nXQogICAgfSwKICAgIHNlY29uZEludGVydmFsOiB7CiAgICAgIHR5cGU6IFtOdW1iZXIsIFN0cmluZ10KICAgIH0sCiAgICBob3VyUmFuZ2U6IHsKICAgICAgdHlwZTogQXJyYXkKICAgIH0sCiAgICBtaW51dGVSYW5nZTogewogICAgICB0eXBlOiBBcnJheQogICAgfSwKICAgIHNlY29uZFJhbmdlOiB7CiAgICAgIHR5cGU6IEFycmF5CiAgICB9LAogICAgaGlkZURpc2FibGVkSG91cnM6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBoaWRlRGlzYWJsZWRNaW51dGVzOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgaGlkZURpc2FibGVkU2Vjb25kczogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGhpZGVEaXNhYmxlZEl0ZW1zOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgaGlkZUNsZWFyQnV0dG9uOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgZGlzYWJsZWQ6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBjbG9zZU9uQ29tcGxldGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBpZDogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBuYW1lOiB7CiAgICAgIHR5cGU6IFN0cmluZwogICAgfSwKICAgIGlucHV0Q2xhc3M6IHsKICAgICAgdHlwZTogW1N0cmluZywgT2JqZWN0LCBBcnJheV0KICAgIH0sCiAgICBwbGFjZWhvbGRlcjogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICB0YWJpbmRleDogewogICAgICB0eXBlOiBbTnVtYmVyLCBTdHJpbmddLAogICAgICBkZWZhdWx0OiAwCiAgICB9LAogICAgaW5wdXRXaWR0aDogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBhdXRvY29tcGxldGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnb2ZmJwogICAgfSwKICAgIGhvdXJMYWJlbDogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBtaW51dGVMYWJlbDogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBzZWNvbmRMYWJlbDogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBhcG1MYWJlbDogewogICAgICB0eXBlOiBTdHJpbmcKICAgIH0sCiAgICBhbVRleHQ6IHsKICAgICAgdHlwZTogU3RyaW5nCiAgICB9LAogICAgcG1UZXh0OiB7CiAgICAgIHR5cGU6IFN0cmluZwogICAgfSwKICAgIGJsdXJEZWxheTogewogICAgICB0eXBlOiBbTnVtYmVyLCBTdHJpbmddCiAgICB9LAogICAgYWR2YW5jZWRLZXlib2FyZDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGxhenk6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBhdXRvU2Nyb2xsOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgZHJvcERpcmVjdGlvbjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdkb3duJwogICAgfSwKICAgIGRyb3BPZmZzZXRIZWlnaHQ6IHsKICAgICAgdHlwZTogW051bWJlciwgU3RyaW5nXQogICAgfSwKICAgIGNvbnRhaW5lcklkOiB7CiAgICAgIHR5cGU6IFN0cmluZwogICAgfSwKICAgIGFwcGVuZFRvQm9keTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIG1hbnVhbElucHV0OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgbWFudWFsSW5wdXRUaW1lb3V0OiB7CiAgICAgIHR5cGU6IFtOdW1iZXIsIFN0cmluZ10KICAgIH0sCiAgICBoaWRlRHJvcGRvd246IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBmaXhlZERyb3Bkb3duQnV0dG9uOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgZGVidWdNb2RlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGltZVZhbHVlOiB7fSwKICAgICAgaG91cnM6IFtdLAogICAgICBtaW51dGVzOiBbXSwKICAgICAgc2Vjb25kczogW10sCiAgICAgIGFwbXM6IFtdLAogICAgICBpc0FjdGl2ZTogZmFsc2UsCiAgICAgIHNob3dEcm9wZG93bjogZmFsc2UsCiAgICAgIGlzRm9jdXNpbmc6IGZhbHNlLAogICAgICBkZWJvdW5jZVRpbWVyOiB1bmRlZmluZWQsCiAgICAgIGhvdXJUeXBlOiAnSEgnLAogICAgICBtaW51dGVUeXBlOiAnbW0nLAogICAgICBzZWNvbmRUeXBlOiAnJywKICAgICAgYXBtVHlwZTogJycsCiAgICAgIGhvdXI6ICcnLAogICAgICBtaW51dGU6ICcnLAogICAgICBzZWNvbmQ6ICcnLAogICAgICBhcG06ICcnLAogICAgICBmdWxsVmFsdWVzOiB1bmRlZmluZWQsCiAgICAgIGJha0Rpc3BsYXlUaW1lOiB1bmRlZmluZWQsCiAgICAgIGRvQ2xlYXJBcG1DaGVja2luZzogZmFsc2UsCiAgICAgIHNlbGVjdGlvblRpbWVyOiB1bmRlZmluZWQsCiAgICAgIGtiSW5wdXRUaW1lcjogdW5kZWZpbmVkLAogICAgICBrYklucHV0TG9nOiAnJywKICAgICAgYmFrQ3VycmVudFBvczogdW5kZWZpbmVkLAogICAgICBmb3JjZURyb3BPblRvcDogZmFsc2UKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgb3B0czogZnVuY3Rpb24gb3B0cygpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX09QVElPTlMpOwoKICAgICAgaWYgKHRoaXMuZm9ybWF0ICYmIHRoaXMuZm9ybWF0Lmxlbmd0aCkgewogICAgICAgIG9wdGlvbnMuZm9ybWF0ID0gU3RyaW5nKHRoaXMuZm9ybWF0KTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNOdW1iZXIodGhpcy5taW51dGVJbnRlcnZhbCkpIHsKICAgICAgICBvcHRpb25zLm1pbnV0ZUludGVydmFsID0gK3RoaXMubWludXRlSW50ZXJ2YWw7CiAgICAgIH0gLy8gbWludXRlSW50ZXJ2YWwgZmFpbHNhZmUKCgogICAgICBpZiAoIW9wdGlvbnMubWludXRlSW50ZXJ2YWwgfHwgb3B0aW9ucy5taW51dGVJbnRlcnZhbCA8IDEgfHwgb3B0aW9ucy5taW51dGVJbnRlcnZhbCA+IDYwKSB7CiAgICAgICAgaWYgKHRoaXMuZGVidWdNb2RlKSB7CiAgICAgICAgICBpZiAob3B0aW9ucy5taW51dGVJbnRlcnZhbCA+IDYwKSB7CiAgICAgICAgICAgIHRoaXMuZGVidWdMb2coIlwibWludXRlLWludGVydmFsXCIgc2hvdWxkIGJlIGxlc3MgdGhhbiA2MC4gQ3VycmVudCB2YWx1ZSBpcyAiLmNvbmNhdCh0aGlzLm1pbnV0ZUludGVydmFsKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMubWludXRlSW50ZXJ2YWwgPT09IDAgfHwgb3B0aW9ucy5taW51dGVJbnRlcnZhbCA8IDEpIHsKICAgICAgICAgICAgdGhpcy5kZWJ1Z0xvZygiXCJtaW51dGUtaW50ZXJ2YWxcIiBzaG91bGQgYmUgTk8gbGVzcyB0aGFuIDEuIEN1cnJlbnQgdmFsdWUgaXMgIi5jb25jYXQodGhpcy5taW51dGVJbnRlcnZhbCkpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKG9wdGlvbnMubWludXRlSW50ZXJ2YWwgPT09IDApIHsKICAgICAgICAgIG9wdGlvbnMubWludXRlSW50ZXJ2YWwgPSA2MDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgb3B0aW9ucy5taW51dGVJbnRlcnZhbCA9IDE7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5pc051bWJlcih0aGlzLnNlY29uZEludGVydmFsKSkgewogICAgICAgIG9wdGlvbnMuc2Vjb25kSW50ZXJ2YWwgPSArdGhpcy5zZWNvbmRJbnRlcnZhbDsKICAgICAgfSAvLyBzZWNvbmRJbnRlcnZhbCBmYWlsc2FmZQoKCiAgICAgIGlmICghb3B0aW9ucy5zZWNvbmRJbnRlcnZhbCB8fCBvcHRpb25zLnNlY29uZEludGVydmFsIDwgMSB8fCBvcHRpb25zLnNlY29uZEludGVydmFsID4gNjApIHsKICAgICAgICBpZiAodGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICAgIGlmIChvcHRpb25zLnNlY29uZEludGVydmFsID4gNjApIHsKICAgICAgICAgICAgdGhpcy5kZWJ1Z0xvZygiXCJzZWNvbmQtaW50ZXJ2YWxcIiBzaG91bGQgYmUgbGVzcyB0aGFuIDYwLiBDdXJyZW50IHZhbHVlIGlzICIuY29uY2F0KHRoaXMuc2Vjb25kSW50ZXJ2YWwpKTsKICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5zZWNvbmRJbnRlcnZhbCA9PT0gMCB8fCBvcHRpb25zLnNlY29uZEludGVydmFsIDwgMSkgewogICAgICAgICAgICB0aGlzLmRlYnVnTG9nKCJcInNlY29uZC1pbnRlcnZhbFwiIHNob3VsZCBiZSBOTyBsZXNzIHRoYW4gMS4gQ3VycmVudCB2YWx1ZSBpcyAiLmNvbmNhdCh0aGlzLnNlY29uZEludGVydmFsKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAob3B0aW9ucy5zZWNvbmRJbnRlcnZhbCA9PT0gMCkgewogICAgICAgICAgb3B0aW9ucy5zZWNvbmRJbnRlcnZhbCA9IDYwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBvcHRpb25zLnNlY29uZEludGVydmFsID0gMTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmhvdXJSYW5nZSAmJiBBcnJheS5pc0FycmF5KHRoaXMuaG91clJhbmdlKSkgewogICAgICAgIG9wdGlvbnMuaG91clJhbmdlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmhvdXJSYW5nZSkpOwoKICAgICAgICBpZiAoIXRoaXMuaG91clJhbmdlLmxlbmd0aCAmJiB0aGlzLmRlYnVnTW9kZSkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygnVGhlICJob3VyLXJhbmdlIiBhcnJheSBpcyBlbXB0eSAobGVuZ3RoID09PSAwKScpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMubWludXRlUmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLm1pbnV0ZVJhbmdlKSkgewogICAgICAgIG9wdGlvbnMubWludXRlUmFuZ2UgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMubWludXRlUmFuZ2UpKTsKCiAgICAgICAgaWYgKCF0aGlzLm1pbnV0ZVJhbmdlLmxlbmd0aCAmJiB0aGlzLmRlYnVnTW9kZSkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygnVGhlICJtaW51dGUtcmFuZ2UiIGFycmF5IGlzIGVtcHR5IChsZW5ndGggPT09IDApJyk7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5zZWNvbmRSYW5nZSAmJiBBcnJheS5pc0FycmF5KHRoaXMuc2Vjb25kUmFuZ2UpKSB7CiAgICAgICAgb3B0aW9ucy5zZWNvbmRSYW5nZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5zZWNvbmRSYW5nZSkpOwoKICAgICAgICBpZiAoIXRoaXMuc2Vjb25kUmFuZ2UubGVuZ3RoICYmIHRoaXMuZGVidWdNb2RlKSB7CiAgICAgICAgICB0aGlzLmRlYnVnTG9nKCdUaGUgInNlY29uZC1yYW5nZSIgYXJyYXkgaXMgZW1wdHkgKGxlbmd0aCA9PT0gMCknKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmhpZGVEaXNhYmxlZEl0ZW1zKSB7CiAgICAgICAgb3B0aW9ucy5oaWRlRGlzYWJsZWRJdGVtcyA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmhpZGVEaXNhYmxlZEhvdXJzIHx8IHRoaXMuaGlkZURpc2FibGVkSXRlbXMpIHsKICAgICAgICBvcHRpb25zLmhpZGVEaXNhYmxlZEhvdXJzID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaGlkZURpc2FibGVkTWludXRlcyB8fCB0aGlzLmhpZGVEaXNhYmxlZEl0ZW1zKSB7CiAgICAgICAgb3B0aW9ucy5oaWRlRGlzYWJsZWRNaW51dGVzID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaGlkZURpc2FibGVkU2Vjb25kcyB8fCB0aGlzLmhpZGVEaXNhYmxlZEl0ZW1zKSB7CiAgICAgICAgb3B0aW9ucy5oaWRlRGlzYWJsZWRTZWNvbmRzID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaGlkZURyb3Bkb3duKSB7CiAgICAgICAgaWYgKHRoaXMubWFudWFsSW5wdXQpIHsKICAgICAgICAgIG9wdGlvbnMuaGlkZURyb3Bkb3duID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGVidWdNb2RlKSB7CiAgICAgICAgICB0aGlzLmRlYnVnTG9nKCciaGlkZS1kcm9wZG93biIgb25seSB3b3JrcyB3aXRoICJtYW51YWwtaW5wdXQiIG1vZGUnKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmJsdXJEZWxheSAmJiArdGhpcy5ibHVyRGVsYXkgPiAwKSB7CiAgICAgICAgb3B0aW9ucy5ibHVyRGVsYXkgPSArdGhpcy5ibHVyRGVsYXk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm1hbnVhbElucHV0VGltZW91dCAmJiArdGhpcy5tYW51YWxJbnB1dFRpbWVvdXQgPiAwKSB7CiAgICAgICAgb3B0aW9ucy5tYW51YWxJbnB1dFRpbWVvdXQgPSArdGhpcy5tYW51YWxJbnB1dFRpbWVvdXQ7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmRyb3BPZmZzZXRIZWlnaHQgJiYgK3RoaXMuZHJvcE9mZnNldEhlaWdodCA+IDApIHsKICAgICAgICBvcHRpb25zLmRyb3BPZmZzZXRIZWlnaHQgPSArdGhpcy5kcm9wT2Zmc2V0SGVpZ2h0OwogICAgICB9CgogICAgICByZXR1cm4gb3B0aW9uczsKICAgIH0sCiAgICB1c2VTdHJpbmdWYWx1ZTogZnVuY3Rpb24gdXNlU3RyaW5nVmFsdWUoKSB7CiAgICAgIHJldHVybiB0eXBlb2YgdGhpcy52YWx1ZSA9PT0gJ3N0cmluZyc7CiAgICB9LAogICAgZm9ybWF0U3RyaW5nOiBmdW5jdGlvbiBmb3JtYXRTdHJpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLm9wdHMuZm9ybWF0IHx8IERFRkFVTFRfT1BUSU9OUy5mb3JtYXQ7CiAgICB9LAogICAgaW5Vc2U6IGZ1bmN0aW9uIGluVXNlKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIHR5cGVzSW5Vc2UgPSBDT05GSUcuQkFTSUNfVFlQRVMuZmlsdGVyKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmdldFRva2VuQnlUeXBlKHR5cGUpOwogICAgICB9KTsgLy8gU29ydCB0eXBlcyBhbmQgdG9rZW5zIGJ5IHRoZWlyIHNlcXVlbmNlIGluIHRoZSAiZm9ybWF0IiBzdHJpbmcKCiAgICAgIHR5cGVzSW5Vc2Uuc29ydChmdW5jdGlvbiAobCwgcikgewogICAgICAgIHJldHVybiBfdGhpcy5mb3JtYXRTdHJpbmcuaW5kZXhPZihfdGhpcy5nZXRUb2tlbkJ5VHlwZShsKSB8fCBudWxsKSAtIF90aGlzLmZvcm1hdFN0cmluZy5pbmRleE9mKF90aGlzLmdldFRva2VuQnlUeXBlKHIpIHx8IG51bGwpOwogICAgICB9KTsKICAgICAgdmFyIHRva2Vuc0luVXNlID0gdHlwZXNJblVzZS5tYXAoZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMuZ2V0VG9rZW5CeVR5cGUodHlwZSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gewogICAgICAgIGhvdXI6ICEhdGhpcy5ob3VyVHlwZSwKICAgICAgICBtaW51dGU6ICEhdGhpcy5taW51dGVUeXBlLAogICAgICAgIHNlY29uZDogISF0aGlzLnNlY29uZFR5cGUsCiAgICAgICAgYXBtOiAhIXRoaXMuYXBtVHlwZSwKICAgICAgICB0eXBlczogdHlwZXNJblVzZSB8fCBbXSwKICAgICAgICB0b2tlbnM6IHRva2Vuc0luVXNlIHx8IFtdCiAgICAgIH07CiAgICB9LAogICAgZGlzcGxheVRpbWU6IGZ1bmN0aW9uIGRpc3BsYXlUaW1lKCkgewogICAgICB2YXIgZm9ybWF0U3RyaW5nID0gU3RyaW5nKHRoaXMuZm9ybWF0U3RyaW5nKTsKCiAgICAgIGlmICh0aGlzLmhvdXIpIHsKICAgICAgICBmb3JtYXRTdHJpbmcgPSBmb3JtYXRTdHJpbmcucmVwbGFjZShuZXcgUmVnRXhwKHRoaXMuaG91clR5cGUsICdnJyksIHRoaXMuaG91cik7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm1pbnV0ZSkgewogICAgICAgIGZvcm1hdFN0cmluZyA9IGZvcm1hdFN0cmluZy5yZXBsYWNlKG5ldyBSZWdFeHAodGhpcy5taW51dGVUeXBlLCAnZycpLCB0aGlzLm1pbnV0ZSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNlY29uZCAmJiB0aGlzLnNlY29uZFR5cGUpIHsKICAgICAgICBmb3JtYXRTdHJpbmcgPSBmb3JtYXRTdHJpbmcucmVwbGFjZShuZXcgUmVnRXhwKHRoaXMuc2Vjb25kVHlwZSwgJ2cnKSwgdGhpcy5zZWNvbmQpOwogICAgICB9CgogICAgICBpZiAodGhpcy5hcG0gJiYgdGhpcy5hcG1UeXBlKSB7CiAgICAgICAgZm9ybWF0U3RyaW5nID0gZm9ybWF0U3RyaW5nLnJlcGxhY2UobmV3IFJlZ0V4cCh0aGlzLmFwbVR5cGUsICdnJyksIHRoaXMuYXBtKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZvcm1hdFN0cmluZzsKICAgIH0sCiAgICBjdXN0b21EaXNwbGF5VGltZTogZnVuY3Rpb24gY3VzdG9tRGlzcGxheVRpbWUoKSB7CiAgICAgIGlmICghdGhpcy5hbVRleHQgJiYgIXRoaXMucG1UZXh0KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGlzcGxheVRpbWU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmRpc3BsYXlUaW1lLnJlcGxhY2UobmV3IFJlZ0V4cCh0aGlzLmFwbSwgJ2cnKSwgdGhpcy5hcG1EaXNwbGF5VGV4dCh0aGlzLmFwbSkpOwogICAgfSwKICAgIGlucHV0SXNFbXB0eTogZnVuY3Rpb24gaW5wdXRJc0VtcHR5KCkgewogICAgICByZXR1cm4gdGhpcy5mb3JtYXRTdHJpbmcgPT09IHRoaXMuZGlzcGxheVRpbWU7CiAgICB9LAogICAgYWxsVmFsdWVTZWxlY3RlZDogZnVuY3Rpb24gYWxsVmFsdWVTZWxlY3RlZCgpIHsKICAgICAgaWYgKHRoaXMuaW5Vc2UuaG91ciAmJiAhdGhpcy5ob3VyIHx8IHRoaXMuaW5Vc2UubWludXRlICYmICF0aGlzLm1pbnV0ZSB8fCB0aGlzLmluVXNlLnNlY29uZCAmJiAhdGhpcy5zZWNvbmQgfHwgdGhpcy5pblVzZS5hcG0gJiYgIXRoaXMuYXBtKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICBjb2x1bW5zU2VxdWVuY2U6IGZ1bmN0aW9uIGNvbHVtbnNTZXF1ZW5jZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuaW5Vc2UudHlwZXMubWFwKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgICAgcmV0dXJuIHR5cGU7CiAgICAgIH0pIHx8IFtdOwogICAgfSwKICAgIHNob3dDbGVhckJ0bjogZnVuY3Rpb24gc2hvd0NsZWFyQnRuKCkgewogICAgICBpZiAodGhpcy5oaWRlQ2xlYXJCdXR0b24gfHwgdGhpcy5kaXNhYmxlZCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuICF0aGlzLmlucHV0SXNFbXB0eTsKICAgIH0sCiAgICBzaG93RHJvcGRvd25CdG46IGZ1bmN0aW9uIHNob3dEcm9wZG93bkJ0bigpIHsKICAgICAgaWYgKHRoaXMuZml4ZWREcm9wZG93bkJ1dHRvbikgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAodGhpcy5vcHRzLmhpZGVEcm9wZG93biAmJiB0aGlzLmlzQWN0aXZlICYmICF0aGlzLnNob3dEcm9wZG93bikgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgYmFzZU9uMTJIb3VyczogZnVuY3Rpb24gYmFzZU9uMTJIb3VycygpIHsKICAgICAgcmV0dXJuIHRoaXMuaG91clR5cGUgPT09ICdoJyB8fCB0aGlzLmhvdXJUeXBlID09PSAnaGgnOwogICAgfSwKICAgIGhvdXJSYW5nZUluMjRIckZvcm1hdDogZnVuY3Rpb24gaG91clJhbmdlSW4yNEhyRm9ybWF0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5ob3VyVHlwZSB8fCAhdGhpcy5vcHRzLmhvdXJSYW5nZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLm9wdHMuaG91clJhbmdlLmxlbmd0aCkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgdmFyIHJhbmdlID0gW107CiAgICAgIHRoaXMub3B0cy5ob3VyUmFuZ2UuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDIgJiYgX3RoaXMyLmRlYnVnTW9kZSkgewogICAgICAgICAgICBfdGhpczIuZGVidWdMb2coIk5lc3RlZCBhcnJheSB3aXRoaW4gXCJob3VyLXJhbmdlXCIgbXVzdCBjb250YWluIG5vIG1vcmUgdGhhbiB0d28gaXRlbXMuIE9ubHkgdGhlIGZpcnN0IHR3byBpdGVtcyBvZiAiLmNvbmNhdChKU09OLnN0cmluZ2lmeSh2YWx1ZSksICIgd2lsbCBiZSB0YWtlbiBpbnRvIGFjY291bnQuIikpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBzdGFydCA9IHZhbHVlWzBdOwogICAgICAgICAgdmFyIGVuZCA9IHZhbHVlWzFdIHx8IHZhbHVlWzBdOwoKICAgICAgICAgIGlmIChfdGhpczIuaXMxMmhSYW5nZShzdGFydCkpIHsKICAgICAgICAgICAgc3RhcnQgPSBfdGhpczIudHJhbnNsYXRlMTJoUmFuZ2Uoc3RhcnQpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChfdGhpczIuaXMxMmhSYW5nZShlbmQpKSB7CiAgICAgICAgICAgIGVuZCA9IF90aGlzMi50cmFuc2xhdGUxMmhSYW5nZShlbmQpOwogICAgICAgICAgfQoKICAgICAgICAgIGZvciAodmFyIGkgPSArc3RhcnQ7IGkgPD0gK2VuZDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChpIDwgMCB8fCBpID4gMjQpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKCFyYW5nZS5pbmNsdWRlcyhpKSkgewogICAgICAgICAgICAgIHJhbmdlLnB1c2goaSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKF90aGlzMi5pczEyaFJhbmdlKHZhbHVlKSkgewogICAgICAgICAgICB2YWx1ZSA9IF90aGlzMi50cmFuc2xhdGUxMmhSYW5nZSh2YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YWx1ZSA9ICt2YWx1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID4gMjQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghcmFuZ2UuaW5jbHVkZXModmFsdWUpKSB7CiAgICAgICAgICAgIHJhbmdlLnB1c2godmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJhbmdlLnNvcnQoZnVuY3Rpb24gKGwsIHIpIHsKICAgICAgICByZXR1cm4gbCAtIHI7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmFuZ2U7CiAgICB9LAogICAgcmVzdHJpY3RlZEhvdXJSYW5nZTogZnVuY3Rpb24gcmVzdHJpY3RlZEhvdXJSYW5nZSgpIHsKICAgICAgLy8gTm8gcmVzdHJpY3Rpb24KICAgICAgaWYgKCF0aGlzLmhvdXJSYW5nZUluMjRIckZvcm1hdCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyAxMi1Ib3VyCgoKICAgICAgaWYgKHRoaXMuYmFzZU9uMTJIb3VycykgewogICAgICAgIHZhciByYW5nZSA9IHRoaXMuaG91clJhbmdlSW4yNEhyRm9ybWF0Lm1hcChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgIGlmICh2YWx1ZSA9PT0gMTIpIHsKICAgICAgICAgICAgcmV0dXJuICcxMnAnOwogICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gMjQgfHwgdmFsdWUgPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuICcxMmEnOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB2YWx1ZSA+IDEyID8gIiIuY29uY2F0KHZhbHVlICUgMTIsICJwIikgOiAiIi5jb25jYXQodmFsdWUsICJhIik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHJhbmdlOwogICAgICB9IC8vIDI0LUhvdXIKCgogICAgICByZXR1cm4gdGhpcy5ob3VyUmFuZ2VJbjI0SHJGb3JtYXQ7CiAgICB9LAogICAgdmFsaWRIb3Vyc0xpc3Q6IGZ1bmN0aW9uIHZhbGlkSG91cnNMaXN0KCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5tYW51YWxJbnB1dCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucmVzdHJpY3RlZEhvdXJSYW5nZSkgewogICAgICAgIHZhciBsaXN0ID0gW107CgogICAgICAgIGlmICh0aGlzLmJhc2VPbjEySG91cnMpIHsKICAgICAgICAgIGxpc3QgPSB0aGlzLnJlc3RyaWN0ZWRIb3VyUmFuZ2UubWFwKGZ1bmN0aW9uIChocikgewogICAgICAgICAgICB2YXIgbCA9IGhyLnN1YnN0cigwLCBoci5sZW5ndGggLSAxKTsKICAgICAgICAgICAgdmFyIHIgPSBoci5zdWJzdHIoLTEpOwogICAgICAgICAgICByZXR1cm4gIiIuY29uY2F0KF90aGlzMy5mb3JtYXRWYWx1ZShfdGhpczMuaG91clR5cGUsIGwpKS5jb25jYXQocik7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBhbTEySW5kZXggPSBsaXN0LmluZGV4T2YoJzEyYScpOwoKICAgICAgICAgIGlmIChhbTEySW5kZXggPiAwKSB7CiAgICAgICAgICAgIC8vIE1ha2UgJzEyYScgdGhlIGZpcnN0IGl0ZW0gaW4gaC9oaAogICAgICAgICAgICBsaXN0LnVuc2hpZnQobGlzdC5zcGxpY2UoYW0xMkluZGV4LCAxKVswXSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGxpc3Q7CiAgICAgICAgfQoKICAgICAgICBsaXN0ID0gdGhpcy5yZXN0cmljdGVkSG91clJhbmdlLm1hcChmdW5jdGlvbiAoaHIpIHsKICAgICAgICAgIHJldHVybiBfdGhpczMuZm9ybWF0VmFsdWUoX3RoaXMzLmhvdXJUeXBlLCBocik7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDEgJiYgbGlzdFswXSAmJiBsaXN0WzBdID09PSAnMjQnKSB7CiAgICAgICAgICAvLyBNYWtlICcyNCcgdGhlIGxhc3QgaXRlbSBpbiBrL2trCiAgICAgICAgICBsaXN0LnB1c2gobGlzdC5zaGlmdCgpKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBsaXN0OwogICAgICB9CgogICAgICBpZiAodGhpcy5iYXNlT24xMkhvdXJzKSB7CiAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChbXSwgdGhpcy5ob3Vycy5tYXAoZnVuY3Rpb24gKGhyKSB7CiAgICAgICAgICByZXR1cm4gIiIuY29uY2F0KGhyLCAiYSIpOwogICAgICAgIH0pLCB0aGlzLmhvdXJzLm1hcChmdW5jdGlvbiAoaHIpIHsKICAgICAgICAgIHJldHVybiAiIi5jb25jYXQoaHIsICJwIik7CiAgICAgICAgfSkpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5ob3VyczsKICAgIH0sCiAgICBoYXM6IGZ1bmN0aW9uIGhhcygpIHsKICAgICAgdmFyIHJlc3VsdCA9IHsKICAgICAgICBjdXN0b21BcG1UZXh0OiBmYWxzZQogICAgICB9OwogICAgICB2YXIgYXBtRW5hYmxlZCA9ICEhdGhpcy5hcG1UeXBlOwoKICAgICAgaWYgKGFwbUVuYWJsZWQgJiYgdGhpcy5ob3VyUmFuZ2VJbjI0SHJGb3JtYXQgJiYgdGhpcy5ob3VyUmFuZ2VJbjI0SHJGb3JtYXQubGVuZ3RoKSB7CiAgICAgICAgdmFyIHJhbmdlID0gW10uY29uY2F0KFtdLCB0aGlzLmhvdXJSYW5nZUluMjRIckZvcm1hdCk7CiAgICAgICAgcmVzdWx0LmFtID0gcmFuZ2Uuc29tZShmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgIHJldHVybiB2YWx1ZSA8IDEyIHx8IHZhbHVlID09PSAyNDsKICAgICAgICB9KTsKICAgICAgICByZXN1bHQucG0gPSByYW5nZS5zb21lKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgcmV0dXJuIHZhbHVlID49IDEyICYmIHZhbHVlIDwgMjQ7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0LmFtID0gYXBtRW5hYmxlZDsKICAgICAgICByZXN1bHQucG0gPSBhcG1FbmFibGVkOwogICAgICB9CgogICAgICBpZiAodGhpcy5hbVRleHQgJiYgdGhpcy5hbVRleHQubGVuZ3RoIHx8IHRoaXMucG1UZXh0ICYmIHRoaXMucG1UZXh0Lmxlbmd0aCkgewogICAgICAgIHJlc3VsdC5jdXN0b21BcG1UZXh0ID0gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBtaW51dGVSYW5nZUxpc3Q6IGZ1bmN0aW9uIG1pbnV0ZVJhbmdlTGlzdCgpIHsKICAgICAgaWYgKCF0aGlzLm1pbnV0ZVR5cGUgfHwgIXRoaXMub3B0cy5taW51dGVSYW5nZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLm9wdHMubWludXRlUmFuZ2UubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5yZW5kZXJSYW5nZUxpc3QodGhpcy5vcHRzLm1pbnV0ZVJhbmdlLCAnbWludXRlJyk7CiAgICB9LAogICAgc2Vjb25kUmFuZ2VMaXN0OiBmdW5jdGlvbiBzZWNvbmRSYW5nZUxpc3QoKSB7CiAgICAgIGlmICghdGhpcy5zZWNvbmRUeXBlIHx8ICF0aGlzLm9wdHMuc2Vjb25kUmFuZ2UpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5vcHRzLnNlY29uZFJhbmdlLmxlbmd0aCkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMucmVuZGVyUmFuZ2VMaXN0KHRoaXMub3B0cy5zZWNvbmRSYW5nZSwgJ3NlY29uZCcpOwogICAgfSwKICAgIGhvdXJMYWJlbFRleHQ6IGZ1bmN0aW9uIGhvdXJMYWJlbFRleHQoKSB7CiAgICAgIHJldHVybiB0aGlzLmhvdXJMYWJlbCB8fCB0aGlzLmhvdXJUeXBlOwogICAgfSwKICAgIG1pbnV0ZUxhYmVsVGV4dDogZnVuY3Rpb24gbWludXRlTGFiZWxUZXh0KCkgewogICAgICByZXR1cm4gdGhpcy5taW51dGVMYWJlbCB8fCB0aGlzLm1pbnV0ZVR5cGU7CiAgICB9LAogICAgc2Vjb25kTGFiZWxUZXh0OiBmdW5jdGlvbiBzZWNvbmRMYWJlbFRleHQoKSB7CiAgICAgIHJldHVybiB0aGlzLnNlY29uZExhYmVsIHx8IHRoaXMuc2Vjb25kVHlwZTsKICAgIH0sCiAgICBhcG1MYWJlbFRleHQ6IGZ1bmN0aW9uIGFwbUxhYmVsVGV4dCgpIHsKICAgICAgcmV0dXJuIHRoaXMuYXBtTGFiZWwgfHwgdGhpcy5hcG1UeXBlOwogICAgfSwKICAgIGlucHV0V2lkdGhTdHlsZTogZnVuY3Rpb24gaW5wdXRXaWR0aFN0eWxlKCkgewogICAgICBpZiAoIXRoaXMuaW5wdXRXaWR0aCB8fCAhdGhpcy5pbnB1dFdpZHRoLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICB3aWR0aDogdGhpcy5pbnB1dFdpZHRoCiAgICAgIH07CiAgICB9LAogICAgdG9rZW5SZWdleEJhc2U6IGZ1bmN0aW9uIHRva2VuUmVnZXhCYXNlKCkgewogICAgICByZXR1cm4gdGhpcy5pblVzZS50b2tlbnMuam9pbignfCcpOwogICAgfSwKICAgIHRva2VuQ2h1bmtzOiBmdW5jdGlvbiB0b2tlbkNodW5rcygpIHsKICAgICAgaWYgKCF0aGlzLm1hbnVhbElucHV0ICYmICF0aGlzLnVzZVN0cmluZ1ZhbHVlKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgZm9ybWF0U3RyaW5nID0gU3RyaW5nKHRoaXMuZm9ybWF0U3RyaW5nKTsKICAgICAgdmFyIHRva2Vuc1JlZ3hTdHIgPSAiKCIuY29uY2F0KHRoaXMudG9rZW5SZWdleEJhc2UsICIpKz8iKTsKICAgICAgdmFyIHRva2Vuc01hdGNoQWxsID0gdGhpcy5nZXRNYXRjaEFsbEJ5UmVnZXgoZm9ybWF0U3RyaW5nLCB0b2tlbnNSZWd4U3RyKTsKICAgICAgdmFyIHRva2VuQ2h1bmtzID0gW107CgogICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodG9rZW5zTWF0Y2hBbGwpLAogICAgICAgICAgX3N0ZXA7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgdGtNYXRjaCA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgdmFyIHJhd1Rva2VuID0gdGtNYXRjaFswXTsKICAgICAgICAgIHZhciB0b2tlbk1hdGNoSXRlbSA9IHsKICAgICAgICAgICAgaW5kZXg6IHRrTWF0Y2guaW5kZXgsCiAgICAgICAgICAgIHRva2VuOiByYXdUb2tlbiwKICAgICAgICAgICAgdHlwZTogdGhpcy5nZXRUb2tlblR5cGUocmF3VG9rZW4pLAogICAgICAgICAgICBuZWVkc0NhbGlicmF0ZTogcmF3VG9rZW4ubGVuZ3RoIDwgMiwKICAgICAgICAgICAgbGVuOiAocmF3VG9rZW4gfHwgJycpLmxlbmd0aAogICAgICAgICAgfTsKICAgICAgICAgIHRva2VuQ2h1bmtzLnB1c2godG9rZW5NYXRjaEl0ZW0pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CgogICAgICByZXR1cm4gdG9rZW5DaHVua3M7CiAgICB9LAogICAgbmVlZHNQb3NDYWxpYnJhdGU6IGZ1bmN0aW9uIG5lZWRzUG9zQ2FsaWJyYXRlKCkgewogICAgICBpZiAoIXRoaXMubWFudWFsSW5wdXQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLnRva2VuQ2h1bmtzLnNvbWUoZnVuY3Rpb24gKGNoaykgewogICAgICAgIHJldHVybiBjaGsubmVlZHNDYWxpYnJhdGU7CiAgICAgIH0pOwogICAgfSwKICAgIHRva2VuQ2h1bmtzUG9zOiBmdW5jdGlvbiB0b2tlbkNodW5rc1BvcygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMubWFudWFsSW5wdXQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5uZWVkc1Bvc0NhbGlicmF0ZSkgewogICAgICAgIHJldHVybiB0aGlzLnRva2VuQ2h1bmtzLm1hcChmdW5jdGlvbiAoY2hrKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB0b2tlbjogY2hrLnRva2VuLAogICAgICAgICAgICB0eXBlOiBjaGsudHlwZSwKICAgICAgICAgICAgc3RhcnQ6IGNoay5pbmRleCwKICAgICAgICAgICAgZW5kOiBjaGsuaW5kZXggKyBjaGsubGVuCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgbGlzdCA9IFtdOwogICAgICB2YXIgY2FsaWJyYXRlTGVuID0gMDsKICAgICAgdGhpcy50b2tlbkNodW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGspIHsKICAgICAgICB2YXIgY2h1bmtDdXJyZW50TGVuOyAvLyBBZGp1c3QgZm9yIGN1c3RvbWl6ZWQgQU0vUE0gdGV4dAoKICAgICAgICBpZiAoY2hrLnR5cGUgPT09ICdhcG0nICYmIF90aGlzNC5oYXMuY3VzdG9tQXBtVGV4dCkgewogICAgICAgICAgaWYgKF90aGlzNC5hcG0gJiYgX3RoaXM0LmFwbS5sZW5ndGgpIHsKICAgICAgICAgICAgdmFyIGN1c3RvbUFwbVRleHQgPSBfdGhpczQuYXBtLnRvTG93ZXJDYXNlKCkgPT09ICdhbScgPyBfdGhpczQuYW1UZXh0IDogX3RoaXM0LnBtVGV4dDsKICAgICAgICAgICAgY2h1bmtDdXJyZW50TGVuID0gY3VzdG9tQXBtVGV4dCAmJiBjdXN0b21BcG1UZXh0Lmxlbmd0aCA/IGN1c3RvbUFwbVRleHQubGVuZ3RoIDogY2hrLmxlbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNodW5rQ3VycmVudExlbiA9IGNoay5sZW47CiAgICAgICAgICB9IC8vIE90aGVycwoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2h1bmtDdXJyZW50TGVuID0gX3RoaXM0W2Noay50eXBlXSAmJiBfdGhpczRbY2hrLnR5cGVdLmxlbmd0aCA/IF90aGlzNFtjaGsudHlwZV0ubGVuZ3RoIDogY2hrLmxlbjsKICAgICAgICB9CgogICAgICAgIGxpc3QucHVzaCh7CiAgICAgICAgICB0b2tlbjogY2hrLnRva2VuLAogICAgICAgICAgdHlwZTogY2hrLnR5cGUsCiAgICAgICAgICBzdGFydDogY2hrLmluZGV4ICsgY2FsaWJyYXRlTGVuLAogICAgICAgICAgZW5kOiBjaGsuaW5kZXggKyBjYWxpYnJhdGVMZW4gKyBjaHVua0N1cnJlbnRMZW4KICAgICAgICB9KTsKCiAgICAgICAgaWYgKGNoay5uZWVkc0NhbGlicmF0ZSAmJiBjaHVua0N1cnJlbnRMZW4gPiBjaGsubGVuKSB7CiAgICAgICAgICBjYWxpYnJhdGVMZW4gKz0gY2h1bmtDdXJyZW50TGVuIC0gY2hrLmxlbjsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gbGlzdDsKICAgIH0sCiAgICBpbnZhbGlkVmFsdWVzOiBmdW5jdGlvbiBpbnZhbGlkVmFsdWVzKCkgewogICAgICBpZiAodGhpcy5pbnB1dElzRW1wdHkpIHsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5yZXN0cmljdGVkSG91clJhbmdlICYmICF0aGlzLm1pbnV0ZVJhbmdlTGlzdCAmJiAhdGhpcy5zZWNvbmRSYW5nZUxpc3QgJiYgdGhpcy5vcHRzLm1pbnV0ZUludGVydmFsID09PSAxICYmIHRoaXMub3B0cy5zZWNvbmRJbnRlcnZhbCA9PT0gMSkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgICAgaWYgKHRoaXMuaW5Vc2UuaG91ciAmJiAhdGhpcy5pc0VtcHR5VmFsdWUodGhpcy5ob3VyVHlwZSwgdGhpcy5ob3VyKSAmJiAoIXRoaXMuaXNWYWxpZFZhbHVlKHRoaXMuaG91clR5cGUsIHRoaXMuaG91cikgfHwgdGhpcy5pc0Rpc2FibGVkKCdob3VyJywgdGhpcy5ob3VyKSkpIHsKICAgICAgICByZXN1bHQucHVzaCgnaG91cicpOwogICAgICB9CgogICAgICBpZiAodGhpcy5pblVzZS5taW51dGUgJiYgIXRoaXMuaXNFbXB0eVZhbHVlKHRoaXMubWludXRlVHlwZSwgdGhpcy5taW51dGUpICYmICghdGhpcy5pc1ZhbGlkVmFsdWUodGhpcy5taW51dGVUeXBlLCB0aGlzLm1pbnV0ZSkgfHwgdGhpcy5pc0Rpc2FibGVkKCdtaW51dGUnLCB0aGlzLm1pbnV0ZSkgfHwgdGhpcy5ub3RJbkludGVydmFsKCdtaW51dGUnLCB0aGlzLm1pbnV0ZSkpKSB7CiAgICAgICAgcmVzdWx0LnB1c2goJ21pbnV0ZScpOwogICAgICB9CgogICAgICBpZiAodGhpcy5pblVzZS5zZWNvbmQgJiYgIXRoaXMuaXNFbXB0eVZhbHVlKHRoaXMuc2Vjb25kVHlwZSwgdGhpcy5zZWNvbmQpICYmICghdGhpcy5pc1ZhbGlkVmFsdWUodGhpcy5zZWNvbmRUeXBlLCB0aGlzLnNlY29uZCkgfHwgdGhpcy5pc0Rpc2FibGVkKCdzZWNvbmQnLCB0aGlzLnNlY29uZCkgfHwgdGhpcy5ub3RJbkludGVydmFsKCdzZWNvbmQnLCB0aGlzLnNlY29uZCkpKSB7CiAgICAgICAgcmVzdWx0LnB1c2goJ3NlY29uZCcpOwogICAgICB9CgogICAgICBpZiAodGhpcy5pblVzZS5hcG0gJiYgIXRoaXMuaXNFbXB0eVZhbHVlKHRoaXMuYXBtVHlwZSwgdGhpcy5hcG0pICYmICghdGhpcy5pc1ZhbGlkVmFsdWUodGhpcy5hcG1UeXBlLCB0aGlzLmFwbSkgfHwgdGhpcy5pc0Rpc2FibGVkKCdhcG0nLCB0aGlzLmFwbSkpKSB7CiAgICAgICAgcmVzdWx0LnB1c2goJ2FwbScpOwogICAgICB9CgogICAgICBpZiAocmVzdWx0Lmxlbmd0aCkgewogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBbXTsKICAgIH0sCiAgICBoYXNJbnZhbGlkSW5wdXQ6IGZ1bmN0aW9uIGhhc0ludmFsaWRJbnB1dCgpIHsKICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5pbnZhbGlkVmFsdWVzICYmIHRoaXMuaW52YWxpZFZhbHVlcy5sZW5ndGgpOwogICAgfSwKICAgIGF1dG9EaXJlY3Rpb25FbmFibGVkOiBmdW5jdGlvbiBhdXRvRGlyZWN0aW9uRW5hYmxlZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuZHJvcERpcmVjdGlvbiA9PT0gJ2F1dG8nOwogICAgfSwKICAgIGRyb3Bkb3duRGlyQ2xhc3M6IGZ1bmN0aW9uIGRyb3Bkb3duRGlyQ2xhc3MoKSB7CiAgICAgIGlmICh0aGlzLmF1dG9EaXJlY3Rpb25FbmFibGVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZm9yY2VEcm9wT25Ub3AgPyAnZHJvcC11cCcgOiAnZHJvcC1kb3duJzsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuZHJvcERpcmVjdGlvbiA9PT0gJ3VwJyA/ICdkcm9wLXVwJyA6ICdkcm9wLWRvd24nOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICdvcHRzLmZvcm1hdCc6IGZ1bmN0aW9uIG9wdHNGb3JtYXQobmV3VmFsdWUpIHsKICAgICAgdGhpcy5yZW5kZXJGb3JtYXQobmV3VmFsdWUpOwogICAgfSwKICAgICdvcHRzLm1pbnV0ZUludGVydmFsJzogZnVuY3Rpb24gb3B0c01pbnV0ZUludGVydmFsKG5ld0ludGV2YWwpIHsKICAgICAgdGhpcy5yZW5kZXJMaXN0KCdtaW51dGUnLCBuZXdJbnRldmFsKTsKICAgIH0sCiAgICAnb3B0cy5zZWNvbmRJbnRlcnZhbCc6IGZ1bmN0aW9uIG9wdHNTZWNvbmRJbnRlcnZhbChuZXdJbnRldmFsKSB7CiAgICAgIHRoaXMucmVuZGVyTGlzdCgnc2Vjb25kJywgbmV3SW50ZXZhbCk7CiAgICB9LAogICAgdmFsdWU6IHsKICAgICAgZGVlcDogdHJ1ZSwKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcigpIHsKICAgICAgICB0aGlzLnJlYWRWYWx1ZXMoKTsKICAgICAgfQogICAgfSwKICAgIGRpc3BsYXlUaW1lOiBmdW5jdGlvbiBkaXNwbGF5VGltZSgpIHsKICAgICAgdGhpcy5maWxsVmFsdWVzKCk7CiAgICB9LAogICAgZGlzYWJsZWQ6IGZ1bmN0aW9uIGRpc2FibGVkKHRvRGlzYWJsZWQpIHsKICAgICAgaWYgKHRvRGlzYWJsZWQpIHsKICAgICAgICAvLyBGb3JjZSBjbG9zZSBkcm9wZG93biBhbmQgcmVzZXQgc3RhdHVzIHdoZW4gZGlzYWJsZWQKICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZSkgewogICAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuc2hvd0Ryb3Bkb3duKSB7CiAgICAgICAgICB0aGlzLnNob3dEcm9wZG93biA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICdpbnZhbGlkVmFsdWVzLmxlbmd0aCc6IGZ1bmN0aW9uIGludmFsaWRWYWx1ZXNMZW5ndGgobmV3TGVuZ3RoLCBvbGRMZW5ndGgpIHsKICAgICAgaWYgKG5ld0xlbmd0aCAmJiBuZXdMZW5ndGggPj0gMSkgewogICAgICAgIHRoaXMuJGVtaXQoJ2Vycm9yJywgdGhpcy5pbnZhbGlkVmFsdWVzKTsKICAgICAgfSBlbHNlIGlmIChvbGRMZW5ndGggJiYgb2xkTGVuZ3RoID49IDEpIHsKICAgICAgICB0aGlzLiRlbWl0KCdlcnJvcicsIFtdKTsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZm9ybWF0VmFsdWU6IGZ1bmN0aW9uIGZvcm1hdFZhbHVlKHRva2VuLCBpKSB7CiAgICAgIGlmICghdGhpcy5pc051bWJlcihpKSkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgaSA9ICtpOwoKICAgICAgc3dpdGNoICh0b2tlbikgewogICAgICAgIGNhc2UgJ0gnOgogICAgICAgIGNhc2UgJ2gnOgogICAgICAgIGNhc2UgJ2snOgogICAgICAgIGNhc2UgJ20nOgogICAgICAgIGNhc2UgJ3MnOgogICAgICAgICAgaWYgKFsnaCcsICdrJ10uaW5jbHVkZXModG9rZW4pICYmIGkgPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHRva2VuID09PSAnaycgPyAnMjQnIDogJzEyJzsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gU3RyaW5nKGkpOwoKICAgICAgICBjYXNlICdISCc6CiAgICAgICAgY2FzZSAnbW0nOgogICAgICAgIGNhc2UgJ3NzJzoKICAgICAgICBjYXNlICdoaCc6CiAgICAgICAgY2FzZSAna2snOgogICAgICAgICAgaWYgKFsnaGgnLCAna2snXS5pbmNsdWRlcyh0b2tlbikgJiYgaSA9PT0gMCkgewogICAgICAgICAgICByZXR1cm4gdG9rZW4gPT09ICdraycgPyAnMjQnIDogJzEyJzsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gaSA8IDEwID8gIjAiLmNvbmNhdChpKSA6IFN0cmluZyhpKTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfSwKICAgIGNoZWNrQWNjZXB0aW5nVHlwZTogZnVuY3Rpb24gY2hlY2tBY2NlcHRpbmdUeXBlKHZhbGlkVmFsdWVzLCBmb3JtYXRTdHJpbmcpIHsKICAgICAgaWYgKCF2YWxpZFZhbHVlcyB8fCAhZm9ybWF0U3RyaW5nIHx8ICFmb3JtYXRTdHJpbmcubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbGlkVmFsdWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGZvcm1hdFN0cmluZy5pbmRleE9mKHZhbGlkVmFsdWVzW2ldKSA+IC0xKSB7CiAgICAgICAgICByZXR1cm4gdmFsaWRWYWx1ZXNbaV07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9LAogICAgcmVuZGVyRm9ybWF0OiBmdW5jdGlvbiByZW5kZXJGb3JtYXQobmV3Rm9ybWF0KSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgbmV3Rm9ybWF0ID0gbmV3Rm9ybWF0IHx8IHRoaXMub3B0cy5mb3JtYXQgfHwgREVGQVVMVF9PUFRJT05TLmZvcm1hdDsKICAgICAgdmFyIGhvdXJUeXBlID0gdGhpcy5jaGVja0FjY2VwdGluZ1R5cGUoQ09ORklHLkhPVVJfVE9LRU5TLCBuZXdGb3JtYXQpOwogICAgICB2YXIgbWludXRlVHlwZSA9IHRoaXMuY2hlY2tBY2NlcHRpbmdUeXBlKENPTkZJRy5NSU5VVEVfVE9LRU5TLCBuZXdGb3JtYXQpOwogICAgICB0aGlzLnNlY29uZFR5cGUgPSB0aGlzLmNoZWNrQWNjZXB0aW5nVHlwZShDT05GSUcuU0VDT05EX1RPS0VOUywgbmV3Rm9ybWF0KTsKICAgICAgdGhpcy5hcG1UeXBlID0gdGhpcy5jaGVja0FjY2VwdGluZ1R5cGUoQ09ORklHLkFQTV9UT0tFTlMsIG5ld0Zvcm1hdCk7IC8vIEZhaWxzYWZlIGNoZWNraW5nCgogICAgICBpZiAoIWhvdXJUeXBlICYmICFtaW51dGVUeXBlICYmICF0aGlzLnNlY29uZFR5cGUgJiYgIXRoaXMuYXBtVHlwZSkgewogICAgICAgIGlmICh0aGlzLmRlYnVnTW9kZSAmJiB0aGlzLmZvcm1hdCkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygiTm8gdmFsaWQgdG9rZW5zIGZvdW5kIGluIHlvdXIgZGVmaW5lZCBcImZvcm1hdFwiIHN0cmluZyBcIiIuY29uY2F0KHRoaXMuZm9ybWF0LCAiXCIuIEZhbGxiYWNrIHRvIHRoZSBkZWZhdWx0IFwiSEg6bW1cIiBmb3JtYXQuIikpOwogICAgICAgIH0KCiAgICAgICAgaG91clR5cGUgPSAnSEgnOwogICAgICAgIG1pbnV0ZVR5cGUgPSAnbW0nOwogICAgICB9CgogICAgICB0aGlzLmhvdXJUeXBlID0gaG91clR5cGU7CiAgICAgIHRoaXMubWludXRlVHlwZSA9IG1pbnV0ZVR5cGU7CiAgICAgIHRoaXMuaG91clR5cGUgPyB0aGlzLnJlbmRlckhvdXJzTGlzdCgpIDogdGhpcy5ob3VycyA9IFtdOwogICAgICB0aGlzLm1pbnV0ZVR5cGUgPyB0aGlzLnJlbmRlckxpc3QoJ21pbnV0ZScpIDogdGhpcy5taW51dGVzID0gW107CiAgICAgIHRoaXMuc2Vjb25kVHlwZSA/IHRoaXMucmVuZGVyTGlzdCgnc2Vjb25kJykgOiB0aGlzLnNlY29uZHMgPSBbXTsKICAgICAgdGhpcy5hcG1UeXBlID8gdGhpcy5yZW5kZXJBcG1MaXN0KCkgOiB0aGlzLmFwbXMgPSBbXTsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNS5yZWFkVmFsdWVzKCk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlbmRlckhvdXJzTGlzdDogZnVuY3Rpb24gcmVuZGVySG91cnNMaXN0KCkgewogICAgICB2YXIgaG91cnNDb3VudCA9IHRoaXMuYmFzZU9uMTJIb3VycyA/IDEyIDogMjQ7CiAgICAgIHZhciBob3VycyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob3Vyc0NvdW50OyBpKyspIHsKICAgICAgICBpZiAodGhpcy5ob3VyVHlwZSA9PT0gJ2snIHx8IHRoaXMuaG91clR5cGUgPT09ICdraycpIHsKICAgICAgICAgIGhvdXJzLnB1c2godGhpcy5mb3JtYXRWYWx1ZSh0aGlzLmhvdXJUeXBlLCBpICsgMSkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBob3Vycy5wdXNoKHRoaXMuZm9ybWF0VmFsdWUodGhpcy5ob3VyVHlwZSwgaSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ob3VycyA9IGhvdXJzOwogICAgfSwKICAgIHJlbmRlckxpc3Q6IGZ1bmN0aW9uIHJlbmRlckxpc3QobGlzdFR5cGUsIGludGVydmFsKSB7CiAgICAgIGlmICghdGhpcy5pc01pbnV0ZU9yU2Vjb25kKGxpc3RUeXBlKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGlzTWludXRlID0gbGlzdFR5cGUgPT09ICdtaW51dGUnOwogICAgICBpbnRlcnZhbCA9IGludGVydmFsIHx8IChpc01pbnV0ZSA/IHRoaXMub3B0cy5taW51dGVJbnRlcnZhbCB8fCBERUZBVUxUX09QVElPTlMubWludXRlSW50ZXJ2YWwgOiB0aGlzLm9wdHMuc2Vjb25kSW50ZXJ2YWwgfHwgREVGQVVMVF9PUFRJT05TLnNlY29uZEludGVydmFsKTsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA2MDsgaSArPSBpbnRlcnZhbCkgewogICAgICAgIHJlc3VsdC5wdXNoKHRoaXMuZm9ybWF0VmFsdWUoaXNNaW51dGUgPyB0aGlzLm1pbnV0ZVR5cGUgOiB0aGlzLnNlY29uZFR5cGUsIGkpKTsKICAgICAgfQoKICAgICAgaXNNaW51dGUgPyB0aGlzLm1pbnV0ZXMgPSByZXN1bHQgOiB0aGlzLnNlY29uZHMgPSByZXN1bHQ7CiAgICB9LAogICAgcmVuZGVyQXBtTGlzdDogZnVuY3Rpb24gcmVuZGVyQXBtTGlzdCgpIHsKICAgICAgdGhpcy5hcG1zID0gdGhpcy5hcG1UeXBlID09PSAnQScgPyBbJ0FNJywgJ1BNJ10gOiBbJ2FtJywgJ3BtJ107CiAgICB9LAogICAgcmVhZFZhbHVlczogZnVuY3Rpb24gcmVhZFZhbHVlcygpIHsKICAgICAgaWYgKHRoaXMudXNlU3RyaW5nVmFsdWUpIHsKICAgICAgICBpZiAodGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICAgIHRoaXMuZGVidWdMb2coIlJlY2VpdmVkIGEgc3RyaW5nIHZhbHVlOiBcIiIuY29uY2F0KHRoaXMudmFsdWUsICJcIiIpKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucmVhZFN0cmluZ1ZhbHVlcyh0aGlzLnZhbHVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICAgIHRoaXMuZGVidWdMb2coIlJlY2VpdmVkIGFuIG9iamVjdCB2YWx1ZTogXCIiLmNvbmNhdChKU09OLnN0cmluZ2lmeSh0aGlzLnZhbHVlIHx8IHt9KSwgIlwiIikpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5yZWFkT2JqZWN0VmFsdWVzKHRoaXMudmFsdWUpOwogICAgICB9CiAgICB9LAogICAgcmVhZE9iamVjdFZhbHVlczogZnVuY3Rpb24gcmVhZE9iamVjdFZhbHVlcyhvYmpWYWx1ZSkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHZhciB0aW1lVmFsdWUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9ialZhbHVlIHx8IHt9KSk7CiAgICAgIHZhciB2YWx1ZXMgPSBPYmplY3Qua2V5cyh0aW1lVmFsdWUpOyAvLyBGYWlsc2FmZSBmb3IgZW1wdHkgYHYtbW9kZWxgIG9iamVjdAoKICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDApIHsKICAgICAgICB0aGlzLmFkZEZhbGxiYWNrVmFsdWVzKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBDT05GSUcuQkFTSUNfVFlQRVMuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkgewogICAgICAgIHZhciB0b2tlbiA9IF90aGlzNi5nZXRUb2tlbkJ5VHlwZSh0eXBlKTsKCiAgICAgICAgaWYgKHZhbHVlcy5pbmRleE9mKHRva2VuKSA+IC0xKSB7CiAgICAgICAgICB2YXIgc2FuaXRpemVkVmFsdWUgPSBfdGhpczYuc2FuaXRpemVkVmFsdWUodG9rZW4sIHRpbWVWYWx1ZVt0b2tlbl0pOwoKICAgICAgICAgIF90aGlzNlt0eXBlXSA9IHNhbml0aXplZFZhbHVlOwogICAgICAgICAgdGltZVZhbHVlW3Rva2VuXSA9IHNhbml0aXplZFZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczZbdHlwZV0gPSAnJzsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLnRpbWVWYWx1ZSA9IHRpbWVWYWx1ZTsKICAgIH0sCiAgICBnZXRNYXRjaEFsbEJ5UmVnZXg6IGZ1bmN0aW9uIGdldE1hdGNoQWxsQnlSZWdleCh0ZXN0U3RyaW5nLCByZWdleFN0cmluZykgewogICAgICB2YXIgc3RyID0gJ3BvbHlmaWxsVGVzdCc7CiAgICAgIHZhciBuZWVkc1BvbHlmaWxsID0gQm9vbGVhbighc3RyLm1hdGNoQWxsIHx8IHR5cGVvZiBzdHIubWF0Y2hBbGwgIT09ICdmdW5jdGlvbicpOwogICAgICByZXR1cm4gbmVlZHNQb2x5ZmlsbCA/IHRoaXMucG9seWZpbGxNYXRjaEFsbCh0ZXN0U3RyaW5nLCByZWdleFN0cmluZykgOiB0ZXN0U3RyaW5nLm1hdGNoQWxsKG5ldyBSZWdFeHAocmVnZXhTdHJpbmcsICdnJykpOwogICAgfSwKICAgIHJlYWRTdHJpbmdWYWx1ZXM6IGZ1bmN0aW9uIHJlYWRTdHJpbmdWYWx1ZXMoc3RyaW5nVmFsdWUpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICAvLyBGYWlsc2FmZSBmb3IgZW1wdHkgYHYtbW9kZWxgIHN0cmluZwogICAgICBpZiAoIXN0cmluZ1ZhbHVlIHx8ICFzdHJpbmdWYWx1ZS5sZW5ndGgpIHsKICAgICAgICB0aGlzLmFkZEZhbGxiYWNrVmFsdWVzKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZm9ybWF0U3RyaW5nID0gU3RyaW5nKHRoaXMuZm9ybWF0U3RyaW5nKTsKICAgICAgdmFyIHRva2Vuc1JlZ3hTdHIgPSAiKCIuY29uY2F0KHRoaXMudG9rZW5SZWdleEJhc2UsICIpKz8iKTsKICAgICAgdmFyIG90aGVyc1JlZ3hTdHIgPSAiW14oIi5jb25jYXQodGhpcy50b2tlblJlZ2V4QmFzZSwgIildKyIpOwogICAgICB2YXIgdG9rZW5zTWF0Y2hBbGwgPSB0aGlzLmdldE1hdGNoQWxsQnlSZWdleChmb3JtYXRTdHJpbmcsIHRva2Vuc1JlZ3hTdHIpOwogICAgICB2YXIgb3RoZXJzTWF0Y2hBbGwgPSB0aGlzLmdldE1hdGNoQWxsQnlSZWdleChmb3JtYXRTdHJpbmcsIG90aGVyc1JlZ3hTdHIpOwogICAgICB2YXIgY2h1bmtzID0gW107CiAgICAgIHZhciB0b2tlbkNodW5rcyA9IFtdOwoKICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0b2tlbnNNYXRjaEFsbCksCiAgICAgICAgICBfc3RlcDI7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgdGtNYXRjaCA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgIHZhciB0b2tlbk1hdGNoSXRlbSA9IHsKICAgICAgICAgICAgaW5kZXg6IHRrTWF0Y2guaW5kZXgsCiAgICAgICAgICAgIHRva2VuOiB0a01hdGNoWzBdLAogICAgICAgICAgICBpc1ZhbHVlVG9rZW46IHRydWUKICAgICAgICAgIH07CiAgICAgICAgICBjaHVua3MucHVzaCh0b2tlbk1hdGNoSXRlbSk7CiAgICAgICAgICB0b2tlbkNodW5rcy5wdXNoKHRva2VuTWF0Y2hJdGVtKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICB9CgogICAgICB2YXIgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG90aGVyc01hdGNoQWxsKSwKICAgICAgICAgIF9zdGVwMzsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IzLnMoKTsgIShfc3RlcDMgPSBfaXRlcmF0b3IzLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBvdE1hdGNoID0gX3N0ZXAzLnZhbHVlOwogICAgICAgICAgY2h1bmtzLnB1c2goewogICAgICAgICAgICBpbmRleDogb3RNYXRjaC5pbmRleCwKICAgICAgICAgICAgdG9rZW46IG90TWF0Y2hbMF0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMy5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMy5mKCk7CiAgICAgIH0KCiAgICAgIGNodW5rcy5zb3J0KGZ1bmN0aW9uIChsLCByKSB7CiAgICAgICAgcmV0dXJuIGwuaW5kZXggPCByLmluZGV4ID8gLTEgOiAxOwogICAgICB9KTsKICAgICAgdmFyIHJlZ2V4Q29tYm8gPSAnJzsKICAgICAgY2h1bmtzLmZvckVhY2goZnVuY3Rpb24gKGNodW5rKSB7CiAgICAgICAgaWYgKGNodW5rLmlzVmFsdWVUb2tlbikgewogICAgICAgICAgdmFyIHRva2VuUmVnZXggPSBfdGhpczcuZ2V0VG9rZW5SZWdleChjaHVuay50b2tlbikgfHwgJyc7CiAgICAgICAgICByZWdleENvbWJvICs9IHRva2VuUmVnZXg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBzYWZlQ2hhcnMgPSBjaHVuay50b2tlbi5yZXBsYWNlKC9cXHswfShcKnxcP3xcLnxcKykvZywgJ1xcJDEnKTsKICAgICAgICAgIHJlZ2V4Q29tYm8gKz0gIig/OiIuY29uY2F0KHNhZmVDaGFycywgIikiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB2YXIgY29tYm9SZWcgPSBuZXcgUmVnRXhwKHJlZ2V4Q29tYm8pOyAvLyBEbyB0ZXN0IGJlZm9yZSBtYXRjaAoKICAgICAgaWYgKGNvbWJvUmVnLnRlc3Qoc3RyaW5nVmFsdWUpKSB7CiAgICAgICAgdmFyIG1hdGNoUmVzdWx0cyA9IHN0cmluZ1ZhbHVlLm1hdGNoKG5ldyBSZWdFeHAocmVnZXhDb21ibykpOwogICAgICAgIHZhciB2YWx1ZVJlc3VsdHMgPSBtYXRjaFJlc3VsdHMuc2xpY2UoMSwgdG9rZW5DaHVua3MubGVuZ3RoICsgMSk7CiAgICAgICAgdmFyIHRpbWVWYWx1ZSA9IHt9OwogICAgICAgIHZhbHVlUmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgdnJJbmRleCkgewogICAgICAgICAgaWYgKHRva2VuQ2h1bmtzW3ZySW5kZXhdKSB7CiAgICAgICAgICAgIHZhciB0YXJnZXRUb2tlbiA9IHRva2VuQ2h1bmtzW3ZySW5kZXhdLnRva2VuOwogICAgICAgICAgICB0aW1lVmFsdWVbdGFyZ2V0VG9rZW5dID0gX3RoaXM3LnNldFZhbHVlRnJvbVN0cmluZyh2YWx1ZSwgdGFyZ2V0VG9rZW4pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMudGltZVZhbHVlID0gdGltZVZhbHVlOwoKICAgICAgICBpZiAodGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICAgIHZhciB0b2tlbkNodW5rc0ZvckxvZyA9IHRva2VuQ2h1bmtzLm1hcChmdW5jdGlvbiAodENodW5rKSB7CiAgICAgICAgICAgIHJldHVybiB0Q2h1bmsgJiYgdENodW5rLnRva2VuOwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmRlYnVnTG9nKCJTdWNjZXNzZnVsbHkgcGFyc2VkIHZhbHVlcyAiLmNvbmNhdChKU09OLnN0cmluZ2lmeSh2YWx1ZVJlc3VsdHMpLCAiXG5mb3IgIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KHRva2VuQ2h1bmtzRm9yTG9nKSwgIlxuaW4gZm9ybWF0IHBhdHRlcm4gJyIpLmNvbmNhdCh0aGlzLmZvcm1hdFN0cmluZywgIiciKSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLmRlYnVnTW9kZSkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygiVGhlIGlucHV0IHN0cmluZyBpbiBcInYtbW9kZWxcIiBkb2VzIE5PVCBtYXRjaCB0aGUgXCJmb3JtYXRcIiBwYXR0ZXJuXG5mb3JtYXQ6ICIuY29uY2F0KHRoaXMuZm9ybWF0U3RyaW5nLCAiXG52LW1vZGVsOiAiKS5jb25jYXQoc3RyaW5nVmFsdWUpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBwb2x5ZmlsbE1hdGNoQWxsOiBmdW5jdGlvbiBwb2x5ZmlsbE1hdGNoQWxsKHRhcmdldFN0cmluZywgcmVneFN0cikgewogICAgICB2YXIgbWF0Y2hlc0xpc3QgPSB0YXJnZXRTdHJpbmcubWF0Y2gobmV3IFJlZ0V4cChyZWd4U3RyLCAnZycpKTsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICB2YXIgaW5kaWNlc1JlZyA9IFtdOwoKICAgICAgaWYgKG1hdGNoZXNMaXN0ICYmIG1hdGNoZXNMaXN0Lmxlbmd0aCkgewogICAgICAgIG1hdGNoZXNMaXN0LmZvckVhY2goZnVuY3Rpb24gKG1hdGNoZWRJdGVtKSB7CiAgICAgICAgICB2YXIgZXhpc3RJbmRleCA9IGluZGljZXNSZWcuZmluZEluZGV4KGZ1bmN0aW9uIChpZHhJdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpZHhJdGVtLnN0ciA9PT0gbWF0Y2hlZEl0ZW07CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBpbmRleDsKCiAgICAgICAgICBpZiAoZXhpc3RJbmRleCA+PSAwKSB7CiAgICAgICAgICAgIGlmIChpbmRpY2VzUmVnW2V4aXN0SW5kZXhdICYmIGluZGljZXNSZWdbZXhpc3RJbmRleF0ucmVnZXgpIHsKICAgICAgICAgICAgICBpbmRleCA9IGluZGljZXNSZWdbZXhpc3RJbmRleF0ucmVnZXguZXhlYyh0YXJnZXRTdHJpbmcpLmluZGV4OwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgaXRlbUluZGljZXNSZWdleCA9IG5ldyBSZWdFeHAobWF0Y2hlZEl0ZW0sICdnJyk7CiAgICAgICAgICAgIGluZGV4ID0gaXRlbUluZGljZXNSZWdleC5leGVjKHRhcmdldFN0cmluZykuaW5kZXg7CiAgICAgICAgICAgIGluZGljZXNSZWcucHVzaCh7CiAgICAgICAgICAgICAgc3RyOiBTdHJpbmcobWF0Y2hlZEl0ZW0pLAogICAgICAgICAgICAgIHJlZ2V4OiBpdGVtSW5kaWNlc1JlZ2V4CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJlc3VsdC5wdXNoKHsKICAgICAgICAgICAgMDogU3RyaW5nKG1hdGNoZWRJdGVtKSwKICAgICAgICAgICAgaW5kZXg6IGluZGV4CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBhZGRGYWxsYmFja1ZhbHVlczogZnVuY3Rpb24gYWRkRmFsbGJhY2tWYWx1ZXMoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHRpbWVWYWx1ZSA9IHt9OwogICAgICB0aGlzLmluVXNlLnR5cGVzLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICB0aW1lVmFsdWVbX3RoaXM4LmdldFRva2VuQnlUeXBlKHR5cGUpXSA9ICcnOwogICAgICB9KTsKICAgICAgdGhpcy50aW1lVmFsdWUgPSB0aW1lVmFsdWU7CiAgICB9LAogICAgc2V0VmFsdWVGcm9tU3RyaW5nOiBmdW5jdGlvbiBzZXRWYWx1ZUZyb21TdHJpbmcocGFyc2VkVmFsdWUsIHRva2VuKSB7CiAgICAgIGlmICghdG9rZW4gfHwgIXBhcnNlZFZhbHVlKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICB2YXIgdG9rZW5UeXBlID0gdGhpcy5nZXRUb2tlblR5cGUodG9rZW4pOwoKICAgICAgaWYgKCF0b2tlblR5cGUgfHwgIXRva2VuVHlwZS5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIHZhciBzdGRWYWx1ZSA9IHBhcnNlZFZhbHVlICE9PSB0aGlzLmdldFRva2VuQnlUeXBlKHRva2VuVHlwZSkgPyBwYXJzZWRWYWx1ZSA6ICcnOwogICAgICB0aGlzW3Rva2VuVHlwZV0gPSBzdGRWYWx1ZTsKICAgICAgcmV0dXJuIHN0ZFZhbHVlOwogICAgfSwKICAgIGZpbGxWYWx1ZXM6IGZ1bmN0aW9uIGZpbGxWYWx1ZXMoZm9yY2VFbWl0KSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdmFyIGZ1bGxWYWx1ZXMgPSB7fTsKICAgICAgdmFyIGJhc2VIb3VyID0gdGhpcy5ob3VyOwogICAgICB2YXIgYmFzZUhvdXJUeXBlID0gdGhpcy5ob3VyVHlwZTsKICAgICAgdmFyIGFwbVZhbHVlOyAvLyBIb3VyIHR5cGUgb3IgaG91ciB2YWx1ZSBpcyBOT1Qgc2V0IGluIHRoZSAiZm9ybWF0IiBzdHJpbmcKCiAgICAgIGlmICghYmFzZUhvdXJUeXBlIHx8ICF0aGlzLmlzTnVtYmVyKGJhc2VIb3VyKSkgewogICAgICAgIENPTkZJRy5IT1VSX1RPS0VOUy5mb3JFYWNoKGZ1bmN0aW9uICh0b2tlbikgewogICAgICAgICAgcmV0dXJuIGZ1bGxWYWx1ZXNbdG9rZW5dID0gJyc7CiAgICAgICAgfSk7CiAgICAgICAgYXBtVmFsdWUgPSB0aGlzLmxvd2VyQ2FzZWRBcG0odGhpcy5hcG0gfHwgJycpOwogICAgICAgIGZ1bGxWYWx1ZXMuYSA9IGFwbVZhbHVlOwogICAgICAgIGZ1bGxWYWx1ZXMuQSA9IGFwbVZhbHVlLnRvVXBwZXJDYXNlKCk7IC8vIEJvdGggSG91ciB0eXBlIGFuZCB2YWx1ZSBhcmUgc2V0CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGhvdXJWYWx1ZSA9ICtiYXNlSG91cjsKCiAgICAgICAgdmFyIF9hcG1WYWx1ZSA9IHRoaXMuYmFzZU9uMTJIb3VycyAmJiB0aGlzLmFwbSA/IHRoaXMubG93ZXJDYXNlZEFwbSh0aGlzLmFwbSkgOiBmYWxzZTsKCiAgICAgICAgQ09ORklHLkhPVVJfVE9LRU5TLmZvckVhY2goZnVuY3Rpb24gKHRva2VuKSB7CiAgICAgICAgICBpZiAodG9rZW4gPT09IGJhc2VIb3VyVHlwZSkgewogICAgICAgICAgICBmdWxsVmFsdWVzW3Rva2VuXSA9IGJhc2VIb3VyOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHZhbHVlOwogICAgICAgICAgdmFyIGFwbTsKCiAgICAgICAgICBzd2l0Y2ggKHRva2VuKSB7CiAgICAgICAgICAgIGNhc2UgJ0gnOgogICAgICAgICAgICBjYXNlICdISCc6CiAgICAgICAgICAgIGNhc2UgJ2snOgogICAgICAgICAgICBjYXNlICdrayc6CiAgICAgICAgICAgICAgaWYgKF90aGlzOS5iYXNlT24xMkhvdXJzKSB7CiAgICAgICAgICAgICAgICBpZiAoX2FwbVZhbHVlID09PSAncG0nKSB7CiAgICAgICAgICAgICAgICAgIHZhbHVlID0gaG91clZhbHVlIDwgMTIgPyBob3VyVmFsdWUgKyAxMiA6IGhvdXJWYWx1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoWydrJywgJ2trJ10uaW5jbHVkZXModG9rZW4pKSB7CiAgICAgICAgICAgICAgICAgIHZhbHVlID0gaG91clZhbHVlID09PSAxMiA/IDI0IDogaG91clZhbHVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgdmFsdWUgPSBob3VyVmFsdWUgJSAxMjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKFsnaycsICdrayddLmluY2x1ZGVzKHRva2VuKSkgewogICAgICAgICAgICAgICAgICB2YWx1ZSA9IGhvdXJWYWx1ZSA9PT0gMCA/IDI0IDogaG91clZhbHVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgdmFsdWUgPSBob3VyVmFsdWUgJSAyNDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZ1bGxWYWx1ZXNbdG9rZW5dID0gX3RoaXM5LmZvcm1hdFZhbHVlKHRva2VuLCB2YWx1ZSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICdoJzoKICAgICAgICAgICAgY2FzZSAnaGgnOgogICAgICAgICAgICAgIC8vIGggPC0+IGhoCiAgICAgICAgICAgICAgaWYgKF90aGlzOS5iYXNlT24xMkhvdXJzKSB7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGhvdXJWYWx1ZTsKICAgICAgICAgICAgICAgIGFwbSA9IF9hcG1WYWx1ZSB8fCAnJzsgLy8gUmVhZCBmcm9tIG90aGVyIGhvdXIgZm9ybWF0cwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoaG91clZhbHVlID4gMTEgJiYgaG91clZhbHVlIDwgMjQpIHsKICAgICAgICAgICAgICAgICAgYXBtID0gJ3BtJzsKICAgICAgICAgICAgICAgICAgdmFsdWUgPSBob3VyVmFsdWUgPT09IDEyID8gMTIgOiBob3VyVmFsdWUgJSAxMjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGFwbSA9ICdhbSc7CiAgICAgICAgICAgICAgICAgIHZhbHVlID0gaG91clZhbHVlICUgMTIgPT09IDAgPyAxMiA6IGhvdXJWYWx1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZ1bGxWYWx1ZXNbdG9rZW5dID0gX3RoaXM5LmZvcm1hdFZhbHVlKHRva2VuLCB2YWx1ZSk7CiAgICAgICAgICAgICAgZnVsbFZhbHVlcy5hID0gYXBtOwogICAgICAgICAgICAgIGZ1bGxWYWx1ZXMuQSA9IGFwbS50b1VwcGVyQ2FzZSgpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdWxsVmFsdWVzLm0gPSB0aGlzLmZvcm1hdFZhbHVlKCdtJywgdGhpcy5taW51dGUpOwogICAgICBmdWxsVmFsdWVzLm1tID0gdGhpcy5mb3JtYXRWYWx1ZSgnbW0nLCB0aGlzLm1pbnV0ZSk7CiAgICAgIGZ1bGxWYWx1ZXMucyA9IHRoaXMuZm9ybWF0VmFsdWUoJ3MnLCB0aGlzLnNlY29uZCk7CiAgICAgIGZ1bGxWYWx1ZXMuc3MgPSB0aGlzLmZvcm1hdFZhbHVlKCdzcycsIHRoaXMuc2Vjb25kKTsKICAgICAgdGhpcy5mdWxsVmFsdWVzID0gZnVsbFZhbHVlczsgLy8gT24gbGF6eSBtb2RlLCBlbWl0IGBpbnB1dGAgYW5kIGBjaGFuZ2VgIGV2ZW50cyBvbmx5IHdoZW46CiAgICAgIC8vIC0gVGhlIHVzZXIgcGljayBhIG5ldyB2YWx1ZSBhbmQgdGhlbiBjbG9zZSB0aGUgZHJvcGRvd24KICAgICAgLy8gLSBUaGUgdXNlciBjbGljayB0aGUgKCJ4IikgY2xlYXIgYnV0dG9uCgogICAgICBpZiAoIXRoaXMubGF6eSB8fCBmb3JjZUVtaXQpIHsKICAgICAgICB0aGlzLmVtaXRUaW1lVmFsdWUoKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuY2xvc2VPbkNvbXBsZXRlICYmIHRoaXMuYWxsVmFsdWVTZWxlY3RlZCAmJiB0aGlzLnNob3dEcm9wZG93bikgewogICAgICAgIHRoaXMudG9nZ2xlQWN0aXZlKCk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRGdWxsRGF0YTogZnVuY3Rpb24gZ2V0RnVsbERhdGEoKSB7CiAgICAgIGlmICghdGhpcy5mdWxsVmFsdWVzKSB7CiAgICAgICAgdGhpcy5maWxsVmFsdWVzKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB7CiAgICAgICAgZGF0YTogSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmZ1bGxWYWx1ZXMpKSwKICAgICAgICBkaXNwbGF5VGltZTogdGhpcy5pbnB1dElzRW1wdHkgPyAnJyA6IFN0cmluZyh0aGlzLmRpc3BsYXlUaW1lKQogICAgICB9OwogICAgfSwKICAgIGVtaXRUaW1lVmFsdWU6IGZ1bmN0aW9uIGVtaXRUaW1lVmFsdWUoKSB7CiAgICAgIGlmICh0aGlzLmxhenkgJiYgdGhpcy5iYWtEaXNwbGF5VGltZSA9PT0gdGhpcy5kaXNwbGF5VGltZSkgewogICAgICAgIGlmICh0aGlzLmRlYnVnTW9kZSkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygnVGhlIHZhbHVlIGRvZXMgbm90IGNoYW5nZSBvbiBgbGF6eWAgbW9kZS4gU2tpcCB0aGUgZW1pdHRpbmcgYGlucHV0YCBhbmQgYGNoYW5nZWAgZXZlbnQuJyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBmdWxsRGF0YSA9IHRoaXMuZ2V0RnVsbERhdGEoKTsKCiAgICAgIGlmICh0aGlzLnVzZVN0cmluZ1ZhbHVlKSB7CiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBmdWxsRGF0YS5kaXNwbGF5VGltZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGZ1bGxWYWx1ZXMgPSBmdWxsRGF0YS5kYXRhOwogICAgICAgIHZhciB0b2tlbnNJblVzZSA9IHRoaXMuaW5Vc2UudG9rZW5zIHx8IFtdOwogICAgICAgIHZhciB0aW1lVmFsdWUgPSB7fTsKICAgICAgICB0b2tlbnNJblVzZS5mb3JFYWNoKGZ1bmN0aW9uICh0b2tlbikgewogICAgICAgICAgdGltZVZhbHVlW3Rva2VuXSA9IGZ1bGxWYWx1ZXNbdG9rZW5dIHx8ICcnOwogICAgICAgIH0pOwogICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aW1lVmFsdWUpKSk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZScsIGZ1bGxEYXRhKTsKICAgIH0sCiAgICB0cmFuc2xhdGUxMmhSYW5nZTogZnVuY3Rpb24gdHJhbnNsYXRlMTJoUmFuZ2UodmFsdWUpIHsKICAgICAgdmFyIHZhbHVlVCA9IHRoaXMubWF0Y2gxMmhSYW5nZSh2YWx1ZSk7CgogICAgICBpZiAoK3ZhbHVlVFsxXSA9PT0gMTIpIHsKICAgICAgICByZXR1cm4gK3ZhbHVlVFsxXSArICh2YWx1ZVRbMl0udG9Mb3dlckNhc2UoKSA9PT0gJ3AnID8gMCA6IDEyKTsKICAgICAgfQoKICAgICAgcmV0dXJuICt2YWx1ZVRbMV0gKyAodmFsdWVUWzJdLnRvTG93ZXJDYXNlKCkgPT09ICdwJyA/IDEyIDogMCk7CiAgICB9LAogICAgaXNEaXNhYmxlZDogZnVuY3Rpb24gaXNEaXNhYmxlZCh0eXBlLCB2YWx1ZSkgewogICAgICBpZiAoIXRoaXMuaXNCYXNpY1R5cGUodHlwZSkgfHwgIXRoaXMuaW5Vc2VbdHlwZV0pIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSAnaG91cic6CiAgICAgICAgICByZXR1cm4gdGhpcy5pc0Rpc2FibGVkSG91cih2YWx1ZSk7CgogICAgICAgIGNhc2UgJ21pbnV0ZSc6CiAgICAgICAgY2FzZSAnc2Vjb25kJzoKICAgICAgICAgIGlmICghdGhpc1siIi5jb25jYXQodHlwZSwgIlJhbmdlTGlzdCIpXSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuICF0aGlzWyIiLmNvbmNhdCh0eXBlLCAiUmFuZ2VMaXN0IildLmluY2x1ZGVzKHZhbHVlKTsKCiAgICAgICAgY2FzZSAnYXBtJzoKICAgICAgICAgIGlmICghdGhpcy5yZXN0cmljdGVkSG91clJhbmdlKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gIXRoaXMuaGFzW3RoaXMubG93ZXJDYXNlZEFwbSh2YWx1ZSldOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBpc0Rpc2FibGVkSG91cjogZnVuY3Rpb24gaXNEaXNhYmxlZEhvdXIodmFsdWUpIHsKICAgICAgaWYgKCF0aGlzLnJlc3RyaWN0ZWRIb3VyUmFuZ2UpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmJhc2VPbjEySG91cnMpIHsKICAgICAgICBpZiAoIXRoaXMuYXBtIHx8ICF0aGlzLmFwbS5sZW5ndGgpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHRva2VuID0gdGhpcy5hcG0udG9Mb3dlckNhc2UoKSA9PT0gJ2FtJyA/ICdhJyA6ICdwJzsKICAgICAgICAgIHJldHVybiAhdGhpcy5yZXN0cmljdGVkSG91clJhbmdlLmluY2x1ZGVzKCIiLmNvbmNhdCgrdmFsdWUpLmNvbmNhdCh0b2tlbikpOwogICAgICAgIH0KICAgICAgfSAvLyBGYWxsYmFjayBmb3IgJ0hIJyBhbmQgJ0ggaG91ciBmb3JtYXQgd2l0aCBhIGBob3VyLXJhbmdlYCBpbiBhIDEyLWhvdXIgZm9ybQoKCiAgICAgIGlmICgodGhpcy5ob3VyVHlwZSA9PT0gJ0hIJyB8fCB0aGlzLmhvdXJUeXBlID09PSAnSCcpICYmICt2YWx1ZSA9PT0gMCAmJiB0aGlzLnJlc3RyaWN0ZWRIb3VyUmFuZ2UuaW5jbHVkZXMoMjQpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gIXRoaXMucmVzdHJpY3RlZEhvdXJSYW5nZS5pbmNsdWRlcygrdmFsdWUpOwogICAgfSwKICAgIG5vdEluSW50ZXJ2YWw6IGZ1bmN0aW9uIG5vdEluSW50ZXJ2YWwoc2VjdGlvbiwgdmFsdWUpIHsKICAgICAgaWYgKCFzZWN0aW9uIHx8ICF0aGlzLmlzTWludXRlT3JTZWNvbmQoc2VjdGlvbikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm9wdHNbIiIuY29uY2F0KHNlY3Rpb24sICJJbnRlcnZhbCIpXSA9PT0gMSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuICt2YWx1ZSAlIHRoaXMub3B0c1siIi5jb25jYXQoc2VjdGlvbiwgIkludGVydmFsIildICE9PSAwOwogICAgfSwKICAgIHJlbmRlclJhbmdlTGlzdDogZnVuY3Rpb24gcmVuZGVyUmFuZ2VMaXN0KHJhd1JhbmdlLCBzZWN0aW9uKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIGlmICghcmF3UmFuZ2UgfHwgIXNlY3Rpb24gfHwgIXRoaXMuaXNNaW51dGVPclNlY29uZChzZWN0aW9uKSkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgdmFyIHJhbmdlID0gW107CiAgICAgIHZhciBmb3JtYXRlZFZhbHVlOwogICAgICByYXdSYW5nZS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID4gMiAmJiBfdGhpczEwLmRlYnVnTW9kZSkgewogICAgICAgICAgICBfdGhpczEwLmRlYnVnTG9nKCJOZXN0ZWQgYXJyYXkgd2l0aGluIFwiIi5jb25jYXQoc2VjdGlvbiwgIi1yYW5nZVwiIG11c3QgY29udGFpbiBubyBtb3JlIHRoYW4gdHdvIGl0ZW1zLiBPbmx5IHRoZSBmaXJzdCB0d28gaXRlbXMgb2YgIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KHZhbHVlKSwgIiB3aWxsIGJlIHRha2VuIGludG8gYWNjb3VudC4iKSk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHN0YXJ0ID0gdmFsdWVbMF07CiAgICAgICAgICB2YXIgZW5kID0gdmFsdWVbMV0gfHwgdmFsdWVbMF07CgogICAgICAgICAgZm9yICh2YXIgaSA9ICtzdGFydDsgaSA8PSArZW5kOyBpKyspIHsKICAgICAgICAgICAgaWYgKGkgPCAwIHx8IGkgPiA1OSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3JtYXRlZFZhbHVlID0gX3RoaXMxMC5mb3JtYXRWYWx1ZShfdGhpczEwLmdldFRva2VuQnlUeXBlKHNlY3Rpb24pLCBpKTsKCiAgICAgICAgICAgIGlmICghcmFuZ2UuaW5jbHVkZXMoZm9ybWF0ZWRWYWx1ZSkpIHsKICAgICAgICAgICAgICByYW5nZS5wdXNoKGZvcm1hdGVkVmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICgrdmFsdWUgPCAwIHx8ICt2YWx1ZSA+IDU5KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3JtYXRlZFZhbHVlID0gX3RoaXMxMC5mb3JtYXRWYWx1ZShfdGhpczEwLmdldFRva2VuQnlUeXBlKHNlY3Rpb24pLCB2YWx1ZSk7CgogICAgICAgICAgaWYgKCFyYW5nZS5pbmNsdWRlcyhmb3JtYXRlZFZhbHVlKSkgewogICAgICAgICAgICByYW5nZS5wdXNoKGZvcm1hdGVkVmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJhbmdlLnNvcnQoZnVuY3Rpb24gKGwsIHIpIHsKICAgICAgICByZXR1cm4gbCAtIHI7CiAgICAgIH0pOyAvLyBEZWJ1ZyBNb2RlCgogICAgICBpZiAodGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICB2YXIgZnVsbExpc3QgPSAoc2VjdGlvbiA9PT0gJ21pbnV0ZScgPyB0aGlzLm1pbnV0ZXMgOiB0aGlzLnNlY29uZHMpIHx8IFtdOwogICAgICAgIHZhciB2YWxpZEl0ZW1zID0gZnVsbExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gcmFuZ2UuaW5jbHVkZXMoaXRlbSk7CiAgICAgICAgfSk7CgogICAgICAgIGlmICghdmFsaWRJdGVtcyB8fCAhdmFsaWRJdGVtcy5sZW5ndGgpIHsKICAgICAgICAgIGlmIChzZWN0aW9uID09PSAnbWludXRlJykgewogICAgICAgICAgICB0aGlzLmRlYnVnTG9nKCJUaGUgbWludXRlIGxpc3QgaXMgZW1wdHkgZHVlIHRvIHRoZSBcIm1pbnV0ZS1yYW5nZVwiIGNvbmZpZ1xubWludXRlLXJhbmdlOiAiLmNvbmNhdChKU09OLnN0cmluZ2lmeSh0aGlzLm1pbnV0ZVJhbmdlKSwgIlxubWludXRlLWludGVydmFsOiAiKS5jb25jYXQodGhpcy5vcHRzLm1pbnV0ZUludGVydmFsKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmRlYnVnTG9nKCJUaGUgc2Vjb25kIGxpc3QgaXMgZW1wdHkgZHVlIHRvIHRoZSBcInNlY29uZC1yYW5nZVwiIGNvbmZpZ1xuc2Vjb25kLXJhbmdlOiAiLmNvbmNhdChKU09OLnN0cmluZ2lmeSh0aGlzLnNlY29uZFJhbmdlKSwgIlxuc2Vjb25kLWludGVydmFsOiAiKS5jb25jYXQodGhpcy5vcHRzLnNlY29uZEludGVydmFsKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmFuZ2U7CiAgICB9LAogICAgZm9yY2VBcG1TZWxlY3Rpb246IGZ1bmN0aW9uIGZvcmNlQXBtU2VsZWN0aW9uKCkgewogICAgICBpZiAodGhpcy5tYW51YWxJbnB1dCkgewogICAgICAgIC8vIFNraXAgdGhpcyB0byBhbGxvdyB1c2VycyB0byBwYXN0ZSBhIHN0cmluZyB2YWx1ZSBmcm9tIHRoZSBjbGlwYm9hcmQgaW4gTWFudWFsIElucHV0IG1vZGUKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmFwbVR5cGUgJiYgIXRoaXMuYXBtKSB7CiAgICAgICAgaWYgKHRoaXMuaGFzLmFtIHx8IHRoaXMuaGFzLnBtKSB7CiAgICAgICAgICB0aGlzLmRvQ2xlYXJBcG1DaGVja2luZyA9IHRydWU7CiAgICAgICAgICB2YXIgYXBtVmFsdWUgPSB0aGlzLmhhcy5hbSA/ICdhbScgOiAncG0nOwogICAgICAgICAgdGhpcy5hcG0gPSB0aGlzLmFwbVR5cGUgPT09ICdBJyA/IGFwbVZhbHVlLnRvVXBwZXJDYXNlKCkgOiBhcG1WYWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBlbXB0eUFwbVNlbGVjdGlvbjogZnVuY3Rpb24gZW1wdHlBcG1TZWxlY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmRvQ2xlYXJBcG1DaGVja2luZyAmJiB0aGlzLmhvdXIgPT09ICcnICYmIHRoaXMubWludXRlID09PSAnJyAmJiB0aGlzLnNlY29uZCA9PT0gJycpIHsKICAgICAgICB0aGlzLmFwbSA9ICcnOwogICAgICB9CgogICAgICB0aGlzLmRvQ2xlYXJBcG1DaGVja2luZyA9IGZhbHNlOwogICAgfSwKICAgIGFwbURpc3BsYXlUZXh0OiBmdW5jdGlvbiBhcG1EaXNwbGF5VGV4dChhcG1WYWx1ZSkgewogICAgICBpZiAodGhpcy5hbVRleHQgJiYgdGhpcy5sb3dlckNhc2VkQXBtKGFwbVZhbHVlKSA9PT0gJ2FtJykgewogICAgICAgIHJldHVybiB0aGlzLmFtVGV4dDsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucG1UZXh0ICYmIHRoaXMubG93ZXJDYXNlZEFwbShhcG1WYWx1ZSkgPT09ICdwbScpIHsKICAgICAgICByZXR1cm4gdGhpcy5wbVRleHQ7CiAgICAgIH0KCiAgICAgIHJldHVybiBhcG1WYWx1ZTsKICAgIH0sCiAgICB0b2dnbGVBY3RpdmU6IGZ1bmN0aW9uIHRvZ2dsZUFjdGl2ZSgpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuaXNBY3RpdmUgPSAhdGhpcy5pc0FjdGl2ZTsKCiAgICAgIGlmICh0aGlzLmlzQWN0aXZlKSB7CiAgICAgICAgdGhpcy5pc0ZvY3VzaW5nID0gdHJ1ZTsKCiAgICAgICAgaWYgKHRoaXMubWFudWFsSW5wdXQpIHsKICAgICAgICAgIHRoaXMuJGVtaXQoJ2ZvY3VzJyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXRoaXMub3B0cy5oaWRlRHJvcGRvd24pIHsKICAgICAgICAgIHRoaXMuc2V0RHJvcGRvd25TdGF0ZSh0cnVlKTsKICAgICAgICB9IC8vIFJlY29yZCB0byBjaGVjayBpZiB2YWx1ZSBkaWQgY2hhbmdlIGluIHRoZSBsYXRlciBwaGFzZQoKCiAgICAgICAgaWYgKHRoaXMubGF6eSkgewogICAgICAgICAgdGhpcy5iYWtEaXNwbGF5VGltZSA9IFN0cmluZyh0aGlzLmRpc3BsYXlUaW1lIHx8ICcnKTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm1hbnVhbElucHV0ICYmICF0aGlzLmlucHV0SXNFbXB0eSkgewogICAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoX3RoaXMxMS4kcmVmcy5pbnB1dCAmJiBfdGhpczExLiRyZWZzLmlucHV0LnNlbGVjdGlvblN0YXJ0ID09PSAwICYmIF90aGlzMTEuJHJlZnMuaW5wdXQuc2VsZWN0aW9uRW5kID09PSBfdGhpczExLmRpc3BsYXlUaW1lLmxlbmd0aCkgewogICAgICAgICAgICAgIC8vIFNlbGVjdCB0aGUgZmlyc3Qgc2xvdCBpbnN0ZWFkIG9mIHRoZSB3aG9sZSB2YWx1ZSBzdHJpbmcgd2hlbiB0YWJiZWQgaW4KICAgICAgICAgICAgICBfdGhpczExLnNlbGVjdEZpcnN0U2xvdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuc2hvd0Ryb3Bkb3duKSB7CiAgICAgICAgICB0aGlzLnNldERyb3Bkb3duU3RhdGUoZmFsc2UpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5tYW51YWxJbnB1dCkgewogICAgICAgICAgdGhpcy4kZW1pdCgnYmx1cicsIHRoaXMuZ2V0RnVsbERhdGEoKSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmlzRm9jdXNpbmcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMubGF6eSkgewogICAgICAgICAgdGhpcy5maWxsVmFsdWVzKHRydWUpOwogICAgICAgICAgdGhpcy5iYWtEaXNwbGF5VGltZSA9IHVuZGVmaW5lZDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnJlc3RyaWN0ZWRIb3VyUmFuZ2UgJiYgdGhpcy5iYXNlT24xMkhvdXJzKSB7CiAgICAgICAgdGhpcy5zaG93RHJvcGRvd24gPyB0aGlzLmZvcmNlQXBtU2VsZWN0aW9uKCkgOiB0aGlzLmVtcHR5QXBtU2VsZWN0aW9uKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNob3dEcm9wZG93bikgewogICAgICAgIHRoaXMuY2hlY2tGb3JBdXRvU2Nyb2xsKCk7CiAgICAgIH0KICAgIH0sCiAgICBzZXREcm9wZG93blN0YXRlOiBmdW5jdGlvbiBzZXREcm9wZG93blN0YXRlKHRvU2hvdykgewogICAgICB2YXIgZnJvbVVzZXJDbGljayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CgogICAgICBpZiAodG9TaG93KSB7CiAgICAgICAgaWYgKHRoaXMuYXBwZW5kVG9Cb2R5KSB7CiAgICAgICAgICB0aGlzLmFwcGVuZERyb3Bkb3duVG9Cb2R5KCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmtlZXBGb2N1c2luZygpOwoKICAgICAgICBpZiAodGhpcy5hdXRvRGlyZWN0aW9uRW5hYmxlZCkgewogICAgICAgICAgdGhpcy5jaGVja0Ryb3BEaXJlY3Rpb24oKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duID0gdHJ1ZTsKICAgICAgICB0aGlzLiRlbWl0KCdvcGVuJyk7CgogICAgICAgIGlmIChmcm9tVXNlckNsaWNrKSB7CiAgICAgICAgICBpZiAodGhpcy5maXhlZERyb3Bkb3duQnV0dG9uKSB7CiAgICAgICAgICAgIHRoaXMuaXNBY3RpdmUgPSB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuJGVtaXQoJ2JsdXInLCB0aGlzLmdldEZ1bGxEYXRhKCkpOwogICAgICAgICAgdGhpcy5jaGVja0ZvckF1dG9TY3JvbGwoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zaG93RHJvcGRvd24gPSBmYWxzZTsKICAgICAgICB0aGlzLiRlbWl0KCdjbG9zZScsIHRoaXMuZ2V0RnVsbERhdGEoKSk7CgogICAgICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSkgewogICAgICAgICAgdGhpcy5yZW1vdmVEcm9wZG93bkZyb21Cb2R5KCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXBwZW5kRHJvcGRvd25Ub0JvZHk6IGZ1bmN0aW9uIGFwcGVuZERyb3Bkb3duVG9Cb2R5KCkgewogICAgICB2YXIgZHJvcGRvd24gPSB0aGlzLiRyZWZzICYmIHRoaXMuJHJlZnMuZHJvcGRvd247CiAgICAgIHZhciBib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXTsKCiAgICAgIGlmIChib2R5ICYmIGRyb3Bkb3duKSB7CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMudXBkYXRlRHJvcGRvd25Qb3MpOwogICAgICAgIGRyb3Bkb3duLmNsYXNzTGlzdC5hZGQoJ3Z1ZV9fdGltZS1waWNrZXItZHJvcGRvd24nKTsKICAgICAgICB0aGlzLnVwZGF0ZURyb3Bkb3duUG9zKCk7CiAgICAgICAgYm9keS5hcHBlbmRDaGlsZChkcm9wZG93bik7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVEcm9wZG93blBvczogZnVuY3Rpb24gdXBkYXRlRHJvcGRvd25Qb3MoKSB7CiAgICAgIGlmICghdGhpcy5hcHBlbmRUb0JvZHkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBkcm9wZG93biA9IHRoaXMuJHJlZnMgJiYgdGhpcy4kcmVmcy5kcm9wZG93bjsKICAgICAgdmFyIGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdOwoKICAgICAgaWYgKGJvZHkgJiYgZHJvcGRvd24pIHsKICAgICAgICB2YXIgYm94ID0gdGhpcy4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogICAgICAgIGlmICh0aGlzLmRyb3Bkb3duRGlyQ2xhc3MgPT09ICdkcm9wLXVwJykgewogICAgICAgICAgZHJvcGRvd24uc3R5bGUuYm90dG9tID0gIiIuY29uY2F0KHdpbmRvdy5pbm5lckhlaWdodCAtIGJveC55LCAicHgiKTsKICAgICAgICAgIGRyb3Bkb3duLnN0eWxlLnRvcCA9ICdhdXRvJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZHJvcGRvd24uc3R5bGUudG9wID0gIiIuY29uY2F0KGJveC55ICsgYm94LmhlaWdodCwgInB4Iik7CiAgICAgICAgICBkcm9wZG93bi5zdHlsZS5ib3R0b20gPSAnYXV0byc7CiAgICAgICAgfQoKICAgICAgICBkcm9wZG93bi5zdHlsZS5sZWZ0ID0gIiIuY29uY2F0KGJveC54LCAicHgiKTsKICAgICAgfQogICAgfSwKICAgIHJlbW92ZURyb3Bkb3duRnJvbUJvZHk6IGZ1bmN0aW9uIHJlbW92ZURyb3Bkb3duRnJvbUJvZHkoKSB7CiAgICAgIHZhciBkcm9wZG93biA9IHRoaXMuJHJlZnMgJiYgdGhpcy4kcmVmcy5kcm9wZG93bjsKICAgICAgdmFyIGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdOwoKICAgICAgaWYgKGJvZHkgJiYgZHJvcGRvd24gJiYgYm9keS5jb250YWlucyhkcm9wZG93bikpIHsKICAgICAgICBib2R5LnJlbW92ZUNoaWxkKGRyb3Bkb3duKTsKICAgICAgfQoKICAgICAgaWYgKGRyb3Bkb3duKSB7CiAgICAgICAgZHJvcGRvd24uY2xhc3NMaXN0LnJlbW92ZSgndnVlX190aW1lLXBpY2tlci1kcm9wZG93bicpOwogICAgICAgIGRyb3Bkb3duLnN0eWxlLnRvcCA9ICcnOwogICAgICAgIGRyb3Bkb3duLnN0eWxlLmJvdHRvbSA9ICcnOwogICAgICAgIGRyb3Bkb3duLnN0eWxlLmxlZnQgPSAnJzsKICAgICAgICB0aGlzLiRlbC5hcHBlbmRDaGlsZChkcm9wZG93bik7CiAgICAgIH0KCiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLnVwZGF0ZURyb3Bkb3duUG9zKTsKICAgIH0sCiAgICBibHVyRXZlbnQ6IGZ1bmN0aW9uIGJsdXJFdmVudCgpIHsKICAgICAgaWYgKHRoaXMubWFudWFsSW5wdXQgJiYgIXRoaXMub3B0cy5oaWRlRHJvcGRvd24pIHsKICAgICAgICAvLyBoaWRlRHJvcGRvd24ncyBgYmx1cmAgZXZlbnQgaXMgaGFuZGxlZCBzb21ld2hlcmUgZWxzZQogICAgICAgIHRoaXMuJGVtaXQoJ2JsdXInLCB0aGlzLmdldEZ1bGxEYXRhKCkpOwogICAgICB9CiAgICB9LAogICAgc2VsZWN0OiBmdW5jdGlvbiBzZWxlY3QodHlwZSwgdmFsdWUpIHsKICAgICAgaWYgKHRoaXMuaXNCYXNpY1R5cGUodHlwZSkgJiYgIXRoaXMuaXNEaXNhYmxlZCh0eXBlLCB2YWx1ZSkpIHsKICAgICAgICB0aGlzW3R5cGVdID0gdmFsdWU7CgogICAgICAgIGlmICh0aGlzLmRvQ2xlYXJBcG1DaGVja2luZykgewogICAgICAgICAgdGhpcy5kb0NsZWFyQXBtQ2hlY2tpbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjbGVhclRpbWU6IGZ1bmN0aW9uIGNsZWFyVGltZSgpIHsKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuaG91ciA9ICcnOwogICAgICB0aGlzLm1pbnV0ZSA9ICcnOwogICAgICB0aGlzLnNlY29uZCA9ICcnOwogICAgICB0aGlzLmFwbSA9ICcnOwoKICAgICAgaWYgKHRoaXMubWFudWFsSW5wdXQgJiYgdGhpcy4kcmVmcyAmJiB0aGlzLiRyZWZzLmlucHV0ICYmIHRoaXMuJHJlZnMuaW5wdXQudmFsdWUubGVuZ3RoKSB7CiAgICAgICAgdGhpcy4kcmVmcy5pbnB1dC52YWx1ZSA9ICcnOwogICAgICB9CgogICAgICBpZiAodGhpcy5sYXp5KSB7CiAgICAgICAgdGhpcy5maWxsVmFsdWVzKHRydWUpOwogICAgICB9CiAgICB9LAogICAgLy8KICAgIC8vIEF1dG8tU2Nyb2xsCiAgICAvLwogICAgY2hlY2tGb3JBdXRvU2Nyb2xsOiBmdW5jdGlvbiBjaGVja0ZvckF1dG9TY3JvbGwoKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmlucHV0SXNFbXB0eSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuYXV0b1Njcm9sbCkgewogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMTIuc2Nyb2xsVG9TZWxlY3RlZFZhbHVlcygpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYWR2YW5jZWRLZXlib2FyZCkgewogICAgICAgIC8vIEF1dG8tZm9jdXMgb24gc2VsZWN0ZWQgdmFsdWUgaW4gdGhlIGZpcnN0IGNvbHVtbiBmb3IgYWR2YW5jZWQta2V5Ym9hcmQKICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZmlyc3RDb2x1bW4gPSBfdGhpczEyLmluVXNlLnR5cGVzWzBdOwoKICAgICAgICAgIF90aGlzMTIuc2Nyb2xsVG9TZWxlY3RlZChmaXJzdENvbHVtbiwgdHJ1ZSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBzY3JvbGxUb1NlbGVjdGVkOiBmdW5jdGlvbiBzY3JvbGxUb1NlbGVjdGVkKGNvbHVtbikgewogICAgICB2YXIgYWxsb3dGYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CgogICAgICBpZiAoIXRoaXMudGltZVZhbHVlIHx8IHRoaXMuaW5wdXRJc0VtcHR5KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGFyZ2V0TGlzdDsKCiAgICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSAmJiB0aGlzLiRyZWZzICYmIHRoaXMuJHJlZnMuZHJvcGRvd24pIHsKICAgICAgICB0YXJnZXRMaXN0ID0gdGhpcy4kcmVmcy5kcm9wZG93bi5xdWVyeVNlbGVjdG9yQWxsKCJ1bC4iLmNvbmNhdChjb2x1bW4sICJzIikpWzBdOwogICAgICB9IGVsc2UgewogICAgICAgIHRhcmdldExpc3QgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCJ1bC4iLmNvbmNhdChjb2x1bW4sICJzIikpWzBdOwogICAgICB9CgogICAgICB2YXIgdGFyZ2V0VmFsdWUgPSB0aGlzLmFjdGl2ZUl0ZW1JbkNvbChjb2x1bW4pWzBdOwoKICAgICAgaWYgKCF0YXJnZXRWYWx1ZSAmJiBhbGxvd0ZhbGxiYWNrKSB7CiAgICAgICAgLy8gTm8gdmFsdWUgc2VsZWN0ZWQgaW4gdGhlIHRhcmdldCBjb2x1bW4sIGZhbGxiYWNrIHRvIHRoZSBmaXJzdCBmb3VuZCB2YWxpZCBpdGVtCiAgICAgICAgdGFyZ2V0VmFsdWUgPSB0aGlzLnZhbGlkSXRlbXNJbkNvbChjb2x1bW4pWzBdOwogICAgICB9CgogICAgICBpZiAodGFyZ2V0TGlzdCAmJiB0YXJnZXRWYWx1ZSkgewogICAgICAgIHRhcmdldExpc3Quc2Nyb2xsVG9wID0gdGFyZ2V0VmFsdWUub2Zmc2V0VG9wIHx8IDA7CgogICAgICAgIGlmICh0aGlzLmFkdmFuY2VkS2V5Ym9hcmQpIHsKICAgICAgICAgIHRhcmdldFZhbHVlLmZvY3VzKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2Nyb2xsVG9TZWxlY3RlZFZhbHVlczogZnVuY3Rpb24gc2Nyb2xsVG9TZWxlY3RlZFZhbHVlcygpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLnRpbWVWYWx1ZSB8fCB0aGlzLmlucHV0SXNFbXB0eSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5pblVzZS50eXBlcy5mb3JFYWNoKGZ1bmN0aW9uIChzZWN0aW9uKSB7CiAgICAgICAgX3RoaXMxMy5zY3JvbGxUb1NlbGVjdGVkKHNlY3Rpb24pOwogICAgICB9KTsKICAgIH0sCiAgICAvLwogICAgLy8gQWRkaXRpb25hbCBLZXlib2FyZCBOYXZpZ2F0aW9uCiAgICAvLwogICAgb25Gb2N1czogZnVuY3Rpb24gb25Gb2N1cygpIHsKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5pc0ZvY3VzaW5nKSB7CiAgICAgICAgdGhpcy5pc0ZvY3VzaW5nID0gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKSB7CiAgICAgICAgdGhpcy50b2dnbGVBY3RpdmUoKTsKICAgICAgfQogICAgfSwKICAgIGVzY0JsdXI6IGZ1bmN0aW9uIGVzY0JsdXIoKSB7CiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2VUaW1lcik7CiAgICAgIHRoaXMuaXNGb2N1c2luZyA9IGZhbHNlOwogICAgICB2YXIgaW5wdXRCb3ggPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dC5kaXNwbGF5LXRpbWUnKVswXTsKCiAgICAgIGlmIChpbnB1dEJveCkgewogICAgICAgIGlucHV0Qm94LmJsdXIoKTsKICAgICAgfQogICAgfSwKICAgIGRlYm91bmNlQmx1cjogZnVuY3Rpb24gZGVib3VuY2VCbHVyKCkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICBpZiAodGhpcy5kaXNhYmxlZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5pc0ZvY3VzaW5nID0gZmFsc2U7CiAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5kZWJvdW5jZVRpbWVyKTsKICAgICAgdGhpcy5kZWJvdW5jZVRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoX3RoaXMxNC5kZWJvdW5jZVRpbWVyKTsKCiAgICAgICAgX3RoaXMxNC5vbkJsdXIoKTsKICAgICAgfSwgdGhpcy5vcHRzLmJsdXJEZWxheSk7CiAgICB9LAogICAgb25CbHVyOiBmdW5jdGlvbiBvbkJsdXIoKSB7CiAgICAgIGlmICghdGhpcy5kaXNhYmxlZCAmJiAhdGhpcy5pc0ZvY3VzaW5nICYmIHRoaXMuaXNBY3RpdmUpIHsKICAgICAgICB0aGlzLnRvZ2dsZUFjdGl2ZSgpOwogICAgICB9CiAgICB9LAogICAga2VlcEZvY3VzaW5nOiBmdW5jdGlvbiBrZWVwRm9jdXNpbmcoKSB7CiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2VUaW1lcik7CgogICAgICBpZiAoIXRoaXMuaXNGb2N1c2luZykgewogICAgICAgIHRoaXMuaXNGb2N1c2luZyA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICBvblRhYjogZnVuY3Rpb24gb25UYWIoY29sdW1uLCB2YWx1ZSwgZXZ0KSB7CiAgICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSAmJiBldnQuc2hpZnRLZXkpIHsKICAgICAgICB2YXIgZmlyc3RDb2x1bW4gPSB0aGlzLmluVXNlLnR5cGVzWzBdOwoKICAgICAgICBpZiAoY29sdW1uICE9PSBmaXJzdENvbHVtbikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGZpcnN0VmFsaWRWYWx1ZSA9IHRoaXMudmFsaWRJdGVtc0luQ29sKGZpcnN0Q29sdW1uKVswXTsgLy8gSXMgdGhlIGZpcnN0IHZhbGlkIGl0ZW0gaW4gdGhlIGZpcnN0IGNvbHVtbgoKICAgICAgICBpZiAoZmlyc3RWYWxpZFZhbHVlICYmIGZpcnN0VmFsaWRWYWx1ZS5nZXRBdHRyaWJ1dGUoJ2RhdGEta2V5JykgPT09IFN0cmluZyh2YWx1ZSkpIHsKICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBGb2N1cyBiYWNrIG9uIDxpbnB1dD4KCiAgICAgICAgICBpZiAodGhpcy4kcmVmcyAmJiB0aGlzLiRyZWZzLmlucHV0KSB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuZm9jdXMoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB2YWxpZEl0ZW1zSW5Db2w6IGZ1bmN0aW9uIHZhbGlkSXRlbXNJbkNvbChjb2x1bW4pIHsKICAgICAgdmFyIGNvbHVtbkNsYXNzID0gIiIuY29uY2F0KGNvbHVtbiwgInMiKTsKCiAgICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSAmJiB0aGlzLiRyZWZzICYmIHRoaXMuJHJlZnMuZHJvcGRvd24pIHsKICAgICAgICByZXR1cm4gdGhpcy4kcmVmcy5kcm9wZG93bi5xdWVyeVNlbGVjdG9yQWxsKCJ1bC4iLmNvbmNhdChjb2x1bW5DbGFzcywgIiA+IGxpOm5vdCguaGludCk6bm90KFtkaXNhYmxlZF0pIikpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbCgidWwuIi5jb25jYXQoY29sdW1uQ2xhc3MsICIgPiBsaTpub3QoLmhpbnQpOm5vdChbZGlzYWJsZWRdKSIpKTsKICAgIH0sCiAgICBhY3RpdmVJdGVtSW5Db2w6IGZ1bmN0aW9uIGFjdGl2ZUl0ZW1JbkNvbChjb2x1bW4pIHsKICAgICAgdmFyIGNvbHVtbkNsYXNzID0gIiIuY29uY2F0KGNvbHVtbiwgInMiKTsKCiAgICAgIGlmICh0aGlzLmFwcGVuZFRvQm9keSAmJiB0aGlzLiRyZWZzICYmIHRoaXMuJHJlZnMuZHJvcGRvd24pIHsKICAgICAgICByZXR1cm4gdGhpcy4kcmVmcy5kcm9wZG93bi5xdWVyeVNlbGVjdG9yQWxsKCJ1bC4iLmNvbmNhdChjb2x1bW5DbGFzcywgIiA+IGxpLmFjdGl2ZTpub3QoLmhpbnQpIikpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbCgidWwuIi5jb25jYXQoY29sdW1uQ2xhc3MsICIgPiBsaS5hY3RpdmU6bm90KC5oaW50KSIpKTsKICAgIH0sCiAgICBnZXRDbG9zZXN0U2libGluZzogZnVuY3Rpb24gZ2V0Q2xvc2VzdFNpYmxpbmcoY29sdW1uLCBkYXRhS2V5KSB7CiAgICAgIHZhciBnZXRQcmV2aW91cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgIHZhciBzaWJsaW5nc0luQ29sID0gdGhpcy52YWxpZEl0ZW1zSW5Db2woY29sdW1uKTsKICAgICAgdmFyIHNlbGZJbmRleCA9IEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXguY2FsbChzaWJsaW5nc0luQ29sLCBmdW5jdGlvbiAoc2JsKSB7CiAgICAgICAgcmV0dXJuIHNibC5nZXRBdHRyaWJ1dGUoJ2RhdGEta2V5JykgPT09IGRhdGFLZXk7CiAgICAgIH0pOyAvLyBBbHJlYWR5IHRoZSBmaXJzdCBpdGVtCgogICAgICBpZiAoZ2V0UHJldmlvdXMgJiYgc2VsZkluZGV4ID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHNpYmxpbmdzSW5Db2xbc2libGluZ3NJbkNvbC5sZW5ndGggLSAxXTsKICAgICAgfSAvLyBBbHJlYWR5IHRoZSBsYXN0IGl0ZW0KCgogICAgICBpZiAoIWdldFByZXZpb3VzICYmIHNlbGZJbmRleCA9PT0gc2libGluZ3NJbkNvbC5sZW5ndGggLSAxKSB7CiAgICAgICAgcmV0dXJuIHNpYmxpbmdzSW5Db2xbMF07CiAgICAgIH0gLy8gU2VsZWN0ZWQgdmFsdWUgbm90IGluIHRoZSB2YWxpZCB2YWx1ZXMgbGlzdAoKCiAgICAgIGlmIChzZWxmSW5kZXggPCAwKSB7CiAgICAgICAgcmV0dXJuIHNpYmxpbmdzSW5Db2xbMF07CiAgICAgIH0KCiAgICAgIGlmIChnZXRQcmV2aW91cykgewogICAgICAgIHJldHVybiBzaWJsaW5nc0luQ29sW3NlbGZJbmRleCAtIDFdOwogICAgICB9CgogICAgICByZXR1cm4gc2libGluZ3NJbkNvbFtzZWxmSW5kZXggKyAxXTsKICAgIH0sCiAgICBwcmV2SXRlbTogZnVuY3Rpb24gcHJldkl0ZW0oY29sdW1uLCBkYXRhS2V5KSB7CiAgICAgIHZhciBpc01hbnVhbElucHV0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgICAgdmFyIHRhcmdldEl0ZW0gPSB0aGlzLmdldENsb3Nlc3RTaWJsaW5nKGNvbHVtbiwgZGF0YUtleSwgdHJ1ZSk7CgogICAgICBpZiAodGFyZ2V0SXRlbSkgewogICAgICAgIHJldHVybiBpc01hbnVhbElucHV0ID8gdGFyZ2V0SXRlbSA6IHRhcmdldEl0ZW0uZm9jdXMoKTsKICAgICAgfQogICAgfSwKICAgIG5leHRJdGVtOiBmdW5jdGlvbiBuZXh0SXRlbShjb2x1bW4sIGRhdGFLZXkpIHsKICAgICAgdmFyIGlzTWFudWFsSW5wdXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwogICAgICB2YXIgdGFyZ2V0SXRlbSA9IHRoaXMuZ2V0Q2xvc2VzdFNpYmxpbmcoY29sdW1uLCBkYXRhS2V5LCBmYWxzZSk7CgogICAgICBpZiAodGFyZ2V0SXRlbSkgewogICAgICAgIHJldHVybiBpc01hbnVhbElucHV0ID8gdGFyZ2V0SXRlbSA6IHRhcmdldEl0ZW0uZm9jdXMoKTsKICAgICAgfQogICAgfSwKICAgIGdldFNpZGVDb2x1bW5OYW1lOiBmdW5jdGlvbiBnZXRTaWRlQ29sdW1uTmFtZShjdXJyZW50Q29sdW1uKSB7CiAgICAgIHZhciB0b0xlZnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICB2YXIgY3VycmVudENvbHVtbkluZGV4ID0gdGhpcy5pblVzZS50eXBlcy5pbmRleE9mKGN1cnJlbnRDb2x1bW4pOwoKICAgICAgaWYgKHRvTGVmdCAmJiBjdXJyZW50Q29sdW1uSW5kZXggPD0gMCkgewogICAgICAgIGlmICh0aGlzLmRlYnVnTW9kZSkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygnWW91XCdyZSBpbiB0aGUgbGVmdG1vc3QgbGlzdCBhbHJlYWR5Jyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoIXRvTGVmdCAmJiBjdXJyZW50Q29sdW1uSW5kZXggPT09IHRoaXMuaW5Vc2UudHlwZXMubGVuZ3RoIC0gMSkgewogICAgICAgIGlmICh0aGlzLmRlYnVnTW9kZSkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygnWW91XCdyZSBpbiB0aGUgcmlnaHRtb3N0IGxpc3QgYWxyZWFkeScpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5pblVzZS50eXBlc1t0b0xlZnQgPyBjdXJyZW50Q29sdW1uSW5kZXggLSAxIDogY3VycmVudENvbHVtbkluZGV4ICsgMV07CiAgICB9LAogICAgZ2V0Rmlyc3RJdGVtSW5TaWRlQ29sdW1uOiBmdW5jdGlvbiBnZXRGaXJzdEl0ZW1JblNpZGVDb2x1bW4oY3VycmVudENvbHVtbikgewogICAgICB2YXIgdG9MZWZ0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgICAgdmFyIHRhcmdldENvbHVtbiA9IHRoaXMuZ2V0U2lkZUNvbHVtbk5hbWUoY3VycmVudENvbHVtbiwgdG9MZWZ0KTsKCiAgICAgIGlmICghdGFyZ2V0Q29sdW1uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgbGlzdEl0ZW1zID0gdGhpcy52YWxpZEl0ZW1zSW5Db2wodGFyZ2V0Q29sdW1uKTsKCiAgICAgIGlmIChsaXN0SXRlbXMgJiYgbGlzdEl0ZW1zWzBdKSB7CiAgICAgICAgcmV0dXJuIGxpc3RJdGVtc1swXTsKICAgICAgfQogICAgfSwKICAgIGdldEFjdGl2ZUl0ZW1JblNpZGVDb2x1bW46IGZ1bmN0aW9uIGdldEFjdGl2ZUl0ZW1JblNpZGVDb2x1bW4oY3VycmVudENvbHVtbikgewogICAgICB2YXIgdG9MZWZ0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICAgICAgdmFyIHRhcmdldENvbHVtbiA9IHRoaXMuZ2V0U2lkZUNvbHVtbk5hbWUoY3VycmVudENvbHVtbiwgdG9MZWZ0KTsKCiAgICAgIGlmICghdGFyZ2V0Q29sdW1uKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgYWN0aXZlSXRlbXMgPSB0aGlzLmFjdGl2ZUl0ZW1JbkNvbCh0YXJnZXRDb2x1bW4pOwoKICAgICAgaWYgKGFjdGl2ZUl0ZW1zICYmIGFjdGl2ZUl0ZW1zWzBdKSB7CiAgICAgICAgcmV0dXJuIGFjdGl2ZUl0ZW1zWzBdOwogICAgICB9CiAgICB9LAogICAgdG9MZWZ0Q29sdW1uOiBmdW5jdGlvbiB0b0xlZnRDb2x1bW4oY3VycmVudENvbHVtbikgewogICAgICB2YXIgdGFyZ2V0SXRlbSA9IHRoaXMuZ2V0QWN0aXZlSXRlbUluU2lkZUNvbHVtbihjdXJyZW50Q29sdW1uLCB0cnVlKSB8fCB0aGlzLmdldEZpcnN0SXRlbUluU2lkZUNvbHVtbihjdXJyZW50Q29sdW1uLCB0cnVlKTsKCiAgICAgIGlmICh0YXJnZXRJdGVtKSB7CiAgICAgICAgdGFyZ2V0SXRlbS5mb2N1cygpOwogICAgICB9CiAgICB9LAogICAgdG9SaWdodENvbHVtbjogZnVuY3Rpb24gdG9SaWdodENvbHVtbihjdXJyZW50Q29sdW1uKSB7CiAgICAgIHZhciB0YXJnZXRJdGVtID0gdGhpcy5nZXRBY3RpdmVJdGVtSW5TaWRlQ29sdW1uKGN1cnJlbnRDb2x1bW4sIGZhbHNlKSB8fCB0aGlzLmdldEZpcnN0SXRlbUluU2lkZUNvbHVtbihjdXJyZW50Q29sdW1uLCBmYWxzZSk7CgogICAgICBpZiAodGFyZ2V0SXRlbSkgewogICAgICAgIHRhcmdldEl0ZW0uZm9jdXMoKTsKICAgICAgfQogICAgfSwKICAgIC8vCiAgICAvLyBNYW51YWwgSW5wdXQKICAgIC8vCiAgICBvbk1vdXNlRG93bjogZnVuY3Rpb24gb25Nb3VzZURvd24oKSB7CiAgICAgIHZhciBfdGhpczE1ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5tYW51YWxJbnB1dCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnNlbGVjdGlvblRpbWVyKTsKICAgICAgdGhpcy5zZWxlY3Rpb25UaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KF90aGlzMTUuc2VsZWN0aW9uVGltZXIpOwoKICAgICAgICBpZiAoX3RoaXMxNS4kcmVmcyAmJiBfdGhpczE1LiRyZWZzLmlucHV0KSB7CiAgICAgICAgICB2YXIgbmVhcmVzdFNsb3QgPSBfdGhpczE1LmdldE5lYXJlc3RDaHVua0J5UG9zKF90aGlzMTUuJHJlZnMuaW5wdXQuc2VsZWN0aW9uU3RhcnQgfHwgMCk7CgogICAgICAgICAgX3RoaXMxNS5kZWJvdW5jZVNldElucHV0U2VsZWN0aW9uKG5lYXJlc3RTbG90KTsKICAgICAgICB9CiAgICAgIH0sIDUwKTsKICAgIH0sCiAgICBrZXlEb3duSGFuZGxlcjogZnVuY3Rpb24ga2V5RG93bkhhbmRsZXIoZXZ0KSB7CiAgICAgIGlmIChldnQuaXNDb21wb3NpbmcgfHwgZXZ0LmtleUNvZGUgPT09IDIyOSkgewogICAgICAgIC8vIFNraXAgSU1FIGlucHV0cwogICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gTnVtYmVycwoKCiAgICAgIGlmIChldnQua2V5Q29kZSA+PSA0OCAmJiBldnQua2V5Q29kZSA8PSA1NyB8fCBldnQua2V5Q29kZSA+PSA5NiAmJiBldnQua2V5Q29kZSA8PSAxMDUpIHsKICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICB0aGlzLmtleWJvYXJkSW5wdXQoZXZ0LmtleSk7IC8vIEF8UHxNCiAgICAgIH0gZWxzZSBpZiAoWzY1LCA4MCwgNzddLmluY2x1ZGVzKGV2dC5rZXlDb2RlKSkgewogICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHRoaXMua2V5Ym9hcmRJbnB1dChldnQua2V5LCB0cnVlKTsgLy8gQXJyb3cga2V5cwogICAgICB9IGVsc2UgaWYgKGV2dC5rZXlDb2RlID49IDM3ICYmIGV2dC5rZXlDb2RlIDw9IDQwKSB7CiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdGhpcy5jbGVhcktiSW5wdXRMb2coKTsKICAgICAgICB0aGlzLmFycm93SGFuZGxlcihldnQpOyAvLyBEZWxldGV8QmFja3NwYWNlCiAgICAgIH0gZWxzZSBpZiAoZXZ0LmtleUNvZGUgPT09IDggfHwgZXZ0LmtleUNvZGUgPT09IDQ2KSB7CiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdGhpcy5jbGVhcktiSW5wdXRMb2coKTsKICAgICAgICB0aGlzLmNsZWFyVGltZSgpOyAvLyBUYWIKICAgICAgfSBlbHNlIGlmIChldnQua2V5Q29kZSA9PT0gOSkgewogICAgICAgIHRoaXMuY2xlYXJLYklucHV0TG9nKCk7CiAgICAgICAgdGhpcy50YWJIYW5kbGVyKGV2dCk7IC8vIENvbG9ufFNwYWNlCiAgICAgIH0gZWxzZSBpZiAoZXZ0LmtleUNvZGUgPT09IDE4NiB8fCBldnQua2V5Q29kZSA9PT0gMzIpIHsKICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICB0aGlzLmNsZWFyS2JJbnB1dExvZygpOwogICAgICAgIHRoaXMudG9OZXh0U2xvdCgpOyAvLyBQcmV2ZW50IGFueSBOb24tRVNDIGFuZCBub24tcGFzdGluZyBpbnB1dHMKICAgICAgfSBlbHNlIGlmIChldnQua2V5Q29kZSAhPT0gMjcgJiYgIShldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkpIHsKICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgfQogICAgfSwKICAgIG9uQ29tcG9zdGlvblN0YXJ0OiBmdW5jdGlvbiBvbkNvbXBvc3Rpb25TdGFydChldnQpIHsKICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgdGhpcy5iYWtDdXJyZW50UG9zID0gdGhpcy5nZXRDdXJyZW50VG9rZW5DaHVuaygpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgb25Db21wb3N0aW9uRW5kOiBmdW5jdGlvbiBvbkNvbXBvc3Rpb25FbmQoZXZ0KSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIHZhciBjcHNEYXRhID0gZXZ0LmRhdGE7CiAgICAgIHZhciBpbnB1dElzQ3VzdG9tQXBtVGV4dCA9IGZhbHNlOwoKICAgICAgaWYgKHRoaXMuaGFzLmN1c3RvbUFwbVRleHQpIHsKICAgICAgICBpbnB1dElzQ3VzdG9tQXBtVGV4dCA9IHRoaXMuaXNDdXN0b21BcG1UZXh0KGNwc0RhdGEpOwogICAgICB9CgogICAgICBpZiAoaW5wdXRJc0N1c3RvbUFwbVRleHQpIHsKICAgICAgICB0aGlzLnNldFNhbml0aXplZFZhbHVlVG9TZWN0aW9uKCdhcG0nLCBpbnB1dElzQ3VzdG9tQXBtVGV4dCk7CiAgICAgIH0KCiAgICAgIHRoaXMuJHJlZnMuaW5wdXQudmFsdWUgPSB0aGlzLmhhcy5jdXN0b21BcG1UZXh0ID8gdGhpcy5jdXN0b21EaXNwbGF5VGltZSA6IHRoaXMuZGlzcGxheVRpbWU7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoX3RoaXMxNi5iYWtDdXJyZW50UG9zKSB7CiAgICAgICAgICB2YXIgYmFrUG9zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfdGhpczE2LmJha0N1cnJlbnRQb3MpKTsKCiAgICAgICAgICBpZiAoaW5wdXRJc0N1c3RvbUFwbVRleHQpIHsKICAgICAgICAgICAgYmFrUG9zLmVuZCA9IGJha1Bvcy5zdGFydCArIGNwc0RhdGEubGVuZ3RoOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzMTYuZGVib3VuY2VTZXRJbnB1dFNlbGVjdGlvbihiYWtQb3MpOwoKICAgICAgICAgIF90aGlzMTYuYmFrQ3VycmVudFBvcyA9IG51bGw7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHBhc3RlSGFuZGxlcjogZnVuY3Rpb24gcGFzdGVIYW5kbGVyKGV2dCkgewogICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgdmFyIHBhc3RpbmdUZXh0ID0gKGV2dC5jbGlwYm9hcmREYXRhIHx8IHdpbmRvdy5jbGlwYm9hcmREYXRhKS5nZXREYXRhKCd0ZXh0Jyk7CgogICAgICBpZiAodGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICB0aGlzLmRlYnVnTG9nKCJQYXN0aW5nIHZhbHVlIFwiIi5jb25jYXQocGFzdGluZ1RleHQsICJcIiBmcm9tIGNsaXBib2FyZCIpKTsKICAgICAgfQoKICAgICAgaWYgKCFwYXN0aW5nVGV4dCB8fCAhcGFzdGluZ1RleHQubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIFJlcGxhY2UgY3VzdG9tIEFNL1BNIHRleHQgKGlmIGFueSkKCgogICAgICBpZiAodGhpcy5oYXMuY3VzdG9tQXBtVGV4dCkgewogICAgICAgIHBhc3RpbmdUZXh0ID0gdGhpcy5yZXBsYWNlQ3VzdG9tQXBtVGV4dChwYXN0aW5nVGV4dCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlucHV0SXNFbXB0eSkgewogICAgICAgIHRoaXMucmVhZFN0cmluZ1ZhbHVlcyhwYXN0aW5nVGV4dCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5rYklucHV0TG9nID0gcGFzdGluZ1RleHQuc3Vic3RyKC0yLCAyKTsKICAgICAgICB0aGlzLnNldEtiSW5wdXQoKTsKICAgICAgICB0aGlzLmRlYm91bmNlQ2xlYXJLYkxvZygpOwogICAgICB9CiAgICB9LAogICAgYXJyb3dIYW5kbGVyOiBmdW5jdGlvbiBhcnJvd0hhbmRsZXIoZXZ0KSB7CiAgICAgIHZhciBkaXJlY3Rpb24gPSB7CiAgICAgICAgMzc6ICdMJywKICAgICAgICAzODogJ1UnLAogICAgICAgIDM5OiAnUicsCiAgICAgICAgNDA6ICdEJwogICAgICB9W2V2dC5rZXlDb2RlXTsKCiAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdVJyB8fCBkaXJlY3Rpb24gPT09ICdEJykgewogICAgICAgIGlmICh0aGlzLmlucHV0SXNFbXB0eSkgewogICAgICAgICAgdGhpcy5zZWxlY3RGaXJzdFZhbGlkVmFsdWUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGN1cnJlbnRDaHVuayA9IHRoaXMuZ2V0Q3VycmVudFRva2VuQ2h1bmsoKTsKCiAgICAgICAgICBpZiAoIWN1cnJlbnRDaHVuaykgewogICAgICAgICAgICB0aGlzLnNlbGVjdEZpcnN0VmFsaWRWYWx1ZSgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHRva2VuVHlwZSA9IGN1cnJlbnRDaHVuay50eXBlOwogICAgICAgICAgdGhpcy5nZXRDbG9zZXN0VmFsaWRJdGVtSW5Db2wodG9rZW5UeXBlLCB0aGlzW3Rva2VuVHlwZV0sIGRpcmVjdGlvbik7CiAgICAgICAgICB2YXIgbmV3Q2h1bmtQb3MgPSB0aGlzLmdldEN1cnJlbnRUb2tlbkNodW5rKCk7CiAgICAgICAgICB0aGlzLmRlYm91bmNlU2V0SW5wdXRTZWxlY3Rpb24obmV3Q2h1bmtQb3MpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdSJykgewogICAgICAgIHRoaXMudG9MYXRlcmFsVG9rZW4oZmFsc2UpOwogICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ0wnKSB7CiAgICAgICAgdGhpcy50b0xhdGVyYWxUb2tlbih0cnVlKTsKICAgICAgfQogICAgfSwKICAgIHRhYkhhbmRsZXI6IGZ1bmN0aW9uIHRhYkhhbmRsZXIoZXZ0KSB7CiAgICAgIGlmICghdGhpcy5pbnB1dElzRW1wdHkgJiYgdGhpcy50b2tlbkNodW5rc1BvcyAmJiB0aGlzLnRva2VuQ2h1bmtzUG9zLmxlbmd0aCkgewogICAgICAgIHZhciBjdXJyZW50Q2h1bmsgPSB0aGlzLmdldEN1cnJlbnRUb2tlbkNodW5rKCk7CgogICAgICAgIGlmICghY3VycmVudENodW5rKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgZmlyc3RDaHVuayA9IHRoaXMudG9rZW5DaHVua3NQb3NbMF07CiAgICAgICAgdmFyIGxhc3RDaHVuayA9IHRoaXMudG9rZW5DaHVua3NQb3NbdGhpcy50b2tlbkNodW5rc1Bvcy5sZW5ndGggLSAxXTsKCiAgICAgICAgaWYgKGV2dC5zaGlmdEtleSAmJiBjdXJyZW50Q2h1bmsudG9rZW4gIT09IGZpcnN0Q2h1bmsudG9rZW4gfHwgIWV2dC5zaGlmdEtleSAmJiBjdXJyZW50Q2h1bmsudG9rZW4gIT09IGxhc3RDaHVuay50b2tlbikgewogICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICB0aGlzLnRvTGF0ZXJhbFRva2VuKGV2dC5zaGlmdEtleSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuYXBwZW5kVG9Cb2R5ICYmIHRoaXMuYWR2YW5jZWRLZXlib2FyZCkgewogICAgICAgIGlmIChldnQuc2hpZnRLZXkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBpZiAodGhpcy5pbnB1dElzRW1wdHkpIHsKICAgICAgICAgIHZhciBmaXJzdENvbHVtbiA9IHRoaXMuaW5Vc2UudHlwZXNbMF07CiAgICAgICAgICB2YXIgdGFyZ2V0VmFsdWUgPSB0aGlzLnZhbGlkSXRlbXNJbkNvbChmaXJzdENvbHVtbilbMF07CgogICAgICAgICAgaWYgKHRhcmdldFZhbHVlKSB7CiAgICAgICAgICAgIHRhcmdldFZhbHVlLmZvY3VzKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAga2V5Ym9hcmRJbnB1dDogZnVuY3Rpb24ga2V5Ym9hcmRJbnB1dChuZXdDaGFyKSB7CiAgICAgIHZhciBpc0FwbSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBjdXJyZW50Q2h1bmsgPSB0aGlzLmdldEN1cnJlbnRUb2tlbkNodW5rKCk7CgogICAgICBpZiAoIWN1cnJlbnRDaHVuayB8fCBjdXJyZW50Q2h1bmsudHlwZSAhPT0gJ2FwbScgJiYgaXNBcG0gfHwgY3VycmVudENodW5rLnR5cGUgPT09ICdhcG0nICYmICFpc0FwbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5rYklucHV0TG9nID0gIiIuY29uY2F0KHRoaXMua2JJbnB1dExvZy5zdWJzdHIoLTEpKS5jb25jYXQobmV3Q2hhcik7CiAgICAgIHRoaXMuc2V0S2JJbnB1dCgpOwogICAgICB0aGlzLmRlYm91bmNlQ2xlYXJLYkxvZygpOwogICAgfSwKICAgIGNsZWFyS2JJbnB1dExvZzogZnVuY3Rpb24gY2xlYXJLYklucHV0TG9nKCkgewogICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMua2JJbnB1dFRpbWVyKTsKICAgICAgdGhpcy5rYklucHV0TG9nID0gJyc7CiAgICB9LAogICAgZGVib3VuY2VDbGVhcktiTG9nOiBmdW5jdGlvbiBkZWJvdW5jZUNsZWFyS2JMb2coKSB7CiAgICAgIHZhciBfdGhpczE3ID0gdGhpczsKCiAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5rYklucHV0VGltZXIpOwogICAgICB0aGlzLmtiSW5wdXRUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczE3LmNsZWFyS2JJbnB1dExvZygpOwogICAgICB9LCB0aGlzLm9wdHMubWFudWFsSW5wdXRUaW1lb3V0KTsKICAgIH0sCiAgICBzZXRLYklucHV0OiBmdW5jdGlvbiBzZXRLYklucHV0KHZhbHVlKSB7CiAgICAgIHZhbHVlID0gdmFsdWUgfHwgdGhpcy5rYklucHV0TG9nOwogICAgICB2YXIgY3VycmVudENodW5rID0gdGhpcy5nZXRDdXJyZW50VG9rZW5DaHVuaygpOwoKICAgICAgaWYgKCFjdXJyZW50Q2h1bmsgfHwgIXZhbHVlIHx8ICF2YWx1ZS5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBjaHVua1R5cGUgPSBjdXJyZW50Q2h1bmsudHlwZTsKICAgICAgdmFyIGNodW5rVG9rZW4gPSBjdXJyZW50Q2h1bmsudG9rZW47CiAgICAgIHZhciB2YWxpZFZhbHVlOwoKICAgICAgaWYgKGNodW5rVHlwZSA9PT0gJ2FwbScpIHsKICAgICAgICBpZiAodGhpcy5sb3dlckNhc2VkQXBtKHZhbHVlKS5pbmNsdWRlcygnYScpKSB7CiAgICAgICAgICB2YWxpZFZhbHVlID0gJ2FtJzsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMubG93ZXJDYXNlZEFwbSh2YWx1ZSkuaW5jbHVkZXMoJ3AnKSkgewogICAgICAgICAgdmFsaWRWYWx1ZSA9ICdwbSc7CiAgICAgICAgfQoKICAgICAgICBpZiAodmFsaWRWYWx1ZSkgewogICAgICAgICAgdmFsaWRWYWx1ZSA9IGNodW5rVG9rZW4gPT09ICdBJyA/IHZhbGlkVmFsdWUudG9VcHBlckNhc2UoKSA6IHZhbGlkVmFsdWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLmlzVmFsaWRWYWx1ZShjaHVua1Rva2VuLCB2YWx1ZSkpIHsKICAgICAgICAgIHZhbGlkVmFsdWUgPSB2YWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGxhc3RJbnB1dFZhbHVlID0gdGhpcy5mb3JtYXRWYWx1ZShjaHVua1Rva2VuLCB2YWx1ZS5zdWJzdHIoLTEpKTsKCiAgICAgICAgICBpZiAodGhpcy5pc1ZhbGlkVmFsdWUoY2h1bmtUb2tlbiwgbGFzdElucHV0VmFsdWUpKSB7CiAgICAgICAgICAgIHZhbGlkVmFsdWUgPSBsYXN0SW5wdXRWYWx1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICh2YWxpZFZhbHVlKSB7CiAgICAgICAgdGhpcy5zZXRTYW5pdGl6ZWRWYWx1ZVRvU2VjdGlvbihjaHVua1R5cGUsIHZhbGlkVmFsdWUpOwogICAgICAgIHZhciBuZXdDaHVua1BvcyA9IHRoaXMuZ2V0Q3VycmVudFRva2VuQ2h1bmsoKTsKICAgICAgICB0aGlzLmRlYm91bmNlU2V0SW5wdXRTZWxlY3Rpb24obmV3Q2h1bmtQb3MpOwogICAgICB9CgogICAgICBpZiAodGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICBpZiAodmFsaWRWYWx1ZSkgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygiU3VjY2Vzc2Z1bGx5IHNldCB2YWx1ZSBcIiIuY29uY2F0KHZhbGlkVmFsdWUsICJcIiBmcm9tIGxhdGVzdCBpbnB1dCBcIiIpLmNvbmNhdCh2YWx1ZSwgIlwiIGZvciB0aGUgXCIiKS5jb25jYXQoY2h1bmtUeXBlLCAiXCIgc2xvdCIpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5kZWJ1Z0xvZygiVmFsdWUgXCIiLmNvbmNhdCh2YWx1ZSwgIlwiIGlzIGludmFsaWQgaW4gdGhlIFwiIikuY29uY2F0KGNodW5rVHlwZSwgIlwiIHNsb3QiKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8gRm9ybSBBdXRvZmlsbAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKCkgewogICAgICBpZiAoIXRoaXMubWFudWFsSW5wdXQgfHwgIXRoaXMuJHJlZnMgfHwgIXRoaXMuJHJlZnMuaW5wdXQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBhdXRvRmlsbFZhbHVlID0gdGhpcy4kcmVmcy5pbnB1dC52YWx1ZSB8fCAnJzsKCiAgICAgIGlmIChhdXRvRmlsbFZhbHVlICYmIGF1dG9GaWxsVmFsdWUubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5yZWFkU3RyaW5nVmFsdWVzKGF1dG9GaWxsVmFsdWUpOwogICAgICB9CiAgICB9LAogICAgZ2V0TmVhcmVzdENodW5rQnlQb3M6IGZ1bmN0aW9uIGdldE5lYXJlc3RDaHVua0J5UG9zKHN0YXJ0UG9zKSB7CiAgICAgIGlmICghdGhpcy50b2tlbkNodW5rc1BvcyB8fCAhdGhpcy50b2tlbkNodW5rc1Bvcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBuZWFyZXN0OwogICAgICB2YXIgbmVhcmVzdERlbHRhID0gLTE7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudG9rZW5DaHVua3NQb3MubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgY2h1bmsgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMudG9rZW5DaHVua3NQb3NbaV0pKTsKCiAgICAgICAgaWYgKGNodW5rLnN0YXJ0ID09PSBzdGFydFBvcykgewogICAgICAgICAgcmV0dXJuIGNodW5rOwogICAgICAgIH0KCiAgICAgICAgdmFyIGRlbHRhID0gTWF0aC5hYnMoY2h1bmsuc3RhcnQgLSBzdGFydFBvcyk7CgogICAgICAgIGlmIChuZWFyZXN0RGVsdGEgPCAwKSB7CiAgICAgICAgICBuZWFyZXN0ID0gY2h1bms7CiAgICAgICAgICBuZWFyZXN0RGVsdGEgPSBkZWx0YTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKG5lYXJlc3REZWx0YSA8PSBkZWx0YSkgewogICAgICAgICAgICByZXR1cm4gbmVhcmVzdDsKICAgICAgICAgIH0KCiAgICAgICAgICBuZWFyZXN0RGVsdGEgPSBkZWx0YTsKICAgICAgICAgIG5lYXJlc3QgPSBjaHVuazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBuZWFyZXN0OwogICAgfSwKICAgIHNlbGVjdEZpcnN0VmFsaWRWYWx1ZTogZnVuY3Rpb24gc2VsZWN0Rmlyc3RWYWxpZFZhbHVlKCkgewogICAgICBpZiAoIXRoaXMudG9rZW5DaHVua3NQb3MgfHwgIXRoaXMudG9rZW5DaHVua3NQb3MubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZmlyc3RTbG90VHlwZSA9IHRoaXMudG9rZW5DaHVua3NQb3NbMF0udHlwZTsKCiAgICAgIGlmIChmaXJzdFNsb3RUeXBlID09PSAnaG91cicpIHsKICAgICAgICB0aGlzLmdldENsb3Nlc3RIb3VySXRlbSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZ2V0Q2xvc2VzdFZhbGlkSXRlbUluQ29sKGZpcnN0U2xvdFR5cGUsIHRoaXNbZmlyc3RTbG90VHlwZV0pOwogICAgICB9CgogICAgICB0aGlzLnNlbGVjdEZpcnN0U2xvdCgpOwogICAgfSwKICAgIGdldENsb3Nlc3RIb3VySXRlbTogZnVuY3Rpb24gZ2V0Q2xvc2VzdEhvdXJJdGVtKGN1cnJlbnRWYWx1ZSkgewogICAgICB2YXIgX3RoaXMxOCA9IHRoaXM7CgogICAgICB2YXIgZGlyZWN0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAnVSc7CgogICAgICBpZiAoIXRoaXMudmFsaWRIb3Vyc0xpc3QgfHwgIXRoaXMudmFsaWRIb3Vyc0xpc3QubGVuZ3RoKSB7CiAgICAgICAgaWYgKHRoaXMuZGVidWdNb2RlKSB7CiAgICAgICAgICB0aGlzLmRlYnVnTG9nKCJObyB2YWxpZCBob3VyIHZhbHVlcyBmb3VuZCwgcGxlYXNlIGNoZWNrIHlvdXIgXCJob3VyLXJhbmdlXCIgY29uZmlnXG5ob3VyLXJhbmdlOiAiLmNvbmNhdChKU09OLnN0cmluZ2lmeSh0aGlzLmhvdXJSYW5nZSkpKTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFjdXJyZW50VmFsdWUpIHsKICAgICAgICB0aGlzLnNldE1hbnVhbEhvdXIodGhpcy52YWxpZEhvdXJzTGlzdFswXSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgY3VycmVudEluZGV4ID0gdGhpcy52YWxpZEhvdXJzTGlzdC5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpZiAoIV90aGlzMTguYmFzZU9uMTJIb3VycykgewogICAgICAgICAgcmV0dXJuIGl0ZW0gPT09IGN1cnJlbnRWYWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIHZhbHVlS2V5ID0gIiIuY29uY2F0KGN1cnJlbnRWYWx1ZSkuY29uY2F0KF90aGlzMTgubG93ZXJDYXNlZEFwbShfdGhpczE4LmFwbSkgPT09ICdwbScgPyAncCcgOiAnYScpOwogICAgICAgICAgcmV0dXJuIGl0ZW0gPT09IHZhbHVlS2V5OwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHZhciBuZXh0SW5kZXg7CgogICAgICBpZiAoY3VycmVudEluZGV4ID09PSAtMSkgewogICAgICAgIG5leHRJbmRleCA9IDA7CiAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnRCcpIHsKICAgICAgICBuZXh0SW5kZXggPSBjdXJyZW50SW5kZXggPT09IDAgPyB0aGlzLnZhbGlkSG91cnNMaXN0Lmxlbmd0aCAtIDEgOiBjdXJyZW50SW5kZXggLSAxOwogICAgICB9IGVsc2UgewogICAgICAgIG5leHRJbmRleCA9IChjdXJyZW50SW5kZXggKyAxKSAlIHRoaXMudmFsaWRIb3Vyc0xpc3QubGVuZ3RoOwogICAgICB9CgogICAgICB2YXIgbmV4dEl0ZW0gPSB0aGlzLnZhbGlkSG91cnNMaXN0W25leHRJbmRleF07CiAgICAgIHRoaXMuc2V0TWFudWFsSG91cihuZXh0SXRlbSk7CiAgICB9LAogICAgZ2V0Q2xvc2VzdFZhbGlkSXRlbUluQ29sOiBmdW5jdGlvbiBnZXRDbG9zZXN0VmFsaWRJdGVtSW5Db2woY29sdW1uLCBjdXJyZW50VmFsdWUpIHsKICAgICAgdmFyIGRpcmVjdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ1UnOwoKICAgICAgaWYgKGNvbHVtbiA9PT0gJ2hvdXInKSB7CiAgICAgICAgdGhpcy5nZXRDbG9zZXN0SG91ckl0ZW0oY3VycmVudFZhbHVlLCBkaXJlY3Rpb24pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBuZXh0SXRlbSA9IGRpcmVjdGlvbiA9PT0gJ0QnID8gdGhpcy5wcmV2SXRlbShjb2x1bW4sIHRoaXNbY29sdW1uXSwgdHJ1ZSkgOiB0aGlzLm5leHRJdGVtKGNvbHVtbiwgdGhpc1tjb2x1bW5dLCB0cnVlKTsKCiAgICAgICAgaWYgKG5leHRJdGVtKSB7CiAgICAgICAgICB0aGlzLnNlbGVjdChjb2x1bW4sIG5leHRJdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1rZXknKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2V0U2FuaXRpemVkVmFsdWVUb1NlY3Rpb246IGZ1bmN0aW9uIHNldFNhbml0aXplZFZhbHVlVG9TZWN0aW9uKHNlY3Rpb24sIGlucHV0VmFsdWUpIHsKICAgICAgaWYgKCFzZWN0aW9uIHx8ICF0aGlzLmdldFRva2VuQnlUeXBlKHNlY3Rpb24pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIE5PVEU6IERpc2FibGVkIHZhbHVlcyBhcmUgYWxsb3dlZCBoZXJlLCBmb2xsb3dlZCBieSBhbiAnZXJyb3InIGV2ZW50LCB0aG91Z2gKCgogICAgICB2YXIgc2FuaXRpemVkVmFsdWUgPSB0aGlzLnNhbml0aXplZFZhbHVlKHRoaXMuZ2V0VG9rZW5CeVR5cGUoc2VjdGlvbiksIGlucHV0VmFsdWUpOwogICAgICB0aGlzW3NlY3Rpb25dID0gc2FuaXRpemVkVmFsdWU7CiAgICB9LAogICAgc2V0TWFudWFsSG91cjogZnVuY3Rpb24gc2V0TWFudWFsSG91cihuZXh0SXRlbSkgewogICAgICBpZiAodGhpcy5pczEyaFJhbmdlKG5leHRJdGVtKSkgewogICAgICAgIHZhciBob3VyVCA9IHRoaXMubWF0Y2gxMmhSYW5nZShuZXh0SXRlbSk7CiAgICAgICAgdmFyIGFwbVZhbHVlID0gaG91clRbMl0gPT09ICdhJyA/ICdBTScgOiAnUE0nOwogICAgICAgIHRoaXMuc2V0U2FuaXRpemVkVmFsdWVUb1NlY3Rpb24oJ2FwbScsIHRoaXMuYXBtVHlwZSA9PT0gJ2EnID8gYXBtVmFsdWUudG9Mb3dlckNhc2UoKSA6IGFwbVZhbHVlKTsKICAgICAgICB0aGlzLnNldFNhbml0aXplZFZhbHVlVG9TZWN0aW9uKCdob3VyJywgaG91clRbMV0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2V0U2FuaXRpemVkVmFsdWVUb1NlY3Rpb24oJ2hvdXInLCBuZXh0SXRlbSk7CiAgICAgIH0KICAgIH0sCiAgICBkZWJvdW5jZVNldElucHV0U2VsZWN0aW9uOiBmdW5jdGlvbiBkZWJvdW5jZVNldElucHV0U2VsZWN0aW9uKF9yZWYpIHsKICAgICAgdmFyIF90aGlzMTkgPSB0aGlzOwoKICAgICAgdmFyIF9yZWYkc3RhcnQgPSBfcmVmLnN0YXJ0LAogICAgICAgICAgc3RhcnQgPSBfcmVmJHN0YXJ0ID09PSB2b2lkIDAgPyAwIDogX3JlZiRzdGFydCwKICAgICAgICAgIF9yZWYkZW5kID0gX3JlZi5lbmQsCiAgICAgICAgICBlbmQgPSBfcmVmJGVuZCA9PT0gdm9pZCAwID8gMCA6IF9yZWYkZW5kOwogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMxOS5zZXRJbnB1dFNlbGVjdGlvblJhbmdlKHN0YXJ0LCBlbmQpOwogICAgICB9KTsKICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnNlbGVjdGlvblRpbWVyKTsKICAgICAgdGhpcy5zZWxlY3Rpb25UaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KF90aGlzMTkuc2VsZWN0aW9uVGltZXIpOyAvLyBEb3VibGUtY2hlY2sgc2VsZWN0aW9uIGZvciAxMmhyIGZvcm1hdAoKICAgICAgICBpZiAoX3RoaXMxOS4kcmVmcy5pbnB1dCAmJiAoX3RoaXMxOS4kcmVmcy5pbnB1dC5zZWxlY3Rpb25TdGFydCAhPT0gc3RhcnQgfHwgX3RoaXMxOS4kcmVmcy5pbnB1dC5zZWxlY3Rpb25FbmQgIT09IGVuZCkpIHsKICAgICAgICAgIF90aGlzMTkuc2V0SW5wdXRTZWxlY3Rpb25SYW5nZShzdGFydCwgZW5kKTsKICAgICAgICB9CiAgICAgIH0sIDMwKTsKICAgIH0sCiAgICBzZXRJbnB1dFNlbGVjdGlvblJhbmdlOiBmdW5jdGlvbiBzZXRJbnB1dFNlbGVjdGlvblJhbmdlKHN0YXJ0LCBlbmQpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMgJiYgdGhpcy4kcmVmcy5pbnB1dCkgewogICAgICAgIHRoaXMuJHJlZnMuaW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2Uoc3RhcnQsIGVuZCk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRDdXJyZW50VG9rZW5DaHVuazogZnVuY3Rpb24gZ2V0Q3VycmVudFRva2VuQ2h1bmsoKSB7CiAgICAgIHJldHVybiB0aGlzLmdldE5lYXJlc3RDaHVua0J5UG9zKHRoaXMuJHJlZnMuaW5wdXQgJiYgdGhpcy4kcmVmcy5pbnB1dC5zZWxlY3Rpb25TdGFydCB8fCAwKTsKICAgIH0sCiAgICBzZWxlY3RGaXJzdFNsb3Q6IGZ1bmN0aW9uIHNlbGVjdEZpcnN0U2xvdCgpIHsKICAgICAgdmFyIGZpcnN0Q2h1bmtQb3MgPSB0aGlzLmdldE5lYXJlc3RDaHVua0J5UG9zKDApOwogICAgICB0aGlzLmRlYm91bmNlU2V0SW5wdXRTZWxlY3Rpb24oZmlyc3RDaHVua1Bvcyk7CiAgICB9LAogICAgdG9OZXh0U2xvdDogZnVuY3Rpb24gdG9OZXh0U2xvdCgpIHsKICAgICAgaWYgKCF0aGlzLmlucHV0SXNFbXB0eSAmJiB0aGlzLnRva2VuQ2h1bmtzUG9zICYmIHRoaXMudG9rZW5DaHVua3NQb3MubGVuZ3RoKSB7CiAgICAgICAgdmFyIGN1cnJlbnRDaHVuayA9IHRoaXMuZ2V0Q3VycmVudFRva2VuQ2h1bmsoKTsKCiAgICAgICAgaWYgKCFjdXJyZW50Q2h1bmspIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBsYXN0Q2h1bmsgPSB0aGlzLnRva2VuQ2h1bmtzUG9zW3RoaXMudG9rZW5DaHVua3NQb3MubGVuZ3RoIC0gMV07CgogICAgICAgIGlmIChjdXJyZW50Q2h1bmsudG9rZW4gIT09IGxhc3RDaHVuay50b2tlbikgewogICAgICAgICAgdGhpcy50b0xhdGVyYWxUb2tlbihmYWxzZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdG9MYXRlcmFsVG9rZW46IGZ1bmN0aW9uIHRvTGF0ZXJhbFRva2VuKHRvTGVmdCkgewogICAgICB2YXIgY3VycmVudENodW5rID0gdGhpcy5nZXRDdXJyZW50VG9rZW5DaHVuaygpOwoKICAgICAgaWYgKCFjdXJyZW50Q2h1bmspIHsKICAgICAgICB0aGlzLnNlbGVjdEZpcnN0VmFsaWRWYWx1ZSgpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGN1cnJlbnRDaHVua0luZGV4ID0gdGhpcy50b2tlbkNodW5rc1Bvcy5maW5kSW5kZXgoZnVuY3Rpb24gKGNoaykgewogICAgICAgIHJldHVybiBjaGsudG9rZW4gPT09IGN1cnJlbnRDaHVuay50b2tlbjsKICAgICAgfSk7CgogICAgICBpZiAoIXRvTGVmdCAmJiBjdXJyZW50Q2h1bmtJbmRleCA+PSB0aGlzLnRva2VuQ2h1bmtzUG9zLmxlbmd0aCAtIDEgfHwgdG9MZWZ0ICYmIGN1cnJlbnRDaHVua0luZGV4ID09PSAwKSB7CiAgICAgICAgaWYgKHRoaXMuZGVidWdNb2RlKSB7CiAgICAgICAgICBpZiAodG9MZWZ0KSB7CiAgICAgICAgICAgIHRoaXMuZGVidWdMb2coJ1lvdVwncmUgaW4gdGhlIGxlZnRtb3N0IHNsb3QgYWxyZWFkeScpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5kZWJ1Z0xvZygnWW91XCdyZSBpbiB0aGUgcmlnaHRtb3N0IHNsb3QgYWxyZWFkeScpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGFyZ2V0U2xvdFBvcyA9IHRvTGVmdCA/IHRoaXMudG9rZW5DaHVua3NQb3NbY3VycmVudENodW5rSW5kZXggLSAxXSA6IHRoaXMudG9rZW5DaHVua3NQb3NbY3VycmVudENodW5rSW5kZXggKyAxXTsKICAgICAgdGhpcy5kZWJvdW5jZVNldElucHV0U2VsZWN0aW9uKHRhcmdldFNsb3RQb3MpOwogICAgfSwKICAgIGlzQ3VzdG9tQXBtVGV4dDogZnVuY3Rpb24gaXNDdXN0b21BcG1UZXh0KGlucHV0RGF0YSkgewogICAgICBpZiAoIWlucHV0RGF0YSB8fCAhaW5wdXREYXRhLmxlbmd0aCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuYW1UZXh0ICYmIHRoaXMuYW1UZXh0ID09PSBpbnB1dERhdGEpIHsKICAgICAgICByZXR1cm4gdGhpcy5hcG1UeXBlID09PSAnQScgPyAnQU0nIDogJ2FtJzsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucG1UZXh0ICYmIHRoaXMucG1UZXh0ID09PSBpbnB1dERhdGEpIHsKICAgICAgICByZXR1cm4gdGhpcy5hcG1UeXBlID09PSAnQScgPyAnUE0nIDogJ3BtJzsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHJlcGxhY2VDdXN0b21BcG1UZXh0OiBmdW5jdGlvbiByZXBsYWNlQ3VzdG9tQXBtVGV4dChpbnB1dFN0cmluZykgewogICAgICBpZiAodGhpcy5hbVRleHQgJiYgdGhpcy5hbVRleHQubGVuZ3RoICYmIGlucHV0U3RyaW5nLmluY2x1ZGVzKHRoaXMuYW1UZXh0KSkgewogICAgICAgIHJldHVybiBpbnB1dFN0cmluZy5yZXBsYWNlKG5ldyBSZWdFeHAodGhpcy5hbVRleHQsICdnJyksIHRoaXMuYXBtVHlwZSA9PT0gJ0EnID8gJ0FNJyA6ICdhbScpOwogICAgICB9IGVsc2UgaWYgKHRoaXMucG1UZXh0ICYmIHRoaXMucG1UZXh0Lmxlbmd0aCAmJiBpbnB1dFN0cmluZy5pbmNsdWRlcyh0aGlzLnBtVGV4dCkpIHsKICAgICAgICByZXR1cm4gaW5wdXRTdHJpbmcucmVwbGFjZShuZXcgUmVnRXhwKHRoaXMucG1UZXh0LCAnZycpLCB0aGlzLmFwbVR5cGUgPT09ICdBJyA/ICdQTScgOiAncG0nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGlucHV0U3RyaW5nOwogICAgfSwKICAgIGNoZWNrRHJvcERpcmVjdGlvbjogZnVuY3Rpb24gY2hlY2tEcm9wRGlyZWN0aW9uKCkgewogICAgICBpZiAoIXRoaXMuJGVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgY29udGFpbmVyOwoKICAgICAgaWYgKHRoaXMuY29udGFpbmVySWQgJiYgdGhpcy5jb250YWluZXJJZC5sZW5ndGgpIHsKICAgICAgICBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmNvbnRhaW5lcklkKTsKCiAgICAgICAgaWYgKCFjb250YWluZXIgJiYgdGhpcy5kZWJ1Z01vZGUpIHsKICAgICAgICAgIHRoaXMuZGVidWdMb2coIkNvbnRhaW5lciB3aXRoIGlkIFwiIi5jb25jYXQodGhpcy5jb250YWluZXJJZCwgIlwiIG5vdCBmb3VuZC4gRmFsbGJhY2sgdG8gZG9jdW1lbnQgYm9keS4iKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZWwgPSB0aGlzLiRlbDsKICAgICAgdmFyIHNwYWNlRG93bjsKCiAgICAgIGlmIChjb250YWluZXIgJiYgY29udGFpbmVyLm9mZnNldEhlaWdodCkgewogICAgICAgIC8vIFZhbGlkIGNvbnRhaW5lciBmb3VuZAogICAgICAgIHNwYWNlRG93biA9IGNvbnRhaW5lci5vZmZzZXRUb3AgKyBjb250YWluZXIub2Zmc2V0SGVpZ2h0IC0gKGVsLm9mZnNldFRvcCArIGVsLm9mZnNldEhlaWdodCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRmFsbGJhY2sgdG8gZG9jdW1lbnQgYm9keQogICAgICAgIHZhciBkb2NIZWlnaHQgPSBNYXRoLm1heChkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCwgZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vZmZzZXRIZWlnaHQsIGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KTsKICAgICAgICBzcGFjZURvd24gPSBkb2NIZWlnaHQgLSAoZWwub2Zmc2V0VG9wICsgZWwub2Zmc2V0SGVpZ2h0KTsKICAgICAgfQoKICAgICAgdGhpcy5mb3JjZURyb3BPblRvcCA9IHRoaXMub3B0cy5kcm9wT2Zmc2V0SGVpZ2h0ID4gc3BhY2VEb3duOwogICAgfSwKICAgIC8vCiAgICAvLyBIZWxwZXJzCiAgICAvLwogICAgaXMxMmhSYW5nZTogZnVuY3Rpb24gaXMxMmhSYW5nZSh2YWx1ZSkgewogICAgICByZXR1cm4gL15cZHsxLDJ9KGF8cHxBfFApJC8udGVzdCh2YWx1ZSk7CiAgICB9LAogICAgbWF0Y2gxMmhSYW5nZTogZnVuY3Rpb24gbWF0Y2gxMmhSYW5nZSh2YWx1ZSkgewogICAgICByZXR1cm4gdmFsdWUubWF0Y2goL14oXGR7MSwyfSkoYXxwfEF8UCkkLyk7CiAgICB9LAogICAgaXNOdW1iZXI6IGZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7CiAgICAgIHJldHVybiAhaXNOYU4ocGFyc2VGbG9hdCh2YWx1ZSkpICYmIGlzRmluaXRlKHZhbHVlKTsKICAgIH0sCiAgICBpc0Jhc2ljVHlwZTogZnVuY3Rpb24gaXNCYXNpY1R5cGUodHlwZSkgewogICAgICByZXR1cm4gQ09ORklHLkJBU0lDX1RZUEVTLmluY2x1ZGVzKHR5cGUpOwogICAgfSwKICAgIGxvd2VyQ2FzZWRBcG06IGZ1bmN0aW9uIGxvd2VyQ2FzZWRBcG0oYXBtVmFsdWUpIHsKICAgICAgcmV0dXJuIChhcG1WYWx1ZSB8fCAnJykudG9Mb3dlckNhc2UoKTsKICAgIH0sCiAgICBnZXRUb2tlblJlZ2V4OiBmdW5jdGlvbiBnZXRUb2tlblJlZ2V4KHRva2VuKSB7CiAgICAgIHN3aXRjaCAodG9rZW4pIHsKICAgICAgICBjYXNlICdISCc6CiAgICAgICAgICByZXR1cm4gJyhbMDFdWzAtOV18MlswLTNdfEh7Mn0pJzsKCiAgICAgICAgY2FzZSAnSCc6CiAgICAgICAgICByZXR1cm4gJyhbMC05XXsxfXwxWzAtOV18MlswLTNdfEh7MX0pJzsKCiAgICAgICAgY2FzZSAnaGgnOgogICAgICAgICAgcmV0dXJuICcoMFsxLTldfDFbMC0yXXxoezJ9KSc7CgogICAgICAgIGNhc2UgJ2gnOgogICAgICAgICAgcmV0dXJuICcoWzEtOV17MX18MVswLTJdfGh7MX0pJzsKCiAgICAgICAgY2FzZSAna2snOgogICAgICAgICAgcmV0dXJuICcoMFsxLTldfDFbMC05XXwyWzAtNF18a3syfSknOwoKICAgICAgICBjYXNlICdrJzoKICAgICAgICAgIHJldHVybiAnKFsxLTldezF9fDFbMC05XXwyWzAtNF18a3sxfSknOwoKICAgICAgICBjYXNlICdtbSc6CiAgICAgICAgICByZXR1cm4gJyhbMC01XVswLTldfG17Mn0pJzsKCiAgICAgICAgY2FzZSAnc3MnOgogICAgICAgICAgcmV0dXJuICcoWzAtNV1bMC05XXxzezJ9KSc7CgogICAgICAgIGNhc2UgJ20nOgogICAgICAgICAgcmV0dXJuICcoWzAtOV17MX18WzEtNV1bMC05XXxtezF9KSc7CgogICAgICAgIGNhc2UgJ3MnOgogICAgICAgICAgcmV0dXJuICcoWzAtOV17MX18WzEtNV1bMC05XXxzezF9KSc7CgogICAgICAgIGNhc2UgJ0EnOgogICAgICAgICAgcmV0dXJuICcoQU18UE18QXsxfSknOwoKICAgICAgICBjYXNlICdhJzoKICAgICAgICAgIHJldHVybiAnKGFtfHBtfGF7MX0pJzsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfSwKICAgIGlzRW1wdHlWYWx1ZTogZnVuY3Rpb24gaXNFbXB0eVZhbHVlKHRhcmdldFRva2VuLCB0ZXN0VmFsdWUpIHsKICAgICAgcmV0dXJuICF0ZXN0VmFsdWUgfHwgIXRlc3RWYWx1ZS5sZW5ndGggfHwgdGVzdFZhbHVlICYmIHRlc3RWYWx1ZSA9PT0gdGFyZ2V0VG9rZW47CiAgICB9LAogICAgaXNWYWxpZFZhbHVlOiBmdW5jdGlvbiBpc1ZhbGlkVmFsdWUodGFyZ2V0VG9rZW4sIHRlc3RWYWx1ZSkgewogICAgICBpZiAoIXRhcmdldFRva2VuIHx8IHRoaXMuaXNFbXB0eVZhbHVlKHRhcmdldFRva2VuLCB0ZXN0VmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgdG9rZW5SZWdleFN0ciA9IHRoaXMuZ2V0VG9rZW5SZWdleCh0YXJnZXRUb2tlbik7CgogICAgICBpZiAoIXRva2VuUmVnZXhTdHIgfHwgIXRva2VuUmVnZXhTdHIubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IFJlZ0V4cCgiXiIuY29uY2F0KHRva2VuUmVnZXhTdHIsICIkIikpLnRlc3QodGVzdFZhbHVlKTsKICAgIH0sCiAgICBzYW5pdGl6ZWRWYWx1ZTogZnVuY3Rpb24gc2FuaXRpemVkVmFsdWUodGFyZ2V0VG9rZW4sIGlucHV0VmFsdWUpIHsKICAgICAgaWYgKHRoaXMuaXNWYWxpZFZhbHVlKHRhcmdldFRva2VuLCBpbnB1dFZhbHVlKSkgewogICAgICAgIHJldHVybiBpbnB1dFZhbHVlOwogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9LAogICAgZ2V0VG9rZW5UeXBlOiBmdW5jdGlvbiBnZXRUb2tlblR5cGUodG9rZW4pIHsKICAgICAgcmV0dXJuIHRoaXMuaW5Vc2UudHlwZXNbdGhpcy5pblVzZS50b2tlbnMuaW5kZXhPZih0b2tlbildIHx8ICcnOwogICAgfSwKICAgIGdldFRva2VuQnlUeXBlOiBmdW5jdGlvbiBnZXRUb2tlbkJ5VHlwZSh0eXBlKSB7CiAgICAgIHJldHVybiB0aGlzWyIiLmNvbmNhdCh0eXBlLCAiVHlwZSIpXSB8fCAnJzsKICAgIH0sCiAgICBpc01pbnV0ZU9yU2Vjb25kOiBmdW5jdGlvbiBpc01pbnV0ZU9yU2Vjb25kKHR5cGUpIHsKICAgICAgcmV0dXJuIFsnbWludXRlJywgJ3NlY29uZCddLmluY2x1ZGVzKHR5cGUpOwogICAgfSwKICAgIGRlYnVnTG9nOiBmdW5jdGlvbiBkZWJ1Z0xvZyhsb2dUZXh0KSB7CiAgICAgIHZhciBfdGhpczIwID0gdGhpczsKCiAgICAgIGlmICghbG9nVGV4dCB8fCAhbG9nVGV4dC5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBpZGVudGlmaWVyID0gJyc7CgogICAgICBpZiAodGhpcy5pZCkgewogICAgICAgIGlkZW50aWZpZXIgKz0gIiMiLmNvbmNhdCh0aGlzLmlkKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubmFtZSkgewogICAgICAgIGlkZW50aWZpZXIgKz0gIltuYW1lPSIuY29uY2F0KHRoaXMubmFtZSwgIl0iKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaW5wdXRDbGFzcykgewogICAgICAgIHZhciBpbnB1dENsYXNzZXMgPSBbXTsKCiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmlucHV0Q2xhc3MgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICBpbnB1dENsYXNzZXMgPSB0aGlzLmlucHV0Q2xhc3Muc3BsaXQoL1xzL2cpOwogICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh0aGlzLmlucHV0Q2xhc3MpKSB7CiAgICAgICAgICBpbnB1dENsYXNzZXMgPSBbXS5jb25jYXQoW10sIHRoaXMuaW5wdXRDbGFzcyk7CiAgICAgICAgfSBlbHNlIGlmIChfdHlwZW9mKHRoaXMuaW5wdXRDbGFzcykgPT09ICdvYmplY3QnKSB7CiAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmlucHV0Q2xhc3MpLmZvckVhY2goZnVuY3Rpb24gKGNsc05hbWUpIHsKICAgICAgICAgICAgaWYgKF90aGlzMjAuaW5wdXRDbGFzc1tjbHNOYW1lXSkgewogICAgICAgICAgICAgIGlucHV0Q2xhc3Nlcy5wdXNoKGNsc05hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHZhciBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoaW5wdXRDbGFzc2VzKSwKICAgICAgICAgICAgX3N0ZXA0OwoKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3I0LnMoKTsgIShfc3RlcDQgPSBfaXRlcmF0b3I0Lm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIGlucHV0Q2xhc3MgPSBfc3RlcDQudmFsdWU7CgogICAgICAgICAgICBpZiAoaW5wdXRDbGFzcyAmJiBpbnB1dENsYXNzLnRyaW0oKS5sZW5ndGgpIHsKICAgICAgICAgICAgICBpZGVudGlmaWVyICs9ICIuIi5jb25jYXQoaW5wdXRDbGFzcy50cmltKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yNC5mKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgZmluYWxMb2dUZXh0ID0gIkRFQlVHOiAiLmNvbmNhdChsb2dUZXh0KS5jb25jYXQoaWRlbnRpZmllciA/ICJcblx0KCIuY29uY2F0KGlkZW50aWZpZXIsICIpIikgOiAnJyk7CgogICAgICBpZiAod2luZG93LmNvbnNvbGUuZGVidWcgJiYgdHlwZW9mIHdpbmRvdy5jb25zb2xlLmRlYnVnID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgd2luZG93LmNvbnNvbGUuZGVidWcoZmluYWxMb2dUZXh0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB3aW5kb3cuY29uc29sZS5sb2coZmluYWxMb2dUZXh0KTsKICAgICAgfQogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5kZWJvdW5jZVRpbWVyKTsKICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5zZWxlY3Rpb25UaW1lcik7CiAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMua2JJbnB1dFRpbWVyKTsKICAgIHRoaXMucmVuZGVyRm9ybWF0KCk7CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLmRlYm91bmNlVGltZXIpOwogICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnNlbGVjdGlvblRpbWVyKTsKICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5rYklucHV0VGltZXIpOwogIH0KfTs="},{"version":3,"sources":["F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\vue2-timepicker\\src\\vue-timepicker.vue"],"names":[],"mappings":"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","sourcesContent":["<script>\nconst CONFIG = {\n  HOUR_TOKENS: ['HH', 'H', 'hh', 'h', 'kk', 'k'],\n  MINUTE_TOKENS: ['mm', 'm'],\n  SECOND_TOKENS: ['ss', 's'],\n  APM_TOKENS: ['A', 'a'],\n  BASIC_TYPES: ['hour', 'minute', 'second', 'apm']\n}\n\nconst DEFAULT_OPTIONS = {\n  format: 'HH:mm',\n  minuteInterval: 1,\n  secondInterval: 1,\n  hourRange: null,\n  minuteRange: null,\n  secondRange: null,\n  hideDisabledHours: false,\n  hideDisabledMinutes: false,\n  hideDisabledSeconds: false,\n  hideDisabledItems: false,\n  hideDropdown: false,\n  blurDelay: 300,\n  manualInputTimeout: 1000,\n  dropOffsetHeight: 160\n}\n\nexport default {\n  name: 'VueTimepicker',\n  props: {\n    value: { type: [ Object, String ] },\n    format: { type: String },\n    minuteInterval: { type: [ Number, String ] },\n    secondInterval: { type: [ Number, String ] },\n\n    hourRange: { type: Array },\n    minuteRange: { type: Array },\n    secondRange: { type: Array },\n\n    hideDisabledHours: { type: Boolean, default: false },\n    hideDisabledMinutes: { type: Boolean, default: false },\n    hideDisabledSeconds: { type: Boolean, default: false },\n    hideDisabledItems: { type: Boolean, default: false },\n\n    hideClearButton: { type: Boolean, default: false },\n    disabled: { type: Boolean, default: false },\n    closeOnComplete: { type: Boolean, default: false },\n\n    id: { type: String },\n    name: { type: String },\n    inputClass: { type: [ String, Object, Array ] },\n    placeholder: { type: String },\n    tabindex: { type: [ Number, String ], default: 0 },\n    inputWidth: { type: String },\n    autocomplete: { type: String, default: 'off' },\n\n    hourLabel: { type: String },\n    minuteLabel: { type: String },\n    secondLabel: { type: String },\n    apmLabel: { type: String },\n    amText: { type: String },\n    pmText: { type: String },\n\n    blurDelay: { type: [ Number, String ] },\n    advancedKeyboard: { type: Boolean, default: false },\n\n    lazy: { type: Boolean, default: false },\n    autoScroll: { type: Boolean, default: false },\n\n    dropDirection: { type: String, default: 'down' },\n    dropOffsetHeight: { type: [ Number, String ] },\n    containerId: { type: String },\n    appendToBody: { type: Boolean, default: false },\n\n    manualInput: { type: Boolean, default: false },\n    manualInputTimeout: { type: [ Number, String ] },\n    hideDropdown: { type: Boolean, default: false },\n    fixedDropdownButton: { type: Boolean, default: false },\n\n    debugMode: { type: Boolean, default: false }\n  },\n\n  data () {\n    return {\n      timeValue: {},\n\n      hours: [],\n      minutes: [],\n      seconds: [],\n      apms: [],\n\n      isActive: false,\n      showDropdown: false,\n      isFocusing: false,\n      debounceTimer: undefined,\n\n      hourType: 'HH',\n      minuteType: 'mm',\n      secondType: '',\n      apmType: '',\n      hour: '',\n      minute: '',\n      second: '',\n      apm: '',\n      fullValues: undefined,\n      bakDisplayTime: undefined,\n      doClearApmChecking: false,\n\n      selectionTimer: undefined,\n      kbInputTimer: undefined,\n      kbInputLog: '',\n      bakCurrentPos: undefined,\n      forceDropOnTop: false\n    }\n  },\n\n  computed: {\n    opts () {\n      const options = Object.assign({}, DEFAULT_OPTIONS)\n\n      if (this.format && this.format.length) {\n        options.format = String(this.format)\n      }\n\n      if (this.isNumber(this.minuteInterval)) {\n        options.minuteInterval = +this.minuteInterval\n      }\n      // minuteInterval failsafe\n      if (!options.minuteInterval || options.minuteInterval < 1 || options.minuteInterval > 60) {\n        if (this.debugMode) {\n          if (options.minuteInterval > 60) {\n            this.debugLog(`\"minute-interval\" should be less than 60. Current value is ${this.minuteInterval}`)\n          } else if (options.minuteInterval === 0 || options.minuteInterval < 1) {\n            this.debugLog(`\"minute-interval\" should be NO less than 1. Current value is ${this.minuteInterval}`)\n          }\n        }\n        if (options.minuteInterval === 0) {\n          options.minuteInterval = 60\n        } else {\n          options.minuteInterval = 1\n        }\n      }\n\n      if (this.isNumber(this.secondInterval)) {\n        options.secondInterval = +this.secondInterval\n      }\n      // secondInterval failsafe\n      if (!options.secondInterval || options.secondInterval < 1 || options.secondInterval > 60) {\n        if (this.debugMode) {\n          if (options.secondInterval > 60) {\n            this.debugLog(`\"second-interval\" should be less than 60. Current value is ${this.secondInterval}`)\n          } else if (options.secondInterval === 0 || options.secondInterval < 1) {\n            this.debugLog(`\"second-interval\" should be NO less than 1. Current value is ${this.secondInterval}`)\n          }\n        }\n        if (options.secondInterval === 0) {\n          options.secondInterval = 60\n        } else {\n          options.secondInterval = 1\n        }\n      }\n\n      if (this.hourRange && Array.isArray(this.hourRange)) {\n        options.hourRange = JSON.parse(JSON.stringify(this.hourRange))\n        if (!this.hourRange.length && this.debugMode) {\n          this.debugLog('The \"hour-range\" array is empty (length === 0)')\n        }\n      }\n\n      if (this.minuteRange && Array.isArray(this.minuteRange)) {\n        options.minuteRange = JSON.parse(JSON.stringify(this.minuteRange))\n        if (!this.minuteRange.length && this.debugMode) {\n          this.debugLog('The \"minute-range\" array is empty (length === 0)')\n        }\n      }\n\n      if (this.secondRange && Array.isArray(this.secondRange)) {\n        options.secondRange = JSON.parse(JSON.stringify(this.secondRange))\n        if (!this.secondRange.length && this.debugMode) {\n          this.debugLog('The \"second-range\" array is empty (length === 0)')\n        }\n      }\n\n      if (this.hideDisabledItems) {\n        options.hideDisabledItems = true\n      }\n\n      if (this.hideDisabledHours || this.hideDisabledItems) {\n        options.hideDisabledHours = true\n      }\n      if (this.hideDisabledMinutes || this.hideDisabledItems) {\n        options.hideDisabledMinutes = true\n      }\n      if (this.hideDisabledSeconds || this.hideDisabledItems) {\n        options.hideDisabledSeconds = true\n      }\n\n      if (this.hideDropdown) {\n        if (this.manualInput) {\n          options.hideDropdown = true\n        } else if (this.debugMode) {\n          this.debugLog('\"hide-dropdown\" only works with \"manual-input\" mode')\n        }\n      }\n\n      if (this.blurDelay && +this.blurDelay > 0) {\n        options.blurDelay = +this.blurDelay\n      }\n\n      if (this.manualInputTimeout && +this.manualInputTimeout > 0) {\n        options.manualInputTimeout = +this.manualInputTimeout\n      }\n\n      if (this.dropOffsetHeight && +this.dropOffsetHeight > 0) {\n        options.dropOffsetHeight = +this.dropOffsetHeight\n      }\n\n      return options\n    },\n\n    useStringValue () {\n      return typeof this.value === 'string'\n    },\n\n    formatString () {\n      return this.opts.format || DEFAULT_OPTIONS.format\n    },\n\n    inUse () {\n      const typesInUse = CONFIG.BASIC_TYPES.filter(type => this.getTokenByType(type))\n      // Sort types and tokens by their sequence in the \"format\" string\n      typesInUse.sort((l, r) => {\n        return this.formatString.indexOf(this.getTokenByType(l) || null) - this.formatString.indexOf(this.getTokenByType(r) || null)\n      })\n      const tokensInUse = typesInUse.map(type => this.getTokenByType(type))\n      return {\n        hour: !!this.hourType,\n        minute: !!this.minuteType,\n        second: !!this.secondType,\n        apm: !!this.apmType,\n        types: typesInUse || [],\n        tokens: tokensInUse || []\n      }\n    },\n\n    displayTime () {\n      let formatString = String(this.formatString)\n      if (this.hour) {\n        formatString = formatString.replace(new RegExp(this.hourType, 'g'), this.hour)\n      }\n      if (this.minute) {\n        formatString = formatString.replace(new RegExp(this.minuteType, 'g'), this.minute)\n      }\n      if (this.second && this.secondType) {\n        formatString = formatString.replace(new RegExp(this.secondType, 'g'), this.second)\n      }\n      if (this.apm && this.apmType) {\n        formatString = formatString.replace(new RegExp(this.apmType, 'g'), this.apm)\n      }\n      return formatString\n    },\n\n    customDisplayTime () {\n      if (!this.amText && !this.pmText) {\n        return this.displayTime\n      }\n      return this.displayTime.replace(new RegExp(this.apm, 'g'), this.apmDisplayText(this.apm))\n    },\n\n    inputIsEmpty () {\n      return this.formatString === this.displayTime\n    },\n\n    allValueSelected () {\n      if (\n        (this.inUse.hour && !this.hour) ||\n        (this.inUse.minute && !this.minute) ||\n        (this.inUse.second && !this.second) ||\n        (this.inUse.apm && !this.apm)\n      ) {\n        return false\n      }\n      return true\n    },\n\n    columnsSequence () {\n      return this.inUse.types.map(type => type) || []\n    },\n\n    showClearBtn () {\n      if (this.hideClearButton || this.disabled) {\n        return false\n      }\n      return !this.inputIsEmpty\n    },\n\n    showDropdownBtn () {\n      if (this.fixedDropdownButton) { return true }\n      if (this.opts.hideDropdown && this.isActive && !this.showDropdown) {\n        return true\n      }\n      return false\n    },\n\n    baseOn12Hours () {\n      return this.hourType === 'h' || this.hourType === 'hh'\n    },\n\n    hourRangeIn24HrFormat () {\n      if (!this.hourType || !this.opts.hourRange) { return false }\n      if (!this.opts.hourRange.length) { return [] }\n\n      const range = []\n      this.opts.hourRange.forEach(value => {\n        if (value instanceof Array) {\n          if (value.length > 2 && this.debugMode) {\n            this.debugLog(`Nested array within \"hour-range\" must contain no more than two items. Only the first two items of ${JSON.stringify(value)} will be taken into account.`)\n          }\n\n          let start = value[0]\n          let end = value[1] || value[0]\n\n          if (this.is12hRange(start)) {\n            start = this.translate12hRange(start)\n          }\n          if (this.is12hRange(end)) {\n            end = this.translate12hRange(end)\n          }\n\n          for (let i = +start; i <= +end; i++) {\n            if (i < 0 || i > 24) { continue }\n            if (!range.includes(i)) {\n              range.push(i)\n            }\n          }\n        } else {\n          if (this.is12hRange(value)) {\n            value = this.translate12hRange(value)\n          } else {\n            value = +value\n          }\n          if (value < 0 || value > 24) { return }\n          if (!range.includes(value)) {\n            range.push(value)\n          }\n        }\n      })\n      range.sort((l, r) => { return l - r })\n      return range\n    },\n\n    restrictedHourRange () {\n      // No restriction\n      if (!this.hourRangeIn24HrFormat) { return false }\n      // 12-Hour\n      if (this.baseOn12Hours) {\n        const range = this.hourRangeIn24HrFormat.map((value) => {\n          if (value === 12) {\n            return '12p'\n          } else if (value === 24 || value === 0) {\n            return '12a'\n          }\n          return value > 12 ? `${value % 12}p` : `${value}a`\n        })\n        return range\n      }\n      // 24-Hour\n      return this.hourRangeIn24HrFormat\n    },\n\n    validHoursList () {\n      if (!this.manualInput) { return false }\n      if (this.restrictedHourRange) {\n        let list = []\n        if (this.baseOn12Hours) {\n          list = this.restrictedHourRange.map(hr => {\n            const l = hr.substr(0, hr.length - 1)\n            const r = hr.substr(-1)\n            return `${this.formatValue(this.hourType, l)}${r}`\n          })\n          const am12Index = list.indexOf('12a')\n          if (am12Index > 0) {\n            // Make '12a' the first item in h/hh\n            list.unshift(list.splice(am12Index, 1)[0])\n          }\n          return list\n        }\n        list = this.restrictedHourRange.map(hr => {\n          return this.formatValue(this.hourType, hr)\n        })\n        if (list.length > 1 && list[0] && list[0] === '24') {\n          // Make '24' the last item in k/kk\n          list.push(list.shift())\n        }\n        return list\n      }\n      if (this.baseOn12Hours) {\n        return [].concat([], this.hours.map(hr => `${hr}a`), this.hours.map(hr => `${hr}p`))\n      }\n      return this.hours\n    },\n\n    has () {\n      const result = {\n        customApmText: false\n      }\n      const apmEnabled = !!this.apmType\n\n      if (apmEnabled && this.hourRangeIn24HrFormat && this.hourRangeIn24HrFormat.length) {\n        const range = [].concat([], this.hourRangeIn24HrFormat)\n        result.am = range.some(value => value < 12 || value === 24)\n        result.pm = range.some(value => value >= 12 && value < 24)\n      } else {\n        result.am = apmEnabled\n        result.pm = apmEnabled\n      }\n      if ((this.amText && this.amText.length) || (this.pmText && this.pmText.length)) {\n        result.customApmText = true\n      }\n      return result\n    },\n\n    minuteRangeList () {\n      if (!this.minuteType || !this.opts.minuteRange) { return false }\n      if (!this.opts.minuteRange.length) { return [] }\n      return this.renderRangeList(this.opts.minuteRange, 'minute')\n    },\n\n    secondRangeList () {\n      if (!this.secondType || !this.opts.secondRange) { return false }\n      if (!this.opts.secondRange.length) { return [] }\n      return this.renderRangeList(this.opts.secondRange, 'second')\n    },\n    \n    hourLabelText () {\n      return this.hourLabel || this.hourType\n    },\n    minuteLabelText () {\n      return this.minuteLabel || this.minuteType\n    },\n    secondLabelText() {\n      return this.secondLabel || this.secondType\n    },\n    apmLabelText () {\n      return this.apmLabel || this.apmType\n    },\n\n    inputWidthStyle () {\n      if (!this.inputWidth || !this.inputWidth.length) { return }\n      return {\n        width: this.inputWidth\n      }\n    },\n\n    tokenRegexBase () {\n      return this.inUse.tokens.join('|')\n    },\n\n    tokenChunks () {\n      if (!this.manualInput && !this.useStringValue) { return false }\n\n      const formatString = String(this.formatString)\n      const tokensRegxStr = `(${this.tokenRegexBase})+?`\n      const tokensMatchAll = this.getMatchAllByRegex(formatString, tokensRegxStr)\n\n      const tokenChunks = []\n      for (let tkMatch of tokensMatchAll) {\n        const rawToken = tkMatch[0]\n        const tokenMatchItem = {\n          index: tkMatch.index,\n          token: rawToken,\n          type: this.getTokenType(rawToken),\n          needsCalibrate: rawToken.length < 2,\n          len: (rawToken || '').length\n        }\n        tokenChunks.push(tokenMatchItem)\n      }\n      return tokenChunks\n    },\n\n    needsPosCalibrate () {\n      if (!this.manualInput) { return false }\n      return this.tokenChunks.some(chk => chk.needsCalibrate)\n    },\n\n    tokenChunksPos () {\n      if (!this.manualInput) { return false }\n      if (!this.needsPosCalibrate) {\n        return this.tokenChunks.map(chk => {\n          return {\n            token: chk.token,\n            type: chk.type,\n            start: chk.index,\n            end: chk.index + chk.len\n          }\n        })\n      }\n      const list = []\n      let calibrateLen = 0\n      this.tokenChunks.forEach(chk => {\n        let chunkCurrentLen\n        // Adjust for customized AM/PM text\n        if (chk.type === 'apm' && this.has.customApmText) {\n          if (this.apm && this.apm.length) {\n            const customApmText = this.apm.toLowerCase() === 'am' ? this.amText : this.pmText\n            chunkCurrentLen = (customApmText && customApmText.length) ? customApmText.length : chk.len\n          } else {\n            chunkCurrentLen = chk.len\n          }\n        // Others\n        } else {\n          chunkCurrentLen = this[chk.type] && this[chk.type].length ? this[chk.type].length : chk.len\n        }\n        list.push({\n          token: chk.token,\n          type: chk.type,\n          start: chk.index + calibrateLen,\n          end: chk.index + calibrateLen + chunkCurrentLen\n        })\n        if (chk.needsCalibrate && chunkCurrentLen > chk.len) {\n          calibrateLen += (chunkCurrentLen - chk.len)\n        }\n      })\n      return list\n    },\n\n    invalidValues () {\n      if (this.inputIsEmpty) { return [] }\n      if (!this.restrictedHourRange && !this.minuteRangeList && !this.secondRangeList && this.opts.minuteInterval === 1 && this.opts.secondInterval === 1) { return [] }\n\n      const result = []\n      if (this.inUse.hour && !this.isEmptyValue(this.hourType, this.hour) && (!this.isValidValue(this.hourType, this.hour) || this.isDisabled('hour', this.hour))) {\n        result.push('hour')\n      }\n      if (this.inUse.minute && !this.isEmptyValue(this.minuteType, this.minute) && (!this.isValidValue(this.minuteType, this.minute) || this.isDisabled('minute', this.minute) || this.notInInterval('minute', this.minute))) {\n        result.push('minute')\n      }\n      if (this.inUse.second && !this.isEmptyValue(this.secondType, this.second) && (!this.isValidValue(this.secondType, this.second) || this.isDisabled('second', this.second) || this.notInInterval('second', this.second))) {\n        result.push('second')\n      }\n      if (this.inUse.apm && !this.isEmptyValue(this.apmType, this.apm) && (!this.isValidValue(this.apmType, this.apm) || this.isDisabled('apm', this.apm))) {\n        result.push('apm')\n      }\n      if (result.length) {\n        return result\n      }\n      return []\n    },\n\n    hasInvalidInput () {\n      return Boolean(this.invalidValues && this.invalidValues.length)\n    },\n\n    autoDirectionEnabled () {\n      return this.dropDirection === 'auto'\n    },\n\n    dropdownDirClass () {\n      if (this.autoDirectionEnabled) {\n        return this.forceDropOnTop ? 'drop-up' : 'drop-down'\n      }\n      return this.dropDirection === 'up' ? 'drop-up' : 'drop-down'      \n    }\n  },\n\n  watch: {\n    'opts.format' (newValue) {\n      this.renderFormat(newValue)\n    },\n    'opts.minuteInterval' (newInteval) {\n      this.renderList('minute', newInteval)\n    },\n    'opts.secondInterval' (newInteval) {\n      this.renderList('second', newInteval)\n    },\n    value: {\n      deep: true,\n      handler () {\n        this.readValues()\n      }\n    },\n    displayTime () {\n      this.fillValues()\n    },\n    disabled (toDisabled) {\n      if (toDisabled) {\n        // Force close dropdown and reset status when disabled\n        if (this.isActive) {\n          this.isActive = false\n        }\n        if (this.showDropdown) {\n          this.showDropdown = false\n        }\n      }\n    },\n    'invalidValues.length' (newLength, oldLength) {\n      if (newLength && newLength >= 1) {\n        this.$emit('error', this.invalidValues)\n      } else if (oldLength && oldLength >= 1) {\n        this.$emit('error', [])\n      }\n    }\n  },\n\n  methods: {\n    formatValue (token, i) {\n      if (!this.isNumber(i)) { return '' }\n      i = +i\n      switch (token) {\n        case 'H':\n        case 'h':\n        case 'k':\n        case 'm':\n        case 's':\n          if (['h', 'k'].includes(token) && i === 0) {\n            return token === 'k' ? '24' : '12'\n          }\n          return String(i)\n        case 'HH':\n        case 'mm':\n        case 'ss':\n        case 'hh':\n        case 'kk':\n          if (['hh', 'kk'].includes(token) && i === 0) {\n            return token === 'kk' ? '24' : '12'\n          }\n          return i < 10 ? `0${i}` : String(i)\n        default:\n          return ''\n      }\n    },\n\n    checkAcceptingType (validValues, formatString) {\n      if (!validValues || !formatString || !formatString.length) { return '' }\n      for (let i = 0; i < validValues.length; i++) {\n        if (formatString.indexOf(validValues[i]) > -1) {\n          return validValues[i]\n        }\n      }\n      return ''\n    },\n\n    renderFormat (newFormat) {\n      newFormat = newFormat || this.opts.format || DEFAULT_OPTIONS.format\n\n      let hourType = this.checkAcceptingType(CONFIG.HOUR_TOKENS, newFormat)\n      let minuteType = this.checkAcceptingType(CONFIG.MINUTE_TOKENS, newFormat)\n      this.secondType = this.checkAcceptingType(CONFIG.SECOND_TOKENS, newFormat)\n      this.apmType = this.checkAcceptingType(CONFIG.APM_TOKENS, newFormat)\n\n      // Failsafe checking\n      if (!hourType && !minuteType && !this.secondType && !this.apmType) {\n        if (this.debugMode && this.format) {\n          this.debugLog(`No valid tokens found in your defined \"format\" string \"${this.format}\". Fallback to the default \"HH:mm\" format.`)\n        }\n        hourType = 'HH'\n        minuteType = 'mm'\n      }\n      this.hourType = hourType\n      this.minuteType = minuteType\n\n      this.hourType ? this.renderHoursList() : this.hours = []\n      this.minuteType ? this.renderList('minute') : this.minutes = []\n      this.secondType ? this.renderList('second') : this.seconds = []\n      this.apmType ? this.renderApmList() : this.apms = []\n\n      this.$nextTick(() => {\n        this.readValues()\n      })\n    },\n\n    renderHoursList () {\n      const hoursCount = this.baseOn12Hours ? 12 : 24\n      const hours = []\n      for (let i = 0; i < hoursCount; i++) {\n        if (this.hourType === 'k' || this.hourType === 'kk') {\n          hours.push(this.formatValue(this.hourType, i + 1))\n        } else {\n          hours.push(this.formatValue(this.hourType, i))\n        }\n      }\n      this.hours = hours\n    },\n\n    renderList (listType, interval) {\n      if (!this.isMinuteOrSecond(listType)) { return }\n\n      const isMinute = listType === 'minute'\n      interval = interval || (isMinute ? (this.opts.minuteInterval || DEFAULT_OPTIONS.minuteInterval) : (this.opts.secondInterval || DEFAULT_OPTIONS.secondInterval))\n\n      const result = []\n      for (let i = 0; i < 60; i += interval) {\n        result.push(this.formatValue(isMinute ? this.minuteType : this.secondType, i))\n      }\n      isMinute ? this.minutes = result : this.seconds = result\n    },\n\n    renderApmList () {\n      this.apms = this.apmType === 'A' ? ['AM', 'PM'] : ['am', 'pm']\n    },\n\n    readValues () {\n      if (this.useStringValue) {\n        if (this.debugMode) {\n          this.debugLog(`Received a string value: \"${this.value}\"`)\n        }\n        this.readStringValues(this.value)\n      } else {\n        if (this.debugMode) {\n          this.debugLog(`Received an object value: \"${JSON.stringify(this.value || {})}\"`)\n        }\n        this.readObjectValues(this.value)\n      }\n    },\n\n    readObjectValues (objValue) {\n      const timeValue = JSON.parse(JSON.stringify(objValue || {}))\n      const values = Object.keys(timeValue)\n\n      // Failsafe for empty `v-model` object\n      if (values.length === 0) {\n        this.addFallbackValues()\n        return\n      }\n\n      CONFIG.BASIC_TYPES.forEach(type => {\n        const token = this.getTokenByType(type)\n        if (values.indexOf(token) > -1) {\n          const sanitizedValue = this.sanitizedValue(token, timeValue[token])\n          this[type] = sanitizedValue\n          timeValue[token] = sanitizedValue\n        } else {\n          this[type] = ''\n        }\n      })\n      this.timeValue = timeValue\n    },\n\n    getMatchAllByRegex (testString, regexString) {\n      const str = 'polyfillTest'\n      const needsPolyfill = Boolean(!str.matchAll || typeof str.matchAll !== 'function')\n      return needsPolyfill ? this.polyfillMatchAll(testString, regexString) : testString.matchAll(new RegExp(regexString, 'g'))\n    },\n\n    readStringValues (stringValue) {\n      // Failsafe for empty `v-model` string\n      if (!stringValue || !stringValue.length) {\n        this.addFallbackValues()\n        return\n      }\n\n      const formatString = String(this.formatString)\n      const tokensRegxStr = `(${this.tokenRegexBase})+?`\n      const othersRegxStr = `[^(${this.tokenRegexBase})]+`\n\n      const tokensMatchAll = this.getMatchAllByRegex(formatString, tokensRegxStr)\n      const othersMatchAll = this.getMatchAllByRegex(formatString, othersRegxStr)\n\n      const chunks = []\n      const tokenChunks = []\n\n      for (let tkMatch of tokensMatchAll) {\n        const tokenMatchItem = {\n          index: tkMatch.index,\n          token: tkMatch[0],\n          isValueToken: true\n        }\n        chunks.push(tokenMatchItem)\n        tokenChunks.push(tokenMatchItem)\n      }\n\n      for (let otMatch of othersMatchAll) {\n        chunks.push({\n          index: otMatch.index,\n          token: otMatch[0]\n        })\n      }\n\n      chunks.sort((l, r) => l.index < r.index ? -1 : 1)\n\n      let regexCombo = ''\n      chunks.forEach(chunk => {\n        if (chunk.isValueToken) {\n          const tokenRegex = this.getTokenRegex(chunk.token) || ''\n          regexCombo += tokenRegex\n        } else {\n          const safeChars = chunk.token.replace(/\\\\{0}(\\*|\\?|\\.|\\+)/g, '\\\\$1')\n          regexCombo += `(?:${safeChars})`\n        }\n      })\n\n      const comboReg = new RegExp(regexCombo)\n\n      // Do test before match\n      if (comboReg.test(stringValue)) {\n        const matchResults = stringValue.match(new RegExp(regexCombo))\n        const valueResults = matchResults.slice(1, tokenChunks.length + 1)\n        const timeValue = {}\n        valueResults.forEach((value, vrIndex) => {\n          if (tokenChunks[vrIndex]) {\n            const targetToken = tokenChunks[vrIndex].token\n            timeValue[targetToken] = this.setValueFromString(value, targetToken)\n          }\n        })\n        this.timeValue = timeValue\n\n        if (this.debugMode) {\n          const tokenChunksForLog = tokenChunks.map(tChunk => tChunk && tChunk.token)\n          this.debugLog(`Successfully parsed values ${JSON.stringify(valueResults)}\\nfor ${JSON.stringify(tokenChunksForLog)}\\nin format pattern '${this.formatString}'`)\n        }\n      } else {\n        if (this.debugMode) {\n          this.debugLog(`The input string in \"v-model\" does NOT match the \"format\" pattern\\nformat: ${this.formatString}\\nv-model: ${stringValue}`)\n        }\n      }\n    },\n\n    polyfillMatchAll (targetString, regxStr) {\n      const matchesList = targetString.match(new RegExp(regxStr, 'g'))\n      const result = []\n      const indicesReg = []\n      if (matchesList && matchesList.length) {\n        matchesList.forEach(matchedItem => {\n          const existIndex = indicesReg.findIndex(idxItem => idxItem.str === matchedItem)\n          let index\n          if (existIndex >= 0) {\n            if (indicesReg[existIndex] && indicesReg[existIndex].regex) {\n              index = indicesReg[existIndex].regex.exec(targetString).index\n            }\n          } else {\n            const itemIndicesRegex = new RegExp(matchedItem, 'g')\n            index = itemIndicesRegex.exec(targetString).index\n            indicesReg.push({\n              str: String(matchedItem),\n              regex: itemIndicesRegex\n            })\n          }\n          result.push({\n            0: String(matchedItem),\n            index: index\n          })\n        })\n      }\n      return result\n    },\n\n    addFallbackValues () {\n      const timeValue = {}\n      this.inUse.types.forEach(type => {\n        timeValue[this.getTokenByType(type)] = ''\n      })\n      this.timeValue = timeValue\n    },\n\n    setValueFromString (parsedValue, token) {\n      if (!token || !parsedValue) { return '' }\n      const tokenType = this.getTokenType(token)\n      if (!tokenType || !tokenType.length) { return '' }\n      const stdValue = (parsedValue !== this.getTokenByType(tokenType)) ? parsedValue : ''\n      this[tokenType] = stdValue\n      return stdValue\n    },\n\n    fillValues (forceEmit) {\n      const fullValues = {}\n\n      const baseHour = this.hour\n      const baseHourType = this.hourType\n\n      let apmValue\n\n      // Hour type or hour value is NOT set in the \"format\" string\n      if (!baseHourType || !this.isNumber(baseHour)) {\n        CONFIG.HOUR_TOKENS.forEach(token => fullValues[token] = '')\n        apmValue = this.lowerCasedApm(this.apm || '')\n        fullValues.a = apmValue\n        fullValues.A = apmValue.toUpperCase()\n\n      // Both Hour type and value are set\n      } else {\n        const hourValue = +baseHour\n        const apmValue = (this.baseOn12Hours && this.apm) ? this.lowerCasedApm(this.apm) : false\n\n        CONFIG.HOUR_TOKENS.forEach((token) => {\n          if (token === baseHourType) {\n            fullValues[token] = baseHour\n            return\n          }\n\n          let value\n          let apm\n          switch (token) {\n            case 'H':\n            case 'HH':\n            case 'k':\n            case 'kk':\n              if (this.baseOn12Hours) {\n                if (apmValue === 'pm') {\n                  value = hourValue < 12 ? hourValue + 12 : hourValue\n                } else if (['k', 'kk'].includes(token)) {\n                  value = hourValue === 12 ? 24 : hourValue\n                } else {\n                  value = hourValue % 12\n                }\n              } else {\n                if (['k', 'kk'].includes(token)) {\n                  value = hourValue === 0 ? 24 : hourValue\n                } else {\n                  value = hourValue % 24\n                }\n              }\n              fullValues[token] = this.formatValue(token, value)\n              break\n            case 'h':\n            case 'hh':\n              // h <-> hh\n              if (this.baseOn12Hours) {\n                value = hourValue\n                apm = apmValue || ''\n              // Read from other hour formats\n              } else {\n                if (hourValue > 11 && hourValue < 24) {\n                  apm = 'pm'\n                  value = hourValue === 12 ? 12 : hourValue % 12\n                } else {\n                  apm = 'am'\n                  value = hourValue % 12 === 0 ? 12 : hourValue\n                }\n              }\n              fullValues[token] = this.formatValue(token, value)\n              fullValues.a = apm\n              fullValues.A = apm.toUpperCase()\n              break\n          }\n        })\n      }\n\n      fullValues.m = this.formatValue('m', this.minute)\n      fullValues.mm = this.formatValue('mm', this.minute)\n      fullValues.s = this.formatValue('s', this.second)\n      fullValues.ss = this.formatValue('ss', this.second)\n\n      this.fullValues = fullValues\n\n      // On lazy mode, emit `input` and `change` events only when:\n      // - The user pick a new value and then close the dropdown\n      // - The user click the (\"x\") clear button\n      if (!this.lazy || forceEmit) {\n        this.emitTimeValue()\n      }\n\n      if (this.closeOnComplete && this.allValueSelected && this.showDropdown) {\n        this.toggleActive()\n      }\n    },\n\n    getFullData () {\n      if (!this.fullValues) {\n        this.fillValues()\n      }\n      return {\n        data: JSON.parse(JSON.stringify(this.fullValues)),\n        displayTime: this.inputIsEmpty ? '' : String(this.displayTime)\n      }\n    },\n\n    emitTimeValue () {\n      if (this.lazy && this.bakDisplayTime === this.displayTime) {\n        if (this.debugMode) {\n          this.debugLog('The value does not change on `lazy` mode. Skip the emitting `input` and `change` event.')\n        }\n        return\n      }\n\n      const fullData = this.getFullData()\n\n      if (this.useStringValue) {\n        this.$emit('input', fullData.displayTime)\n      } else {\n        const fullValues = fullData.data\n        const tokensInUse = this.inUse.tokens || []\n        const timeValue = {}\n        tokensInUse.forEach((token) => {\n          timeValue[token] = fullValues[token] || ''\n        })\n        this.$emit('input', JSON.parse(JSON.stringify(timeValue)))\n      }\n\n      this.$emit('change', fullData)\n    },\n\n    translate12hRange (value) {\n      const valueT = this.match12hRange(value)\n      if (+valueT[1] === 12) {\n        return +valueT[1] + (valueT[2].toLowerCase() === 'p' ? 0 : 12)\n      }\n      return +valueT[1] + (valueT[2].toLowerCase() === 'p' ? 12 : 0)\n    },\n\n    isDisabled (type, value) {\n      if (!this.isBasicType(type) || !this.inUse[type]) { return true }\n      switch (type) {\n        case 'hour':\n          return this.isDisabledHour(value)\n        case 'minute':\n        case 'second':\n          if (!this[`${type}RangeList`]) {\n            return false\n          }\n          return !this[`${type}RangeList`].includes(value)\n        case 'apm':\n          if (!this.restrictedHourRange) {\n            return false\n          }\n          return !this.has[this.lowerCasedApm(value)]\n        default:\n          return true\n      }\n    },\n\n    isDisabledHour (value) {\n      if (!this.restrictedHourRange) { return false }\n      if (this.baseOn12Hours) {\n        if (!this.apm || !this.apm.length) {\n          return false\n        } else {\n          const token = this.apm.toLowerCase() === 'am' ? 'a' : 'p'\n          return !this.restrictedHourRange.includes(`${+value}${token}`)\n        }\n      }\n      // Fallback for 'HH' and 'H hour format with a `hour-range` in a 12-hour form\n      if (\n        (this.hourType === 'HH' || this.hourType === 'H') &&\n        +value === 0 && this.restrictedHourRange.includes(24)\n      ) {\n        return false\n      }\n      return !this.restrictedHourRange.includes(+value)\n    },\n\n    notInInterval (section, value) {\n      if (!section || !this.isMinuteOrSecond(section)) { return }\n      if (this.opts[`${section}Interval`] === 1) { return false }\n      return +value % this.opts[`${section}Interval`] !== 0\n    },\n\n    renderRangeList (rawRange, section) {\n      if (!rawRange || !section || !this.isMinuteOrSecond(section)) { return [] }\n      const range = []\n      let formatedValue\n      rawRange.forEach(value => {\n        if (value instanceof Array) {\n          if (value.length > 2 && this.debugMode) {\n            this.debugLog(`Nested array within \"${section}-range\" must contain no more than two items. Only the first two items of ${JSON.stringify(value)} will be taken into account.`)\n          }\n          const start = value[0]\n          const end = value[1] || value[0]\n          for (let i = +start; i <= +end; i++) {\n            if (i < 0 || i > 59) { continue }\n            formatedValue = this.formatValue(this.getTokenByType(section), i)\n            if (!range.includes(formatedValue)) {\n              range.push(formatedValue)\n            }\n          }\n        } else {\n          if (+value < 0 || +value > 59) { return }\n          formatedValue = this.formatValue(this.getTokenByType(section), value)\n          if (!range.includes(formatedValue)) {\n            range.push(formatedValue)\n          }\n        }\n      })\n      range.sort((l, r) => { return l - r })\n      // Debug Mode\n      if (this.debugMode) {\n        const fullList = (section === 'minute' ? this.minutes : this.seconds) || []\n        const validItems = fullList.filter(item => range.includes(item))\n        if (!validItems || !validItems.length) {\n          if (section === 'minute') {\n            this.debugLog(`The minute list is empty due to the \"minute-range\" config\\nminute-range: ${JSON.stringify(this.minuteRange)}\\nminute-interval: ${this.opts.minuteInterval}`)\n          } else {\n            this.debugLog(`The second list is empty due to the \"second-range\" config\\nsecond-range: ${JSON.stringify(this.secondRange)}\\nsecond-interval: ${this.opts.secondInterval}`)\n          }\n        }\n      }\n      return range\n    },\n\n    forceApmSelection () {\n      if (this.manualInput) {\n        // Skip this to allow users to paste a string value from the clipboard in Manual Input mode\n        return\n      }\n      if (this.apmType && !this.apm) {\n        if (this.has.am || this.has.pm) {\n          this.doClearApmChecking = true\n          const apmValue = this.has.am ? 'am' : 'pm'\n          this.apm = this.apmType === 'A' ? apmValue.toUpperCase() : apmValue\n        }\n      }\n    },\n\n    emptyApmSelection () {\n      if (this.doClearApmChecking && this.hour === '' && this.minute === '' && this.second === '') {\n        this.apm = ''\n      }\n      this.doClearApmChecking = false\n    },\n\n    apmDisplayText (apmValue) {\n      if (this.amText && this.lowerCasedApm(apmValue) === 'am') {\n        return this.amText\n      }\n      if (this.pmText && this.lowerCasedApm(apmValue) === 'pm') {\n        return this.pmText\n      }\n      return apmValue\n    },\n\n    toggleActive () {\n      if (this.disabled) { return }\n      this.isActive = !this.isActive\n\n      if (this.isActive) {\n        this.isFocusing = true\n        if (this.manualInput) {\n          this.$emit('focus')\n        }\n        if (!this.opts.hideDropdown) {\n          this.setDropdownState(true)\n        }\n        // Record to check if value did change in the later phase\n        if (this.lazy) {\n          this.bakDisplayTime = String(this.displayTime || '')\n        }\n        if (this.manualInput && !this.inputIsEmpty) {\n          this.$nextTick(() => {\n            if (this.$refs.input && this.$refs.input.selectionStart === 0 && this.$refs.input.selectionEnd === this.displayTime.length) {\n              // Select the first slot instead of the whole value string when tabbed in\n              this.selectFirstSlot()\n            }\n          })\n        }\n      } else {\n        if (this.showDropdown) {\n          this.setDropdownState(false)\n        } else if (this.manualInput) {\n          this.$emit('blur', this.getFullData())\n        }\n        this.isFocusing = false\n        if (this.lazy) {\n          this.fillValues(true)\n          this.bakDisplayTime = undefined\n        }\n      }\n\n      if (this.restrictedHourRange && this.baseOn12Hours) {\n        this.showDropdown ? this.forceApmSelection() : this.emptyApmSelection()\n      }\n      if (this.showDropdown) {\n        this.checkForAutoScroll()\n      }\n    },\n\n    setDropdownState (toShow, fromUserClick = false) {\n      if (toShow) {\n        if (this.appendToBody) {\n          this.appendDropdownToBody()\n        }\n        this.keepFocusing()\n        if (this.autoDirectionEnabled) {\n          this.checkDropDirection()\n        }\n        this.showDropdown = true\n        this.$emit('open') \n        if (fromUserClick) {\n          if (this.fixedDropdownButton) {\n            this.isActive = true\n          }\n          this.$emit('blur', this.getFullData())\n          this.checkForAutoScroll()\n        }\n      } else {\n        this.showDropdown = false\n        this.$emit('close', this.getFullData())\n        if (this.appendToBody) {\n          this.removeDropdownFromBody()\n        }\n      }\n    },\n\n    appendDropdownToBody () {\n      const dropdown = this.$refs && this.$refs.dropdown\n      const body = document.getElementsByTagName('body')[0]\n      if (body && dropdown) {\n        window.addEventListener('scroll', this.updateDropdownPos)\n        dropdown.classList.add('vue__time-picker-dropdown')\n        this.updateDropdownPos()\n        body.appendChild(dropdown)\n      }\n    },\n\n    updateDropdownPos () {\n      if (!this.appendToBody) { return }\n      const dropdown = this.$refs && this.$refs.dropdown\n      const body = document.getElementsByTagName('body')[0]\n      if (body && dropdown) {\n        const box = this.$el.getBoundingClientRect()\n        if (this.dropdownDirClass === 'drop-up') {\n          dropdown.style.bottom = `${window.innerHeight - box.y}px`\n          dropdown.style.top = 'auto'\n        } else {\n          dropdown.style.top = `${box.y + box.height}px`\n          dropdown.style.bottom = 'auto'\n        }\n        dropdown.style.left = `${box.x}px`\n      }\n    },\n\n    removeDropdownFromBody () {\n      const dropdown = this.$refs && this.$refs.dropdown\n      const body = document.getElementsByTagName('body')[0]\n      if (body && dropdown && body.contains(dropdown)) {\n        body.removeChild(dropdown)\n      }\n      if (dropdown) {\n        dropdown.classList.remove('vue__time-picker-dropdown')\n        dropdown.style.top = ''\n        dropdown.style.bottom = ''\n        dropdown.style.left = ''\n        this.$el.appendChild(dropdown)\n      }\n      window.removeEventListener('scroll', this.updateDropdownPos)\n    },\n\n    blurEvent () {\n      if (this.manualInput && !this.opts.hideDropdown) {\n        // hideDropdown's `blur` event is handled somewhere else\n        this.$emit('blur', this.getFullData())\n      }\n    },\n\n    select (type, value) {\n      if (this.isBasicType(type) && !this.isDisabled(type, value)) {\n        this[type] = value\n        if (this.doClearApmChecking) {\n          this.doClearApmChecking = false\n        }\n      }\n    },\n\n    clearTime () {\n      if (this.disabled) { return }\n      this.hour = ''\n      this.minute = ''\n      this.second = ''\n      this.apm = ''\n\n      if (this.manualInput && this.$refs && this.$refs.input && this.$refs.input.value.length) {\n        this.$refs.input.value = ''\n      }\n\n      if (this.lazy) {\n        this.fillValues(true)\n      }\n    },\n\n    //\n    // Auto-Scroll\n    //\n\n    checkForAutoScroll () {\n      if (this.inputIsEmpty) { return }\n      if (this.autoScroll) {\n        this.$nextTick(() => {\n          this.scrollToSelectedValues()\n        })\n      } else if (this.advancedKeyboard) {\n        // Auto-focus on selected value in the first column for advanced-keyboard\n        this.$nextTick(() => {\n          const firstColumn = this.inUse.types[0]\n          this.scrollToSelected(firstColumn, true)\n        })\n      }\n    },\n\n    scrollToSelected (column, allowFallback = false) {\n      if (!this.timeValue || this.inputIsEmpty) { return }\n      let targetList\n      if (this.appendToBody && this.$refs && this.$refs.dropdown) {\n        targetList = this.$refs.dropdown.querySelectorAll(`ul.${column}s`)[0]\n      } else {\n        targetList = this.$el.querySelectorAll(`ul.${column}s`)[0]\n      }\n      let targetValue = this.activeItemInCol(column)[0]\n      if (!targetValue && allowFallback) {\n        // No value selected in the target column, fallback to the first found valid item\n        targetValue = this.validItemsInCol(column)[0]\n      }\n      if (targetList && targetValue) {\n        targetList.scrollTop = targetValue.offsetTop || 0\n        if (this.advancedKeyboard) {\n          targetValue.focus()\n        }\n      }\n    },\n\n    scrollToSelectedValues () {\n      if (!this.timeValue || this.inputIsEmpty) { return }\n      this.inUse.types.forEach(section => {\n        this.scrollToSelected(section)\n      })\n    },\n\n    //\n    // Additional Keyboard Navigation\n    //\n\n    onFocus () {\n      if (this.disabled) { return }\n      if (!this.isFocusing) {\n        this.isFocusing = true\n      }\n      if (!this.isActive) {\n        this.toggleActive()\n      }\n    },\n\n    escBlur () {\n      if (this.disabled) { return }\n      window.clearTimeout(this.debounceTimer)\n      this.isFocusing = false\n      const inputBox = this.$el.querySelectorAll('input.display-time')[0]\n      if (inputBox) {\n        inputBox.blur()\n      }\n    },\n\n    debounceBlur () {\n      if (this.disabled) { return }\n      this.isFocusing = false\n      window.clearTimeout(this.debounceTimer)\n      this.debounceTimer = window.setTimeout(() => {\n        window.clearTimeout(this.debounceTimer)\n        this.onBlur()\n      }, this.opts.blurDelay)\n    },\n\n    onBlur () {\n      if (!this.disabled && !this.isFocusing && this.isActive) {\n        this.toggleActive()\n      }\n    },\n\n    keepFocusing () {\n      if (this.disabled) { return }\n      window.clearTimeout(this.debounceTimer)\n      if (!this.isFocusing) {\n        this.isFocusing = true\n      }\n    },\n\n    onTab (column, value, evt) {\n      if (this.appendToBody && evt.shiftKey) {\n        const firstColumn = this.inUse.types[0]\n        if (column !== firstColumn) { return }\n        const firstValidValue = this.validItemsInCol(firstColumn)[0]\n        // Is the first valid item in the first column\n        if (firstValidValue && firstValidValue.getAttribute('data-key') === String(value)) {\n          evt.preventDefault()\n          // Focus back on <input>\n          if (this.$refs && this.$refs.input) {\n            this.$refs.input.focus()\n          }\n        }\n      }\n    },\n\n    validItemsInCol (column) {\n      const columnClass = `${column}s`\n      if (this.appendToBody && this.$refs && this.$refs.dropdown) {\n        return this.$refs.dropdown.querySelectorAll(`ul.${columnClass} > li:not(.hint):not([disabled])`)\n      }\n      return this.$el.querySelectorAll(`ul.${columnClass} > li:not(.hint):not([disabled])`)\n    },\n\n    activeItemInCol (column) {\n      const columnClass = `${column}s`\n      if (this.appendToBody && this.$refs && this.$refs.dropdown) {\n        return this.$refs.dropdown.querySelectorAll(`ul.${columnClass} > li.active:not(.hint)`)\n      }\n      return this.$el.querySelectorAll(`ul.${columnClass} > li.active:not(.hint)`)\n    },\n\n    getClosestSibling (column, dataKey, getPrevious = false) {\n      const siblingsInCol = this.validItemsInCol(column)\n      const selfIndex = Array.prototype.findIndex.call(siblingsInCol, (sbl) => {\n        return sbl.getAttribute('data-key') === dataKey\n      })\n\n      // Already the first item\n      if (getPrevious && selfIndex === 0) {\n        return siblingsInCol[siblingsInCol.length - 1]\n      }\n      // Already the last item\n      if (!getPrevious && selfIndex === siblingsInCol.length - 1) {\n        return siblingsInCol[0]\n      }\n      // Selected value not in the valid values list\n      if (selfIndex < 0) {\n        return siblingsInCol[0]\n      }\n\n      if (getPrevious) {\n        return siblingsInCol[selfIndex - 1]\n      }\n      return siblingsInCol[selfIndex + 1]\n    },\n\n    prevItem (column, dataKey, isManualInput = false) {\n      const targetItem = this.getClosestSibling(column, dataKey, true)\n      if (targetItem) {\n        return isManualInput ? targetItem : targetItem.focus()\n      }\n    },\n\n    nextItem (column, dataKey, isManualInput = false) {\n      const targetItem = this.getClosestSibling(column, dataKey, false)\n      if (targetItem) {\n        return isManualInput ? targetItem : targetItem.focus()\n      }\n    },\n\n    getSideColumnName (currentColumn, toLeft = false) {\n      const currentColumnIndex = this.inUse.types.indexOf(currentColumn)\n      if (toLeft && currentColumnIndex <= 0) {\n        if (this.debugMode) {\n          this.debugLog('You\\'re in the leftmost list already')\n        }\n        return\n      } else if (!toLeft && currentColumnIndex === (this.inUse.types.length - 1)) {\n        if (this.debugMode) {\n          this.debugLog('You\\'re in the rightmost list already')\n        }\n        return\n      }\n      return this.inUse.types[toLeft ? currentColumnIndex - 1 : currentColumnIndex + 1]\n    },\n\n    getFirstItemInSideColumn (currentColumn, toLeft = false) {\n      const targetColumn = this.getSideColumnName(currentColumn, toLeft)\n      if (!targetColumn) { return }\n      const listItems = this.validItemsInCol(targetColumn)\n      if (listItems && listItems[0]) {\n        return listItems[0]\n      }\n    },\n\n    getActiveItemInSideColumn (currentColumn, toLeft = false) {\n      const targetColumn = this.getSideColumnName(currentColumn, toLeft)\n      if (!targetColumn) { return }\n      const activeItems = this.activeItemInCol(targetColumn)\n      if (activeItems && activeItems[0]) {\n        return activeItems[0]\n      }\n    },\n\n    toLeftColumn (currentColumn) {\n      const targetItem = this.getActiveItemInSideColumn(currentColumn, true) || this.getFirstItemInSideColumn(currentColumn, true)\n      if (targetItem) {\n        targetItem.focus()\n      }\n    },\n\n    toRightColumn (currentColumn) {\n      const targetItem = this.getActiveItemInSideColumn(currentColumn, false) || this.getFirstItemInSideColumn(currentColumn, false)\n      if (targetItem) {\n        targetItem.focus()\n      }\n    },\n\n    //\n    // Manual Input\n    //\n\n    onMouseDown () {\n      if (!this.manualInput) { return }\n      window.clearTimeout(this.selectionTimer)\n      this.selectionTimer = window.setTimeout(() => {\n        window.clearTimeout(this.selectionTimer)\n        if (this.$refs && this.$refs.input) {\n          const nearestSlot = this.getNearestChunkByPos(this.$refs.input.selectionStart || 0)\n          this.debounceSetInputSelection(nearestSlot)\n        }\n      }, 50)\n    },\n\n    keyDownHandler (evt) {\n      if (evt.isComposing || evt.keyCode === 229) {\n        // Skip IME inputs\n        evt.preventDefault()\n        evt.stopPropagation()\n        return false\n      }\n      // Numbers\n      if ((evt.keyCode >= 48 && evt.keyCode <= 57) || (evt.keyCode >= 96 && evt.keyCode <= 105)) {\n        evt.preventDefault()\n        this.keyboardInput(evt.key)\n      // A|P|M\n      } else if ([65, 80, 77].includes(evt.keyCode)) {\n        evt.preventDefault()\n        this.keyboardInput(evt.key, true)\n      // Arrow keys\n      } else if (evt.keyCode >= 37 && evt.keyCode <= 40) {\n        evt.preventDefault()\n        this.clearKbInputLog()\n        this.arrowHandler(evt)\n      // Delete|Backspace\n      } else if (evt.keyCode === 8 || evt.keyCode === 46) {\n        evt.preventDefault()\n        this.clearKbInputLog()\n        this.clearTime()\n      // Tab\n      } else if (evt.keyCode === 9) {\n        this.clearKbInputLog()\n        this.tabHandler(evt)\n      // Colon|Space\n      } else if (evt.keyCode === 186 || evt.keyCode === 32) {\n        evt.preventDefault()\n        this.clearKbInputLog()\n        this.toNextSlot()\n      // Prevent any Non-ESC and non-pasting inputs\n      } else if (evt.keyCode !== 27 && !(evt.metaKey || evt.ctrlKey)) {\n        evt.preventDefault()\n      }\n    },\n\n    onCompostionStart (evt) {\n      evt.preventDefault()\n      evt.stopPropagation()\n      this.bakCurrentPos = this.getCurrentTokenChunk()\n      return false\n    },\n\n    onCompostionEnd (evt) {\n      evt.preventDefault()\n      evt.stopPropagation()\n\n      const cpsData = evt.data\n      let inputIsCustomApmText = false\n      if (this.has.customApmText) {\n        inputIsCustomApmText = this.isCustomApmText(cpsData)\n      }\n      if (inputIsCustomApmText) {\n        this.setSanitizedValueToSection('apm', inputIsCustomApmText)\n      }\n\n      this.$refs.input.value = this.has.customApmText ? this.customDisplayTime : this.displayTime\n\n      this.$nextTick(() => {\n        if (this.bakCurrentPos) {\n          const bakPos = JSON.parse(JSON.stringify(this.bakCurrentPos))\n          if (inputIsCustomApmText) {\n            bakPos.end = (bakPos.start + cpsData.length)\n          }\n          this.debounceSetInputSelection(bakPos)\n          this.bakCurrentPos = null\n        }\n      })\n      return false\n    },\n\n    pasteHandler (evt) {\n      evt.preventDefault()\n      let pastingText = (evt.clipboardData || window.clipboardData).getData('text')\n      if (this.debugMode) {\n        this.debugLog(`Pasting value \"${pastingText}\" from clipboard`)\n      }\n      if (!pastingText || !pastingText.length) { return }\n\n      // Replace custom AM/PM text (if any)\n      if (this.has.customApmText) {\n        pastingText = this.replaceCustomApmText(pastingText)\n      }\n\n      if (this.inputIsEmpty) {\n        this.readStringValues(pastingText)\n      } else {\n        this.kbInputLog = pastingText.substr(-2, 2)\n        this.setKbInput()\n        this.debounceClearKbLog()\n      }\n    },\n\n    arrowHandler (evt) {\n      const direction = { 37: 'L', 38: 'U', 39: 'R', 40: 'D' }[evt.keyCode]\n      if (direction === 'U' || direction === 'D') {\n        if (this.inputIsEmpty) {\n          this.selectFirstValidValue()\n        } else {\n          const currentChunk = this.getCurrentTokenChunk()\n          if (!currentChunk) {\n            this.selectFirstValidValue()\n            return\n          }\n          const tokenType = currentChunk.type\n          this.getClosestValidItemInCol(tokenType, this[tokenType], direction)\n          const newChunkPos = this.getCurrentTokenChunk()\n          this.debounceSetInputSelection(newChunkPos)\n        }\n      } else if (direction === 'R') {\n        this.toLateralToken(false)\n      } else if (direction === 'L') {\n        this.toLateralToken(true)\n      }\n    },\n\n    tabHandler (evt) {\n      if (!this.inputIsEmpty && this.tokenChunksPos && this.tokenChunksPos.length) {\n        const currentChunk = this.getCurrentTokenChunk()\n        if (!currentChunk) { return }\n        const firstChunk = this.tokenChunksPos[0]\n        const lastChunk = this.tokenChunksPos[this.tokenChunksPos.length - 1]\n        if ((evt.shiftKey && currentChunk.token !== firstChunk.token) || (!evt.shiftKey && currentChunk.token !== lastChunk.token)) {\n          evt.preventDefault()\n          this.toLateralToken(evt.shiftKey)\n        }\n      } else if (this.appendToBody && this.advancedKeyboard) {\n        if (evt.shiftKey) { return }\n        evt.preventDefault()\n        if (this.inputIsEmpty) {\n          const firstColumn = this.inUse.types[0]\n          const targetValue = this.validItemsInCol(firstColumn)[0]\n          if (targetValue) {\n            targetValue.focus()\n          }\n        }\n      }\n    },\n\n    keyboardInput (newChar, isApm = false) {\n      const currentChunk = this.getCurrentTokenChunk()\n      if (!currentChunk || (currentChunk.type !== 'apm' && isApm) || (currentChunk.type === 'apm' && !isApm)) { return }\n      this.kbInputLog = `${this.kbInputLog.substr(-1)}${newChar}`\n      this.setKbInput()\n      this.debounceClearKbLog()\n    },\n\n    clearKbInputLog () {\n      window.clearTimeout(this.kbInputTimer)\n      this.kbInputLog = ''\n    },\n\n    debounceClearKbLog () {\n      window.clearTimeout(this.kbInputTimer)\n      this.kbInputTimer = window.setTimeout(() => {\n        this.clearKbInputLog()\n      }, this.opts.manualInputTimeout)\n    },\n\n    setKbInput (value) {\n      value = value || this.kbInputLog\n      const currentChunk = this.getCurrentTokenChunk()\n      if (!currentChunk || !value || !value.length) { return }\n      const chunkType = currentChunk.type\n      const chunkToken = currentChunk.token\n\n      let validValue\n      if (chunkType === 'apm') {\n        if (this.lowerCasedApm(value).includes('a')) {\n          validValue = 'am'\n        } else if (this.lowerCasedApm(value).includes('p')) {\n          validValue = 'pm'\n        }\n        if (validValue) {\n          validValue = chunkToken === 'A' ? validValue.toUpperCase() : validValue\n        }\n      } else {\n        if (this.isValidValue(chunkToken, value)) {\n          validValue = value\n        } else {\n          const lastInputValue = this.formatValue(chunkToken, value.substr(-1))\n          if (this.isValidValue(chunkToken, lastInputValue)) {\n            validValue = lastInputValue\n          }\n        }\n      }\n\n      if (validValue) {\n        this.setSanitizedValueToSection(chunkType, validValue)\n        const newChunkPos = this.getCurrentTokenChunk()\n        this.debounceSetInputSelection(newChunkPos)      \n      }\n      if (this.debugMode) {\n        if (validValue) {\n          this.debugLog(`Successfully set value \"${validValue}\" from latest input \"${value}\" for the \"${chunkType}\" slot`)\n        } else {\n          this.debugLog(`Value \"${value}\" is invalid in the \"${chunkType}\" slot`)\n        }\n      }\n    },\n\n    // Form Autofill\n    onChange () {\n      if (!this.manualInput || !this.$refs || !this.$refs.input) { return }\n      const autoFillValue = this.$refs.input.value || ''\n      if (autoFillValue && autoFillValue.length) {\n        this.readStringValues(autoFillValue)\n      }\n    },\n\n    getNearestChunkByPos (startPos) {\n      if (!this.tokenChunksPos || !this.tokenChunksPos.length) { return }\n      let nearest\n      let nearestDelta = -1\n      for (let i = 0; i < this.tokenChunksPos.length; i++) {\n        const chunk = JSON.parse(JSON.stringify(this.tokenChunksPos[i]))\n        if (chunk.start === startPos) {\n          return chunk\n        }\n        const delta = Math.abs(chunk.start - startPos)\n        if (nearestDelta < 0) {\n          nearest = chunk\n          nearestDelta = delta\n        } else {\n          if (nearestDelta <= delta) {\n            return nearest\n          }\n          nearestDelta = delta\n          nearest = chunk\n        }\n      }\n      return nearest\n    },\n\n    selectFirstValidValue () {\n      if (!this.tokenChunksPos || !this.tokenChunksPos.length) { return }\n      const firstSlotType = this.tokenChunksPos[0].type\n      if (firstSlotType === 'hour') {\n        this.getClosestHourItem()\n      } else {\n        this.getClosestValidItemInCol(firstSlotType, this[firstSlotType])\n      }\n      this.selectFirstSlot()\n    },\n\n    getClosestHourItem (currentValue, direction = 'U') {\n      if (!this.validHoursList || !this.validHoursList.length) {\n        if (this.debugMode) {\n          this.debugLog(`No valid hour values found, please check your \"hour-range\" config\\nhour-range: ${JSON.stringify(this.hourRange)}`)\n        }\n        return\n      }\n      if (!currentValue) {\n        this.setManualHour(this.validHoursList[0])\n        return\n      }\n      const currentIndex = this.validHoursList.findIndex(item => {\n        if (!this.baseOn12Hours) {\n          return item === currentValue\n        } else {\n          const valueKey = `${currentValue}${this.lowerCasedApm(this.apm) === 'pm' ? 'p' : 'a'}` \n          return item === valueKey\n        }\n      })\n      let nextIndex\n      if (currentIndex === -1) {\n        nextIndex = 0\n      } else if (direction === 'D') {\n        nextIndex = currentIndex === 0 ? this.validHoursList.length - 1 : currentIndex - 1\n      } else {\n        nextIndex = (currentIndex + 1) % this.validHoursList.length\n      }\n      const nextItem = this.validHoursList[nextIndex]\n      this.setManualHour(nextItem)\n    },\n\n    getClosestValidItemInCol (column, currentValue, direction = 'U') {\n      if (column === 'hour') {\n        this.getClosestHourItem(currentValue, direction)\n      } else {\n        const nextItem = direction === 'D' ? this.prevItem(column, this[column], true) : this.nextItem(column, this[column], true)\n        if (nextItem) {\n          this.select(column, nextItem.getAttribute('data-key'))\n        }\n      }\n    },\n\n    setSanitizedValueToSection (section, inputValue) {\n      if (!section || !this.getTokenByType(section)) { return }\n      // NOTE: Disabled values are allowed here, followed by an 'error' event, though\n      const sanitizedValue = this.sanitizedValue(this.getTokenByType(section), inputValue)\n      this[section] = sanitizedValue\n    },\n\n    setManualHour (nextItem) {\n      if (this.is12hRange(nextItem)) {\n        const hourT = this.match12hRange(nextItem)\n        const apmValue = hourT[2] === 'a' ? 'AM' : 'PM'\n        this.setSanitizedValueToSection('apm', this.apmType === 'a' ? apmValue.toLowerCase() : apmValue)\n        this.setSanitizedValueToSection('hour', hourT[1])\n      } else {\n        this.setSanitizedValueToSection('hour', nextItem)\n      }\n    },\n\n    debounceSetInputSelection ({start = 0, end = 0 }) {\n      this.$nextTick(() => {\n        this.setInputSelectionRange(start, end)\n      })\n      window.clearTimeout(this.selectionTimer)\n      this.selectionTimer = window.setTimeout(() => {\n        window.clearTimeout(this.selectionTimer)\n        // Double-check selection for 12hr format\n        if (this.$refs.input && (this.$refs.input.selectionStart !== start || this.$refs.input.selectionEnd !== end)) {\n          this.setInputSelectionRange(start, end)\n        }\n      }, 30)\n    },\n\n    setInputSelectionRange (start, end) {\n      if (this.$refs && this.$refs.input) {\n        this.$refs.input.setSelectionRange(start, end)\n      }\n    },\n\n    getCurrentTokenChunk () {\n      return this.getNearestChunkByPos((this.$refs.input && this.$refs.input.selectionStart) || 0)\n    },\n\n    selectFirstSlot () {\n      const firstChunkPos = this.getNearestChunkByPos(0)\n      this.debounceSetInputSelection(firstChunkPos)\n    },\n\n    toNextSlot () {\n      if (!this.inputIsEmpty && this.tokenChunksPos && this.tokenChunksPos.length) {\n        const currentChunk = this.getCurrentTokenChunk()\n        if (!currentChunk) { return }\n        const lastChunk = this.tokenChunksPos[this.tokenChunksPos.length - 1]\n        if (currentChunk.token !== lastChunk.token) {\n          this.toLateralToken(false)\n        }\n      }\n    },\n\n    toLateralToken (toLeft) {\n      const currentChunk = this.getCurrentTokenChunk()\n      if (!currentChunk) {\n        this.selectFirstValidValue()\n        return\n      }\n      const currentChunkIndex = this.tokenChunksPos.findIndex(chk => chk.token === currentChunk.token)\n      if ((!toLeft && currentChunkIndex >= this.tokenChunksPos.length - 1) || (toLeft && currentChunkIndex === 0)) {\n        if (this.debugMode) {\n          if (toLeft) {\n            this.debugLog('You\\'re in the leftmost slot already')\n          } else {\n            this.debugLog('You\\'re in the rightmost slot already')\n          }\n        }\n        return\n      }\n      const targetSlotPos = toLeft ? this.tokenChunksPos[currentChunkIndex - 1] : this.tokenChunksPos[currentChunkIndex + 1]\n      this.debounceSetInputSelection(targetSlotPos)\n    },\n\n    isCustomApmText (inputData) {\n      if (!inputData || !inputData.length) { return false }\n      if (this.amText && this.amText === inputData) {\n        return this.apmType === 'A' ? 'AM' : 'am'\n      }\n      if (this.pmText && this.pmText === inputData) {\n        return this.apmType === 'A' ? 'PM' : 'pm'\n      }\n      return false\n    },\n\n    replaceCustomApmText (inputString) {\n      if (this.amText && this.amText.length && inputString.includes(this.amText)) {\n        return inputString.replace(new RegExp(this.amText, 'g'), this.apmType === 'A' ? 'AM' : 'am')\n      } else if (this.pmText && this.pmText.length && inputString.includes(this.pmText)) {\n        return inputString.replace(new RegExp(this.pmText, 'g'), this.apmType === 'A' ? 'PM' : 'pm')\n      }\n      return inputString\n    },\n\n    checkDropDirection () {\n      if (!this.$el) { return }\n      let container\n      if (this.containerId && this.containerId.length) {\n        container = document.getElementById(this.containerId)\n        if (!container && this.debugMode) {\n          this.debugLog(`Container with id \"${this.containerId}\" not found. Fallback to document body.`)\n        }\n      }\n      const el = this.$el\n      let spaceDown\n      if (container && container.offsetHeight) {\n        // Valid container found\n        spaceDown = (container.offsetTop + container.offsetHeight) - (el.offsetTop + el.offsetHeight)\n      } else {\n        // Fallback to document body\n        const docHeight = Math.max(document.body.scrollHeight, document.documentElement.scrollHeight, document.body.offsetHeight, document.documentElement.offsetHeight, document.body.clientHeight, document.documentElement.clientHeight)\n        spaceDown = docHeight - (el.offsetTop + el.offsetHeight)\n      }\n      this.forceDropOnTop = this.opts.dropOffsetHeight > spaceDown\n    },\n\n    //\n    // Helpers\n    //\n\n    is12hRange (value) {\n      return /^\\d{1,2}(a|p|A|P)$/.test(value)\n    },\n\n    match12hRange (value) {\n      return value.match(/^(\\d{1,2})(a|p|A|P)$/)\n    },\n\n    isNumber (value) {\n      return !isNaN(parseFloat(value)) && isFinite(value)\n    },\n\n    isBasicType (type) {\n      return CONFIG.BASIC_TYPES.includes(type)\n    },\n\n    lowerCasedApm (apmValue) {\n      return (apmValue || '').toLowerCase()\n    },\n\n    getTokenRegex (token) {\n      switch (token) {\n        case 'HH':\n          return '([01][0-9]|2[0-3]|H{2})'\n        case 'H':\n          return '([0-9]{1}|1[0-9]|2[0-3]|H{1})'\n        case 'hh':\n          return '(0[1-9]|1[0-2]|h{2})'\n        case 'h':\n          return '([1-9]{1}|1[0-2]|h{1})'\n        case 'kk':\n          return '(0[1-9]|1[0-9]|2[0-4]|k{2})'\n        case 'k':\n          return '([1-9]{1}|1[0-9]|2[0-4]|k{1})'\n        case 'mm':\n          return '([0-5][0-9]|m{2})'\n        case 'ss':\n          return '([0-5][0-9]|s{2})'\n        case 'm':\n          return '([0-9]{1}|[1-5][0-9]|m{1})'\n        case 's':\n          return '([0-9]{1}|[1-5][0-9]|s{1})'\n        case 'A':\n          return '(AM|PM|A{1})'\n        case 'a':\n          return '(am|pm|a{1})'\n        default:\n          return ''\n      }\n    },\n\n    isEmptyValue (targetToken, testValue) {\n      return (!testValue || !testValue.length) || (testValue && testValue === targetToken)\n    },\n\n    isValidValue (targetToken, testValue) {\n      if (!targetToken || this.isEmptyValue(targetToken, testValue)) { return false }\n      const tokenRegexStr = this.getTokenRegex(targetToken)\n      if (!tokenRegexStr || !tokenRegexStr.length) { return false }\n      return (new RegExp(`^${tokenRegexStr}$`)).test(testValue)\n    },\n\n    sanitizedValue (targetToken, inputValue) {\n      if (this.isValidValue(targetToken, inputValue)) {\n        return inputValue\n      }\n      return ''\n    },\n\n    getTokenType (token) {\n      return this.inUse.types[this.inUse.tokens.indexOf(token)] || ''\n    },\n\n    getTokenByType (type) {\n      return this[`${type}Type`] || ''\n    },\n\n    isMinuteOrSecond (type) {\n      return ['minute', 'second'].includes(type)\n    },\n\n    debugLog (logText) {\n      if (!logText || !logText.length) { return }\n      let identifier = ''\n      if (this.id) {\n        identifier += `#${this.id}`\n      }\n      if (this.name) {\n        identifier += `[name=${this.name}]`\n      }\n      if (this.inputClass) {\n        let inputClasses = []\n        if (typeof this.inputClass === 'string') {\n          inputClasses = this.inputClass.split(/\\s/g)\n        } else if (Array.isArray(this.inputClass)) {\n          inputClasses = [].concat([], this.inputClass)\n        } else if (typeof this.inputClass === 'object') {\n          Object.keys(this.inputClass).forEach(clsName => {\n            if (this.inputClass[clsName]) {\n              inputClasses.push(clsName)\n            }\n          })\n        }\n        for (let inputClass of inputClasses) {\n          if (inputClass && inputClass.trim().length) {\n            identifier += `.${inputClass.trim()}`\n          }\n        }\n      }\n      const finalLogText = `DEBUG: ${logText}${identifier ? `\\n\\t(${identifier})` : '' }`\n      if (window.console.debug && typeof window.console.debug === 'function') {\n        window.console.debug(finalLogText)\n      } else {\n        window.console.log(finalLogText)\n      }\n    }\n  },\n\n  mounted () {\n    window.clearTimeout(this.debounceTimer)\n    window.clearTimeout(this.selectionTimer)\n    window.clearTimeout(this.kbInputTimer)\n    this.renderFormat()\n  },\n\n  beforeDestroy () {\n    window.clearTimeout(this.debounceTimer)\n    window.clearTimeout(this.selectionTimer)\n    window.clearTimeout(this.kbInputTimer)\n  }\n}\n</script>\n\n<template>\n<span class=\"vue__time-picker time-picker\" :style=\"inputWidthStyle\">\n  <input type=\"text\" class=\"display-time\" ref=\"input\"\n         :class=\"[inputClass, {'is-empty': inputIsEmpty, 'invalid': hasInvalidInput, 'all-selected': allValueSelected, 'disabled': disabled, 'has-custom-icon': $slots && $slots.icon }]\"\n         :style=\"inputWidthStyle\"\n         :id=\"id\"\n         :name=\"name\"\n         :value=\"inputIsEmpty ? null : customDisplayTime\"\n         :placeholder=\"placeholder ? placeholder : formatString\"\n         :tabindex=\"disabled ? -1 : tabindex\"\n         :disabled=\"disabled\"\n         :readonly=\"!manualInput\"\n         :autocomplete=\"autocomplete\"\n         @focus=\"onFocus\"\n         @change=\"onChange\"\n         @blur=\"debounceBlur(); blurEvent()\"\n         @mousedown=\"onMouseDown\"\n         @keydown=\"keyDownHandler\"\n         @compositionstart=\"onCompostionStart\"\n         @compositionend=\"onCompostionEnd\"\n         @paste=\"pasteHandler\"\n         @keydown.esc.exact=\"escBlur\" />\n  <div class=\"controls\" v-if=\"showClearBtn || showDropdownBtn\" tabindex=\"-1\">\n    <span v-if=\"!isActive && showClearBtn\" class=\"clear-btn\" tabindex=\"-1\"\n          :class=\"{'has-custom-btn': $slots && $slots.clearButton }\"\n          @click=\"clearTime\">\n      <slot name=\"clearButton\"><span class=\"char\">&times;</span></slot>\n    </span>\n    <span v-if=\"showDropdownBtn\" class=\"dropdown-btn\" tabindex=\"-1\"\n          :class=\"{'has-custom-btn': $slots && $slots.dropdownButton }\"\n          @click=\"setDropdownState(fixedDropdownButton ? !showDropdown : true, true)\"\n          @mousedown=\"keepFocusing\">\n      <slot name=\"dropdownButton\"><span class=\"char\">&dtrif;</span></slot>\n    </span>\n  </div>\n  <div class=\"custom-icon\" v-if=\"$slots && $slots.icon\"><slot name=\"icon\"></slot></div>\n  <div class=\"time-picker-overlay\" v-if=\"showDropdown\" @click=\"toggleActive\" tabindex=\"-1\"></div>\n  <div class=\"dropdown\" ref=\"dropdown\" v-show=\"showDropdown\" tabindex=\"-1\"\n       :class=\"[dropdownDirClass]\" :style=\"inputWidthStyle\"\n       @mouseup=\"keepFocusing\" @click.stop=\"\">\n    <div class=\"select-list\" :style=\"inputWidthStyle\" tabindex=\"-1\">\n      <!-- Common Keyboard Support: less event listeners -->\n      <template v-if=\"!advancedKeyboard\">\n        <template v-for=\"column in columnsSequence\">\n          <ul v-if=\"column === 'hour'\" :key=\"column\" class=\"hours\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"hourLabelText\"></li>\n            <template v-for=\"(hr, hIndex) in hours\">\n              <li v-if=\"!opts.hideDisabledHours || (opts.hideDisabledHours && !isDisabled('hour', hr))\"\n                  :key=\"hIndex\"\n                  :class=\"{active: hour === hr}\"\n                  :disabled=\"isDisabled('hour', hr)\"\n                  :data-key=\"hr\"\n                  v-text=\"hr\"\n                  @click=\"select('hour', hr)\"></li>\n            </template>\n          </ul>\n          <ul v-if=\"column === 'minute'\" :key=\"column\" class=\"minutes\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"minuteLabelText\"></li>\n            <template v-for=\"(m, mIndex) in minutes\">\n              <li v-if=\"!opts.hideDisabledMinutes || (opts.hideDisabledMinutes && !isDisabled('minute', m))\"\n                  :key=\"mIndex\"\n                  :class=\"{active: minute === m}\"\n                  :disabled=\"isDisabled('minute', m)\"\n                  :data-key=\"m\"\n                  v-text=\"m\"\n                  @click=\"select('minute', m)\"></li>\n            </template>\n          </ul>\n          <ul v-if=\"column === 'second'\" :key=\"column\" class=\"seconds\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"secondLabelText\"></li>\n            <template v-for=\"(s, sIndex) in seconds\">\n              <li v-if=\"!opts.hideDisabledSeconds || (opts.hideDisabledSeconds && !isDisabled('second', s))\"\n                  :key=\"sIndex\"\n                  :class=\"{active: second === s}\"\n                  :disabled=\"isDisabled('second', s)\"\n                  :data-key=\"s\"\n                  v-text=\"s\"\n                  @click=\"select('second', s)\"></li>\n            </template>\n          </ul>\n          <ul v-if=\"column === 'apm'\" :key=\"column\" class=\"apms\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"apmLabelText\"></li>\n            <template v-for=\"(a, aIndex) in apms\">\n              <li v-if=\"!opts.hideDisabledHours || (opts.hideDisabledHours && !isDisabled('apm', a))\"\n                  :key=\"aIndex\"\n                  :class=\"{active: apm === a}\"\n                  :disabled=\"isDisabled('apm', a)\"\n                  :data-key=\"a\"\n                  v-text=\"apmDisplayText(a)\"\n                  @click=\"select('apm', a)\"></li>\n            </template>\n          </ul>\n        </template>\n      </template><!-- / Common Keyboard Support -->\n\n      <!--\n        Advanced Keyboard Support\n        Addeds hundreds of additional event lisenters\n      -->\n      <template v-if=\"advancedKeyboard\">\n        <template v-for=\"column in columnsSequence\">\n          <ul v-if=\"column === 'hour'\" :key=\"column\" class=\"hours\" tabindex=\"-1\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"hourLabelText\" tabindex=\"-1\"></li>\n            <template v-for=\"(hr, hIndex) in hours\">\n              <li v-if=\"!opts.hideDisabledHours || (opts.hideDisabledHours && !isDisabled('hour', hr))\"\n                  :key=\"hIndex\"\n                  :class=\"{active: hour === hr}\"\n                  :tabindex=\"isDisabled('hour', hr) ? -1 : tabindex\"\n                  :data-key=\"hr\"\n                  :disabled=\"isDisabled('hour', hr)\"\n                  v-text=\"hr\"\n                  @click=\"select('hour', hr)\"\n                  @keydown.tab=\"onTab('hour', hr, $event)\"\n                  @keydown.space.prevent=\"select('hour', hr)\"\n                  @keydown.enter.prevent=\"select('hour', hr)\"\n                  @keydown.up.prevent=\"prevItem('hour', hr)\"\n                  @keydown.down.prevent=\"nextItem('hour', hr)\"\n                  @keydown.left.prevent=\"toLeftColumn('hour')\"\n                  @keydown.right.prevent=\"toRightColumn('hour')\"\n                  @keydown.esc.exact=\"debounceBlur\"\n                  @blur=\"debounceBlur\"\n                  @focus=\"keepFocusing\"></li>\n            </template>\n          </ul>\n          <ul v-if=\"column === 'minute'\" :key=\"column\" class=\"minutes\" tabindex=\"-1\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"minuteLabelText\" tabindex=\"-1\"></li>\n            <template v-for=\"(m, mIndex) in minutes\">\n              <li v-if=\"!opts.hideDisabledMinutes || (opts.hideDisabledMinutes && !isDisabled('minute', m))\"\n                  :key=\"mIndex\"\n                  :class=\"{active: minute === m}\"\n                  :tabindex=\"isDisabled('minute', m) ? -1 : tabindex\"\n                  :data-key=\"m\"\n                  :disabled=\"isDisabled('minute', m)\"\n                  v-text=\"m\"\n                  @click=\"select('minute', m)\"\n                  @keydown.tab=\"onTab('minute', m, $event)\"\n                  @keydown.space.prevent=\"select('minute', m)\"\n                  @keydown.enter.prevent=\"select('minute', m)\"\n                  @keydown.up.prevent=\"prevItem('minute', m)\"\n                  @keydown.down.prevent=\"nextItem('minute', m)\"\n                  @keydown.left.prevent=\"toLeftColumn('minute')\"\n                  @keydown.right.prevent=\"toRightColumn('minute')\"\n                  @keydown.esc.exact=\"debounceBlur\"\n                  @blur=\"debounceBlur\"\n                  @focus=\"keepFocusing\"></li>\n            </template>\n          </ul>\n          <ul v-if=\"column === 'second'\" :key=\"column\" class=\"seconds\" tabindex=\"-1\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"secondLabelText\" tabindex=\"-1\"></li>\n            <template v-for=\"(s, sIndex) in seconds\">\n              <li v-if=\"!opts.hideDisabledSeconds || (opts.hideDisabledSeconds && !isDisabled('second', s))\"\n                  :key=\"sIndex\"\n                  :class=\"{active: second === s}\"\n                  :tabindex=\"isDisabled('second', s) ? -1 : tabindex\"\n                  :data-key=\"s\"\n                  :disabled=\"isDisabled('second', s)\"\n                  v-text=\"s\"\n                  @click=\"select('second', s)\"\n                  @keydown.tab=\"onTab('second', s, $event)\"\n                  @keydown.space.prevent=\"select('second', s)\"\n                  @keydown.enter.prevent=\"select('second', s)\"\n                  @keydown.up.prevent=\"prevItem('second', s)\"\n                  @keydown.down.prevent=\"nextItem('second', s)\"\n                  @keydown.left.prevent=\"toLeftColumn('second')\"\n                  @keydown.right.prevent=\"toRightColumn('second')\"\n                  @keydown.esc.exact=\"debounceBlur\"\n                  @blur=\"debounceBlur\"\n                  @focus=\"keepFocusing\"></li>\n            </template>\n          </ul>\n          <ul v-if=\"column === 'apm'\" :key=\"column\" class=\"apms\" tabindex=\"-1\" @scroll=\"keepFocusing\">\n            <li class=\"hint\" v-text=\"apmLabelText\" tabindex=\"-1\"></li>\n            <template v-for=\"(a, aIndex) in apms\">\n              <li v-if=\"!opts.hideDisabledHours || (opts.hideDisabledHours && !isDisabled('apm', a))\"\n                  :key=\"aIndex\"\n                  :class=\"{active: apm === a}\"\n                  :tabindex=\"isDisabled('apm', a) ? -1 : tabindex\"\n                  :data-key=\"a\"\n                  :disabled=\"isDisabled('apm', a)\"\n                  v-text=\"apmDisplayText(a)\"\n                  @click=\"select('apm', a)\"\n                  @keydown.tab=\"onTab('apm', a, $event)\"\n                  @keydown.space.prevent=\"select('apm', a)\"\n                  @keydown.enter.prevent=\"select('apm', a)\"\n                  @keydown.up.prevent=\"prevItem('apm', a)\"\n                  @keydown.down.prevent=\"nextItem('apm', a)\"\n                  @keydown.left.prevent=\"toLeftColumn('apm')\"\n                  @keydown.right.prevent=\"toRightColumn('apm')\"\n                  @keydown.esc.exact=\"debounceBlur\"\n                  @blur=\"debounceBlur\"\n                  @focus=\"keepFocusing\"></li>\n            </template>\n          </ul>\n        </template>\n      </template><!-- / Advanced Keyboard Support -->\n    </div>\n  </div>\n</span>\n</template>\n\n<style>\n.vue__time-picker {\n  display: inline-block;\n  position: relative;\n  font-size: 1em;\n  width: 10em;\n  font-family: sans-serif;\n  vertical-align: middle;\n}\n\n.vue__time-picker * {\n  box-sizing: border-box;\n}\n\n.vue__time-picker input.display-time {\n  border: 1px solid #d2d2d2;\n  width: 10em;\n  height: 2.2em;\n  padding: 0.3em 0.5em;\n  font-size: 1em;\n}\n\n.vue__time-picker input.has-custom-icon {\n  padding-left: 1.8em;\n}\n\n.vue__time-picker input.display-time.invalid:not(.skip-error-style) {\n  border-color: #cc0033;\n  outline-color: #cc0033;\n}\n\n.vue__time-picker input.display-time:disabled,\n.vue__time-picker input.display-time.disabled {\n  color: #d2d2d2;\n}\n\n.vue__time-picker .controls {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 3;\n\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: flex-end;\n  align-items: stretch;\n\n  /* Prevent browser focusing on the controls layer */\n  pointer-events: none;\n}\n\n.vue__time-picker .controls > * {\n  cursor: pointer;\n  \n  width: auto;\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: center;\n  align-items: center;\n\n  padding: 0 0.35em;\n\n  color: #d2d2d2;\n  line-height: 100%;\n  font-style: normal;\n\n  /* Resume pointer-events on children components */\n  pointer-events: initial;\n\n  transition: color .2s, opacity .2s;\n}\n\n.vue__time-picker .controls > *:hover {\n  color: #797979;\n}\n\n.vue__time-picker .controls > *:focus,\n.vue__time-picker .controls > *:active {\n  outline: 0;\n}\n\n.vue__time-picker .controls .char {\n  font-size: 1.1em;\n  line-height: 100%;\n\n  /* Vertical align fixes for webkit browsers only */\n  -webkit-margin-before: -0.15em;\n}\n\n.vue__time-picker .custom-icon {\n  z-index: 2;\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  width: 1.8em;\n\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: center;\n  align-items: center;\n\n  /* pass down mouse events to the <input> underneath */\n  pointer-events: none;\n}\n\n.vue__time-picker .custom-icon img,\n.vue__time-picker .custom-icon svg,\n.vue__time-picker .controls img,\n.vue__time-picker .controls svg {\n  display: inline-block;\n  vertical-align: middle;\n  margin: 0;\n  border: 0;\n  outline: 0;\n  max-width: 1em;\n  height: auto;\n}\n\n.vue__time-picker .time-picker-overlay {\n  z-index: 4;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n\n.vue__time-picker .dropdown,\n.vue__time-picker-dropdown {\n  position: absolute;\n  z-index: 5;\n  top: calc(2.2em + 2px);\n  left: 0;\n  background: #fff;\n  box-shadow: 0 1px 6px rgba(0,0,0,0.15);\n  width: 10em;\n  height: 10em;\n  font-weight: normal;\n}\n\n/* Dropdown class when \"append-to-body\" is on */\n.vue__time-picker-dropdown {\n  position: fixed;\n  z-index: 100;\n}\n\n.vue__time-picker .dropdown.drop-up,\n.vue__time-picker-dropdown.drop-up {\n  top: auto;\n  bottom: calc(2.2em + 1px);\n}\n\n.vue__time-picker .dropdown .select-list,\n.vue__time-picker-dropdown .select-list {\n  width: 10em;\n  height: 10em;\n  overflow: hidden;\n  display: flex;\n  flex-flow: row nowrap;\n  align-items: stretch;\n  justify-content: space-between;\n}\n\n.vue__time-picker .dropdown .select-list:focus,\n.vue__time-picker .dropdown .select-list:active,\n.vue__time-picker-dropdown .select-list:focus,\n.vue__time-picker-dropdown .select-list:active {\n  outline: 0;\n}\n\n.vue__time-picker .dropdown ul,\n.vue__time-picker-dropdown ul {\n  padding: 0;\n  margin: 0;\n  list-style: none;\n  outline: 0;\n\n  flex: 1 1 0.00001px;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n.vue__time-picker .dropdown ul.minutes,\n.vue__time-picker .dropdown ul.seconds,\n.vue__time-picker .dropdown ul.apms,\n.vue__time-picker-dropdown ul.minutes,\n.vue__time-picker-dropdown ul.seconds,\n.vue__time-picker-dropdown ul.apms {\n  border-left: 1px solid #fff;\n}\n\n.vue__time-picker .dropdown ul li,\n.vue__time-picker-dropdown ul li {\n  list-style: none;\n  text-align: center;\n  padding: 0.3em 0;\n  color: #161616;\n}\n\n.vue__time-picker .dropdown ul li:not(.hint):not([disabled]):hover,\n.vue__time-picker .dropdown ul li:not(.hint):not([disabled]):focus,\n.vue__time-picker-dropdown ul li:not(.hint):not([disabled]):hover,\n.vue__time-picker-dropdown ul li:not(.hint):not([disabled]):focus  {\n  background: rgba(0,0,0,.08);\n  color: #161616;\n  cursor: pointer;\n}\n\n.vue__time-picker .dropdown ul li:not([disabled]).active,\n.vue__time-picker .dropdown ul li:not([disabled]).active:hover,\n.vue__time-picker .dropdown ul li:not([disabled]).active:focus,\n.vue__time-picker-dropdown ul li:not([disabled]).active,\n.vue__time-picker-dropdown ul li:not([disabled]).active:hover,\n.vue__time-picker-dropdown ul li:not([disabled]).active:focus {\n  background: #41B883;\n  color: #fff;\n}\n\n.vue__time-picker .dropdown ul li[disabled],\n.vue__time-picker .dropdown ul li[disabled]:hover,\n.vue__time-picker-dropdown ul li[disabled],\n.vue__time-picker-dropdown ul li[disabled]:hover {\n  background: transparent;\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n.vue__time-picker .dropdown .hint,\n.vue__time-picker-dropdown .hint {\n  color: #a5a5a5;\n  cursor: default;\n  font-size: 0.8em;\n}\n</style>\n"],"sourceRoot":""}]}