{"remainingRequest":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\cash-counter\\AdmissionPayment.js","dependencies":[{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\src\\scripts\\cash-counter\\AdmissionPayment.js","mtime":1683805448865},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\babel.config.js","mtime":1624271518206},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"F:\\SVN PROJECTS\\ERP_Hospital_Client\\trunk\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L1NWTiBQUk9KRUNUUy9FUlBfSG9zcGl0YWxfQ2xpZW50L3RydW5rL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIudG8tZml4ZWQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0IFBhdGllbnRQYXltZW50U2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL2Nhc2gtY291bnRlci9QYXRpZW50UGF5bWVudFNlcnZpY2UiOwppbXBvcnQgUGF5bWVudFR5cGVTZXR1cFNlcnZpY2UgZnJvbSAiLi4vLi4vc2VydmljZS9zZXR1cC9QYXltZW50VHlwZVNldHVwU2VydmljZSI7CmltcG9ydCBJUERSZXBvcnRTZXJ2aWNlIGZyb20gIi4uLy4uL3NlcnZpY2UvcmVwb3J0L0lQRFJlcG9ydFNlcnZpY2UiOwppbXBvcnQgQ29tbW9uU2VydmljZSBmcm9tICIuLi8uLi9zZXJ2aWNlL0NvbW1vblNlcnZpY2UiOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCB7IEZpbHRlck1hdGNoTW9kZSwgRmlsdGVyT3BlcmF0b3IgfSBmcm9tICJwcmltZXZ1ZS9hcGkiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzUGF5bWVudDogdHJ1ZSwKICAgICAgLy9hZGRMaXN0OiBmYWxzZSwKICAgICAgYnV0dG9uOiBmYWxzZSwKICAgICAgaXNDYXNoOiBmYWxzZSwKICAgICAgLy9pc1BhaWQ6ICIiLAogICAgICBpc0Nhc2hQYWlkOiAiIiwKICAgICAgLy9pc0R1ZUV4aXN0OiAiIiwKICAgICAgLy9pc0V4aXN0OiAiIiwKICAgICAgcGF5bWVudFR5cGVMaXN0OiBbXSwKICAgICAgdG90YWxQdHlBbW91bnQ6IDAsCiAgICAgIGFkbWlzc2lvbl9ubzogIiIsCiAgICAgIHBhdGllbnRQYXltZW50OiB7CiAgICAgICAgY2RwYXltZW50X2RhdGU6IG1vbWVudChTdHJpbmcobmV3IERhdGUoKSkpLmZvcm1hdCgiTU0vREQvWVlZWSIpLAogICAgICAgIHRvdGFsX2Ftb3VudDogMCwKICAgICAgICBwdHlwYWlkX2Ftb3VudDogMCwKICAgICAgICB0b3RhbF9hbW91bnRfaW5mOiAwLAogICAgICAgIHBheW1lbnRUeXBlQ2FzaDogIjEiLAogICAgICAgIGludm9pY2VfaWQ6ICIiLAogICAgICAgIGFQYXRpZW50OiB7fSwKICAgICAgICBsc3RQYXRpZW50UGF5bWVudERldGFpbHM6IFtdLAogICAgICAgIGRpc2NvdW50X2Ftb3VudDogMCwKICAgICAgICBkaXNjb3VudF9wZXJjZW50OiAwLAogICAgICAgIHJlZnVuZF9hbW91bnQ6IDAsCiAgICAgICAgaXNSZWZ1bmQ6IGZhbHNlLAogICAgICAgIGlwZFNlcnZpY2VMaXN0OiBbXQogICAgICB9LAogICAgICBmaWx0ZXJzOiB7CiAgICAgICAgZ2xvYmFsOiB7CiAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLkNPTlRBSU5TCiAgICAgICAgfSwKICAgICAgICBuYW1lOiB7CiAgICAgICAgICB2YWx1ZTogbnVsbCwKICAgICAgICAgIG1hdGNoTW9kZTogRmlsdGVyTWF0Y2hNb2RlLlNUQVJUU19XSVRICiAgICAgICAgfQogICAgICB9LAogICAgICBpbml0RmlsdGVyczogZnVuY3Rpb24gaW5pdEZpbHRlcnMoKSB7CiAgICAgICAgdGhpcy5maWx0ZXJzID0gewogICAgICAgICAgZ2xvYmFsOiB7CiAgICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgICBtYXRjaE1vZGU6IEZpbHRlck1hdGNoTW9kZS5DT05UQUlOUwogICAgICAgICAgfSwKICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgb3BlcmF0b3I6IEZpbHRlck9wZXJhdG9yLkFORCwKICAgICAgICAgICAgY29uc3RyYWludHM6IFt7CiAgICAgICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICAgICAgbWF0Y2hNb2RlOiBGaWx0ZXJNYXRjaE1vZGUuU1RBUlRTX1dJVEgKICAgICAgICAgICAgfV0KICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9LAogICAgICBzdWJtaXR0ZWQ6IGZhbHNlCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy5wYXRpZW50UGF5bWVudFNlcnZpY2UgPSBuZXcgUGF0aWVudFBheW1lbnRTZXJ2aWNlKCk7CiAgICB0aGlzLnBheW1lbnRUeXBlU2V0dXBTZXJ2aWNlID0gbmV3IFBheW1lbnRUeXBlU2V0dXBTZXJ2aWNlKCk7CiAgICB0aGlzLmlQRFJlcG9ydFNlcnZpY2UgPSBuZXcgSVBEUmVwb3J0U2VydmljZSgpOwogICAgdGhpcy5jb21tb25TZXJ2aWNlID0gbmV3IENvbW1vblNlcnZpY2UoKTsKICAgIHRoaXMucGF5bWVudFR5cGVTZXR1cFNlcnZpY2UuZ2V0QWxsKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gX3RoaXMucGF5bWVudFR5cGVMaXN0ID0gZGF0YS5kYXRhOwogICAgfSk7CiAgICB2YXIgYWRtaXNzaW9uX2lkX2Zvcl9wYXltZW50ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FkbWlzc2lvbl9pZF9mb3JfcGF5bWVudCcpOwoKICAgIGlmIChhZG1pc3Npb25faWRfZm9yX3BheW1lbnQpIHsKICAgICAgdGhpcy5hZG1pc3Npb25fbm8gPSBhZG1pc3Npb25faWRfZm9yX3BheW1lbnQ7IC8vbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FkbWlzc2lvbl9pZF9mb3JfcGF5bWVudCcpOwoKICAgICAgdGhpcy5maW5kSVBEUGF5bWVudEluZm8oKTsKICAgIH0KCiAgICB2YXIgYWRtaXNzaW9uX25vX2Zvcl9wYXltZW50X2Zyb21fYWRtaXNzaW9ubGlzdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhZG1pc3Npb25fbm9fZm9yX3BheW1lbnRfZnJvbV9hZG1pc3Npb25saXN0Jyk7CgogICAgaWYgKGFkbWlzc2lvbl9ub19mb3JfcGF5bWVudF9mcm9tX2FkbWlzc2lvbmxpc3QpIHsKICAgICAgdGhpcy5hZG1pc3Npb25fbm8gPSBhZG1pc3Npb25fbm9fZm9yX3BheW1lbnRfZnJvbV9hZG1pc3Npb25saXN0OyAvL2xvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhZG1pc3Npb25fbm9fZm9yX3BheW1lbnRfZnJvbV9hZG1pc3Npb25saXN0Jyk7CgogICAgICB0aGlzLmZpbmRJUERQYXltZW50SW5mbygpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgcHJpbnRBZG1pc3Npb25QYXltZW50OiBmdW5jdGlvbiBwcmludEFkbWlzc2lvblBheW1lbnQoSWQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmlQRFJlcG9ydFNlcnZpY2UuR2V0QWRtaXNzaW9uUGF5bWVudChJZCwgdGhpcykudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczIuY29tbW9uU2VydmljZS5Eb3dubG9hZGZpbGUoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgcHJpbnREaXNjaGFyZ2VCaWxsU3VtbWFyeTogZnVuY3Rpb24gcHJpbnREaXNjaGFyZ2VCaWxsU3VtbWFyeShJZCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuaVBEUmVwb3J0U2VydmljZS5HZXREaXNjaGFyZ2VCaWxsU3VtbWFyeShJZCwgdGhpcykudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczMuY29tbW9uU2VydmljZS5Eb3dubG9hZGZpbGUoZGF0YS5kYXRhKTsKICAgICAgfSk7CiAgICB9LAogICAgcGF5bWVudFJlc2V0OiBmdW5jdGlvbiBwYXltZW50UmVzZXQoKSB7CiAgICAgIHRoaXMuaXNQYXltZW50ID0gdHJ1ZTsKICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5kZGxQYXltZW50VHlwZSA9ICIiOyAvL3RoaXMuaXNFeGlzdCA9ICIiOwogICAgfSwKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgdGhpcy5pc1BheW1lbnQgPSB0cnVlOyAvL3RoaXMuYWRkTGlzdCA9IGZhbHNlOwoKICAgICAgdGhpcy5idXR0b24gPSBmYWxzZTsKICAgICAgdGhpcy5pc0Nhc2ggPSBmYWxzZTsgLy90aGlzLmlzRXhpc3QgPSAiIjsKICAgICAgLy90aGlzLmlzUGFpZCA9ICIiOwoKICAgICAgdGhpcy5pc0Nhc2hQYWlkID0gIiI7CiAgICAgIHRoaXMudG90YWxQdHlBbW91bnQgPSAwOwogICAgICB0aGlzLnBhdGllbnRQYXltZW50ID0gewogICAgICAgIGNkcGF5bWVudF9kYXRlOiBtb21lbnQoU3RyaW5nKG5ldyBEYXRlKCkpKS5mb3JtYXQoIk1NL0REL1lZWVkiKSwKICAgICAgICB0b3RhbF9hbW91bnQ6IDAsCiAgICAgICAgcHR5cGFpZF9hbW91bnQ6IDAsCiAgICAgICAgdG90YWxfYW1vdW50X2luZjogMCwKICAgICAgICBwYXltZW50VHlwZUNhc2g6ICIxIiwKICAgICAgICBjYXNoX3BhaWRfYW1vdW50OiAwLAogICAgICAgIGludm9pY2VfaWQ6ICIiLAogICAgICAgIGFQYXRpZW50OiB7fSwKICAgICAgICBsc3RQYXRpZW50UGF5bWVudERldGFpbHM6IFtdLAogICAgICAgIGRpc2NvdW50X2Ftb3VudDogMCwKICAgICAgICBkaXNjb3VudF9wZXJjZW50OiAwLAogICAgICAgIHJlZnVuZF9hbW91bnQ6IDAsCiAgICAgICAgaXNSZWZ1bmQ6IGZhbHNlLAogICAgICAgIGlwZFNlcnZpY2VMaXN0OiBbXQogICAgICB9OwogICAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlOwogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYWRtaXNzaW9uX2lkX2Zvcl9wYXltZW50Jyk7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhZG1pc3Npb25fbm9fZm9yX3BheW1lbnRfZnJvbV9hZG1pc3Npb25saXN0Jyk7CiAgICB9LAogICAgZmlsdGVyUGF5bWVudFR5cGU6IGZ1bmN0aW9uIGZpbHRlclBheW1lbnRUeXBlKCkgewogICAgICByZXR1cm4gdGhpcy5wYXltZW50VHlwZUxpc3QuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBlbC5wYXltZW50X3R5cGVfaWQgIT0gMSAmJiBlbC5hY3RpdmUgPT0gdHJ1ZTsKICAgICAgfSwgdGhpcyk7CiAgICB9LAogICAgZ2V0Rm9ybWF0dGVkOiBmdW5jdGlvbiBnZXRGb3JtYXR0ZWQob2JqKSB7CiAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShvYmouZGF0YSk7IC8vdGhpcy5yZXNldCgpOwoKICAgICAgaWYgKGRhdGEubGVuZ3RoID09IDApIHsKICAgICAgICAvLyB0aGlzLmlzRHVlRXhpc3QgPSAiTm90IGR1ZSEiOwogICAgICAgIHRoaXMuJHRvYXN0LmFkZCh7CiAgICAgICAgICBzZXZlcml0eTogIndhcm4iLAogICAgICAgICAgc3VtbWFyeTogIldhcm4gTWVzc2FnZSIsCiAgICAgICAgICBkZXRhaWw6ICJOb3QgZHVlISIsCiAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgIH0pOwogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQgPSB7CiAgICAgICAgICBjZHBheW1lbnRfZGF0ZTogbW9tZW50KFN0cmluZyhuZXcgRGF0ZSgpKSkuZm9ybWF0KCJNTS9ERC9ZWVlZIiksCiAgICAgICAgICB0b3RhbF9hbW91bnQ6IDAsCiAgICAgICAgICBwYXltZW50VHlwZUNhc2g6ICIxIiwKICAgICAgICAgIGludm9pY2VfaWQ6ICIiLAogICAgICAgICAgYVBhdGllbnQ6IHt9LAogICAgICAgICAgbHN0UGF0aWVudFBheW1lbnREZXRhaWxzOiBbXSwKICAgICAgICAgIHJlZnVuZF9hbW91bnQ6IDAsCiAgICAgICAgICBpc1JlZnVuZDogZmFsc2UsCiAgICAgICAgICBpcGRTZXJ2aWNlTGlzdDogW10KICAgICAgICB9OwogICAgICB9IGVsc2UgewogICAgICAgIC8vdGhpcy5pc0R1ZUV4aXN0ID0gIiI7CiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5yZWZ1bmRfYW1vdW50ID0gMDsKICAgICAgICB0aGlzLnBhdGllbnRQYXltZW50LmlzUmVmdW5kID0gZmFsc2U7CiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5pbnZvaWNlX2lkID0gZGF0YVswXS5pbnZvaWNlX2lkOwogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuYWRtaXNzaW9uX2lkID0gZGF0YVswXS5hZG1pc3Npb25faWQ7IC8vdGhpcy5wYXRpZW50UGF5bWVudC5kaXNjaGFyZ2Vfc3VtbWFyeSA9IGRhdGFbMF0uZGlzY2hhcmdlX3N1bW1hcnk7CgogICAgICAgIGlmIChkYXRhWzBdLmRpc2NoYXJnZV9zdW1tYXJ5ICE9IG51bGwpIHsKICAgICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuaXNSZWFkeUZvclNldHRsZW1lbnQgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGRhdGFbMF0uZGlzY2hhcmdlX3N1bW1hcnkgPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5pc1JlYWR5Rm9yU2V0dGxlbWVudCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5yZWZmZXJlZF9ieV9pZCA9IGRhdGFbMF0ucmVmZmVyZWRfYnlfaWQ7CiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5hUGF0aWVudC5wYXRpZW50X2lkID0gZGF0YVswXS5wYXRpZW50X2lkOwogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuYVBhdGllbnQuZmlyc3RfbmFtZSA9IGRhdGFbMF0uZmlyc3RfbmFtZTsKICAgICAgICB0aGlzLnBhdGllbnRQYXltZW50LmFQYXRpZW50LmNvbnRhY3Rfbm8gPSBkYXRhWzBdLmNvbnRhY3Rfbm87CiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5iaWxsX2Ftb3VudCA9IGRhdGFbMF0udG90YWxfYW1vdW50OwogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQudG90YWxfYW1vdW50ID0gZGF0YVswXS5kdWVfYW1vdW50OwoKICAgICAgICBpZiAoZGF0YVswXS5kdWVfYW1vdW50IDwgMCkgewogICAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50ID0gMDsKICAgICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQucHR5cGFpZF9hbW91bnQgPSAwOwogICAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5hZHZhbmNlX2Ftb3VudCA9IHBhcnNlRmxvYXQoZGF0YVswXS50b3RhbF9hbW91bnQgKyBNYXRoLmFicyhkYXRhWzBdLmR1ZV9hbW91bnQpKS50b0ZpeGVkKDIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnBhdGllbnRQYXltZW50LmNhc2hfcGFpZF9hbW91bnQgPSBkYXRhWzBdLmR1ZV9hbW91bnQ7CiAgICAgICAgICB0aGlzLnBhdGllbnRQYXltZW50LnB0eXBhaWRfYW1vdW50ID0gZGF0YVswXS5kdWVfYW1vdW50OwogICAgICAgIH0KCiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5jZGFkbWlzc2lvbl9kYXRlID0gbW9tZW50KFN0cmluZyhkYXRhWzBdLmFkbWlzc2lvbl9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7IC8vCgogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuaXBkU2VydmljZUxpc3QgPSBKU09OLnBhcnNlKG9iai5zZXJ2aWNlTGlzdCk7CiAgICAgIH0KICAgIH0sCiAgICBmaW5kSVBEUGF5bWVudEluZm86IGZ1bmN0aW9uIGZpbmRJUERQYXltZW50SW5mbygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLnJlc2V0KCk7CiAgICAgIHRoaXMucGF0aWVudFBheW1lbnRTZXJ2aWNlLmdldElQRFBhYmxlQnlhZG1pc3Npb25fbm8odGhpcy5hZG1pc3Npb25fbm8pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LmdldEZvcm1hdHRlZChkYXRhLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBwYXltZW50VHlwZUlzRXhpc3Q6IGZ1bmN0aW9uIHBheW1lbnRUeXBlSXNFeGlzdCgpIHsKICAgICAgdmFyIGFQYXltZW50VHlwZSA9IHRoaXMucGF0aWVudFBheW1lbnQubHN0UGF0aWVudFBheW1lbnREZXRhaWxzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwucGF5bWVudF90eXBlX2lkID09PSB0aGlzLnBhdGllbnRQYXltZW50LmRkbFBheW1lbnRUeXBlLnBheW1lbnRfdHlwZV9pZDsKICAgICAgfSwgdGhpcyk7CgogICAgICBpZiAoYVBheW1lbnRUeXBlLmxlbmd0aCkgewogICAgICAgIC8vdGhpcy5pc0V4aXN0ID0gIlRoaXMgUGF5bWVudCBUeXBlIGFscmVhZHkgYWRkZWQiOwogICAgICAgIHRoaXMuJHRvYXN0LmFkZCh7CiAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciBNZXNzYWdlIiwKICAgICAgICAgIGRldGFpbDogIlRoaXMgUGF5bWVudCBUeXBlIGFscmVhZHkgYWRkZWQiLAogICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICB9KTsKICAgICAgICB0aGlzLmlzUGF5bWVudCA9IHRydWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIC8vdGhpcy5pc0V4aXN0ID0gIiI7CiAgICAgICAgdGhpcy5pc1BheW1lbnQgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGFkZFBheW1lbnRUeXBlOiBmdW5jdGlvbiBhZGRQYXltZW50VHlwZSgpIHsKICAgICAgdGhpcy5zdWJtaXR0ZWQgPSB0cnVlOwogICAgICB2YXIgYVBheW1lbnRUeXBlID0gdGhpcy5wYXRpZW50UGF5bWVudC5sc3RQYXRpZW50UGF5bWVudERldGFpbHMuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBlbC5wYXltZW50X3R5cGVfaWQgPT09IHRoaXMucGF0aWVudFBheW1lbnQuZGRsUGF5bWVudFR5cGUucGF5bWVudF90eXBlX2lkOwogICAgICB9LCB0aGlzKTsKCiAgICAgIGlmIChhUGF5bWVudFR5cGUubGVuZ3RoKSB7CiAgICAgICAgLy90aGlzLmlzRXhpc3QgPSAiVGhpcyBQYXltZW50IFR5cGUgYWxyZWFkeSBhZGRlZCI7CiAgICAgICAgdGhpcy4kdG9hc3QuYWRkKHsKICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgc3VtbWFyeTogIkVycm9yIE1lc3NhZ2UiLAogICAgICAgICAgZGV0YWlsOiAiVGhpcyBQYXltZW50IFR5cGUgYWxyZWFkeSBhZGRlZCIsCiAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgIH0pOyAvL3RoaXMuaXNQYXltZW50ID0gdHJ1ZTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICghdGhpcy5wYXRpZW50UGF5bWVudC5hUGF0aWVudC5maXJzdF9uYW1lKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5wYXRpZW50UGF5bWVudC5jZHBheW1lbnRfZGF0ZSkgewogICAgICAgICAgdGhpcy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciBNZXNzYWdlIiwKICAgICAgICAgICAgZGV0YWlsOiAiUGF5bWVudCBEYXRlIGlzIHJlcXVpcmVkIiwKICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAoIXRoaXMucGF0aWVudFBheW1lbnQuZGRsUGF5bWVudFR5cGUpIHsKICAgICAgICAgIC8vdGhpcy5pc0V4aXN0ID0gIlBheW1lbnQgVHlwZSBpcyByZXF1aXJlZC4iOwogICAgICAgICAgdGhpcy4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciBNZXNzYWdlIiwKICAgICAgICAgICAgZGV0YWlsOiAiUGF5bWVudCBUeXBlIGlzIHJlcXVpcmVkIiwKICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5wYXRpZW50UGF5bWVudC5wdHlwYWlkX2Ftb3VudCA8PSAwIHx8ICF0aGlzLnBhdGllbnRQYXltZW50LnB0eXBhaWRfYW1vdW50KSB7CiAgICAgICAgICAvL3RoaXMuaXNQYWlkID0gIk5vbi1DYXNoIFBhaWQgQW10IGlzIHJlcXVpcmVkIjsKICAgICAgICAgIHRoaXMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IgTWVzc2FnZSIsCiAgICAgICAgICAgIGRldGFpbDogIk5vbi1DYXNoIFBhaWQgQW10IGlzIHJlcXVpcmVkIiwKICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5wYXRpZW50UGF5bWVudC5yZWZ1bmRfYW1vdW50ID4gMCkgewogICAgICAgICAgLy90aGlzLmlzUGFpZCA9ICJZb3UgaGF2ZSBSZWZ1bmQgQW10IjsKICAgICAgICAgIHRoaXMuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IgTWVzc2FnZSIsCiAgICAgICAgICAgIGRldGFpbDogIllvdSBoYXZlIFJlZnVuZCBBbXQiLAogICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBhdGllbnRQYXltZW50LmlzUmVhZHlGb3JTZXR0bGVtZW50ICYmIHRoaXMucGF0aWVudFBheW1lbnQudG90YWxfYW1vdW50IDw9IDApIHsKICAgICAgICAgIC8vdGhpcy5pc1BhaWQgPSAiWW91IGhhdmUgUmVmdW5kIEFtdCI7CiAgICAgICAgICB0aGlzLiR0b2FzdC5hZGQoewogICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIE1lc3NhZ2UiLAogICAgICAgICAgICBkZXRhaWw6ICJZb3UgaGF2ZSBSZWZ1bmQgQW10IiwKICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8gZWxzZSBpZiAoCiAgICAgICAgLy8gICB0aGlzLnBhdGllbnRQYXltZW50LmNhc2hfcGFpZF9hbW91bnQgPD0gMCB8fAogICAgICAgIC8vICAgdGhpcy5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50IDwKICAgICAgICAvLyAgIHRoaXMucGF0aWVudFBheW1lbnQucHR5cGFpZF9hbW91bnQKICAgICAgICAvLyApIHsKICAgICAgICAvLyAgIHRoaXMuaXNQYWlkID0gIkV4Y2VlZCBhbW91bnQhIjsKICAgICAgICAvLyAgIHJldHVybjsKICAgICAgICAvLyB9IAogICAgICAgIGVsc2UgewogICAgICAgICAgICAvL3RoaXMuaXNFeGlzdCA9ICIiOwogICAgICAgICAgICAvL3RoaXMuaXNQYWlkID0gIiI7CiAgICAgICAgICAgIHZhciBvYmogPSB7CiAgICAgICAgICAgICAgcGF5bWVudF90eXBlX2lkOiB0aGlzLnBhdGllbnRQYXltZW50LmRkbFBheW1lbnRUeXBlLnBheW1lbnRfdHlwZV9pZCwKICAgICAgICAgICAgICBfcGF5bWVudF90eXBlX25hbWU6IHRoaXMucGF0aWVudFBheW1lbnQuZGRsUGF5bWVudFR5cGUucGF5bWVudF90eXBlX25hbWUsCiAgICAgICAgICAgICAgcGFpZF9hbW91bnQ6IHBhcnNlRmxvYXQodGhpcy5wYXRpZW50UGF5bWVudC5wdHlwYWlkX2Ftb3VudCkKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5sc3RQYXRpZW50UGF5bWVudERldGFpbHMucHVzaChvYmopOyAvLyB0aGlzLnRvdGFsUHR5QW1vdW50ID0KICAgICAgICAgICAgLy8gICB0aGlzLnRvdGFsUHR5QW1vdW50ICsgcGFyc2VJbnQodGhpcy5wYXRpZW50UGF5bWVudC5wdHlwYWlkX2Ftb3VudCk7CiAgICAgICAgICAgIC8vIHRoaXMucGF0aWVudFBheW1lbnQuY2FzaF9wYWlkX2Ftb3VudCA9CiAgICAgICAgICAgIC8vICAgdGhpcy5wYXRpZW50UGF5bWVudC50b3RhbF9hbW91bnQgLSB0aGlzLnRvdGFsUHR5QW1vdW50OwoKICAgICAgICAgICAgdGhpcy5ncmlkU3VtKCk7CiAgICAgICAgICB9CiAgICAgIH0gLy90aGlzLmFkZExpc3QgPSB0cnVlOwoKCiAgICAgIHRoaXMuYnV0dG9uID0gdHJ1ZTsKICAgIH0sCiAgICBkZWxldGVGcm9tTGlzdDogZnVuY3Rpb24gZGVsZXRlRnJvbUxpc3QoZGF0YSkgewogICAgICB0aGlzLnBhdGllbnRQYXltZW50LmxzdFBhdGllbnRQYXltZW50RGV0YWlscyA9IHRoaXMucGF0aWVudFBheW1lbnQubHN0UGF0aWVudFBheW1lbnREZXRhaWxzLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwucGF5bWVudF90eXBlX2lkICE9IGRhdGEucGF5bWVudF90eXBlX2lkOwogICAgICB9LCB0aGlzKTsgLy8gdGhpcy5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50ID0KICAgICAgLy8gICB0aGlzLnBhdGllbnRQYXltZW50LmNhc2hfcGFpZF9hbW91bnQgKyBwYXJzZUludChkYXRhLnBhaWRfYW1vdW50KTsKCiAgICAgIGlmICghdGhpcy5wYXRpZW50UGF5bWVudC5sc3RQYXRpZW50UGF5bWVudERldGFpbHMubGVuZ3RoKSB7CiAgICAgICAgLy90aGlzLmFkZExpc3QgPSBmYWxzZTsKICAgICAgICB0aGlzLmJ1dHRvbiA9IGZhbHNlOwogICAgICB9CgogICAgICB0aGlzLmdyaWRTdW0oKTsKICAgIH0sCiAgICBncmlkU3VtOiBmdW5jdGlvbiBncmlkU3VtKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMucGF0aWVudFBheW1lbnQudG90YWxfYW1vdW50X2luZiA9IDA7CiAgICAgIHRoaXMucGF0aWVudFBheW1lbnQubHN0UGF0aWVudFBheW1lbnREZXRhaWxzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczUucGF0aWVudFBheW1lbnQudG90YWxfYW1vdW50X2luZiArPSBlbGVtZW50LnBhaWRfYW1vdW50OwogICAgICB9KTsKICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50ID0gMDsgLy90aGlzLnBhdGllbnRQYXltZW50LnRvdGFsX2Ftb3VudCAtIHRoaXMucGF0aWVudFBheW1lbnQudG90YWxfYW1vdW50X2luZiAtIHRoaXMucGF0aWVudFBheW1lbnQuZGlzY291bnRfYW1vdW50OwoKICAgICAgaWYgKHRoaXMucGF0aWVudFBheW1lbnQuY2FzaF9wYWlkX2Ftb3VudCA8IDApIHsKICAgICAgICB0aGlzLnBhdGllbnRQYXltZW50LmNhc2hfcGFpZF9hbW91bnQgPSAwOwogICAgICB9CgogICAgICB0aGlzLmR1ZUNhbGN1bGF0ZSgpOwogICAgfSwKICAgIGR1ZUNhbGN1bGF0ZTogZnVuY3Rpb24gZHVlQ2FsY3VsYXRlKCkgewogICAgICAvLyBMaW5lIERpc2NvdW50IFN0YXJ0CiAgICAgIHZhciB3aXRoT3V0TGluZURpc2NvdW50VG90YWxTZXJ2aWNlQ29zdCA9IDA7CiAgICAgIHZhciB3aXRoTGluZURpc2NvdW50VG90YWxTZXJ2aWNlQ29zdCA9IDA7CiAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuaXBkU2VydmljZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIHdpdGhPdXRMaW5lRGlzY291bnRUb3RhbFNlcnZpY2VDb3N0ID0gd2l0aE91dExpbmVEaXNjb3VudFRvdGFsU2VydmljZUNvc3QgKyBlbGVtZW50LmNoYXJnZTsKICAgICAgICB3aXRoTGluZURpc2NvdW50VG90YWxTZXJ2aWNlQ29zdCA9IHdpdGhMaW5lRGlzY291bnRUb3RhbFNlcnZpY2VDb3N0ICsgZWxlbWVudC50b3RhbF9hbW91bnQ7CiAgICAgIH0pOyAvLyBMaW5lIERpc2NvdW50IEVuZAoKICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5kdWVfYW1vdW50ID0gcGFyc2VGbG9hdCh0aGlzLnBhdGllbnRQYXltZW50LnRvdGFsX2Ftb3VudCAtIHRoaXMucGF0aWVudFBheW1lbnQuY2FzaF9wYWlkX2Ftb3VudCAtIHRoaXMucGF0aWVudFBheW1lbnQudG90YWxfYW1vdW50X2luZiAtIHRoaXMucGF0aWVudFBheW1lbnQuZGlzY291bnRfYW1vdW50IC0gd2l0aE91dExpbmVEaXNjb3VudFRvdGFsU2VydmljZUNvc3QgKyB3aXRoTGluZURpc2NvdW50VG90YWxTZXJ2aWNlQ29zdCkudG9GaXhlZCgyKTsKCiAgICAgIGlmICh0aGlzLnBhdGllbnRQYXltZW50LmR1ZV9hbW91bnQgPCAwKSB7CiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5yZWZ1bmRfYW1vdW50ID0gTWF0aC5hYnModGhpcy5wYXRpZW50UGF5bWVudC5kdWVfYW1vdW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhdGllbnRQYXltZW50LnJlZnVuZF9hbW91bnQgPSAwOwogICAgICB9IC8vIGlmICgKICAgICAgLy8gICB0aGlzLnBhdGllbnRQYXltZW50LnRvdGFsX2Ftb3VudCA8IHRoaXMucGF0aWVudFBheW1lbnQuY2FzaF9wYWlkX2Ftb3VudAogICAgICAvLyApIHsKICAgICAgLy8gICB0aGlzLmlzQ2FzaFBhaWQgPSAiRXhjZWVkIGFtb3VudCEiOwogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAgIHRoaXMuaXNDYXNoUGFpZCA9ICIiOwogICAgICAvLyB9CgogICAgfSwKICAgIGNhbGN1bGF0ZUNoYW5nZUFtb3VudDogZnVuY3Rpb24gY2FsY3VsYXRlQ2hhbmdlQW1vdW50KCkgewogICAgICBpZiAodGhpcy5wYXRpZW50UGF5bWVudC5jYXNoX2Ftb3VudC5sZW5ndGgpIHsKICAgICAgICB0aGlzLnBhdGllbnRQYXltZW50LmNoYW5nZV9hbW91bnQgPSB0aGlzLnBhdGllbnRQYXltZW50LmNhc2hfYW1vdW50IC0gdGhpcy5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuY2hhbmdlX2Ftb3VudCA9IDA7CiAgICAgIH0KICAgIH0sCiAgICBnZXREaXNjb3VudFBlcmNlbnQ6IGZ1bmN0aW9uIGdldERpc2NvdW50UGVyY2VudCgpIHsKICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5kaXNjb3VudF9wZXJjZW50ID0gcGFyc2VGbG9hdCh0aGlzLnBhdGllbnRQYXltZW50LmRpc2NvdW50X2Ftb3VudCAvIHRoaXMucGF0aWVudFBheW1lbnQuYmlsbF9hbW91bnQgKiAxMDApLnRvRml4ZWQoMik7CiAgICAgIHRoaXMuZ3JpZFN1bSgpOwogICAgfSwKICAgIGdldERpc2NvdW50QW1vdW50OiBmdW5jdGlvbiBnZXREaXNjb3VudEFtb3VudCgpIHsKICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5kaXNjb3VudF9hbW91bnQgPSB0aGlzLnBhdGllbnRQYXltZW50LmJpbGxfYW1vdW50ICogdGhpcy5wYXRpZW50UGF5bWVudC5kaXNjb3VudF9wZXJjZW50IC8gMTAwOwogICAgICB0aGlzLmdyaWRTdW0oKTsKICAgIH0sCiAgICBnZXRSZWZ1bmRBbXQ6IGZ1bmN0aW9uIGdldFJlZnVuZEFtdCgpIHsKICAgICAgdGhpcy5ncmlkU3VtKCk7CgogICAgICBpZiAoIXRoaXMucGF0aWVudFBheW1lbnQuaXNTZXR0bGVtZW50ICYmIHRoaXMucGF0aWVudFBheW1lbnQudG90YWxfYW1vdW50IDwgMCkgewogICAgICAgIC8vdGhpcy5wYXRpZW50UGF5bWVudC5yZWZ1bmRfYW1vdW50ID0gTWF0aC5hYnModGhpcy5wYXRpZW50UGF5bWVudC50b3RhbF9hbW91bnQpOwogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuaXNSZWZ1bmQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGF0aWVudFBheW1lbnQucmVmdW5kX2Ftb3VudCA9IDA7CiAgICAgICAgdGhpcy5wYXRpZW50UGF5bWVudC5pc1JlZnVuZCA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgYWRkOiBmdW5jdGlvbiBhZGQoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgcmVzdWx0LCBhZG1pc3Npb25fbm9fZm9yX3BheW1lbnRfZnJvbV9hZG1pc3Npb25saXN0LCBhZG1pc3Npb25faWRfZm9yX3BheW1lbnQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXM2LnN1Ym1pdHRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2LnBhdGllbnRQYXltZW50LmFQYXRpZW50LmZpcnN0X25hbWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2LnBhdGllbnRQYXltZW50LmNkcGF5bWVudF9kYXRlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXM2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIE1lc3NhZ2UiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJQYXltZW50IERhdGUgaXMgcmVxdWlyZWQiLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM2LnBhdGllbnRQYXltZW50Lmludm9pY2VfaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgIGlmICghKF90aGlzNi5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50IDw9IDAgJiYgIV90aGlzNi5wYXRpZW50UGF5bWVudC5pc1JlYWR5Rm9yU2V0dGxlbWVudCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJFbnRlciBhbW91bnQhIiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgaWYgKCEoX3RoaXM2LnBhdGllbnRQYXltZW50LmlzU2V0dGxlbWVudCAmJiBfdGhpczYucGF0aWVudFBheW1lbnQuZHVlX2Ftb3VudCA+IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXM2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICBzZXZlcml0eTogImVycm9yIiwKICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiQ2Fubm90IHNldHRsZW1lbnQgd2l0aCBkdWUgYW1vdW50ISIsCiAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICAgIGlmICghX3RoaXM2LmlzQ2FzaFBhaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICAgIGlmICghKF90aGlzNi5wYXRpZW50UGF5bWVudC5pc1JlZnVuZCAmJiBfdGhpczYucGF0aWVudFBheW1lbnQucmVmdW5kX2Ftb3VudCA+IDAgJiYgX3RoaXM2LnBhdGllbnRQYXltZW50LmNhc2hfcGFpZF9hbW91bnQgPiAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzNi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJFcnJvciIsCiAgICAgICAgICAgICAgICAgIGRldGFpbDogIllvdSBoYXZlIFJlZnVuZCBBbXQiLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzQ6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczYucGF0aWVudFBheW1lbnQuaXNSZWFkeUZvclNldHRsZW1lbnQgJiYgX3RoaXM2LnBhdGllbnRQYXltZW50LnRvdGFsX2Ftb3VudCA8PSAwICYmIF90aGlzNi5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50ID4gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiRXJyb3IiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6ICJZb3UgaGF2ZSBSZWZ1bmQgQW10IiwKICAgICAgICAgICAgICAgICAgbGlmZTogMTAwMDAKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDM5OgogICAgICAgICAgICAgICAgX3RoaXM2LnBhdGllbnRQYXltZW50LnBheW1lbnRfZGF0ZSA9IG1vbWVudChTdHJpbmcoX3RoaXM2LnBhdGllbnRQYXltZW50LmNkcGF5bWVudF9kYXRlKSkuZm9ybWF0KCJZWVlZLU1NLUREIik7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNi5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50ID4gMCAmJiAhX3RoaXM2LmlzQ2FzaCkgewogICAgICAgICAgICAgICAgICBfdGhpczYucGF0aWVudFBheW1lbnQubHN0UGF0aWVudFBheW1lbnREZXRhaWxzLnB1c2goewogICAgICAgICAgICAgICAgICAgIHBheW1lbnRfdHlwZV9pZDogX3RoaXM2LnBhdGllbnRQYXltZW50LnBheW1lbnRUeXBlQ2FzaCwKICAgICAgICAgICAgICAgICAgICBwYWlkX2Ftb3VudDogX3RoaXM2LnBhdGllbnRQYXltZW50LmNhc2hfcGFpZF9hbW91bnQKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfdGhpczYuaXNDYXNoID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczYucGF0aWVudFBheW1lbnQucGFpZF9hbW91bnQgPSBwYXJzZUZsb2F0KF90aGlzNi5wYXRpZW50UGF5bWVudC5jYXNoX3BhaWRfYW1vdW50KSArIHBhcnNlRmxvYXQoX3RoaXM2LnBhdGllbnRQYXltZW50LnRvdGFsX2Ftb3VudF9pbmYpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ0OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi5wYXRpZW50UGF5bWVudFNlcnZpY2UuYWRkSVBEKF90aGlzNi5wYXRpZW50UGF5bWVudCwgX3RoaXM2KTsKCiAgICAgICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5OiAiU3VjY2VzcyIsCiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiAiU2F2ZWQgU3VjY2Vzc2Z1bGx5IiwKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczYucGF0aWVudFBheW1lbnQuaXNTZXR0bGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM2LnByaW50RGlzY2hhcmdlQmlsbFN1bW1hcnkocmVzdWx0LmRhdGEpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIF90aGlzNi5wcmludEFkbWlzc2lvblBheW1lbnQocmVzdWx0LmRhdGEpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBhZG1pc3Npb25fbm9fZm9yX3BheW1lbnRfZnJvbV9hZG1pc3Npb25saXN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FkbWlzc2lvbl9ub19mb3JfcGF5bWVudF9mcm9tX2FkbWlzc2lvbmxpc3QnKTsKCiAgICAgICAgICAgICAgICAgIGlmIChhZG1pc3Npb25fbm9fZm9yX3BheW1lbnRfZnJvbV9hZG1pc3Npb25saXN0KSB7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FkbWlzc2lvbl9ub19mb3JfcGF5bWVudF9mcm9tX2FkbWlzc2lvbmxpc3QnKTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXM2LiRyb3V0ZXIucHVzaCgiL3BhdGllbnQtYWRtaXNzaW9uLWxpc3QiKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgYWRtaXNzaW9uX2lkX2Zvcl9wYXltZW50ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FkbWlzc2lvbl9pZF9mb3JfcGF5bWVudCcpOwoKICAgICAgICAgICAgICAgICAgaWYgKGFkbWlzc2lvbl9pZF9mb3JfcGF5bWVudCkgewogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhZG1pc3Npb25faWRfZm9yX3BheW1lbnQnKTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXM2LiRyb3V0ZXIucHVzaCgiL3BhdGllbnQtYWRtaXNzaW9uLWZvcm0iKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgX3RoaXM2LnJlc2V0KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICBfdGhpczYuJHRvYXN0LmFkZCh7CiAgICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeTogIkVycm9yIiwKICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IHJlc3VsdC5kYXRhLAogICAgICAgICAgICAgICAgICAgIGxpZmU6IDEwMDAwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXM2LiR0b2FzdC5hZGQoewogICAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICAgIGRldGFpbDogcmVzdWx0LnJlcywKICAgICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNi5yZXNldCgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDQ2OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDUyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNDg6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNDg7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwoKICAgICAgICAgICAgICAgIF90aGlzNi4kdG9hc3QuYWRkKHsKICAgICAgICAgICAgICAgICAgc2V2ZXJpdHk6ICJlcnJvciIsCiAgICAgICAgICAgICAgICAgIHN1bW1hcnk6ICJGYWlsZWQiLAogICAgICAgICAgICAgICAgICBkZXRhaWw6IF9jb250ZXh0LnQwLAogICAgICAgICAgICAgICAgICBsaWZlOiAxMDAwMAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgX3RoaXM2LnJlc2V0KCk7CgogICAgICAgICAgICAgIGNhc2UgNTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzEsIDQ4XV0pOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvLyBsaW5lIGRpc2NvdW50CiAgICBjYWxjdWxhdGVQZXJJbnZlc3RpZ2F0aW9uRGlzY291bnRBbW91bnQ6IGZ1bmN0aW9uIGNhbGN1bGF0ZVBlckludmVzdGlnYXRpb25EaXNjb3VudEFtb3VudChkYXRhKSB7CiAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuaXBkU2VydmljZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gZGF0YS50eXBlICYmIGVsZW1lbnQuYWRtaXNzaW9uX2JlZF9zZXJ2aWNlX3BhY2thZ2VfZGV0YWlsc19pZCA9PSBkYXRhLmFkbWlzc2lvbl9iZWRfc2VydmljZV9wYWNrYWdlX2RldGFpbHNfaWQpIHsKICAgICAgICAgIGVsZW1lbnQuZGlzY291bnRfYW1vdW50ID0gZWxlbWVudC5jaGFyZ2UgKiBlbGVtZW50LmRpc2NvdW50X3BlcmNlbnQgLyAxMDA7CiAgICAgICAgICBlbGVtZW50LnRvdGFsX2Ftb3VudCA9IGVsZW1lbnQuY2hhcmdlIC0gZWxlbWVudC5kaXNjb3VudF9hbW91bnQ7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5ncmlkU3VtKCk7CiAgICB9LAogICAgY2FsY3VsYXRlUGVySW52ZXN0aWdhdGlvbkRpc2NvdW50UGVyY2VudDogZnVuY3Rpb24gY2FsY3VsYXRlUGVySW52ZXN0aWdhdGlvbkRpc2NvdW50UGVyY2VudChkYXRhKSB7CiAgICAgIHRoaXMucGF0aWVudFBheW1lbnQuaXBkU2VydmljZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIGlmIChlbGVtZW50LnR5cGUgPT0gZGF0YS50eXBlICYmIGVsZW1lbnQuYWRtaXNzaW9uX2JlZF9zZXJ2aWNlX3BhY2thZ2VfZGV0YWlsc19pZCA9PSBkYXRhLmFkbWlzc2lvbl9iZWRfc2VydmljZV9wYWNrYWdlX2RldGFpbHNfaWQpIHsKICAgICAgICAgIGVsZW1lbnQuZGlzY291bnRfcGVyY2VudCA9IHBhcnNlRmxvYXQoZWxlbWVudC5kaXNjb3VudF9hbW91bnQgLyBlbGVtZW50LmNoYXJnZSAqIDEwMCkudG9GaXhlZCgyKTsgLy92YXIgZGlzY291bnRfYW1vdW50ID0gKGVsZW1lbnQuY2hhcmdlICogZWxlbWVudC5kaXNjb3VudF9wZXJjZW50KSAvIDEwMDsKCiAgICAgICAgICBlbGVtZW50LnRvdGFsX2Ftb3VudCA9IGVsZW1lbnQuY2hhcmdlIC0gZWxlbWVudC5kaXNjb3VudF9hbW91bnQ7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5ncmlkU3VtKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["F:/SVN PROJECTS/ERP_Hospital_Client/trunk/src/scripts/cash-counter/AdmissionPayment.js"],"names":["PatientPaymentService","PaymentTypeSetupService","IPDReportService","CommonService","moment","FilterMatchMode","FilterOperator","data","isPayment","button","isCash","isCashPaid","paymentTypeList","totalPtyAmount","admission_no","patientPayment","cdpayment_date","String","Date","format","total_amount","ptypaid_amount","total_amount_inf","paymentTypeCash","invoice_id","aPatient","lstPatientPaymentDetails","discount_amount","discount_percent","refund_amount","isRefund","ipdServiceList","filters","global","value","matchMode","CONTAINS","name","STARTS_WITH","initFilters","operator","AND","constraints","submitted","created","patientPaymentService","paymentTypeSetupService","iPDReportService","commonService","getAll","then","admission_id_for_payment","localStorage","getItem","findIPDPaymentInfo","admission_no_for_payment_from_admissionlist","methods","printAdmissionPayment","Id","GetAdmissionPayment","Downloadfile","printDischargeBillSummary","GetDischargeBillSummary","paymentReset","ddlPaymentType","reset","cash_paid_amount","removeItem","filterPaymentType","filter","el","payment_type_id","active","getFormatted","obj","JSON","parse","length","$toast","add","severity","summary","detail","life","admission_id","discharge_summary","isReadyForSettlement","reffered_by_id","patient_id","first_name","contact_no","bill_amount","due_amount","advance_amount","parseFloat","Math","abs","toFixed","cdadmission_date","admission_date","serviceList","getIPDPableByadmission_no","paymentTypeIsExist","aPaymentType","addPaymentType","_payment_type_name","payment_type_name","paid_amount","push","gridSum","deleteFromList","forEach","element","dueCalculate","withOutLineDiscountTotalServiceCost","withLineDiscountTotalServiceCost","charge","calculateChangeAmount","cash_amount","change_amount","getDiscountPercent","getDiscountAmount","getRefundAmt","isSettlement","payment_date","addIPD","result","status","$router","res","calculatePerInvestigationDiscountAmount","type","admission_bed_service_package_details_id","calculatePerInvestigationDiscountPercent"],"mappings":"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","sourcesContent":["import PatientPaymentService from \"../../service/cash-counter/PatientPaymentService\";\r\nimport PaymentTypeSetupService from \"../../service/setup/PaymentTypeSetupService\";\r\nimport IPDReportService from \"../../service/report/IPDReportService\";\r\nimport CommonService from \"../../service/CommonService\";\r\nimport moment from \"moment\";\r\nimport { FilterMatchMode, FilterOperator } from \"primevue/api\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      isPayment: true,\r\n      //addList: false,\r\n      button: false,\r\n      isCash: false,\r\n      //isPaid: \"\",\r\n      isCashPaid: \"\",\r\n      //isDueExist: \"\",\r\n      //isExist: \"\",\r\n      paymentTypeList: [],\r\n      totalPtyAmount: 0,\r\n      admission_no: \"\",\r\n      patientPayment: {\r\n        cdpayment_date: moment(String(new Date())).format(\r\n          \"MM/DD/YYYY\"\r\n        ),\r\n        total_amount: 0,\r\n        ptypaid_amount: 0,\r\n        total_amount_inf: 0,\r\n        paymentTypeCash: \"1\",\r\n        invoice_id: \"\",\r\n        aPatient: {},\r\n        lstPatientPaymentDetails: [],\r\n        discount_amount: 0,\r\n        discount_percent: 0,\r\n        refund_amount: 0,\r\n        isRefund: false,\r\n        ipdServiceList: [],\r\n      },\r\n      filters: {\r\n        global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        name: { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n      },\r\n      initFilters() {\r\n        this.filters = {\r\n          global: { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n          name: {\r\n            operator: FilterOperator.AND,\r\n            constraints: [\r\n              { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n            ],\r\n          },\r\n        };\r\n      },\r\n      submitted: false,\r\n    };\r\n  },\r\n  created() {\r\n    this.patientPaymentService = new PatientPaymentService();\r\n    this.paymentTypeSetupService = new PaymentTypeSetupService();\r\n    this.iPDReportService = new IPDReportService();\r\n    this.commonService = new CommonService();\r\n\r\n    this.paymentTypeSetupService\r\n      .getAll()\r\n      .then((data) => (this.paymentTypeList = data.data));\r\n\r\n    var admission_id_for_payment = localStorage.getItem('admission_id_for_payment');\r\n    if (admission_id_for_payment) {\r\n\r\n      this.admission_no = admission_id_for_payment;\r\n      //localStorage.removeItem('admission_id_for_payment');\r\n      this.findIPDPaymentInfo();\r\n    }\r\n\r\n    var admission_no_for_payment_from_admissionlist = localStorage.getItem('admission_no_for_payment_from_admissionlist');\r\n    if (admission_no_for_payment_from_admissionlist) {\r\n      this.admission_no = admission_no_for_payment_from_admissionlist;\r\n      //localStorage.removeItem('admission_no_for_payment_from_admissionlist');\r\n      this.findIPDPaymentInfo();\r\n    }\r\n  },\r\n  methods: {\r\n    printAdmissionPayment(Id) {\r\n      this.iPDReportService.GetAdmissionPayment(Id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    printDischargeBillSummary(Id) {\r\n      this.iPDReportService.GetDischargeBillSummary(Id, this).then((data) => (this.commonService.Downloadfile(data.data)));\r\n    },\r\n    paymentReset() {\r\n      this.isPayment = true;\r\n      this.patientPayment.ddlPaymentType = \"\";\r\n      //this.isExist = \"\";\r\n    },\r\n    reset() {\r\n      this.isPayment = true;\r\n      //this.addList = false;\r\n      this.button = false;\r\n      this.isCash = false;\r\n      //this.isExist = \"\";\r\n      //this.isPaid = \"\";\r\n      this.isCashPaid = \"\";\r\n      this.totalPtyAmount = 0;\r\n      this.patientPayment = {\r\n        cdpayment_date: moment(String(new Date())).format(\r\n          \"MM/DD/YYYY\"\r\n        ),\r\n        total_amount: 0,\r\n        ptypaid_amount: 0,\r\n        total_amount_inf: 0,\r\n        paymentTypeCash: \"1\",\r\n        cash_paid_amount: 0,\r\n        invoice_id: \"\",\r\n        aPatient: {},\r\n        lstPatientPaymentDetails: [],\r\n        discount_amount: 0,\r\n        discount_percent: 0,\r\n        refund_amount: 0,\r\n        isRefund: false,\r\n        ipdServiceList: [],\r\n      };\r\n      this.submitted = false;\r\n      localStorage.removeItem('admission_id_for_payment');\r\n      localStorage.removeItem('admission_no_for_payment_from_admissionlist');\r\n    },\r\n    filterPaymentType() {\r\n      return this.paymentTypeList.filter(function (el) {\r\n        return el.payment_type_id != 1 && el.active == true;\r\n      }, this);\r\n    },\r\n    getFormatted(obj) {\r\n      var data = JSON.parse(obj.data);\r\n      //this.reset();\r\n      if (data.length == 0) {\r\n        // this.isDueExist = \"Not due!\";\r\n        this.$toast.add({\r\n          severity: \"warn\",\r\n          summary: \"Warn Message\",\r\n          detail: \"Not due!\",\r\n          life: 10000,\r\n        });\r\n        this.patientPayment = {\r\n          cdpayment_date: moment(String(new Date())).format(\r\n            \"MM/DD/YYYY\"\r\n          ),\r\n          total_amount: 0,\r\n          paymentTypeCash: \"1\",\r\n          invoice_id: \"\",\r\n          aPatient: {},\r\n          lstPatientPaymentDetails: [],\r\n          refund_amount: 0,\r\n          isRefund: false,\r\n          ipdServiceList: [],\r\n        };\r\n      } else {\r\n        //this.isDueExist = \"\";\r\n        this.patientPayment.refund_amount = 0;\r\n        this.patientPayment.isRefund = false;\r\n        this.patientPayment.invoice_id = data[0].invoice_id;\r\n        this.patientPayment.admission_id = data[0].admission_id;\r\n        //this.patientPayment.discharge_summary = data[0].discharge_summary;\r\n        if (data[0].discharge_summary != null) {\r\n          this.patientPayment.isReadyForSettlement = true;\r\n        }\r\n        if (data[0].discharge_summary == null) {\r\n          this.patientPayment.isReadyForSettlement = false;\r\n        }\r\n        this.patientPayment.reffered_by_id = data[0].reffered_by_id;\r\n        this.patientPayment.aPatient.patient_id = data[0].patient_id;\r\n        this.patientPayment.aPatient.first_name = data[0].first_name;\r\n        this.patientPayment.aPatient.contact_no = data[0].contact_no;\r\n\r\n        this.patientPayment.bill_amount = data[0].total_amount;\r\n        this.patientPayment.total_amount = data[0].due_amount;\r\n        if (data[0].due_amount < 0) {\r\n          this.patientPayment.cash_paid_amount = 0;\r\n          this.patientPayment.ptypaid_amount = 0;\r\n          this.patientPayment.advance_amount = parseFloat(data[0].total_amount + Math.abs(data[0].due_amount)).toFixed(2);\r\n        } else {\r\n          this.patientPayment.cash_paid_amount = data[0].due_amount;\r\n          this.patientPayment.ptypaid_amount = data[0].due_amount;\r\n        }\r\n\r\n        this.patientPayment.cdadmission_date = moment(\r\n          String(data[0].admission_date)\r\n        ).format(\"YYYY-MM-DD\");\r\n\r\n        //\r\n        this.patientPayment.ipdServiceList = JSON.parse(obj.serviceList);\r\n      }\r\n    },\r\n    findIPDPaymentInfo() {\r\n      this.reset();\r\n      this.patientPaymentService\r\n        .getIPDPableByadmission_no(this.admission_no)\r\n        .then((data) => this.getFormatted(data.data));\r\n    },\r\n    paymentTypeIsExist() {\r\n      var aPaymentType = this.patientPayment.lstPatientPaymentDetails.filter(\r\n        function (el) {\r\n          return (\r\n            el.payment_type_id ===\r\n            this.patientPayment.ddlPaymentType.payment_type_id\r\n          );\r\n        },\r\n        this\r\n      );\r\n\r\n      if (aPaymentType.length) {\r\n        //this.isExist = \"This Payment Type already added\";\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Error Message\",\r\n          detail: \"This Payment Type already added\",\r\n          life: 10000,\r\n        });\r\n        this.isPayment = true;\r\n        return;\r\n      } else {\r\n        //this.isExist = \"\";\r\n        this.isPayment = false;\r\n      }\r\n    },\r\n    addPaymentType() {\r\n      this.submitted = true;\r\n      var aPaymentType = this.patientPayment.lstPatientPaymentDetails.filter(\r\n        function (el) {\r\n          return (\r\n            el.payment_type_id ===\r\n            this.patientPayment.ddlPaymentType.payment_type_id\r\n          );\r\n        },\r\n        this\r\n      );\r\n\r\n      if (aPaymentType.length) {\r\n        //this.isExist = \"This Payment Type already added\";\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Error Message\",\r\n          detail: \"This Payment Type already added\",\r\n          life: 10000,\r\n        });\r\n        //this.isPayment = true;\r\n        return;\r\n      } else {\r\n        if (!this.patientPayment.aPatient.first_name) {\r\n          return;\r\n        } else if (!this.patientPayment.cdpayment_date) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error Message\",\r\n            detail: \"Payment Date is required\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (!this.patientPayment.ddlPaymentType) {\r\n          //this.isExist = \"Payment Type is required.\";\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error Message\",\r\n            detail: \"Payment Type is required\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (\r\n          this.patientPayment.ptypaid_amount <= 0 ||\r\n          !this.patientPayment.ptypaid_amount\r\n        ) {\r\n          //this.isPaid = \"Non-Cash Paid Amt is required\";\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error Message\",\r\n            detail: \"Non-Cash Paid Amt is required\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (this.patientPayment.refund_amount > 0) {\r\n          //this.isPaid = \"You have Refund Amt\";\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error Message\",\r\n            detail: \"You have Refund Amt\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (this.patientPayment.isReadyForSettlement && this.patientPayment.total_amount <= 0) {\r\n          //this.isPaid = \"You have Refund Amt\";\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error Message\",\r\n            detail: \"You have Refund Amt\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        }\r\n        // else if (\r\n        //   this.patientPayment.cash_paid_amount <= 0 ||\r\n        //   this.patientPayment.cash_paid_amount <\r\n        //   this.patientPayment.ptypaid_amount\r\n        // ) {\r\n        //   this.isPaid = \"Exceed amount!\";\r\n        //   return;\r\n        // } \r\n        else {\r\n          //this.isExist = \"\";\r\n          //this.isPaid = \"\";\r\n\r\n          var obj = {\r\n            payment_type_id: this.patientPayment.ddlPaymentType.payment_type_id,\r\n            _payment_type_name:\r\n              this.patientPayment.ddlPaymentType.payment_type_name,\r\n\r\n            paid_amount: parseFloat(this.patientPayment.ptypaid_amount),\r\n          };\r\n\r\n          this.patientPayment.lstPatientPaymentDetails.push(obj);\r\n\r\n          // this.totalPtyAmount =\r\n          //   this.totalPtyAmount + parseInt(this.patientPayment.ptypaid_amount);\r\n\r\n          // this.patientPayment.cash_paid_amount =\r\n          //   this.patientPayment.total_amount - this.totalPtyAmount;\r\n          this.gridSum();\r\n        }\r\n      }\r\n\r\n      //this.addList = true;\r\n      this.button = true;\r\n    },\r\n\r\n    deleteFromList(data) {\r\n      this.patientPayment.lstPatientPaymentDetails =\r\n        this.patientPayment.lstPatientPaymentDetails.filter(function (el) {\r\n          return el.payment_type_id != data.payment_type_id;\r\n        }, this);\r\n\r\n      // this.patientPayment.cash_paid_amount =\r\n      //   this.patientPayment.cash_paid_amount + parseInt(data.paid_amount);\r\n\r\n      if (!this.patientPayment.lstPatientPaymentDetails.length) {\r\n        //this.addList = false;\r\n        this.button = false;\r\n      }\r\n      this.gridSum();\r\n    },\r\n    gridSum() {\r\n      this.patientPayment.total_amount_inf = 0;\r\n      this.patientPayment.lstPatientPaymentDetails.forEach((element) => {\r\n        this.patientPayment.total_amount_inf += element.paid_amount;\r\n      });\r\n      this.patientPayment.cash_paid_amount = 0;\r\n      //this.patientPayment.total_amount - this.patientPayment.total_amount_inf - this.patientPayment.discount_amount;\r\n      if (this.patientPayment.cash_paid_amount < 0) {\r\n        this.patientPayment.cash_paid_amount = 0;\r\n      }\r\n      this.dueCalculate();\r\n    },\r\n    dueCalculate() {\r\n      // Line Discount Start\r\n      var withOutLineDiscountTotalServiceCost = 0;\r\n      var withLineDiscountTotalServiceCost = 0;\r\n      this.patientPayment.ipdServiceList.forEach(\r\n        (element) => {\r\n          withOutLineDiscountTotalServiceCost = withOutLineDiscountTotalServiceCost + element.charge;\r\n          withLineDiscountTotalServiceCost = withLineDiscountTotalServiceCost + element.total_amount;\r\n        }\r\n      );\r\n      // Line Discount End\r\n\r\n      this.patientPayment.due_amount = parseFloat(\r\n        this.patientPayment.total_amount -\r\n        this.patientPayment.cash_paid_amount -\r\n        this.patientPayment.total_amount_inf -\r\n        this.patientPayment.discount_amount - withOutLineDiscountTotalServiceCost + withLineDiscountTotalServiceCost).toFixed(2);\r\n\r\n      if (this.patientPayment.due_amount < 0) {\r\n        this.patientPayment.refund_amount = Math.abs(this.patientPayment.due_amount);\r\n      } else {\r\n        this.patientPayment.refund_amount = 0;\r\n      }\r\n      // if (\r\n      //   this.patientPayment.total_amount < this.patientPayment.cash_paid_amount\r\n      // ) {\r\n      //   this.isCashPaid = \"Exceed amount!\";\r\n      // } else {\r\n      //   this.isCashPaid = \"\";\r\n      // }\r\n    },\r\n    calculateChangeAmount() {\r\n      if (this.patientPayment.cash_amount.length) {\r\n        this.patientPayment.change_amount =\r\n          this.patientPayment.cash_amount -\r\n          this.patientPayment.cash_paid_amount;\r\n      } else {\r\n        this.patientPayment.change_amount = 0;\r\n      }\r\n    },\r\n    getDiscountPercent() {\r\n      this.patientPayment.discount_percent = parseFloat(\r\n        (this.patientPayment.discount_amount /\r\n          this.patientPayment.bill_amount) *\r\n        100).toFixed(2);\r\n\r\n      this.gridSum();\r\n    },\r\n    getDiscountAmount() {\r\n      this.patientPayment.discount_amount =\r\n        (this.patientPayment.bill_amount *\r\n          this.patientPayment.discount_percent) /\r\n        100;\r\n\r\n      this.gridSum();\r\n    },\r\n    getRefundAmt() {\r\n      this.gridSum();\r\n\r\n      if (!this.patientPayment.isSettlement && this.patientPayment.total_amount < 0) {\r\n        //this.patientPayment.refund_amount = Math.abs(this.patientPayment.total_amount);\r\n        this.patientPayment.isRefund = true;\r\n      } else {\r\n        this.patientPayment.refund_amount = 0;\r\n        this.patientPayment.isRefund = false;\r\n      }\r\n    },\r\n    async add() {\r\n      this.submitted = true;\r\n      try {\r\n        if (!this.patientPayment.aPatient.first_name) {\r\n          return;\r\n        } else if (!this.patientPayment.cdpayment_date) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error Message\",\r\n            detail: \"Payment Date is required\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (!this.patientPayment.invoice_id) {\r\n          return;\r\n        } else if (this.patientPayment.cash_paid_amount <= 0 && !this.patientPayment.isReadyForSettlement) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Enter amount!\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (this.patientPayment.isSettlement && this.patientPayment.due_amount > 0) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"Cannot settlement with due amount!\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (this.isCashPaid) {\r\n          return;\r\n        } else if (this.patientPayment.isRefund && this.patientPayment.refund_amount > 0 && this.patientPayment.cash_paid_amount > 0) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"You have Refund Amt\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else if (this.patientPayment.isReadyForSettlement && this.patientPayment.total_amount <= 0 && this.patientPayment.cash_paid_amount > 0) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Error\",\r\n            detail: \"You have Refund Amt\",\r\n            life: 10000,\r\n          });\r\n          return;\r\n        } else {\r\n          this.patientPayment.payment_date = moment(\r\n            String(this.patientPayment.cdpayment_date)\r\n          ).format(\"YYYY-MM-DD\");\r\n\r\n          if (this.patientPayment.cash_paid_amount > 0 && !this.isCash) {\r\n            this.patientPayment.lstPatientPaymentDetails.push({\r\n              payment_type_id: this.patientPayment.paymentTypeCash,\r\n\r\n              paid_amount: this.patientPayment.cash_paid_amount,\r\n            });\r\n\r\n            this.isCash = true;\r\n          }\r\n          this.patientPayment.paid_amount =\r\n          parseFloat(this.patientPayment.cash_paid_amount) +\r\n          parseFloat(this.patientPayment.total_amount_inf);\r\n\r\n          let result = await this.patientPaymentService.addIPD(\r\n            this.patientPayment, this\r\n          );\r\n          if (result.status === 200) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Success\",\r\n              detail: \"Saved Successfully\",\r\n              life: 10000,\r\n            });\r\n            if (this.patientPayment.isSettlement) {\r\n              this.printDischargeBillSummary(result.data)\r\n            } else {\r\n              this.printAdmissionPayment(result.data);\r\n            }\r\n\r\n            var admission_no_for_payment_from_admissionlist = localStorage.getItem('admission_no_for_payment_from_admissionlist');\r\n            if (admission_no_for_payment_from_admissionlist) {\r\n              localStorage.removeItem('admission_no_for_payment_from_admissionlist');\r\n              this.$router.push(\"/patient-admission-list\");\r\n            }\r\n\r\n            var admission_id_for_payment = localStorage.getItem('admission_id_for_payment');\r\n            if (admission_id_for_payment) {\r\n              localStorage.removeItem('admission_id_for_payment');\r\n              this.$router.push(\"/patient-admission-form\");\r\n            }\r\n            this.reset();\r\n          } else if (result.status === 401) {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Error\",\r\n              detail: result.data,\r\n              life: 10000,\r\n            });\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"error\",\r\n              summary: \"Failed\",\r\n              detail: result.res,\r\n              life: 10000,\r\n            });\r\n            this.reset();\r\n          }\r\n        }\r\n      } catch (error) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Failed\",\r\n          detail: error,\r\n          life: 10000,\r\n        });\r\n        this.reset();\r\n      }\r\n    },\r\n\r\n    // line discount\r\n    calculatePerInvestigationDiscountAmount(data) {\r\n      this.patientPayment.ipdServiceList.forEach(\r\n        (element) => {\r\n          if (element.type == data.type && element.admission_bed_service_package_details_id == data.admission_bed_service_package_details_id) {\r\n            element.discount_amount = (element.charge * element.discount_percent) / 100;\r\n            element.total_amount = element.charge - element.discount_amount;\r\n          }\r\n        }\r\n      );\r\n      this.gridSum();\r\n    },\r\n    calculatePerInvestigationDiscountPercent(data) {\r\n      this.patientPayment.ipdServiceList.forEach(\r\n        (element) => {\r\n          if (element.type == data.type && element.admission_bed_service_package_details_id == data.admission_bed_service_package_details_id) {\r\n            element.discount_percent = parseFloat((element.discount_amount / element.charge) * 100).toFixed(2);\r\n            //var discount_amount = (element.charge * element.discount_percent) / 100;\r\n            element.total_amount = element.charge - element.discount_amount;\r\n          }\r\n        }\r\n      );\r\n      this.gridSum();\r\n    },\r\n  },\r\n};"]}]}